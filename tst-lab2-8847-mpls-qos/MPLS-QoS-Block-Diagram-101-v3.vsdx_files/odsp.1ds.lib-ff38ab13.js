/*! For license information please see odsp.1ds.lib-ff38ab13.js.LICENSE.txt */
(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["odsp.1ds.lib"],{"1ds-lib":function(e,t,n){"use strict";n.r(t),n.d(t,"_OneDSTelemetryHandler",function(){return Fo}),n.d(t,"_OneDSLogger",function(){return Uo}),n.d(t,"_InMemoryPropertyStorage",function(){return Ho});var a={};n.r(a),n.d(a,"requiredDiagnostic",function(){return w}),n.d(a,"optionalDiagnostic",function(){return E}),n.d(a,"requiredService",function(){return A});var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)};function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return o=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)};function s(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}function c(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))}Object.create,Object.create;var d=function(){function e(e){this._items=[],this._maxSize=e}return Object.defineProperty(e.prototype,"isFull",{get:function(){return this._items.length>=this._maxSize},enumerable:!1,configurable:!0}),e.prototype.getAll=function(){return this._items.slice()},e.prototype.push=function(e){this._items.length>=this._maxSize&&(this._items.length=0),this._items.push(e)},e}(),l=function(){function e(e){if(e<=0)throw new Error("Size must be positive");this._size=e,this._buffer=new Array(e),this._length=0,this._head=-1}return e.prototype.push=function(e){this._length<this._size&&this._length++,this._head++,this._head===this._size&&(this._head=0),this._buffer[this._head]=e},e.prototype.popOldest=function(){if(0===this._length)return null;var e=(this._head-this._length+1+this._size)%this._size;return this._length--,this._buffer[e]},Object.defineProperty(e.prototype,"isFull",{get:function(){return this._length>=this._size},enumerable:!1,configurable:!0}),e.prototype.getAll=function(){var e=this._head+1;return this._length<this._size?this._buffer.slice(0,e):c(c([],this._buffer.slice(e),!0),this._buffer.slice(0,e),!0)},e}();function u(e,t){for(var n="";n.length<e;){var a=16*(null!=t?t:Math.random)();n+=(a|=0).toString(16)}return n}function f(e,t){return void 0===t&&(t=!1),e?function(e,t){var n=e.match(/^\{(.*)\}$/);return n?t?n[0]:n[1]:t?"{"+e+"}":e}(e.toUpperCase(),t):""}var p="KillSwitchOverrides",m="".concat(p,"_").concat("enableKillSwitches"),_="".concat(p,"_").concat("disableKillSwitches");function h(e){try{var t=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return t?t.pop():""}catch(e){return""}}function b(e){var t=[],n=[];for(var a in e)(e[a]?t:n).push(a);try{document.cookie="".concat(m,"=").concat(t.join(","),";path=/;samesite=none;secure;").concat(t.length?"":"expires=Thu, 01 Jan 1970 00:00:01 GMT;"),document.cookie="".concat(_,"=").concat(n.join(","),";path=/;samesite=none;secure;").concat(n.length?"":"expires=Thu, 01 Jan 1970 00:00:01 GMT;")}catch(e){}}var g={},v=function(){g=function(e,t,n,a){if(t)for(var i=0,r=t.split(",");i<r.length;i++)e[f(r[i],!1)]=!0;if(n)for(var o=0,s=n.split(",");o<s.length;o++)e[f(s[o],!1)]=!1;return e}({},h(m),h(_));var e=function(e){var t={};if(e)for(var n=e.split("&"),a=0;a<n.length;a++){var i=n[a].split("=");void 0!==i[1]&&(i[1]=i[1].replace(/\+/g," "),t[i[0]]=decodeURIComponent(i[1]))}return t}(function(){try{return location.search?location.search.substring(1):""}catch(e){return""}}());e.enableKillSwitches,e.disableKillSwitches,e.debugKillSwitches,b(g);try{window.__debugSetKillSwitch=function(e,t){void 0===t&&(t=!0),g[f(e,!1)]=!!t,b(g)}}catch(e){}v=function(){}};function y(e){var t=e&&e.killSwitches;return{isActivated:function(e,n,a){var i=!1;if(e){var r=f(e,!1);r in g?i=!!g[r]:t&&(i=!!t[r])}return i}}}var S=!function(){function e(){}return e.initKillSwitches=function(t){e._killSwitch=y({killSwitches:t||{}})},e.isActivated=function(t,n,a){var i;if(v(),e._killSwitch)return e.isActivated=e._killSwitch.isActivated,e._killSwitch.isActivated(t,n,a);try{if(window._spPageContextInfo){var r=y(window._spPageContextInfo);return(null===(i=window._spPageContextInfo)||void 0===i?void 0:i.killSwitches)&&(e.isActivated=r.isActivated),r.isActivated(t,n,a)}if(window.Flight){var o=void 0;if(window.Flight.KillSwitches){o={};for(var s=0,c=Object.keys(window.Flight.KillSwitches);s<c.length;s++){var d=c[s];o[window.Flight.KillSwitches[d]]=!0}}var l=y({killSwitches:o});return o&&(e.isActivated=l.isActivated),l.isActivated(t,n,a)}}catch(e){return!1}return!1},e}().isActivated("115330F7-9AB5-4692-80AB-7401BE3808AA","03/17/2022","Events are stored in a Circular Buffer instead of an array"),D=function(){function e(){this._handlers=[],this._buffer=S?new l(500):new d(500),this._hasBufferOverflown=!1}return Object.defineProperty(e.prototype,"startDate",{get:function(){return window.performance&&window.performance.timing&&window.performance.timing.navigationStart?new Date(window.performance.timing.navigationStart):new Date},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"startTime",{get:function(){return this.startDate.getTime()},enumerable:!1,configurable:!0}),e.prototype.getTime=function(){return(new Date).getTime()},e.prototype.cleanString=function(e){return e},e.prototype.addLogHandler=function(e){var t=this._handlers,n=this._buffer;return t.push(e),n.getAll()},e.prototype.removeLogHandler=function(e){for(var t=this._handlers,n=0;n<t.length;n++)if(t[n]===e){t.splice(n,1);break}},e.prototype.logEvent=function(e,t){var n,a,i=this._buffer,r=this._handlers,s=Object.freeze({data:(n=e.data,a=[],"object"!=typeof n?n:function e(t){var n=null;return t&&(n=Array.isArray(t)?[]:Object.create(Object.getPrototypeOf(t)),Object.keys(t).forEach(function(i){var r=t[i];if("object"==typeof r){if(-1!==a.indexOf(r))throw new Error("Cannot perform DeepCopy() because a circular reference was encountered, object: ".concat(t,", ")+"property: ".concat(i));a.push(r),n[i]=e(r),a.pop()}else n[i]=r})),n}(n)),context:o({},e.context),id:e.id,critical:e.critical,endTime:e.endTime,eventName:e.eventName,shortEventName:e.shortEventName,parentId:e.parentId,startTime:e.startTime,eventType:t,metadata:e.metadata,vector:e.vector,isEventTypePrefixingDisabled:e.isEventTypePrefixingDisabled}),c=i.isFull;i.push(s),!this._hasBufferOverflown&&c&&(this._hasBufferOverflown=!0,0===r.length&&C(new Error("Logging buffer overflow hit before any logging handler was registered")));for(var d=0;d<r.length;d++)try{r[d](s)}catch(e){C(e)}},e.prototype.isFeatureEnabled=function(e){return!0},e.prototype.addFeatureEnabler=function(e){},e.prototype.removeFeatureEnabler=function(e){},e.prototype.getStack=function(){var e;try{var t=window;t.______ExpectedError______&&t.______ExpectedError______()}catch(t){e=t}return e&&e.stack||void 0},e}();function I(){return new D}var x="undefined"!=typeof window?window.ODSP_TELEMETRY_MANAGER=window.ODSP_TELEMETRY_MANAGER||I():"undefined"!=typeof self?self.ODSP_TELEMETRY_MANAGER=self.ODSP_TELEMETRY_MANAGER||I():I();function C(e){console.error("Telemetry Manager:",e)}var O,w="requiredDiagnostic",E="optionalDiagnostic",A="requiredService",L=function(){function e(e,t){e?(this.root=e.root,this.parent=e.current):this.root=this.parent="00000000-0000-0000-0000-000000000000",this.current=t||function(e){var t=[];t.push(u(8,e)),t.push(u(4,e));var n="4"+u(3,e);t.push(n);var a=u(4,e),i=parseInt(a[0],16);return i&=3,a=(i|=8).toString(16)+a.substr(1),t.push(a),t.push(u(12,e)),t.join("-")}()}return e._getCorrelationVector=function(){var t;return"undefined"!=typeof window?t=window.rootVector:"undefined"!=typeof self&&(t=self.rootVector),t||new e},e.prototype.toString=function(){return"".concat(this.root,"#").concat(this.parent,"#").concat(this.current)},e.RootVector=e._getCorrelationVector(),e}();!function(e){e[e.Single=0]="Single",e[e.Start=1]="Start",e[e.End=2]="End"}(O||(O={}));var k,M=0;!function(e){e[e.Consumer=0]="Consumer",e[e.ConsumerAnonymous=1]="ConsumerAnonymous",e[e.Business=2]="Business",e[e.BusinessAnonymous=3]="BusinessAnonymous",e[e.Unknown=4]="Unknown",e[e.ConsumerOnSPO=5]="ConsumerOnSPO"}(k||(k={}));var P=new WeakMap,T=function(){function e(e,t,n){this.context={},this.data={},this.context=o({},this.addContext({})),this.id=M++,n&&(this.parentId=n.id),this.startTime=e&&e.startTimeOverride||x.getTime(),this.vector=new L(n?n.vector:L.RootVector),e&&this._setData(e),this._logEvent(t)}return e.isTypeOf=function(e){return e.eventName?e.eventName.indexOf(this.prototype.shortEventName+",")>=0:!!e.prototype&&e.prototype.shortEventName===this.prototype.shortEventName},e.withManager=function(e){if(!e||e===x)return this;var t=P.get(e);t||(t=new WeakMap,P.set(e,t));var n=t.get(this);if(n)return n;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t}(this);return a.prototype.manager=e,n=a,t.set(this,n),n},e.withData=function(e){if(!e)return this;var t="function"!=typeof e?function(t){return o(o({},e),t)}:e,n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return r(n,e),n.prototype.addData=function(n){var a=o(o({},n),t(n));return o(o({},a),e.prototype.addData.call(this,a))},n}(this);return n},e.withContext=function(e){if(!e)return this;var t="function"!=typeof e?function(t){return o(o({},e),t)}:e,n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return r(n,e),n.prototype.addContext=function(n){var a=o(o({},n),t(n));return o(o({},a),e.prototype.addContext.call(this,a))},n}(this);return n},e.from=function(e){return e?this.withManager(e.prototype.manager).withContext(function(t){return e.prototype.addContext(t)}).withData(function(t){return e.prototype.addData(t)}):this},e.prototype.addContext=function(e){return F(this.manager,e,{})},e.prototype.addData=function(e){return e},e.prototype._setData=function(e){var t=o(o({},this.addData(this.data)),e);!function(e,t,n,a){for(var i=0,r=Object.keys(n);i<r.length;i++){var o=r[i];o in t&&U(e,n,a,o,t[o])}}(this.manager,this.metadata,t,this.data)},e.prototype._logEvent=function(e){this.manager.logEvent(this,e)},e}();function U(e,t,n,a,i){var r=t[a];switch(typeof r){case"string":var o=e.cleanString(r,a,i);return void(void 0!==o&&(n[a]=o));case"undefined":return;case"object":return void(r&&Object.getPrototypeOf(r)===Object.prototype?n[a]=F(e,r,{}):n[a]=r);default:return void(n[a]=r)}}function F(e,t,n){for(var a=0,i=Object.keys(t);a<i.length;a++)U(e,t,n,i[a]);return n}var H=T.prototype;H.eventName="EventBase,",H.shortEventName="EventBase",H.critical=!1,H.manager=x;var R=function(e){var t="undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0;e||(e=t&&t.navigator&&navigator.userAgent||"");var n,a=e,i=e.toLowerCase(),r=function(e){var t;function n(n){return t=RegExp("".concat(n,"(\\d+)([\\d.]*)")).exec(e)}e=e.toLowerCase();var a=n("msie ")||n("trident.*rv:"),i=t&&"9"===t[1],r=!t&&n("edge/"),o=!t&&n("edg/"),s=!t&&n("fxios|firefox/"),c=!t&&n("(?:chrome|crios)/"),d=!t&&/safari\/(\d+)/.test(e);return d&&n("version/"),{browserName:a?"IE":r?"Edge":o?"EdgeChromium":s?"Firefox":c?"Chrome":d?"Safari":"NA",isChrome:!!c,isEdge:!!r,isEdgeChromium:!!o,isFirefox:!!s,isIE:!!a,isIE9:!!i,isSafari:!!d,matchedBrowser:t}}(i),s={browserMajor:(n=r.matchedBrowser)&&parseInt(n[1],10)||0,browserMinor:n&&n[2]&&n[2].slice(1)||"0"},c=function(e){e=e.toLowerCase();var t=/windows phone|wpdesktop/.test(e),n=t||/ipad|iphone|ipod|android/.exec(e),a=n&&n[0],i="android"===a,r="ipad"===a,o=!!a&&!i,s=!n&&e.indexOf("macintosh")>-1,c=!n&&e.indexOf("windows nt")>-1;return{isAndroid:i,isIOS:o,isIPad:r,isMac:s,isWindows:c,isWinPhone:!!t,isMobile:!!n,osName:c?"Windows":t?"Windows Phone":s?"OSX":o?"IOS":i?"Android":"NA"}}(i),d=c.isMobile,l=/electron\/\\d+[\\d.]*/.test(i),u=i.indexOf("winappwipenabled")>-1,f=!("undefined"==typeof window||!window.matchMedia)&&(window.matchMedia("(display-mode: standalone)").matches||window.matchMedia("(display-mode: minimal-ui)").matches),p=/[\s\(](os|os x|windows (?:phone|nt)|android) ([\d._]+)/.exec(i),m=!1,_=!1,h=!1,b=!1;if(t&&t.document){var g=document.createElement("style");g.type="text/css",m=!g.styleSheet,_="addBehavior"in HTMLDivElement.prototype;var v=document.createElement("input");v.type="file";var y=t.File,S=y&&y.prototype;b=!(!S||!(S.slice||S.mozSlice||S.webkitSlice)),h="webkitdirectory"in v&&!l}return o(o(o(o({},r),s),c),{isElectron:l,osVersion:p?p[2]:"NA",isWindows81:!d&&/windows (?:8\.1|nt 6\.3)/.test(i),isWindows10:!d&&i.indexOf("windows nt 10")>-1,isWindows7:!d&&i.indexOf("windows nt 6.1")>-1,isWinAppWipEnabled:u,isPWA:f,areCSS3TransitionsSupported:!r.isIE||s.browserMajor>9,areTouchEventsSupported:!!t&&"ontouchstart"in t,isFolderUploadSupported:h,isHtml5FileUploadSupported:b,isRetinaSupported:!!t&&t.devicePixelRatio>1,isUnlimitedStyleSheetsSupported:m,isWebDavSupported:_,userAgent:a})};function N(e,t){void 0===t&&(t=new R);var n=function(e){return void 0===e&&(e=new R),{BrowserIsMobile:e.isMobile,BrowserIsPWA:e.isPWA,BrowserMajVer:e.browserMajor,BrowserMinVer:e.browserMinor,BrowserName:e.browserName,BrowserUserAgent:e.userAgent,OSName:e.osName,OSVersion:e.osVersion}}(t);return o(o({AccountType:void 0!==e.accountType?k[e.accountType]:void 0,CloudType:e.cloudType,Environment:e.environment,FarmLabel:e.farmLabel,FarmName:e.farmName,IsAuthenticated:void 0===e.isAuthenticated?void 0:e.isAuthenticated?1:0,Market:e.market,Manifest:e.manifest,Session:e.session,SiteSubscriptionId:e.siteSubscriptionId,UserId:e.userId,Version:e.version,Workload:e.workload,SiteId:e.siteId,WebId:e.webId,WebTemplateId:e.webTemplateId,pageCorrelationId:e.pageCorrelationId,originalSession:e.originalSession,listId:e.listId,Product:e.product,SessionId:e.session,TenantId:e.siteSubscriptionId,UserAgent:n.BrowserUserAgent,ServerGU:e.sideBySideToken},n||{}),e.context||{})}var B=n("odsp.1ds_577"),j=n("odsp.1ds_3294"),V=n("odsp.1ds_43"),z="",G=j.a,K=j.t.freeze,W=(j.t.seal,j.t.keys),q=String[j.l],Q=q.trim,Y=q.endsWith,J=q.startsWith,X=Date[j.l].toISOString,Z=Array.isArray,$=j.r.toString,ee=j.i.toString,te=ee.call(j.t),ne=/-([a-z])/g,ae=/([^\w\d_$])/g,ie=/^(\d+[\w\d_$])/,re=Object.getPrototypeOf;function oe(e){return void 0===e||typeof e===j.u}function se(e){return null===e||oe(e)}function ce(e){return!se(e)}function de(e,t){return!(!e||!j.i.call(e,t))}function le(e){return!(!e||typeof e!==j.d)}function ue(e){return!(!e||typeof e!==j.s)}function fe(e){var t=e;return t&&ve(t)&&(t=(t=(t=t.replace(ne,function(e,t){return t.toUpperCase()})).replace(ae,"_")).replace(ie,function(e,t){return"_"+t})),t}function pe(e,t){if(e)for(var n in e)j.i.call(e,n)&&t.call(e,n,e[n])}function me(e,t){var n=!1;return e&&t&&!(n=e===t)&&(n=Y?e.endsWith(t):function(e,t){var n=!1,a=t?t.length:0,i=e?e.length:0;if(a&&i&&i>=a&&!(n=e===t)){for(var r=i-1,o=a-1;o>=0;o--){if(e[r]!=t[o])return!1;r--}n=!0}return n}(e,t)),n}function _e(e,t){var n=!1;return e&&t&&!(n=e===t)&&(n=J?e.startsWith(t):function(e,t){var n=!1,a=t?t.length:0;if(e&&a&&e.length>=a&&!(n=e===t)){for(var i=0;i<a;i++)if(e[i]!==t[i])return!1;n=!0}return n}(e,t)),n}function he(e,t){return!(!e||!t)&&-1!==e.indexOf(t)}var be=Z||function(e){return!(!e||"[object Array]"!==$.call(e))};function ge(e){return!(!e||"[object Error]"!==$.call(e))}function ve(e){return"string"==typeof e}function ye(e){return"number"==typeof e}function Se(e){return"boolean"==typeof e}function De(e){var t=!1;if(e&&"object"==typeof e){var n=re?re(e):function(e){if(e){if(re)return re(e);var t=e.__proto__||e[j.l]||e.constructor;if(t)return t}return null}(e);n?(n.constructor&&j.i.call(n,"constructor")&&(n=n.constructor),t=typeof n===j.s&&ee.call(n)===te):t=!0}return t}function Ie(e){if(e)return X?e.toISOString():function(e){if(e&&e.getUTCFullYear){var t=function(e){var t=String(e);return 1===t.length&&(t="0"+t),t};return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}(e)}function xe(e,t,n){var a=e.length;try{for(var i=0;i<a&&(!(i in e)||-1!==t.call(n||e,e[i],i,e));i++);}catch(e){}}function Ce(e,t,n){if(e){if(e.indexOf)return e.indexOf(t,n);var a=e.length,i=n||0;try{for(var r=Math.max(i>=0?i:a-Math.abs(i),0);r<a;r++)if(r in e&&e[r]===t)return r}catch(e){}}return-1}function Oe(e){return e&&(e=Q&&e.trim?e.trim():e.replace?e.replace(/^\s+|\s+$/g,""):e),e}var we=!{toString:null}.propertyIsEnumerable("toString"),Ee=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];function Ae(e){var t=typeof e;if(t===j.s||t===j.d&&null!==e||Object(V.n)("objKeys called on non-object"),!we&&W)return W(e);var n=[];for(var a in e)e&&j.i.call(e,a)&&n.push(a);if(we)for(var i=Ee.length,r=0;r<i;r++)e&&j.i.call(e,Ee[r])&&n.push(Ee[r]);return n}function Le(e,t,n,a){if(G)try{var i={enumerable:!0,configurable:!0};return n&&(i.get=n),a&&(i.set=a),G(e,t,i),!0}catch(e){}return!1}function ke(e){return K&&pe(e,function(e,t){(be(t)||le(t))&&K(t)}),Me(e)}var Me=K||function(e){return e};function Pe(){var e=Date;return e.now?e.now():(new e).getTime()}function Te(e){return ge(e)?e.name:z}function Ue(e,t,n,a,i){var r=n;return e&&((r=e[t])===n||i&&!i(r)||a&&!a(n)||(r=n,e[t]=r)),r}function Fe(e){return!e}function He(e){return!!e}function Re(e){throw new Error(e)}function Ne(e,t,n,a,i){e&&t&&n&&(!1!==i||oe(e[t]))&&(e[t]=function(e,t){var n=null,a=null;return ue(e)?n=e:a=e,function(){var e=arguments;if(n&&(a=n()),a)return a[t].apply(a,e)}}(n,a))}function Be(e,t,n,a){return e&&t&&le(e)&&be(n)&&xe(n,function(n){ve(n)&&Ne(e,n,t,n,a)}),e}function je(e){return e&&j.e&&(e=Object(j.t)(Object(j.e)({},e))),e}function Ve(e,t,n,a,i,r){var o=arguments,s=o[0]||{},c=o.length,d=!1,l=1;for(c>0&&Se(s)&&(d=s,s=o[l]||{},l++),le(s)||(s={});l<c;l++){var u=o[l],f=be(u),p=le(u);for(var m in u){var _=f&&m in u||p&&j.i.call(u,m);if(_){var h=u[m],b=void 0;if(d&&h&&((b=be(h))||De(h))){var g=s[m];b?be(g)||(g=[]):De(g)||(g={}),h=Ve(d,g,h)}void 0!==h&&(s[m]=h)}}}return s}var ze="window",Ge="JSON",Ke="XMLHttpRequest",We=null,qe=null,Qe=null,Ye=null;function Je(e,t){var n=!1;if(e){try{if(!(n=t in e)){var a=e[j.l];a&&(n=t in a)}}catch(e){}if(!n)try{n=!oe((new e)[t])}catch(e){}}return n}function Xe(e){var t=Object(V.e)();return t&&t[e]?t[e]:e===ze&&Ze()?window:null}function Ze(){return Boolean(typeof window===j.d&&window)}function $e(){return Ze()?window:Xe(ze)}function et(){return Boolean(typeof document===j.d&&document)}function tt(){return et()?document:Xe("document")}function nt(){return Boolean(typeof navigator===j.d&&navigator)}function at(){return nt()?navigator:Xe("navigator")}function it(e){return typeof location===j.d&&location?location:Xe("location")}function rt(){return Boolean(typeof JSON===j.d&&JSON||null!==Xe(Ge))}function ot(){return rt()?JSON||Xe(Ge):null}function st(){var e=at();return!(!e||!e.product)&&"ReactNative"===e.product}function ct(){var e=at();if(e&&(e.userAgent!==qe||null===We)){var t=((qe=e.userAgent)||z).toLowerCase();We=he(t,"msie")||he(t,"trident/")}return We}function dt(e){var t=Object[j.l].toString.call(e),n=z;return"[object Error]"===t?n="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e.name+"'":rt()&&(n=ot().stringify(e)),t+n}function lt(){return null===Ye&&(Ye=nt()&&Boolean(at().sendBeacon)),Ye}function ut(e){var t=!1;try{t=!!Xe("fetch");var n=Xe("Request");t&&e&&n&&(t=Je(n,"keepalive"))}catch(e){}return t}function ft(){var e=!1;try{e=!!Xe(Ke)}catch(e){}return e}var pt,mt=n("odsp.1ds_1947"),_t=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],ht=null;function bt(e,t){return function(){var n=arguments,a=gt(t);if(a){var i=a.listener;i&&i[e]&&i[e].apply(i,n)}}}function gt(e){var t,n=ht;return n||!0===e.disableDbgExt||(n=ht||((t=Xe("Microsoft"))&&(ht=t.ApplicationInsights),ht)),n?n.ChromeDbgExt:null}function vt(e){return e?'"'+e.replace(/\"/g,z)+'"':z}function yt(e,t){var n=typeof console!==j.u?console:Xe("console");if(n){var a="log";n[e]&&(a=e),ue(n[a])&&n[a](t)}}var St=function(){function e(e,t,n,a){void 0===n&&(n=!1);var i=this;i.messageId=e,i.message=(n?"AI: ":"AI (Internal): ")+e;var r=z;rt()&&(r=ot().stringify(a));var o=(t?" message:"+vt(t):z)+(a?" props:"+vt(r):z);i.message+=o}return e.dataType="MessageData",e}();function Dt(e,t){return(e||{}).logger||new It(t)}var It=function e(t){this.identifier="DiagnosticLogger",this.queue=[];var n=0,a={};Object(mt.e)(e,this,function(e){function i(e,n){var a=t[e];return se(a)?n:a}function r(e,n){var a=gt(t);a&&a.diagLog&&a.diagLog(e,n)}se(t)&&(t={}),e.consoleLoggingLevel=function(){return i("loggingLevelConsole",0)},e.telemetryLoggingLevel=function(){return i("loggingLevelTelemetry",1)},e.maxInternalMessageLimit=function(){return i("maxMessageLimit",25)},e.enableDebugExceptions=function(){return i("enableDebugExceptions",!1)},e.throwInternal=function(t,n,i,o,s){void 0===s&&(s=!1);var c=new St(n,i,s,o);if(e.enableDebugExceptions())throw dt(c);var d=1===t?"errorToConsole":"warnToConsole";if(oe(c.message))r("throw"+(1===t?"Critical":"Warning"),c);else{var l=e.consoleLoggingLevel();if(s){var u=+c.messageId;!a[u]&&l>=t&&(e[d](c.message),a[u]=!0)}else l>=t&&e[d](c.message);e.logInternalMessage(t,c)}},e.warnToConsole=function(e){yt("warn",e),r("warning",e)},e.errorToConsole=function(e){yt("error",e),r("error",e)},e.resetInternalMessageCount=function(){n=0,a={}},e.logInternalMessage=function(t,i){if(!(n>=e.maxInternalMessageLimit())){var o=!0,s="AITR_"+i.messageId;if(a[s]?o=!1:a[s]=!0,o&&(t<=e.telemetryLoggingLevel()&&(e.queue.push(i),n++,r(1===t?"error":"warn",i)),n===e.maxInternalMessageLimit())){var c="Internal events throttle limit per PageView reached for this app.",d=new St(23,c,!1);e.queue.push(d),1===t?e.errorToConsole(c):e.warnToConsole(c)}}}})};function xt(e,t,n,a,i,r){void 0===r&&(r=!1),(e||new It).throwInternal(t,n,a,i,r)}var Ct=function(){function e(t,n,a){var i,r=this,o=!1;r.start=Pe(),r.name=t,r.isAsync=a,r.isChildEvt=function(){return!1},ue(n)&&(o=Le(r,"payload",function(){return!i&&ue(n)&&(i=n(),n=null),i})),r.getCtx=function(t){return t?t===e.ParentContextKey||t===e.ChildrenContextKey?r[t]:(r.ctx||{})[t]:null},r.setCtx=function(t,n){t&&(t===e.ParentContextKey?(r[t]||(r.isChildEvt=function(){return!0}),r[t]=n):t===e.ChildrenContextKey?r[t]=n:(r.ctx=r.ctx||{})[t]=n)},r.complete=function(){var t=0,a=r.getCtx(e.ChildrenContextKey);if(be(a))for(var i=0;i<a.length;i++){var s=a[i];s&&(t+=s.time)}r.time=Pe()-r.start,r.exTime=r.time-t,r.complete=function(){},!o&&ue(n)&&(r.payload=n())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),Ot=function e(t){this.ctx={},Object(mt.e)(e,this,function(e){e.create=function(e,t,n){return new Ct(e,t,n)},e.fire=function(e){e&&(e.complete(),t&&ue(t.perfEvent)&&t.perfEvent(e))},e.setCtx=function(t,n){t&&((e.ctx=e.ctx||{})[t]=n)},e.getCtx=function(t){return(e.ctx||{})[t]}})},wt="CoreUtils.doPerf";function Et(e,t,n,a,i){if(e){var r=e;if(ue(r.getPerfMgr)&&(r=r.getPerfMgr()),r){var o=void 0,s=r.getCtx(wt);try{if(o=r.create(t(),a,i)){if(s&&o.setCtx&&(o.setCtx(Ct.ParentContextKey,s),s.getCtx&&s.setCtx)){var c=s.getCtx(Ct.ChildrenContextKey);c||(c=[],s.setCtx(Ct.ChildrenContextKey,c)),c.push(o)}return r.setCtx(wt,o),n(o)}}catch(e){o&&o.setCtx&&o.setCtx("exception",e)}finally{o&&r.fire(o),r.setCtx(wt,s)}}}return n()}var At=n("odsp.1ds_1787"),Lt=4294967296,kt=4294967295,Mt=!1,Pt=123456789,Tt=987654321;function Ut(e){e<0&&(e>>>=0),Pt=123456789+e&kt,Tt=987654321-e&kt,Mt=!0}function Ft(){try{var e=2147483647&Pe();Ut((Math.random()*Lt^e)+e)}catch(e){}}function Ht(e){return e>0?Math.floor(Rt()/kt*(e+1))>>>0:0}function Rt(e){var t=0,n=Xe("crypto")||Xe("msCrypto");return n&&n.getRandomValues&&(t=n.getRandomValues(new Uint32Array(1))[0]&kt),0===t&&ct()&&(Mt||Ft(),t=Nt()&kt),0===t&&(t=Math.floor(Lt*Math.random()|0)),e||(t>>>=0),t}function Nt(e){var t=((Tt=36969*(65535&Tt)+(Tt>>16)&kt)<<16)+(65535&(Pt=18e3*(65535&Pt)+(Pt>>16)&kt))>>>0&kt|0;return e||(t>>>=0),t}function Bt(e){void 0===e&&(e=22);for(var t=Rt()>>>0,n=0,a=z;a.length<e;)n++,a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&t),t>>>=6,5===n&&(t=(Rt()<<2&4294967295|3&t)>>>0,n=0);return a}var jt=j.a,Vt="."+Bt(6),zt=0;function Gt(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType}function Kt(e,t){return void 0===t&&(t=!1),fe(e+zt+++(t?".2.8.3":"")+Vt)}function Wt(e){var t={id:Kt("_aiData-"+(e||"")+".2.8.3"),accept:function(e){return Gt(e)},get:function(e,n,a,i){var r=e[t.id];return r?r[fe(n)]:(i&&((r=function(e,t){var n=t[e.id];if(!n){n={};try{Gt(t)&&(function(e,t,n){if(jt)try{return jt(e,t,{value:n,enumerable:!1,configurable:!0}),!0}catch(e){}return!1}(t,e.id,n)||(t[e.id]=n))}catch(e){}}return n}(t,e))[fe(n)]=a),a)},kill:function(e,t){if(e&&e[t])try{delete e[t]}catch(e){}}};return t}var qt=Wt("plugin");function Qt(e){return qt.get(e,"state",{},!0)}function Yt(e,t){for(var n,a=[],i=null,r=e.getNext();r;){var o=r.getPlugin();o&&(i&&ue(i.setNextPlugin)&&ue(o.processTelemetry)&&i.setNextPlugin(o),(ue(o.isInitialized)?o.isInitialized():(n=Qt(o)).isInitialized)||a.push(o),i=o,r=r.getNext())}xe(a,function(a){var i=e.core();a.initialize(e.getCfg(),i,t,e.getNext()),n=Qt(a),a.core||n.core||(n.core=i),n.isInitialized=!0,delete n.teardown})}function Jt(e){return e.sort(function(e,t){var n=0,a=ue(t.processTelemetry);return ue(e.processTelemetry)?n=a?e.priority-t.priority:1:a&&(n=-1),n})}var Xt=0;function Zt(e,t,n,a){var i=null,r=[];null!==a&&(i=a?function(e,t,n){for(;e;){if(e.getPlugin()===n)return e;e=e.getNext()}return nn([n],t.config||{},t)}(e,n,a):e);var o={_next:function(){var e=i;if(i=e?e.getNext():null,!e){var t=r;t&&t.length>0&&(xe(t,function(e){try{e.func.call(e.self,e.args)}catch(e){xt(n.logger,2,73,"Unexpected Exception during onComplete - "+dt(e))}}),r=[])}return e},ctx:{core:function(){return n},diagLog:function(){return Dt(n,t)},getCfg:function(){return t},getExtCfg:s,getConfig:function(e,n,a){void 0===a&&(a=!1);var i,r=s(e,null);return r&&!se(r[n])?i=r[n]:t&&!se(t[n])&&(i=t[n]),se(i)?a:i},hasNext:function(){return!!i},getNext:function(){return i},setNext:function(e){i=e},iterate:function(e){for(var t;t=o._next();){var n=t.getPlugin();n&&e(n)}},onComplete:function(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];e&&r.push({func:e,self:oe(t)?o.ctx:t,args:n})}}};function s(e,n,a){var i;if(void 0===n&&(n={}),void 0===a&&(a=0),t){var r=t.extensionConfig;r&&e&&(i=r[e])}if(i){if(le(n)&&0!==a){var o=Ve(!0,n,i);t&&2===a&&pe(n,function(e){if(se(o[e])){var n=t[e];se(n)||(o[e]=n)}}),i=o}}else i=n;return i}return o}function $t(e,t,n,a){var i=Zt(e,t,n,a),r=i.ctx;return r.processNext=function(e){var t=i._next();return t&&t.processTelemetry(e,r),!t},r.createNew=function(e,a){return void 0===e&&(e=null),be(e)&&(e=nn(e,t,n,a)),$t(e||r.getNext(),t,n,a)},r}function en(e,t,n){var a=t.config||{},i=Zt(e,a,t,n),r=i.ctx;return r.processNext=function(e){var t=i._next();return t&&t.unload(r,e),!t},r.createNew=function(e,n){return void 0===e&&(e=null),be(e)&&(e=nn(e,a,t,n)),en(e||r.getNext(),t,n)},r}function tn(e,t,n){var a=t.config||{},i=Zt(e,a,t,n).ctx;return i.processNext=function(e){return i.iterate(function(t){ue(t.update)&&t.update(i,e)})},i.createNew=function(e,n){return void 0===e&&(e=null),be(e)&&(e=nn(e,a,t,n)),tn(e||i.getNext(),t,n)},i}function nn(e,t,n,a){var i=null,r=!a;if(be(e)&&e.length>0){var o=null;xe(e,function(e){if(r||a!==e||(r=!0),r&&e&&ue(e.processTelemetry)){var s=function(e,t,n){var a,i=null,r=ue(e.processTelemetry),o=ue(e.setNextPlugin),s={getPlugin:function(){return e},getNext:function(){return i},processTelemetry:function(a,d){c(d=d||function(){var a;return e&&ue(e._getTelCtx)&&(a=e._getTelCtx()),a||(a=$t(s,t,n)),a}(),function(t){if(!e||!r)return!1;var n=Qt(e);return!n.teardown&&!n.disabled&&(o&&e.setNextPlugin(i),e.processTelemetry(a,t),!0)},"processTelemetry",function(){return{item:a}},!a.sync)||d.processNext(a)},unload:function(t,n){c(t,function(){var a=!1;if(e){var i=Qt(e),r=e.core||i.core;!e||r&&r!==t.core()||i.teardown||(i.core=null,i.teardown=!0,i.isInitialized=!1,e.teardown&&!0===e.teardown(t,n)&&(a=!0))}return a},"unload",function(){},n.isAsync)||t.processNext(n)},update:function(t,n){c(t,function(){var a=!1;if(e){var i=Qt(e),r=e.core||i.core;!e||r&&r!==t.core()||i.teardown||e.update&&!0===e.update(t,n)&&(a=!0)}return a},"update",function(){},!1)||t.processNext(n)},_id:a=e?e.identifier+"-"+e.priority+"-"+Xt++:"Unknown-0-"+Xt++,_setNext:function(e){i=e}};function c(t,n,r,o,s){var c=!1,d=e?e.identifier:"TelemetryPluginChain",l=t._hasRun;return l||(l=t._hasRun={}),t.setNext(i),e&&Et(t.core(),function(){return d+":"+r},function(){l[a]=!0;try{var e=i?i._id:z;e&&(l[e]=!1),c=n(t)}catch(e){var o=!i||l[i._id];o&&(c=!0),i&&o||xt(t.diagLog(),1,73,"Plugin ["+d+"] failed during "+r+" - "+dt(e)+", run flags: "+dt(l))}},o,s),c}return Me(s)}(e,t,n);i||(i=s),o&&o._setNext(s),o=s}})}return a&&!i?nn([a],t,n):i}var an=function(e,t,n,a){var i=$t(e,t,n,a);Be(this,i,Ae(i))},rn="toGMTString",on="toUTCString",sn=null,cn=null,dn=null,ln=tt(),un={},fn={};function pn(e,t){var n=hn._ckMgr||fn._ckMgr;return n||(n=hn._ckMgr=hn(e,t),fn._ckMgr=n),n}function mn(e){return!e||e.isEnabled()}function _n(e,t){var n;if(e)n=e.getCookieMgr();else if(t){var a=t.cookieCfg;n=a._ckMgr?a._ckMgr:hn(t)}return n||(n=pn(t,(e||{}).logger)),n}function hn(e,t){var n=function(e){var t=e.cookieCfg=e.cookieCfg||{};if(Ue(t,"domain",e.cookieDomain,ce,se),Ue(t,"path",e.cookiePath||"/",null,se),se(t.enabled)){var n=void 0;oe(e.isCookieUseDisabled)||(n=!e.isCookieUseDisabled),oe(e.disableCookiesUsage)||(n=!e.disableCookiesUsage),t.enabled=n}return t}(e||fn),a=n.path||"/",i=n.domain,r=!1!==n.enabled,o={isEnabled:function(){var e=r&&bn(t),n=fn._ckMgr;return e&&n&&o!==n&&(e=mn(n)),e},setEnabled:function(e){r=!1!==e},set:function(e,t,r,s,c){var d,l=!1;if(mn(o)){var u={},f=Oe(t||z),p=f.indexOf(";");if(-1!==p&&(f=Oe(t.substring(0,p)),u=gn(t.substring(p+1))),Ue(u,"domain",s||i,He,oe),!se(r)){var m=ct();if(oe(u.expires)){var _=Pe()+1e3*r;if(_>0){var h=new Date;h.setTime(_),Ue(u,"expires",vn(h,m?rn:on)||vn(h,m?rn:on)||z,He)}}m||Ue(u,"max-age",z+r,null,oe)}var b=it();b&&"https:"===b.protocol&&(Ue(u,"secure",null,null,oe),null===cn&&(d=(at()||{}).userAgent,cn=!(ve(d)&&(he(d,"CPU iPhone OS 12")||he(d,"iPad; CPU OS 12")||he(d,"Macintosh; Intel Mac OS X 10_14")&&he(d,"Version/")&&he(d,"Safari")||he(d,"Macintosh; Intel Mac OS X 10_14")&&me(d,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||he(d,"Chrome/5")||he(d,"Chrome/6")||he(d,"UnrealEngine")&&!he(d,"Chrome")||he(d,"UCBrowser/12")||he(d,"UCBrowser/11")))),cn&&Ue(u,"SameSite","None",null,oe)),Ue(u,"path",c||a,null,oe),(n.setCookie||Dn)(e,yn(f,u)),l=!0}return l},get:function(e){var t=z;return mn(o)&&(t=(n.getCookie||Sn)(e)),t},del:function(e,t){var n=!1;return mn(o)&&(n=o.purge(e,t)),n},purge:function(e,a){var i,r=!1;if(bn(t)){var o=((i={}).path=a||"/",i.expires="Thu, 01 Jan 1970 00:00:01 GMT",i);ct()||(o["max-age"]="0"),(n.delCookie||Dn)(e,yn(z,o)),r=!0}return r}};return o._ckMgr=o,o}function bn(e){if(null===sn){sn=!1;try{sn=void 0!==(ln||{}).cookie}catch(t){xt(e,2,68,"Cannot access document.cookie - "+Te(t),{exception:dt(t)})}}return sn}function gn(e){var t={};return e&&e.length&&xe(Oe(e).split(";"),function(e){if(e=Oe(e||z)){var n=e.indexOf("=");-1===n?t[e]=null:t[Oe(e.substring(0,n))]=Oe(e.substring(n+1))}}),t}function vn(e,t){return ue(e[t])?e[t]():null}function yn(e,t){var n=e||z;return pe(t,function(e,t){n+="; "+e+(se(t)?z:"="+t)}),n}function Sn(e){var t=z;if(ln){var n=ln.cookie||z;dn!==n&&(un=gn(n),dn=n),t=Oe(un[e]||z)}return t}function Dn(e,t){ln&&(ln.cookie=e+"="+t)}var In="extensionConfig",xn=500;function Cn(e,t,n,a){t&&be(t)&&t.length>0&&(xe(t=t.sort(function(e,t){return e.priority-t.priority}),function(e){e.priority<xn&&Re("Channel has invalid priority - "+e.identifier)}),e.push({queue:Me(t),chain:nn(t,n,a)}))}function On(){var e=[];return{add:function(t){t&&e.push(t)},run:function(t,n){xe(e,function(e){try{e(t,n)}catch(e){xt(t.diagLog(),2,73,"Unexpected error calling unload handler - "+dt(e))}}),e=[]}}}var wn=function e(){var t,n,a,i,r,o=this;function s(e){void 0===e&&(e=null);var t=e;if(!t){var i=n||$t(null,{},o.core);t=a&&a.getPlugin?i.createNew(null,a.getPlugin):i.createNew(null,a)}return t}function c(e,t,i){e&&Ue(e,In,[],null,se),!i&&t&&(i=t.getProcessTelContext().getNext());var r=a;a&&a.getPlugin&&(r=a.getPlugin()),o.core=t,n=$t(i,e,t,r)}function d(){t=!1,o.core=null,n=null,a=null,r=[],i=On()}d(),Object(mt.e)(e,o,function(e){e.initialize=function(e,n,a,i){c(e,n,i),t=!0},e.teardown=function(t,n){var o=e.core;if(o&&(!t||o===t.core())){var s,c=!1,l=t||en(null,o,a&&a.getPlugin?a.getPlugin():a),u=n||{reason:0,isAsync:!1};return e._doTeardown&&!0===e._doTeardown(l,u,f)?s=!0:f(),s}function f(){c||(c=!0,i.run(l,n),xe(r,function(e){e.rm()}),r=[],!0===s&&l.processNext(u),d())}},e.update=function(t,n){var i=e.core;if(i&&(!t||i===t.core())){var r,o=!1,s=t||tn(null,i,a&&a.getPlugin?a.getPlugin():a),d=n||{reason:0};return e._doUpdate&&!0===e._doUpdate(s,d,l)?r=!0:l(),r}function l(){o||(o=!0,c(s.getCfg(),s.core(),s.getNext()))}},e._addHook=function(e){e&&(be(e)?r=r.concat(e):r.push(e))},Ne(e,"_addUnloadCb",function(){return i},"add")}),o.diagLog=function(e){return s(e).diagLog()},o.isInitialized=function(){return t},o.setInitialized=function(e){t=e},o.setNextPlugin=function(e){a=e},o.processNext=function(e,t){t?t.processNext(e):a&&ue(a.processTelemetry)&&a.processTelemetry(e,null)},o._getTelCtx=s},En=function(e){function t(){var n,a,i=e.call(this)||this;function r(){n=0,a=[]}return i.identifier="TelemetryInitializerPlugin",i.priority=199,r(),Object(mt.e)(t,i,function(e,t){e.addTelemetryInitializer=function(e){var t={id:n++,fn:e};return a.push(t),{remove:function(){xe(a,function(e,n){if(e.id===t.id)return a.splice(n,1),-1})}}},e.processTelemetry=function(t,n){for(var i=!1,r=a.length,o=0;o<r;++o){var s=a[o];if(s)try{if(!1===s.fn.apply(null,[t])){i=!0;break}}catch(e){xt(n.diagLog(),1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+Te(e),{exception:dt(e)},!0)}}i||e.processNext(t,n)},e._doTeardown=function(){r()}}),i}return Object(At.e)(t,e),t}(wn),An="Plugins must provide initialize method",Ln="SDK is still unloading...",kn={loggingLevelConsole:1};function Mn(e,t){return new Ot(t)}function Pn(e,t){var n=!1;return xe(t,function(t){if(t===e)return n=!0,-1}),n}function Tn(e,t,n,a){xe(e,function(e){if(e&&e[t])if(n)setTimeout(function(){return a(e)},0);else try{a(e)}catch(e){}})}var Un=function e(t){this.listeners=[];var n=!!(t||{}).perfEvtsSendAll;Object(mt.e)(e,this,function(e){e.addNotificationListener=function(t){e.listeners.push(t)},e.removeNotificationListener=function(t){for(var n=Ce(e.listeners,t);n>-1;)e.listeners.splice(n,1),n=Ce(e.listeners,t)},e.eventsSent=function(t){Tn(e.listeners,"eventsSent",!0,function(e){e.eventsSent(t)})},e.eventsDiscarded=function(t,n){Tn(e.listeners,"eventsDiscarded",!0,function(e){e.eventsDiscarded(t,n)})},e.eventsSendRequest=function(t,n){Tn(e.listeners,"eventsSendRequest",n,function(e){e.eventsSendRequest(t,n)})},e.perfEvent=function(t){t&&(!n&&t.isChildEvt()||Tn(e.listeners,"perfEvent",!1,function(e){t.isAsync?setTimeout(function(){return e.perfEvent(t)},0):e.perfEvent(t)}))}})},Fn=function(e){function t(){var n=e.call(this)||this;return Object(mt.e)(t,n,function(e,t){function n(t){var n=e.getNotifyMgr();n&&n.eventsDiscarded([t],2)}e.initialize=function(e,n,a,i){t.initialize(e,n,a||new It(e),i||new Un(e))},e.track=function(a){Et(e.getPerfMgr(),function(){return"AppInsightsCore:track"},function(){null===a&&(n(a),Re("Invalid telemetry item")),function(e){se(e.name)&&(n(e),Re("telemetry name required"))}(a),t.track(a)},function(){return{item:a}},!a.sync)}}),n}return Object(At.e)(t,e),t}(function e(){var t,n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v=0;Object(mt.e)(e,this,function(e){function y(){t=!1,e.config=Ve(!0,{},kn),e.logger=new It(e.config),e._extensions=[],m=new En,n=[],a=null,i=null,r=null,o=null,s=null,d=null,c=[],l=null,u=null,f=null,p=!1,_=null,h=Kt("AIBaseCore",!0),b=On()}function S(){return $t(x(),e.config,e)}function D(t,n){var a=function(e,t,n){var a=[],i={};return xe(n,function(n){(se(n)||se(n.initialize))&&Re(An);var r=n.priority,o=n.identifier;n&&r&&(se(i[r])?i[r]=o:function(e,t){(function(e){return e||new It})(e).warnToConsole(t)}(e,"Two extensions have same priority #"+r+" - "+i[r]+", "+o)),(!r||r<t)&&a.push(n)}),{all:n,core:a}}(e.logger,xn,c);d=a.core,s=null;var i=a.all;if(f=Me(function(e,t,n,a){var i=[];if(e&&xe(e,function(e){return Cn(i,e,n,a)}),t){var r=[];xe(t,function(e){e.priority>xn&&r.push(e)}),Cn(i,r,n,a)}return i}(u,i,t,e)),l){var r=Ce(i,l);-1!==r&&i.splice(r,1),-1!==(r=Ce(d,l))&&d.splice(r,1),l._setQueue(f)}else l=function(e,t){var n;function a(){return $t(null,t.config,t,null)}function i(e,t,n,a){var i=e?e.length+1:1;function r(){0==--i&&(a&&a(),a=null)}i>0&&xe(e,function(e){if(e&&e.queue.length>0){var a=e.chain,o=t.createNew(a);o.onComplete(r),n(o)}else i--}),r()}var r=!1,o=(n={identifier:"ChannelControllerPlugin",priority:xn,initialize:function(t,n,a,i){r=!0,xe(e,function(e){e&&e.queue.length>0&&Yt($t(e.chain,t,n),a)})},isInitialized:function(){return r},processTelemetry:function(t,n){i(e,n||a(),function(e){e.processNext(t)},function(){n.processNext(t)})},update:function(t,n){var a=n||{reason:0};return i(e,t,function(e){e.processNext(a)},function(){t.processNext(a)}),!0}},n.pause=function(){i(e,a(),function(e){e.iterate(function(e){e.pause&&e.pause()})},null)},n.resume=function(){i(e,a(),function(e){e.iterate(function(e){e.resume&&e.resume()})},null)},n.teardown=function(t,n){var a=n||{reason:0,isAsync:!1};return i(e,t,function(e){e.processNext(a)},function(){t.processNext(a),r=!1}),!0},n.getChannel=function(t){var n=null;return e&&e.length>0&&xe(e,function(e){if(e&&e.queue.length>0&&(xe(e.queue,function(e){if(e.identifier===t)return n=e,-1}),n))return-1}),n},n.flush=function(t,n,r,o){var s=1,c=!1,d=null;function l(){s--,c&&0===s&&(d&&(clearTimeout(d),d=null),n&&n(c),n=null)}return o=o||5e3,i(e,a(),function(e){e.iterate(function(e){if(e.flush){s++;var n=!1;e.flush(t,function(){n=!0,l()},r)||n||(t&&null==d?d=setTimeout(function(){d=null,l()},o):l())}})},function(){c=!0,l()}),!0},n._setQueue=function(t){e=t},n);return o}(f,e);i.push(l),d.push(l),e._extensions=Jt(i),l.initialize(t,e,i),Yt(S(),i),e._extensions=Me(Jt(d||[])).slice(),n&&function(t){var n=tn(x(),e);e._updateHook&&!0===e._updateHook(n,t)||n.processNext(t)}(n)}function I(t){var n=null,a=null;return xe(e._extensions,function(e){if(e.identifier===t&&e!==l&&e!==m)return a=e,-1}),!a&&l&&(a=l.getChannel(t)),a&&(n={plugin:a,setEnabled:function(e){Qt(a).disabled=!e},isEnabled:function(){var e=Qt(a);return!e.teardown&&!e.disabled},remove:function(t,n){void 0===t&&(t=!0);var i=[a];C(i,{reason:1,isAsync:t},function(t){t&&D(e.config,{reason:32,removed:i}),n&&n(t)})}}),n}function x(){if(!s){var t=(d||[]).slice();-1===Ce(t,m)&&t.push(m),s=nn(Jt(t),e.config,e)}return s}function C(t,n,a){if(t&&t.length>0){var i=en(nn(t,e.config,e),e);i.onComplete(function(){var e=!1,n=[];xe(c,function(a,i){Pn(a,t)?e=!0:n.push(a)}),c=n;var i=[];u&&(xe(u,function(n,a){var r=[];xe(n,function(n){Pn(n,t)?e=!0:r.push(n)}),i.push(r)}),u=i),a&&a(e)}),i.processNext(n)}else a(!1)}function O(){var t=e.logger?e.logger.queue:[];t&&(xe(t,function(t){var n={name:_||"InternalMessageId: "+t.messageId,iKey:e.config.instrumentationKey,time:Ie(new Date),baseType:St.dataType,baseData:{message:t.message}};e.track(n)}),t.length=0)}function w(e,t,n,a){return l?l.flush(e,t,n||6,a):(t&&t(!1),!0)}function E(t){var n=e.logger;n?xt(n,2,73,t):Re(t)}y(),e.isInitialized=function(){return t},e.initialize=function(n,i,o,s){p&&Re(Ln),e.isInitialized()&&Re("Core should not be initialized more than once"),n&&!se(n.instrumentationKey)||Re("Please provide instrumentation key"),a=s,e._notificationManager=s,e.config=n||{},function(e){!0===e.disableDbgExt&&g&&(a.removeNotificationListener(g),g=null),a&&!g&&!0!==e.disableDbgExt&&(g=function(e){if(!pt){pt={};for(var t=0;t<_t.length;t++)pt[_t[t]]=bt(_t[t],e)}return pt}(e),a.addNotificationListener(g))}(n),function(t){!t.enablePerfMgr&&r&&(r=null),t.enablePerfMgr&&Ue(e.config,"createPerfMgr",Mn)}(n),n.extensions=se(n.extensions)?[]:n.extensions,function(e){var t,n,i,r;(t=e,n=In,t?!(r=t[n])&&se(r)&&(r=oe(i)?{}:i,t[n]=r):r=oe(i)?{}:i,r).NotificationManager=a}(n),o&&(e.logger=o),(c=[]).push.apply(c,Object(At.t)(Object(At.t)([],i,!1),n.extensions,!1)),u=(n||{}).channels,D(n,null),f&&0!==f.length||Re("No channels available"),t=!0,e.releaseQueue()},e.getTransmissionControls=function(){var e=[];return f&&xe(f,function(t){e.push(t.queue)}),Me(e)},e.track=function(t){Ue(t,"iKey",e.config.instrumentationKey,null,Fe),Ue(t,"time",Ie(new Date),null,Fe),Ue(t,"ver","4.0",null,se),!p&&e.isInitialized()?S().processNext(t):n.push(t)},e.getProcessTelContext=S,e.getNotifyMgr=function(){var t;return a||(a=Object(V.t)(((t={}).addNotificationListener=function(e){},t.removeNotificationListener=function(e){},t.eventsSent=function(e){},t.eventsDiscarded=function(e,t){},t.eventsSendRequest=function(e,t){},t)),e._notificationManager=a),a},e.addNotificationListener=function(e){a&&a.addNotificationListener(e)},e.removeNotificationListener=function(e){a&&a.removeNotificationListener(e)},e.getCookieMgr=function(){return o||(o=hn(e.config,e.logger)),o},e.setCookieMgr=function(e){o=e},e.getPerfMgr=function(){return i||r||e.config&&e.config.enablePerfMgr&&ue(e.config.createPerfMgr)&&(r=e.config.createPerfMgr(e,e.getNotifyMgr())),i||r||null},e.setPerfMgr=function(e){i=e},e.eventCnt=function(){return n.length},e.releaseQueue=function(){if(t&&n.length>0){var e=n;n=[],xe(e,function(e){S().processNext(e)})}},e.pollInternalLogs=function(t){_=t||null;var n=e.config.diagnosticLogInterval;return n&&n>0||(n=1e4),v&&clearInterval(v),v=setInterval(function(){O()},n)},e.stopPollingInternalLogs=function(){v&&(clearInterval(v),v=0,O())},Be(e,function(){return m},["addTelemetryInitializer"]),e.unload=function(n,a,i){void 0===n&&(n=!0),t||Re("SDK is not initialized"),p&&Re(Ln);var r={reason:50,isAsync:n,flushComplete:!1},o=en(x(),e);function s(t){r.flushComplete=t,p=!0,b.run(o,r),e.stopPollingInternalLogs(),o.processNext(r)}o.onComplete(function(){y(),a&&a(r)},e),w(n,s,6,i)||s(!1)},e.getPlugin=I,e.addPlugin=function(t,n,a,i){if(!t)return i&&i(!1),void E(An);var r=I(t.identifier);if(r&&!n)return i&&i(!1),void E("Plugin ["+t.identifier+"] is already loaded!");var o={reason:16};function s(n){c.push(t),o.added=[t],D(e.config,o),i&&i(!0)}if(r){var d=[r.plugin];C(d,{reason:2,isAsync:!!a},function(e){e?(o.removed=d,o.reason|=32,s()):i&&i(!1)})}else s()},e.evtNamespace=function(){return h},e.flush=w,Ne(e,"addUnloadCb",function(){return b},"add")})}),Hn=n("odsp.1ds_2030"),Rn=n("odsp.1ds_3632"),Nn="events",Bn="visibilitychange",jn="pagehide",Vn="pageshow",zn="unload",Gn="beforeunload",Kn=Kt("aiEvtPageHide"),Wn=Kt("aiEvtPageShow"),qn=/\.[\.]+/g,Qn=/[\.]+$/,Yn=1,Jn=Wt("events"),Xn=/^([^.]*)(?:\.(.+)|)/;function Zn(e){return e&&e.replace?e.replace(/^\s*\.*|\.*\s*$/g,""):e}function $n(e,t){if(t){var n="";be(t)?(n="",xe(t,function(e){(e=Zn(e))&&("."!==e[0]&&(e="."+e),n+=e)})):n=Zn(t),n&&("."!==n[0]&&(n="."+n),e=(e||"")+n)}var a=Xn.exec(e||"")||[];return{type:a[1],ns:(a[2]||"").replace(qn,".").replace(Qn,"").split(".").sort().join(".")}}function ea(e,t,n){void 0===n&&(n=!0);var a=Jn.get(e,Nn,{},n),i=a[t];return i||(i=a[t]=[]),i}function ta(e,t,n,a){e&&t&&t.type&&(e.removeEventListener?e.removeEventListener(t.type,n,a):e.detachEvent&&e.detachEvent("on"+t.type,n))}function na(e,t,n,a){for(var i=t.length;i--;){var r=t[i];r&&(n.ns&&n.ns!==r.evtName.ns||a&&!a(r)||(ta(e,r.evtName,r.handler,r.capture),t.splice(i,1)))}}function aa(e,t){return t?$n("xx",be(t)?[e].concat(t):[e,t]).ns.split("."):e}function ia(e,t,n,a,i){void 0===i&&(i=!1);var r=!1;if(e)try{var o=$n(t,a);if(r=function(e,t,n,a){var i=!1;return e&&t&&t.type&&n&&(e.addEventListener?(e.addEventListener(t.type,n,a),i=!0):e.attachEvent&&(e.attachEvent("on"+t.type,n),i=!0)),i}(e,o,n,i),r&&Jn.accept(e)){var s={guid:Yn++,evtName:o,handler:n,capture:i};ea(e,o.type).push(s)}}catch(e){}return r}function ra(e,t,n,a,i){if(void 0===i&&(i=!1),e)try{var r=$n(t,a),o=!1;!function(e,t,n){if(t.type)na(e,ea(e,t.type),t,n);else{var a=Jn.get(e,Nn,{});pe(a,function(a,i){na(e,i,t,n)}),0===Ae(a).length&&Jn.kill(e,Nn)}}(e,r,function(e){return!((!r.ns||n)&&e.handler!==n||(o=!0,0))}),o||ta(e,r,n,i)}catch(e){}}function oa(e,t,n){var a=!1,i=$e();i&&(a=ia(i,e,t,n),a=ia(i.body,e,t,n)||a);var r=tt();return r&&(a=ia(r,e,t,n)||a),a}function sa(e,t,n,a){var i=!1;return t&&e&&e.length>0&&xe(e,function(e){e&&(n&&-1!==Ce(n,e)||(i=oa(e,t,a)||i))}),i}function ca(e,t,n){e&&be(e)&&xe(e,function(e){e&&function(e,t,n){var a=$e();a&&(ra(a,e,t,n),ra(a.body,e,t,n));var i=tt();i&&ra(i,e,t,n)}(e,t,n)})}function da(e,t,n){var a=aa(Kn,n),i=sa([jn],e,t,a);return t&&-1!==Ce(t,Bn)||(i=sa([Bn],function(t){var n=tt();e&&n&&"hidden"===n.visibilityState&&e(t)},t,a)||i),!i&&t&&(i=da(e,null,n)),i}function la(e,t,n){var a=aa(Wn,n),i=sa([Vn],e,t,a);return!(i=sa([Bn],function(t){var n=tt();e&&n&&"visible"===n.visibilityState&&e(t)},t,a)||i)&&t&&(i=la(e,null,n)),i}var ua,fa=null;function pa(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(ga,function(e){var t=0|Ht(15);return("x"===e?t:3&t|8).toString(16)})}function ma(){var e=Xe("performance");return e&&e.now?e.now():Pe()}function _a(){for(var e,t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n=z,a=0;a<4;a++)n+=t[15&(e=Rt())]+t[e>>4&15]+t[e>>8&15]+t[e>>12&15]+t[e>>16&15]+t[e>>20&15]+t[e>>24&15]+t[e>>28&15];var i=t[8+(3&Rt())|0];return n.substr(0,8)+n.substr(9,4)+"4"+n.substr(13,3)+i+n.substr(16,3)+n.substr(19,12)}j.u;var ha,ba={_canUseCookies:void 0,isTypeof:function(e,t){return typeof e===t},isUndefined:oe,isNullOrUndefined:se,hasOwnProperty:de,isFunction:ue,isObject:le,isDate:function(e){return!(!e||"[object Date]"!==$.call(e))},isArray:be,isError:ge,isString:ve,isNumber:ye,isBoolean:Se,toISOString:Ie,arrForEach:xe,arrIndexOf:Ce,arrMap:function(e,t,n){var a;if(e){if(e.map)return e.map(t,n);var i=e.length,r=n||e;a=new Array(i);try{for(var o=0;o<i;o++)o in e&&(a[o]=t.call(r,e[o],e))}catch(e){}}return a},arrReduce:function(e,t,n){var a;if(e){if(e.reduce)return e.reduce(t,n);var i=e.length,r=0;if(arguments.length>=3)a=arguments[2];else{for(;r<i&&!(r in e);)r++;a=e[r++]}for(;r<i;)r in e&&(a=t(a,e[r],r,e)),r++}return a},strTrim:Oe,objCreate:V.t,objKeys:Ae,objDefineAccessors:Le,addEventHandler:oa,dateNow:Pe,isIE:ct,disableCookies:function(){var e,t;(e=pn(undefined,undefined),t=ba._canUseCookies,null===fa&&(fa=[],ua=t,Le(ba,"_canUseCookies",function(){return ua},function(e){ua=e,xe(fa,function(t){t.setEnabled(e)})})),-1===Ce(fa,e)&&fa.push(e),Se(t)&&e.setEnabled(t),Se(ua)&&e.setEnabled(ua),e).setEnabled(!1)},newGuid:pa,perfNow:ma,newId:Bt,randomValue:Ht,random32:Rt,mwcRandomSeed:function(e){e?Ut(e):Ft()},mwcRandom32:Nt,generateW3CId:_a},ga=/[xy]/g,va="1DS-Web-JS-3.2.2",ya="withCredentials",Sa=((ha={})[0]=0,ha[2]=6,ha[1]=1,ha[3]=7,ha[4098]=6,ha[4097]=1,ha[4099]=7,ha);function Da(e){return!(""===e||se(e))}function Ia(e){if(e){var t=e.indexOf("-");if(t>-1)return e.substring(0,t)}return""}function xa(e,t,n){var a=-1;if(!oe(e))if(t>0&&(32===t?a=8192:t<=13&&(a=t<<5)),function(e){return e>=0&&e<=9}(n))-1===a&&(a=0),a|=n;else{var i=Sa[La(e)]||-1;-1!==a&&-1!==i?a|=i:6===i&&(a=i)}return a}function Ca(e,t,n){var a;return void 0===n&&(n=!0),e&&(a=e.get(t),n&&a&&decodeURIComponent&&(a=decodeURIComponent(a))),a||""}function Oa(e){void 0===e&&(e="D");var t=pa();return"B"===e?t="{"+t+"}":"P"===e?t="("+t+")":"N"===e&&(t=t.replace(/-/g,"")),t}function wa(e,t,n,a,i){var r={},o=!1,s=0,c=arguments.length,d=Object[j.l],l=arguments;for("[object Boolean]"===d.toString.call(l[0])&&(o=l[0],s++);s<c;s++)pe(e=l[s],function(e,t){o&&t&&le(t)?be(t)?(r[e]=r[e]||[],xe(t,function(t,n){t&&le(t)?r[e][n]=wa(!0,r[e][n],t):r[e][n]=t})):r[e]=wa(!0,r[e],t):r[e]=t});return r}Boolean(tt()),Boolean($e());var Ea=ma;function Aa(e,t){var n=e;n.timings=n.timings||{},n.timings.processTelemetryStart=n.timings.processTelemetryStart||{},n.timings.processTelemetryStart[t]=Ea()}function La(e){var t=0;if(null!=e){var n=typeof e;"string"===n?t=1:"number"===n?t=2:"boolean"===n?t=3:n===Hn.d&&(t=4,be(e)?(t=4096,e.length>0&&(t|=La(e[0]))):de(e,"value")&&(t=8192|La(e.value)))}return t}j.u,j.d,j.u,Rn.t;var ka=function(e){function t(){var n=e.call(this)||this;return n.pluginVersionStringArr=[],n.pluginVersionString="",Object(mt.e)(t,n,function(e,t){e.logger&&e.logger.queue||(e.logger=new It({loggingLevelConsole:1})),e.initialize=function(n,a,i,r){Et(e,function(){return"AppInsightsCore.initialize"},function(){if(n){n.endpointUrl||(n.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/");var o=n.propertyStorageOverride;if(o&&(!o.getProperty||!o.setProperty))throw new Error("Invalid property storage override passed.");n.channels&&xe(n.channels,function(t){t&&xe(t,function(t){if(t.identifier&&t.version){var n=t.identifier+"="+t.version;e.pluginVersionStringArr.push(n)}})})}e.getWParam=function(){return"undefined"!=typeof document?0:-1},a&&xe(a,function(t){if(t&&t.identifier&&t.version){var n=t.identifier+"="+t.version;e.pluginVersionStringArr.push(n)}}),e.pluginVersionString=e.pluginVersionStringArr.join(";");try{t.initialize(n,a,i,r),e.pollInternalLogs("InternalLog")}catch(t){var s=e.logger,c=dt(t);-1!==c.indexOf("channels")&&(c+="\n - Channels must be provided through config.channels only!"),s.throwInternal(1,514,"SDK Initialization Failed - no telemetry will be sent: "+c)}},function(){return{config:n,extensions:a,logger:i,notificationManager:r}})},e.track=function(n){Et(e,function(){return"AppInsightsCore.track"},function(){var a,i=n;if(i){i.timings=i.timings||{},i.timings.trackStart=Ea(),(a=i.latency)&&ye(a)&&a>=1&&a<=4||(i.latency=1);var r=i.ext=i.ext||{};r.sdk=r.sdk||{},r.sdk.ver=va;var o=i.baseData=i.baseData||{};o.properties||(o.properties={});var s=o.properties;s.version||(s.version=""),""!==e.pluginVersionString&&(s.version=e.pluginVersionString)}t.track(i)},function(){return{item:n}},!n.sync)}}),n}return Object(B.e)(t,e),t}(Fn),Ma=["AX","EX","SF","CS","CF","CT","CU","DC","DF","H5","HL","WS","WP"];function Pa(e,t){void 0===t&&(t=Ma);var n=null;if(e)for(var a=e.split(","),i=0;i<a.length;i++)Ta(a[i],t)&&(n?n+=","+a[i]:n=a[i]);return n}function Ta(e,t){if(void 0===t&&(t=Ma),!e||e.length<4)return!1;for(var n=!1,a=e.substring(0,3).toString().toUpperCase(),i=0;i<t.length;i++)if(t[i]+":"===a&&e.length<=256){n=!0;break}return n}function Ua(){return this.getExpId()}var Fa=function(){function e(t,n){var a=null,i=Ma.slice(0),r=_n(n),o=t;Object(mt.e)(e,this,function(e){if(et()){var n=tt().documentElement;n&&(e.locale=n.lang)}function s(e){e!==a&&(a=Pa(e,i))}e.env=t.env?t.env:function(e){var t,n={},a=tt();if(a){t=a&&a.querySelectorAll("meta");for(var i=0;i<t.length;i++){var r=t[i];r.name&&0===r.name.toLowerCase().indexOf(e)&&(n[r.name.replace(e,"")]=r.content)}}return n}("awa-").env,e.getExpId=function(){return o.expId?(s(o.expId),a):(s(Ca(r,"Treatments")),a)}})}return e.validateAppExpId=Pa,e._staticInit=void Le(e.prototype,"expId",Ua),e}(),Ha=function(){};function Ra(){return this.getLocalId()}function Na(e){this.setLocalId(e)}var Ba=function(){function e(t,n,a){var i,r=n,o=_n(a,t);Object(mt.e)(e,this,function(n){if(o&&o.isEnabled()&&(f(),r.enableApplicationInsightsUser)){var a=Ca(o,e.userCookieName);if(a){var s=a.split(e.cookieSeparator);s.length>0&&(n.id=s[0])}if(!n.id){n.id=Bt(t&&!oe(t.idLength)?t.idLength:22);var c=Ie(new Date);n.accountAcquisitionDate=c;var d=[n.id,c],l=r.cookieDomain?r.cookieDomain:void 0;o.set(e.userCookieName,d.join(e.cookieSeparator),31536e3,l)}}if("undefined"!=typeof navigator){var u=navigator;n.locale=u.userLanguage||u.language}function f(){if(!r.hashIdentifiers&&!r.dropIdentifiers){var e=Ca(o,"MUID");e&&(i="t:"+e)}return i}n.getLocalId=function(){return i||f()},n.setLocalId=function(e){i=e}})}return e.cookieSeparator="|",e.userCookieName="ai_user",e._staticInit=void Le(e.prototype,"localId",Ra,Na),e}(),ja="Unknown",Va="Edg/",za=[{ua:"OPR/",b:"Opera"},{ua:"PhantomJS",b:"PhantomJS"},{ua:"Edge",b:"Edge"},{ua:Va,b:"Edge"},{ua:"Electron",b:"Electron"},{ua:"Chrome",b:"Chrome"},{ua:"Trident",b:"MSIE"},{ua:"MSIE ",b:"MSIE"},{ua:"Firefox",b:"Firefox"},{ua:"Safari",b:"Safari"},{ua:"SkypeShell",b:"SkypeShell"}],Ga=[{br:"Microsoft Edge",b:"Edge"},{br:"Google Chrome",b:"Chrome"},{br:"Opera",b:"Opera"}];function Ka(e,t){return t.indexOf(e)>-1}function Wa(e,t){for(var n=0;n<t.length;n++)if(e==t[n].brand)return t[n].version;return null}function qa(){return this.getUserConsent()}var Qa=function(){function e(t,n){var a=_n(n),i=t||{};Object(mt.e)(e,this,function(e){var t=it();if(t){var n=t.hostname;n&&(e.domain="file:"===t.protocol?"local":n)}if(i.populateBrowserInfo){var r=i.userAgent,o=(i.userAgentData||{}).brands,s=at();s&&(r=r||s.userAgent||"",o=o||(s.userAgentData||{}).brands),function(t,n){if(be(n))try{for(var a=0;a<Ga.length;a++){var i=Wa(Ga[a].br,n);if(i)return e.browser=Ga[a].b,void(e.browserVer=i)}}catch(e){}if(t){var r=function(e){if(e)for(var t=0;t<za.length;t++)if(Ka(za[t].ua,e))return za[t].b;return ja}(t);e.browser=r,e.browserVer=function(e,t){return"MSIE"===t?function(e){var t=e.match(new RegExp("MSIE ([\\d,.]+)"));if(t)return t[1];var n=e.match(new RegExp("rv:([\\d,.]+)"));return n?n[1]:void 0}(e):function(e,t){"Safari"===e?e="Version":"Edge"===e&&Ka(Va,t)&&(e="Edg");var n=t.match(new RegExp(e+"/([\\d,.]+)"));return n||"Opera"===e&&(n=t.match(new RegExp("OPR/([\\d,.]+)")))?n[1]:ja}(t,e)}(t,r)}}(r,o);var c=function(){var e={h:0,w:0},t=$e();return t&&t.screen&&(e.h=screen.height,e.w=screen.width),e}();e.screenRes=c.w+"X"+c.h}e.getUserConsent=function(){return i.userConsented||!!Ca(a,i.userConsentCookieName||"MSCC")},e.getUserConsentDetails=function(){try{var e=i.callback;if(e&&e.userConsentDetails){var t=e.userConsentDetails();if(t)return JSON.stringify({Required:t.Required||!1,Analytics:t.Analytics||!1,SocialMedia:t.SocialMedia||!1,Advertising:t.Advertising||!1})}}catch(e){}return null},Le(e,"userConsent",e.getUserConsent)})}return e._staticInit=void Le(e.prototype,"userConsent",qa),e}(),Ya={WIN:/(windows|win32)/i,WINRT:/ arm;/i,WINPHONE:/windows\sphone\s\d+\.\d+/i,OSX:/(macintosh|mac os x)/i,IOS:/(ipad|iphone|ipod)(?=.*like mac os x)/i,LINUX:/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,ANDROID:/android/i,CROS:/CrOS/i},Ja={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},Xa="Unknown",Za=[{r:Ya.WINPHONE,os:"Windows Phone"},{r:Ya.WINRT,os:"Windows RT"},{r:Ya.WIN,os:"Windows"},{r:Ya.IOS,os:"iOS"},{r:Ya.ANDROID,os:"Android"},{r:Ya.LINUX,os:"Linux"},{r:Ya.CROS,os:"Chrome OS"},{s:"x11",os:"Unix"},{s:"blackberry",os:"BlackBerry"},{s:"symbian",os:"Symbian"},{s:"nokia",os:"Nokia"},{r:Ya.OSX,os:"Mac OS X"}];function $a(e,t){var n=e.match(new RegExp(t+" ([\\d,.]+)"));return n?Ja[n[1]]?Ja[n[1]]:n[1]:Xa}function ei(e){return e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null}var ti=function(e){if(e.populateOperatingSystemInfo){var t=this,n=at()||{},a=e.userAgent||n.userAgent||"",i=e.userAgentData||n.userAgentData||{};if(a){var r=function(e){for(var t=0;t<Za.length;t++){var n=Za[t];if(n.r&&e.match(n.r))return n.os;if(n.s&&-1!==e.indexOf(n.s))return n.os}return Xa}(a.toLowerCase());t.name=r,t.ver=function(e,t){return"Windows"===t?$a(e,"Windows NT"):"Android"===t?$a(e,t):"Mac OS X"===t?function(e){var t=e.match(new RegExp("Mac OS X ([\\d,_,.]+)"));if(t){var n=t[1].replace(/_/g,".");if(n){var a=ei(n);return a?n.split(a)[0]:n}}return Xa}(e):"iOS"===t?function(e){var t=e.match(new RegExp("OS ([\\d,_,.]+)"));if(t){var n=t[1].replace(/_/g,".");if(n){var a=ei(n);return a?n.split(a)[0]:n}}return Xa}(e):Xa}(a,r)}t.name&&t.name!==Xa||!ve(i.platform)||(t.name=i.platform)}};function ni(){return this.getMsfpc()}function ai(){return this.getAnid()}var ii=function(){function e(t,n){var a=_n(n);Object(mt.e)(e,this,function(e){t.serviceName&&(e.serviceName=t.serviceName),e.getMsfpc=function(){return Ca(a,"MSFPC")},e.getAnid=function(){return Ca(a,"ANON").slice(0,34)}})}var t;return e._staticInit=(Le(t=e.prototype,"msfpc",ni),void Le(t,"anid",ai)),e}(),ri=function(e){var t=this;t.popSample=100,t.eventFlags=0,e.hashIdentifiers&&(t.eventFlags=1048576|t.eventFlags),e.dropIdentifiers&&(t.eventFlags=2097152|t.eventFlags)},oi=function(){var e=(new Date).getTimezoneOffset(),t=e%60,n=(e-t)/60,a="+";n>0&&(a="-"),n=Math.abs(n),t=Math.abs(t),this.tz=a+(n<10?"0"+n:n.toString())+":"+(t<10?"0"+t:t.toString())},si=function(){};function ci(){return this.getId()}function di(e){this.setId(e)}var li=function(){function e(){Object(mt.e)(e,this,function(e){e.setId=function(t){e.customId=t},e.getId=function(){return ve(e.customId)?e.customId:e.automaticId}})}return e._staticInit=void Le(e.prototype,"id",ci,di),e}(),ui=function(e,t,n,a){if(e.enableApplicationInsightsTrace){var i=this;i.traceId=t||_a(),i.parentId=n,i.name=a;var r=it();r&&r.pathname&&(i.name=r.pathname)}};function fi(e){var t={};return pe(e,function(e,n){t[e]=n[1],t[n[0]]=n[1]}),ke(t)}var pi,mi=fi({UserExt:[0,"user"],DeviceExt:[1,"device"],TraceExt:[2,"trace"],WebExt:[3,"web"],AppExt:[4,"app"],OSExt:[5,"os"],SdkExt:[6,"sdk"],IntWebExt:[7,"intweb"],UtcExt:[8,"utc"],LocExt:[9,"loc"],CloudExt:[10,"cloud"]}),_i=fi({id:[0,"id"],ver:[1,"ver"],appName:[2,"name"],locale:[3,"locale"],expId:[4,"expId"],env:[5,"env"]}),hi=fi({domain:[0,"domain"],browser:[1,"browser"],browserVer:[2,"browserVer"],screenRes:[3,"screenRes"],userConsent:[4,"userConsent"],consentDetails:[5,"consentDetails"]}),bi=fi({locale:[0,"locale"],localId:[1,"localId"],id:[2,"id"]}),gi=fi({osName:[0,"name"],ver:[1,"ver"]}),vi=fi({ver:[0,"ver"],seq:[1,"seq"],installId:[2,"installId"],epoch:[3,"epoch"]}),yi=fi({msfpc:[0,"msfpc"],anid:[1,"anid"],serviceName:[2,"serviceName"]}),Si=fi({popSample:[0,"popSample"],eventFlags:[1,"eventFlags"]}),Di=fi({tz:[0,"tz"]}),Ii=fi({sessionId:[0,"sesId"]}),xi=fi({localId:[0,"localId"],deviceClass:[1,"deviceClass"],make:[2,"make"],model:[3,"model"]}),Ci=fi({role:[0,"role"],roleInstance:[1,"roleInstance"],roleVer:[2,"roleVer"]}),Oi=fi({traceId:[0,"traceID"],traceName:[1,"name"],parentId:[2,"parentID"]}),wi="MicrosoftApplicationsTelemetryDeviceId",Ei=function e(t,n){var a=0;Object(mt.e)(e,this,function(e){var i=t.propertyStorageOverride;e.seq=a,e.epoch=Rt(!1).toString();var r=_n(n,t);if(r.isEnabled()||i){var o=function(e,t,n){return t?t.getProperty(n)||"":Ca(e,n)}(r,i,wi);o||(o=pa()),function(e,t,n,a){t?t.setProperty(n,a):e.set(n,a,31536e3)}(r,i,wi,o),e.installId=o}else r.purge(wi);e.getSequenceId=function(){return++a}})};function Ai(){return void 0===pi&&(pi=!!ki(0)),pi}function Li(){return Ai()?ki(0):null}function ki(e){var t,n,a=null;try{var i=Object(V.e)();if(!i)return null;n=new Date,(a=0===e?i.localStorage:i.sessionStorage)&&ue(a.setItem)&&(a.setItem(n,n),t=a.getItem(n)!==n,a.removeItem(n),t&&(a=null))}catch(e){a=null}return a}var Mi="ai_session",Pi=function(){function e(t,n){var a,i,r=Dt(t),o=_n(t);Object(mt.e)(e,this,function(t){var s,c={sessionRenewalMs:(s=n).sessionRenewalMs&&function(){return s.sessionRenewalMs},sessionExpirationMs:s.sessionExpirationMs&&function(){return s.sessionExpirationMs},cookieDomain:s.cookieDomain&&function(){return s.cookieDomain},namePrefix:s.namePrefix&&function(){return s.namePrefix},sessionAsGuid:function(){return s.sessionAsGuid},idLength:function(){return s.idLength?s.idLength:22}};function d(e){var n=t.automaticSession,a=e.split("|");a.length>0&&n.setId(a[0]);try{if(a.length>1){var i=+a[1];n.acquisitionDate=+new Date(i),n.acquisitionDate=n.acquisitionDate>0?n.acquisitionDate:0}if(a.length>2){var o=+a[2];n.renewalDate=+new Date(o),n.renewalDate=n.renewalDate>0?n.renewalDate:0}}catch(e){xt(r,1,510,"Error parsing ai_session cookie, session will be reset: "+e)}0===n.renewalDate&&xt(r,2,517,"AI session renewal date is 0, session will be reset.")}function l(){var e=t.automaticSession,n=(new Date).getTime(),a=t.config.sessionAsGuid();!oe(a)&&a?Se(a)?e.setId(Oa()):e.setId(Oa(a)):e.setId(Bt(c&&c.idLength?c.idLength():22)),e.acquisitionDate=n,e.renewalDate=n,u(e.getId(),e.acquisitionDate,e.renewalDate),Ai()||xt(r,2,505,"Browser does not support local storage. Session durations will be inaccurate.")}function u(e,n,r){var s=n+t.config.sessionExpirationMs(),c=r+t.config.sessionRenewalMs(),d=new Date,l=[e,n,r];s<c?d.setTime(s):d.setTime(c);var u=t.config.cookieDomain?t.config.cookieDomain():null;o.set(i(),l.join("|")+";expires="+d.toUTCString(),null,u),a=(new Date).getTime()}ue(n.sessionExpirationMs)||(c.sessionExpirationMs=function(){return e.acquisitionSpan}),ue(n.sessionRenewalMs)||(c.sessionRenewalMs=function(){return e.renewalSpan}),t.config=c,i=function(){return t.config.namePrefix&&t.config.namePrefix()?Mi+t.config.namePrefix():Mi},t.automaticSession=new li,t.update=function(){t.automaticSession.getId()||function(){var e=o.get(i());if(e&&ue(e.split))d(e);else{var n=function(e,t){var n=Li();if(null!==n)try{return n.getItem(t)}catch(t){pi=!1,xt(e,1,503,"Browser failed read of local storage. "+t)}return null}(r,i());n&&d(n)}t.automaticSession.getId()||l()}();var n=t.automaticSession,s=t.config,c=(new Date).getTime(),f=c-n.acquisitionDate>s.sessionExpirationMs(),p=c-n.renewalDate>s.sessionRenewalMs();f||p?l():(!a||c-a>e.cookieUpdateInterval)&&(n.renewalDate=c,u(n.getId(),n.acquisitionDate,n.renewalDate))},t.backup=function(){var e,n,a,o=t.automaticSession;e=o.getId(),n=o.acquisitionDate,a=o.renewalDate,function(e,t,n){var a=Li();if(null!==a)try{a.setItem(t,n)}catch(t){pi=!1,xt(e,1,504,"Browser failed write to local storage. "+t)}}(r,i(),[e,n,a].join("|"))}})}return e.acquisitionSpan=864e5,e.renewalSpan=18e5,e.cookieUpdateInterval=6e4,e}();function Ti(e,t,n,a){var i=t.ext[mi[e]];return i&&pe(a,function(e,t){ve(t)&&(i[n[e]]=t)}),i}var Ui,Fi=function e(t,n,a){Object(mt.e)(e,this,function(e){e.app=new Fa(n,a),e.cloud=new Ha,e.user=new Ba(t,n,a),e.os=new ti(n),e.web=new Qa(n,a);var i=new Ei(t,a),r=new ii(n,a),o=new ri(n);e.loc=new oi,e.device=new si;var s=new ui(n),c=new Pi(a,n);function d(){var t=e.session;if(t&&ve(t.customId))return t.customId;c.update();var n=c.automaticSession;if(n){var a=n.getId();a&&ve(a)&&(t.automaticId=a)}return t.automaticId}e.session=new li,e.getSessionId=d,e.applyApplicationContext=function(t){var n,a=e.app;Ti(4,t,_i,((n={})[0]=a.id,n[1]=a.ver,n[2]=a.name,n[3]=a.locale,n[4]=a.getExpId(),n[5]=a.env,n))},e.applyUserContext=function(t){var n,a=e.user;Ti(0,t,bi,((n={})[1]=a.getLocalId(),n[0]=a.locale,n[2]=a.id,n))},e.applyWebContext=function(t){var n,a=e.web;Ti(3,t,hi,((n={})[0]=a.domain,n[1]=a.browser,n[2]=a.browserVer,n[3]=a.screenRes,n[5]=a.getUserConsentDetails(),n))[hi[4]]=a.getUserConsent()},e.applyOsContext=function(t){var n,a=e.os;Ti(5,t,gi,((n={})[0]=a.name,n[1]=a.ver,n))},e.applySdkContext=function(e){var t,n=Ti(6,e,vi,((t={})[2]=i.installId,t));n[vi[1]]=i.getSequenceId(),n[vi[3]]=i.epoch},e.applyIntWebContext=function(e){var t;Ti(7,e,yi,((t={})[0]=r.getMsfpc(),t[1]=r.getAnid(),t[2]=r.serviceName,t))},e.applyUtcContext=function(e){var t=e.ext[mi[8]];t[Si[0]]=o.popSample,o.eventFlags>0&&(t[Si[1]]=o.eventFlags)},e.applyLocContext=function(t){t.ext[mi[9]][Di.tz]=e.loc.tz},e.applySessionContext=function(e){e.ext[mi[4]][Ii[0]]=d()},e.applyDeviceContext=function(t){var n,a=e.device;Ti(1,t,xi,((n={})[0]=a.localId,n[2]=a.make,n[3]=a.model,n[1]=a.deviceClass,n))},e.applyCloudContext=function(t){var n,a=e.cloud;Ti(10,t,Ci,((n={})[0]=a.role,n[1]=a.roleInstance,n[2]=a.roleVer,n))},e.applyAITraceContext=function(e){var t;Ti(2,e,Oi,((t={})[0]=s.traceId,t[1]=s.name,t[2]=s.parentId,t))}})},Hi=[mi[4],mi[0],mi[3],mi[5],mi[6],mi[7],mi[8],mi[9],mi[1],mi[2],mi[10]],Ri=function(e){function t(){var n,a,i=e.call(this)||this;return i.identifier="SystemPropertiesCollector",i.priority=3,i.version="3.2.2",Object(mt.e)(t,i,function(e,t){function i(){n=null,a={}}i(),e.initialize=function(a,i,r){t.initialize(a,i,r),n=new Fi(a,e._getTelCtx().getExtCfg(e.identifier),i)},e.processTelemetry=function(t,i){Aa(t,e.identifier),i=e._getTelCtx(i);var r,o,s=t.ext=t.ext?t.ext:{};t.data=t.data?t.data:{},xe(Hi,function(e){s[e]=s[e]||{}}),n&&(n.applyApplicationContext(t),n.applyUserContext(t),n.applyWebContext(t),n.applyOsContext(t),n.applySdkContext(t),n.applyIntWebContext(t),n.applyUtcContext(t),n.applyLocContext(t),n.applySessionContext(t),n.applyDeviceContext(t),n.applyAITraceContext(t),n.applyCloudContext(t)),xe(Ae(s),function(e){0===Ae(s[e]).length&&delete s[e]}),r=a,o=t.data,r&&pe(r,function(e,t){o[e]||(o[e]=t)}),e.processNext(t,i)},e.getPropertiesContext=function(){return n},e.setProperty=function(e,t){a[e]=t},e._doTeardown=function(e,t){i()}}),i}return Object(B.e)(t,e),t}(wn),Ni=(Ui={},pe({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5},function(e,t){Ui[e]=t,Ui[t]=e}),ke(Ui)),Bi="REAL_TIME",ji="POST",Vi="drop",zi="requeue",Gi="application/x-json-stream",Ki="cache-control",Wi="content-type",qi="time-delta-millis",Qi="client-version",Yi="client-id",Ji="time-delta-to-apply-millis",Xi="upload-time",Zi="apikey",$i="AuthMsaDeviceTicket",er="AuthXToken";function tr(e){var t=(e.ext||{}).intweb;return t&&Da(t.msfpc)?t.msfpc:null}function nr(e){for(var t=null,n=0;null===t&&n<e.length;n++)t=tr(e[n]);return t}var ar=function(){function e(t,n){var a=n?[].concat(n):[],i=this,r=nr(a);i.iKey=function(){return t},i.Msfpc=function(){return r||""},i.count=function(){return a.length},i.events=function(){return a},i.addEvent=function(e){return!!e&&(a.push(e),r||(r=tr(e)),!0)},i.split=function(n,i){var o;if(n<a.length){var s=a.length-n;se(i)||(s=i<s?i:s),o=a.splice(n,s),r=nr(a)}return new e(t,o)}}return e.create=function(t,n){return new e(t,n)},e}(),ir=2e6,rr=Math.min(ir,65e3),or=/\./,sr=function e(t,n,a,i){var r="baseData",o=!!i,s=n,c={};Object(mt.e)(e,this,function(e){function n(e,t,i,r,d,l,u){pe(e,function(e,f){var p=null;if(f||Da(f)){var m=i,_=e,h=d,b=t;if(o&&!r&&or.test(e)){var g=e.split("."),v=g.length;if(v>1){h&&(h=h.slice());for(var y=0;y<v-1;y++){var S=g[y];b=b[S]=b[S]||{},m+="."+S,h&&h.push(S)}_=g[v-1]}}var D=r&&function(e,t){var n=c[e];return void 0===n&&(e.length>=7&&(n=_e(e,"ext.metadata")||_e(e,"ext.web")),c[e]=n),n}(m);if(p=!D&&s&&s.handleField(m,_)?s.value(m,_,f,a):function(e,t,n){if(!t&&!Da(t)||"string"!=typeof e)return null;var a,i=typeof t;if("string"===i||"number"===i||"boolean"===i||be(t))t={value:t};else if("object"!==i||t.hasOwnProperty("value")){if(se(t.value)||""===t.value||!ve(t.value)&&!ye(t.value)&&!Se(t.value)&&!be(t.value))return null}else t={value:n?JSON.stringify(t):t};if(be(t.value)&&!(t.value.length>0))return null;if(!se(t.kind)){if(be(t.value)||!(0===(a=t.kind)||a>0&&a<=13||32===a))return null;t.value=t.value.toString()}return t}(_,f,a)){var I=p.value;if(b[_]=I,l&&l(h,_,p),u&&"object"==typeof I&&!be(I)){var x=h;x&&(x=x.slice()).push(_),n(f,I,m+"."+_,r,x,l,u)}}}})}e.createPayload=function(e,t,n,a,i,r){return{apiKeys:[],payloadBlob:"",overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:e,isTeardown:t,isSync:n,isBeacon:a,sendType:r,sendReason:i}},e.appendPayload=function(n,a,i){var r=n&&a&&!n.overflow;return r&&Et(t,function(){return"Serializer:appendPayload"},function(){for(var t=a.events(),r=n.payloadBlob,o=n.numEvents,s=!1,c=[],d=[],l=n.isBeacon,u=l?65e3:3984588,f=l?rr:ir,p=0,m=0;p<t.length;){var _=t[p];if(_){if(o>=i){n.overflow=a.split(p);break}var h=e.getEventBlob(_);if(h&&h.length<=f){var b=h.length;if(r.length+b>u){n.overflow=a.split(p);break}r&&(r+="\n"),r+=h,++m>20&&(r.substr(0,1),m=0),s=!0,o++}else h?c.push(_):d.push(_),t.splice(p,1),p--}p++}if(c&&c.length>0&&n.sizeExceed.push(ar.create(a.iKey(),c)),d&&d.length>0&&n.failedEvts.push(ar.create(a.iKey(),d)),s){n.batches.push(a),n.payloadBlob=r,n.numEvents=o;var g=a.iKey();-1===Ce(n.apiKeys,g)&&n.apiKeys.push(g)}},function(){return{payload:n,theBatch:{iKey:a.iKey(),evts:a.events()},max:i}}),r},e.getEventBlob=function(e){try{return Et(t,function(){return"Serializer.getEventBlob"},function(){var t={};t.name=e.name,t.time=e.time,t.ver=e.ver,t.iKey="o:"+Ia(e.iKey);var a={},i=e.ext;i&&(t.ext=a,pe(i,function(e,t){n(t,a[e]={},"ext."+e,!0,null,null,!0)}));var o=t.data={};o.baseType=e.baseType;var s=o.baseData={};return n(e.baseData,s,r,!1,[r],function(e,t,n){cr(a,e,t,n)},!0),n(e.data,o,"data",!1,[],function(e,t,n){cr(a,e,t,n)},!0),JSON.stringify(t)},function(){return{item:e}})}catch(e){return null}}})};function cr(e,t,n,a){if(a&&e){var i=xa(a.value,a.kind,a.propertyType);if(i>-1){var r=e.metadata;r||(r=e.metadata={f:{}});var o=r.f;if(o||(o=r.f={}),t)for(var s=0;s<t.length;s++){var c=t[s];o[c]||(o[c]={f:{}});var d=o[c].f;d||(d=o[c].f={}),o=d}o=o[n]={},be(a.value)?o.a={t:i}:o.t=i}}}function dr(e){var t,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(2,e)*n,Math.min(t,6e5)}var lr,ur=function e(){var t={};Object(mt.e)(e,this,function(e){e.setKillSwitchTenants=function(e,n){if(e&&n)try{var a=(o=e.split(","),s=[],o&&xe(o,function(e){s.push(Oe(e))}),s);if("this-request-only"===n)return a;for(var i=1e3*parseInt(n,10),r=0;r<a.length;++r)t[a[r]]=Pe()+i}catch(e){return[]}var o,s;return[]},e.isTenantKilled=function(e){var n=t,a=Oe(e);return void 0!==n[a]&&n[a]>Pe()||(delete n[a],!1)}})},fr=function e(){var t=!0,n=!0,a=!0,i="use-collector-delta",r=!1;Object(mt.e)(e,this,function(e){e.allowRequestSending=function(){return t},e.firstRequestSent=function(){a&&(a=!1,r||(t=!1))},e.shouldAddClockSkewHeaders=function(){return n},e.getClockSkewHeaderValue=function(){return i},e.setClockSkew=function(e){r||(e?(i=e,n=!0,r=!0):n=!1,t=!0)}})},pr="&NoResponseBody=true",mr=((lr={})[1]=zi,lr[100]=zi,lr[200]="sent",lr[8004]=Vi,lr[8003]=Vi,lr),_r={},hr={};function br(e,t,n){_r[e]=t,!1!==n&&(hr[t]=e)}function gr(e){try{return e.responseText}catch(e){}return""}function vr(e,t){var n=!1;if(e&&t){var a=Ae(e);if(a&&a.length>0)for(var i=t.toLowerCase(),r=0;r<a.length;r++){var o=a[r];if(o&&de(t,o)&&o.toLowerCase()===i){n=!0;break}}}return n}function yr(e,t,n,a){t&&n&&n.length>0&&(a&&_r[t]?(e.hdrs[_r[t]]=n,e.useHdrs=!0):e.url+="&"+t+"="+n)}br($i,$i,!1),br(Qi,Qi),br(Yi,"Client-Id"),br(Zi,Zi),br(Ji,Ji),br(Xi,Xi),br(er,er);var Sr=function e(t,n,a,i,r){this._responseHandlers=[];var o,s,c,d,l,u,f="?cors=true&"+Wi.toLowerCase()+"="+Gi,p=new ur,m=!1,_=new fr,h=!1,b=0,g=!0,v=[],y={},S=[],D=null,I=!1,x=!1,C=!1;Object(mt.e)(e,this,function(e){var O=!0;function w(e,t){for(var n=0,a=null,i=0;null==a&&i<e.length;)1===(n=e[i])?(null===Qe&&(Qe=typeof XDomainRequest!==j.u)&&ft()&&(Qe=Qe&&!Je(Xe(Ke),"withCredentials")),Qe?a=E:ft()&&(a=L)):2===n&&ut(t)?a=A:h&&3===n&&lt()&&(a=M),i++;return a?{_transport:n,_isSync:t,sendPOST:a}:null}function E(e,t,n){var a=new XDomainRequest;a.open(ji,e.urlString),e.timeout&&(a.timeout=e.timeout),a.onload=function(){var e=gr(a);k(t,200,{},e),G(e)},a.onerror=function(){k(t,400,{})},a.ontimeout=function(){k(t,500,{})},a.onprogress=function(){},n?a.send(e.data):r.set(function(){a.send(e.data)},0)}function A(e,t,n){var a,i=e.urlString,o=!1,s=!1,c=((a={body:e.data,method:ji}).Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,a);n&&(c.keepalive=!0,2===e._sendReason&&(o=!0,i+=pr)),O&&(c.credentials="include"),e.headers&&Ae(e.headers).length>0&&(c.headers=e.headers),fetch(i,c).then(function(e){var n={},a="";e.headers&&e.headers.forEach(function(e,t){n[t]=e}),e.body&&e.text().then(function(e){a=e}),s||(s=!0,k(t,e.status,n,a),G(a))}).catch(function(e){s||(s=!0,k(t,0,{}))}),o&&!s&&(s=!0,k(t,200,{})),!s&&e.timeout>0&&r.set(function(){s||(s=!0,k(t,500,{}))},e.timeout)}function L(e,t,n){var a=e.urlString;function i(e,t,n){if(!e[n]&&t&&t.getResponseHeader){var a=t.getResponseHeader(n);a&&(e[n]=Oe(a))}return e}function r(e,n){k(t,e.status,function(e){var t,n,a={};return e.getAllResponseHeaders?(t=e.getAllResponseHeaders(),n={},ve(t)&&xe(Oe(t).split(/[\r\n]+/),function(e){if(e){var t=e.indexOf(": ");if(-1!==t){var a=Oe(e.substring(0,t)).toLowerCase(),i=Oe(e.substring(t+1));n[a]=i}else n[Oe(e)]=1}}),a=n):(a=i(a,e,qi),a=i(a,e,"kill-duration"),a=i(a,e,"kill-duration-seconds")),a}(e),n)}n&&e.disableXhrSync&&(n=!1);var o=function(e,t,n,a,i,r){function o(e,t,n){try{e[t]=n}catch(e){}}void 0===a&&(a=!1),void 0===i&&(i=!1);var s=new XMLHttpRequest;return a&&o(s,"Microsoft_ApplicationInsights_BypassAjaxInstrumentation",a),n&&o(s,ya,n),s.open("POST",t,!i),n&&o(s,ya,n),!i&&r&&o(s,"timeout",r),s}(0,a,O,!0,n,e.timeout);pe(e.headers,function(e,t){o.setRequestHeader(e,t)}),o.onload=function(){var e=gr(o);r(o,e),G(e)},o.onerror=function(){r(o)},o.ontimeout=function(){r(o)},o.send(e.data)}function k(e,t,n,a){try{e(t,n,a)}catch(e){xt(o.diagLog(),2,518,dt(e))}}function M(e,t,n){var a=200,i=e._thePayload,r=e.urlString+pr;try{var s=at();if(!s.sendBeacon(r,e.data))if(i){var c=[];xe(i.batches,function(e){if(c&&e&&e.count()>0){for(var t=e.events(),n=0;n<t.length;n++)if(!s.sendBeacon(r,D.getEventBlob(t[n]))){c.push(e.split(n));break}}else c.push(e.split(0))}),K(c,8003,i.sendType,!0)}else a=0}catch(e){o.diagLog().warnToConsole("Failed to send telemetry using sendBeacon API. Ex:"+dt(e)),a=0}finally{k(t,a,{},"")}}function P(e){return 2===e||3===e}function T(e){return x&&P(e)&&(e=2),e}function U(){return!m&&b<n}function F(){var e=S;return S=[],e}function H(e,t,n){var a=!1;return e&&e.length>0&&!m&&s[t]&&D&&(a=0!==t||U()&&(n>0||_.allowRequestSending())),a}function R(e){var t={};return e&&xe(e,function(e,n){t[n]={iKey:e.iKey(),evts:e.events()}}),t}function N(e,n,a,i,r){if(e&&0!==e.length)if(m)K(e,1,i);else{i=T(i);try{var d=e,l=0!==i;Et(c,function(){return"HttpManager:_sendBatches"},function(o){o&&(e=e.slice(0));for(var c=[],d=null,u=Ea(),f=s[i]||(l?s[1]:s[0]),m=(x||P(i)||f&&3===f._transport)&&!g&&h&&lt();H(e,i,n);){var _=e.shift();_&&_.count()>0&&(p.isTenantKilled(_.iKey())?c.push(_):(d=d||D.createPayload(n,a,l,m,r,i),D.appendPayload(d,_,t)?null!==d.overflow&&(e=[d.overflow].concat(e),d.overflow=null,V(d,u,Ea(),r),u=Ea(),d=null):(V(d,u,Ea(),r),u=Ea(),e=[_].concat(e),d=null)))}d&&V(d,u,Ea(),r),e.length>0&&(S=e.concat(S)),K(c,8004,i)},function(){return{batches:R(d),retryCount:n,isTeardown:a,isSynchronous:l,sendReason:r,useSendBeacon:P(i),sendType:i}},!l)}catch(e){xt(o.diagLog(),2,48,"Unexpected Exception sending batch: "+dt(e))}}}function B(e,t,n){e[t]=e[t]||{},e[t][o.identifier]=n}function V(t,n,i,r){if(t&&t.payloadBlob&&t.payloadBlob.length>0){var d=!!e.sendHook,m=s[t.sendType];!P(t.sendType)&&t.isBeacon&&2===t.sendReason&&(m=s[2]||s[3]||m);var h=C;(t.isBeacon||3===m._transport)&&(h=!1);var S=function(e,t){var n={url:f,hdrs:{},useHdrs:!1};t?(n.hdrs=wa(n.hdrs,y),n.useHdrs=Ae(n.hdrs).length>0):pe(y,function(e,t){hr[e]?yr(n,hr[e],t,!1):(n.hdrs[e]=t,n.useHdrs=!0)}),yr(n,Yi,"NO_AUTH",t),yr(n,Qi,va,t);var a="";xe(e.apiKeys,function(e){a.length>0&&(a+=","),a+=e}),yr(n,Zi,a,t),yr(n,Xi,Pe().toString(),t);var i=function(e){for(var t=0;t<e.batches.length;t++){var n=e.batches[t].Msfpc();if(n)return encodeURIComponent(n)}return""}(e);if(Da(i)&&(n.url+="&ext.intweb.msfpc="+i),_.shouldAddClockSkewHeaders()&&yr(n,Ji,_.getClockSkewHeaderValue(),t),c.getWParam){var r=c.getWParam();r>=0&&(n.url+="&w="+r)}for(var o=0;o<v.length;o++)n.url+="&"+v[o].name+"="+v[o].value;return n}(t,h);h=h||S.useHdrs;var D=Ea();Et(c,function(){return"HttpManager:_doPayloadSend"},function(){for(var s=0;s<t.batches.length;s++)for(var f=t.batches[s].events(),v=0;v<f.length;v++){var y=f[v];if(I){var C=y.timings=y.timings||{};B(C,"sendEventStart",D),B(C,"serializationStart",n),B(C,"serializationCompleted",i)}y.sendAttempt>0?y.sendAttempt++:y.sendAttempt=1}K(t.batches,1e3+(r||0),t.sendType,!0);var O={data:t.payloadBlob,urlString:S.url,headers:S.hdrs,_thePayload:t,_sendReason:r,timeout:l};oe(u)||(O.disableXhrSync=!!u),h&&(vr(O.headers,Ki)||(O.headers[Ki]="no-cache, no-store"),vr(O.headers,Wi)||(O.headers["content-type"]=Gi));var w=null;m&&(w=function(n){_.firstRequestSent();var i=function(n,i){!function(t,n,i,r){var s,c=9e3,d=null,l=!1,u=!1;try{var f=!0;if(typeof t!==j.u){if(n){_.setClockSkew(n[qi]);var m=n["kill-duration"]||n["kill-duration-seconds"];xe(p.setKillSwitchTenants(n["kill-tokens"],m),function(e){xe(i.batches,function(t){if(t.iKey()===e){d=d||[];var n=t.split(0);i.numEvents-=n.count(),d.push(n)}})})}if(200==t||204==t)return void(c=200);((s=t)>=300&&s<500&&408!=s&&429!=s||501==s||505==s||i.numEvents<=0)&&(f=!1),c=9e3+t%1e3}if(f){c=100;var h=i.retryCnt;0===i.sendType&&(h<a?(l=!0,z(function(){0===i.sendType&&b--,N(i.batches,h+1,i.isTeardown,x?2:i.sendType,5)},x,dr(h))):(u=!0,x&&(c=8001)))}}finally{l||(_.setClockSkew(),function(t,n,a,i){try{i&&o._backOffTransmission(),200===n&&(i||t.isSync||o._clearBackOff(),function(e){if(I){var t=Ea();xe(e,function(e){e&&e.count()>0&&function(e,t){I&&xe(e,function(e){B(e.timings=e.timings||{},"sendEventCompleted",t)})}(e.events(),t)})}}(t.batches)),K(t.batches,n,t.sendType,!0)}finally{0===t.sendType&&(b--,5!==a&&e.sendQueuedRequests(t.sendType,a))}}(i,c,r,u)),K(d,8004,i.sendType)}}(n,i,t,r)},s=t.isTeardown||t.isSync;try{m.sendPOST(n,i,s),e.sendListener&&e.sendListener(O,n,s,t.isBeacon)}catch(e){o.diagLog().warnToConsole("Unexpected exception sending payload. Ex:"+dt(e)),k(i,0,{})}}),Et(c,function(){return"HttpManager:_doPayloadSend.sender"},function(){if(w)if(0===t.sendType&&b++,d&&!t.isBeacon&&3!==m._transport){var n={data:O.data,urlString:O.urlString,headers:wa({},O.headers),timeout:O.timeout,disableXhrSync:O.disableXhrSync},a=!1;Et(c,function(){return"HttpManager:_doPayloadSend.sendHook"},function(){try{e.sendHook(n,function(e){a=!0,g||e._thePayload||(e._thePayload=e._thePayload||O._thePayload,e._sendReason=e._sendReason||O._sendReason),w(e)},t.isSync||t.isTeardown)}catch(e){a||w(O)}})}else w(O)})},function(){return{thePayload:t,serializationStart:n,serializationCompleted:i,sendReason:r}},t.isSync)}t.sizeExceed&&t.sizeExceed.length>0&&K(t.sizeExceed,8003,t.sendType),t.failedEvts&&t.failedEvts.length>0&&K(t.failedEvts,8002,t.sendType)}function z(e,t,n){t?e():r.set(e,n)}function G(t){var n=e._responseHandlers;try{for(var a=0;a<n.length;a++)try{n[a](t)}catch(e){xt(o.diagLog(),1,519,"Response handler failed: "+e)}if(t){var i=JSON.parse(t);Da(i.webResult)&&Da(i.webResult.msfpc)&&d.set("MSFPC",i.webResult.msfpc,31536e3)}}catch(e){}}function K(e,t,n,a){if(e&&e.length>0&&i){var r=i[(d=t,l=mr[d],Da(l)||(l="oth",d>=9e3&&d<=9999?l="rspFail":d>=8e3&&d<=8999?l=Vi:d>=1e3&&d<=1999&&(l="send")),l)];if(r){var s=0!==n;Et(c,function(){return"HttpManager:_sendBatchesNotification"},function(){z(function(){try{r.call(i,e,t,s,n)}catch(e){xt(o.diagLog(),1,74,"send request notification failed: "+e)}},a||s,0)},function(){return{batches:R(e),reason:t,isSync:s,sendSync:a,sendType:n}},!s)}}var d,l}e.initialize=function(e,t,n,a,i){var r;i||(i={}),f=e+f,C=!!oe(i.avoidOptions)||!i.avoidOptions,c=t,d=t.getCookieMgr(),I=!c.config.disableEventTimings;var p=!!c.config.enableCompoundKey;o=n;var m=i.valueSanitizer,_=i.stringifyObjects;oe(i.enableCompoundKey)||(p=!!i.enableCompoundKey),l=i.xhrTimeout,u=i.disableXhrSync,h=!st(),D=new sr(c,m,_,p);var b=a,v=i.alwaysUseXhrOverride?a:null,y=i.alwaysUseXhrOverride?a:null;if(!a){g=!1;var S=it();S&&S.protocol&&"file:"===S.protocol.toLowerCase()&&(O=!1);var x=[];x=st()?[2,1]:[1,2,3];var E=i.transports;E&&(ye(E)?x=[E].concat(x):be(E)&&(x=E.concat(x))),a=w(x,!1),b=w(x,!0),a||o.diagLog().warnToConsole("No available transport to send events")}(r={})[0]=a,r[1]=b||w([1,2,3],!0),r[2]=v||w([3,2],!0)||b||w([1],!0),r[3]=y||w([2,3],!0)||b||w([1],!0),s=r},e._getDbgPlgTargets=function(){return[s[0],p,D,s]},e.addQueryStringParameter=function(e,t){for(var n=0;n<v.length;n++)if(v[n].name===e)return void(v[n].value=t);v.push({name:e,value:t})},e.addHeader=function(e,t){y[e]=t},e.canSendRequest=function(){return U()&&_.allowRequestSending()},e.sendQueuedRequests=function(e,t){oe(e)&&(e=0),x&&(e=T(e),t=2),H(S,e,0)&&N(F(),0,!1,e,t||0)},e.isCompletelyIdle=function(){return!m&&0===b&&0===S.length},e.setUnloading=function(e){x=e},e.addBatch=function(e){if(e&&e.count()>0){if(p.isTenantKilled(e.iKey()))return!1;S.push(e)}return!0},e.teardown=function(){S.length>0&&N(F(),0,!0,2,2)},e.pause=function(){m=!0},e.resume=function(){m=!1,e.sendQueuedRequests(0,4)},e.sendSynchronousBatch=function(e,t,n){e&&e.count()>0&&(se(t)&&(t=1),x&&(t=T(t),n=2),N([e],0,!1,t,n||0))}})};function Dr(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];return setTimeout(e,t,n)}function Ir(e){clearTimeout(e)}function xr(e,t){return{set:e||Dr,clear:t||Ir}}var Cr="eventsDiscarded",Or=function(e){function t(){var n,a=e.call(this)||this;a.identifier="PostChannel",a.priority=1011,a.version="3.2.2";var i,r,o,s,c,d,l,u=!1,f=[],p=null,m=!1,_=0,h=500,b=0,g=1e4,v={},y=Bi,S=null,D=null,I=0,x=0,C={},O=-1,w=!0,E=!1,A=6,L=2;return Object(mt.e)(t,a,function(e,t){function a(e){"beforeunload"!==(e||$e().event).type&&(E=!0,r.setUnloading(E)),N(2,2)}function k(e){E=!1,r.setUnloading(E)}function M(e,t){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=1),e.ext&&e.ext.trace&&delete e.ext.trace,e.ext&&e.ext.user&&e.ext.user.id&&delete e.ext.user.id,w&&(e.ext=je(e.ext),e.baseData&&(e.baseData=je(e.baseData)),e.data&&(e.data=je(e.data))),e.sync)if(I||m)e.latency=3,e.sync=!1;else if(r)return w&&(e=je(e)),void r.sendSynchronousBatch(ar.create(e.iKey,[e]),!0===e.sync?1:e.sync,3);var n=e.latency,a=b,i=g;4===n&&(a=_,i=h);var o=!1;if(a<i)o=!V(e,t);else{var s=1,c=20;4===n&&(s=4,c=1),o=!0,function(e,t,n,a){for(;n<=t;){var i=B(e,t,!0);if(i&&i.count()>0){var r=i.split(0,a),o=r.count();if(o>0)return 4===n?_-=o:b-=o,X(Cr,[r],Ni.QueueFull),!0}n++}return z(),!1}(e.iKey,e.latency,s,c)&&(o=!V(e,t))}o&&J(Cr,[e],Ni.QueueFull)}function P(e,t,n){var a=G(e,t,n);return r.sendQueuedRequests(t,n),a}function T(){return b>0}function U(){if(O>=0&&G(O,0,c)&&r.sendQueuedRequests(0,c),_>0&&!D&&!m){var e=v[y][2];e>=0&&(D=H(function(){D=null,P(4,0,1),U()},e))}var t=v[y][1];!S&&!p&&t>=0&&!m&&(T()?S=H(function(){S=null,P(0===x?3:1,0,1),x++,x%=2,U()},t):x=0)}function F(){n=null,u=!1,f=[],p=null,m=!1,_=0,h=500,b=0,g=1e4,v={},y=Bi,S=null,D=null,I=0,x=0,i=null,C={},o=void 0,s=0,O=-1,c=null,w=!0,E=!1,A=6,L=2,d=null,l=xr(),r=new Sr(500,2,1,{requeue:Q,send:Z,sent:$,drop:ee,rspFail:te,oth:ne},l),q(),C[4]={batches:[],iKeyMap:{}},C[3]={batches:[],iKeyMap:{}},C[2]={batches:[],iKeyMap:{}},C[1]={batches:[],iKeyMap:{}},ae()}function H(e,t){0===t&&I&&(t=1);var n=1e3;return I&&(n=dr(I-1)),l.set(e,t*n)}function R(){null!==S&&(l.clear(S),S=null,x=0)}function N(e,t){R(),p&&(l.clear(p),p=null),m||P(1,e,t)}function B(e,t,n){var a=C[t];a||(a=C[t=1]);var i=a.iKeyMap[e];return!i&&n&&(i=ar.create(e),a.batches.push(i),a.iKeyMap[e]=i),i}function j(t,n){r.canSendRequest()&&!I&&(o>0&&b>o&&(n=!0),n&&null==p&&e.flush(t,null,20))}function V(e,t){w&&(e=je(e));var n=e.latency,a=B(e.iKey,n,!0);return!!a.addEvent(e)&&(4!==n?(b++,t&&0===e.sendAttempt&&j(!e.sync,s>0&&a.count()>=s)):_++,!0)}function z(){for(var e=0,t=0,n=function(n){var a=C[n];a&&a.batches&&xe(a.batches,function(a){4===n?e+=a.count():t+=a.count()})},a=1;a<=4;a++)n(a);b=t,_=e}function G(t,n,a){var i=!1,o=0===n;return!o||r.canSendRequest()?Et(e.core,function(){return"PostChannel._queueBatches"},function(){for(var e=[],n=4;n>=t;){var a=C[n];a&&a.batches&&a.batches.length>0&&(xe(a.batches,function(t){r.addBatch(t)?i=i||t&&t.count()>0:e=e.concat(t.events()),4===n?_-=t.count():b-=t.count()}),a.batches=[],a.iKeyMap={}),n--}e.length>0&&J(Cr,e,Ni.KillSwitch),i&&O>=t&&(O=-1,c=0)},function(){return{latency:t,sendType:n,sendReason:a}},!o):(O=O>=0?Math.min(O,t):t,c=Math.max(c,a)),i}function K(e,t){P(1,0,t),W(function(){e&&e(),f.length>0?p=H(function(){return K(f.shift(),t)},0):(p=null,T()&&U())})}function W(e){r.isCompletelyIdle()?e():p=H(function(){W(e)},.25)}function q(){(v={}).REAL_TIME=[2,1,0],v.NEAR_REAL_TIME=[6,3,0],v.BEST_EFFORT=[18,9,0]}function Q(t,n){var a=[],i=A;E&&(i=L),xe(t,function(t){t&&t.count()>0&&xe(t.events(),function(t){t&&(t.sync&&(t.latency=4,t.sync=!1),t.sendAttempt<i?(Aa(t,e.identifier),M(t,!1)):a.push(t))})}),a.length>0&&J(Cr,a,Ni.NonRetryableStatus),E&&N(2,2)}function Y(t,n){var a=e._notificationManager||{},i=a[t];if(i)try{i.apply(a,n)}catch(n){xt(e.diagLog(),1,74,t+" notification failed: "+n)}}function J(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];t&&t.length>0&&Y(e,[t].concat(n))}function X(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];t&&t.length>0&&xe(t,function(t){t&&t.count()>0&&Y(e,[t.events()].concat(n))})}function Z(e,t,n){e&&e.length>0&&Y("eventsSendRequest",[t>=1e3&&t<=1999?t-1e3:0,!0!==n])}function $(e,t){X("eventsSent",e,t),U()}function ee(e,t){X(Cr,e,t>=8e3&&t<=8999?t-8e3:Ni.Unknown)}function te(e){X(Cr,e,Ni.NonRetryableStatus),U()}function ne(e,t){X(Cr,e,Ni.Unknown),U()}function ae(){s=n&&n.disableAutoBatchFlushLimit?0:Math.max(1500,g/6)}F(),e._getDbgPlgTargets=function(){return[r]},e.initialize=function(s,c,u){Et(c,function(){return"PostChannel:initialize"},function(){var f,p,m,_,b=c;t.initialize(s,c,u);try{c.addUnloadCb,d=aa(Kt(e.identifier),c.evtNamespace&&c.evtNamespace());var v=e._getTelCtx();s.extensionConfig[e.identifier]=s.extensionConfig[e.identifier]||{},n=v.getExtCfg(e.identifier),l=xr(n.setTimeoutOverride,n.clearTimeoutOverride),w=!n.disableOptimizeObj&&!!Xe("chrome"),function(e){var t=e.getWParam;e.getWParam=function(){var e=0;return n.ignoreMc1Ms0CookieProcessing&&(e|=2),e|t()}}(b),n.eventsLimitInMem>0&&(g=n.eventsLimitInMem),n.immediateEventLimit>0&&(h=n.immediateEventLimit),n.autoFlushEventsLimit>0&&(o=n.autoFlushEventsLimit),n.disableXhrSync,ye(n.maxEventRetryAttempts)&&(A=n.maxEventRetryAttempts),ye(n.maxUnloadEventRetryAttempts)&&(L=n.maxUnloadEventRetryAttempts),ae(),n.httpXHROverride&&n.httpXHROverride.sendPOST&&(i=n.httpXHROverride),Da(s.anonCookieName)&&r.addQueryStringParameter("anoncknm",s.anonCookieName),r.sendHook=n.payloadPreprocessor,r.sendListener=n.payloadListener;var y=n.overrideEndpointUrl?n.overrideEndpointUrl:s.endpointUrl;e._notificationManager=s.extensionConfig.NotificationManager,r.initialize(y,e.core,e,i,n);var S=s.disablePageUnloadEvents||[];f=[Gn,zn,jn],m=S,_=d,(p=a)&&f&&be(f)&&!sa(f,p,m,_)&&m&&m.length>0&&sa(f,p,null,_),da(a,S,d),la(k,s.disablePageShowEvents,d)}catch(t){throw e.setInitialized(!1),t}},function(){return{coreConfig:s,core:c,extensions:u}})},e.processTelemetry=function(t,a){Aa(t,e.identifier);var i=(a=e._getTelCtx(a)).getExtCfg(e.identifier),r=!!n.disableTelemetry;i&&(r=r||!!i.disableTelemetry);var o=t;r||u||(n.overrideInstrumentationKey&&(o.iKey=n.overrideInstrumentationKey),i&&i.overrideInstrumentationKey&&(o.iKey=i.overrideInstrumentationKey),M(o,!0),E?N(2,2):U()),e.processNext(o,a)},e._doTeardown=function(e,t){var n;N(2,2),u=!0,r.teardown(),ca([Gn,zn,jn],null,d),n=aa(Kn,d),ca([jn],null,n),ca([Bn],null,n),function(e,t){var n=aa(Wn,t);ca([Vn],null,n),ca([Bn],null,n)}(0,d),F()},e.setEventQueueLimits=function(e,t){g=e>0?e:1e4,o=t>0?t:0,ae();var n=b>e;if(!n&&s>0)for(var a=1;!n&&a<=3;a++){var i=C[a];i&&i.batches&&xe(i.batches,function(e){e&&e.count()>=s&&(n=!0)})}j(!0,n)},e.pause=function(){R(),m=!0,r.pause()},e.resume=function(){m=!1,r.resume(),U()},e.addResponseHandler=function(e){r._responseHandlers.push(e)},e._loadTransmitProfiles=function(e){R(),q(),y=Bi,U(),pe(e,function(e,t){var n=t.length;if(n>=2){var a=n>2?t[2]:0;if(t.splice(0,n-2),t[1]<0&&(t[0]=-1),t[1]>0&&t[0]>0){var i=t[0]/t[1];t[0]=Math.ceil(i)*t[1]}a>=0&&t[1]>=0&&a>t[1]&&(a=t[1]),t.push(a),v[e]=t}})},e.flush=function(e,t,n){void 0===e&&(e=!0),m||(R(),n=n||1,e?(G(1,0,n),z(),null==p?p=H(function(){K(t,n)},0):f.push(t)):(P(1,1,n),null!=t&&t()))},e.setMsaAuthTicket=function(e){r.addHeader($i,e)},e.hasEvents=T,e._setTransmitProfile=function(e){y!==e&&void 0!==v[e]&&(R(),y=e,U())},e._backOffTransmission=function(){I<4&&(I++,R(),U())},e._clearBackOff=function(){I&&(I=0,R(),U())},Le(e,"_setTimeoutOverride",function(){return l.set},function(e){l=xr(e,l.clear)}),Le(e,"_clearTimeoutOverride",function(){return l.clear},function(e){l=xr(l.set,e)})}),a}return Object(B.e)(t,e),t}(wn),wr=Or,Er=["ACCDA","ACCDB","ACCDC","ACCDE","ACCDR","ACCDT","ACCDU","ACCDW","ACCFT","ADE","ADN","ADP","AVI","BMP","CSV","DOC","DOCX","DOT","DOTX","ERR","FON","GIF","HTML","ISO","JPEG","JPG","LACCDB","LDB","LOG","MAD","MAF","MAG","MAM","MAQ","MAR","MAS","MAT","MAU","MAV","MAW","MDA","MDBHTML","MDE","MDN","MDT","MDW","MOV","MP3","MPD","MPG","MPP","MPT","MPW","MPX","MSG","OLS","ONE","ONEPKG","ONETOC","ONETOC2","OST","PDF","PNG","POT","POTHTML","POTX","PPA","PPS","PPSX","PPT","PPTHTML","PPTMHTML","PPTX","PPTXML","PST","PUB","PWZ","RTF","SLDM","SLDX","SLK","THMX","TIF","TIFF","TSX","TTF","TXT","VDW","VDX","VHD","VSD","VSDM","VSDX","VSIX","VSL","VSS","VSSM","VSSX","VST","VSTM","VSTX","VSU","VSW","VSX","WAV","WIZHTML","WMA","WMV","WPL","XLS","XLSHTML","XLSMHTML","XLSX","XLTHTML","XLTM","XLTX","XLW","XLXML","XPS","ZIP"],Ar=function(){function e(){this.map={},this.isWord=!1,this.isInitialized=!1}return e.prototype.search=function(e){return this.find(e,0,this)},e.prototype.init=function(){if(!this.isInitialized){for(var e=0,t=Er;e<t.length;e++){var n=t[e];this.add(n,0,this)}this.isInitialized=!0}},e.prototype.add=function(t,n,a){if(n!==t.length)return a.map[t.charAt(n)]||(a.map[t.charAt(n)]=new e),this.add(t,n+1,a.map[t.charAt(n)]);a.isWord=!0},e.prototype.find=function(e,t,n){return t===e.length?!!n.isWord:!!n.map[e[t]]&&this.find(e,t+1,n.map[e.charAt(t)])},e}(),Lr=/([A-Z0-9_]|\.|%2E){1,50}(@|_AT_|%40)([A-Z0-9_]{1,50}(\.|_|%2E))+(COM|ORG|GOV|EDU)/,kr=/([A-Z]:|\\)(\\\\{0,1}\w+)+/,Mr=/((<HTML>)|(\{\\RTF)|(<\?XML)|(MIME-VERSION)|(<ASP:))/,Pr=function(){function e(){var t=[],n=!1,a=!0,i=!0,r=[],o=new Ar;Object(mt.e)(e,this,function(e,s){function c(e){return e=(e=e.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&")).replace(/\-/g,"-?"),new RegExp(e)}function d(e,t){for(var n=0,a=e.split(" ");n<a.length;n++){var i=a[n];i.length>=4&&(!t||t&&-1===Ce(t,i))&&r.push(i)}}function l(e,t){if(!e||0===e.length||!t||0===t.length)return!1;var n=e.indexOf(t)-1,a=n+t.length+1;if(n>=-1&&a>=0){var i=e.charCodeAt(a);return n>-1?!u(e.charCodeAt(n))&&!u(i):!u(i)}return!1}function u(e){return e>=65&&e<=90||e>=97&&e<=122}function f(e){for(var t=0;t<e.length;t++)if(u(e.charCodeAt(t)))return!0;return!1}function p(e){return e.match(/MICROSOFT(\.|_|%2E)COM/)||e.match(/LINKEDIN(\.|_|%2E)COM/)?11:5}function m(e,t,n){if(n<0||n+t.length>=e.length)return!1;for(var a=0;a<t.length;a++)if(e[n+a]!==t[a])return!1;return!0}e.initialize=function(t){if(!t)throw new Error;i=!0!==t.disableAdvancedScans,void 0!==t.scanForUrls&&(a=!0===t.scanForUrls),t.context&&e.updateCommonContext(t.context),o.init(),n=!0},e.isEnabled=function(){return n},e.setEnabled=function(e){return(n=e)===e},e.updateCommonContext=function(e){if(null===e)throw new Error;if(e.UserName&&f(e.UserName)&&d(e.UserName,e.IgnoredNameParts),e.UserNames&&e.UserNames.length>0)for(var n=0,a=e.UserNames;n<a.length;n++){var r=a[n];f(r)&&d(r,e.IgnoredNameParts)}if(e.UserAlias&&f(e.UserAlias)&&t.push({stringIsolatedWord:e.UserAlias.replace(/[^a-zA-Z]/g,"").toUpperCase(),concern:19}),e.UserAliases&&e.UserAliases.length>0)for(var o=0,s=e.UserAliases;o<s.length;o++){var l=s[o];f(l)&&t.push({stringIsolatedWord:l.replace(/[^a-zA-Z]/g,"").toUpperCase(),concern:19})}if(e.MachineIds&&e.MachineIds.length>0)for(var u=0,p=e.MachineIds;u<p.length;u++){var m=p[u];t.push({stringValue:m.toUpperCase(),concern:14})}if(i&&e.OutOfScopeIdentifiers&&e.OutOfScopeIdentifiers.length>0)for(var _=0,h=e.OutOfScopeIdentifiers;_<h.length;_++){var b=h[_];t.push({regexpValue:c(b.toUpperCase()),concern:15})}},e.getAllPrivacyConcerns=function(e,n,s,c){var d=[];c.length>1e3&&(c=c.substring(0,1e3));var f=function(e){for(var t={hasAlphabets:!1,hasAtSign:!1,hasBackslash:!1,hasDash:!1,hasDot:!1,hasFileUrl:!1,hasFileSharingConcern:!1,hasFormatChars:!1,hasForwardSlash:!1,hasHttp:!1,hasPercentage:!1,hasSecurityAccessTokenConcern:!1,hasSecuritySignatureConcern:!1,hasUnderscore:!1,valueToCheck:e.toUpperCase()},n=t.valueToCheck,i=0;i<n.length;i++){var r=n.charAt(i);switch(t.hasAlphabets||(t.hasAlphabets=u(n.charCodeAt(i))),r){case"@":t.hasAtSign||(t.hasAtSign=i<n.length-3);break;case"\\":t.hasBackslash||(t.hasBackslash=!0);break;case"-":t.hasDash||(t.hasDash=!0);break;case".":t.hasDot||(t.hasDot=i<n.length-2);break;case"<":case"{":t.hasFormatChars||(t.hasFormatChars=!0);break;case"/":t.hasForwardSlash||(t.hasForwardSlash=!0),t.hasHttp&&a&&!t.hasFileSharingConcern&&(i<n.length-16&&(t.hasFileSharingConcern=m(n,"WOPI.ASHX/FILES",i+1),t.hasFileSharingConcern&&(i+=14)),!t.hasFileSharingConcern&&i<n.length-12&&(t.hasFileSharingConcern=m(n,"WOPI/FILES/",i+1),t.hasFileSharingConcern&&(i+=10)));break;case"_":t.hasUnderscore||(t.hasUnderscore=!0),!t.hasAtSign&&i<n.length-4&&(t.hasAtSign="A"===n.charAt(i+1)&&"T"===n.charAt(i+2)&&"_"===n.charAt(i+3),t.hasAtSign&&(i+=2));break;case"A":t.hasForwardSlash&&t.hasHttp&&!t.hasSecurityAccessTokenConcern&&(i<n.length-14&&(t.hasSecurityAccessTokenConcern=m(n,"WSACCESSKEYID",i+1),t.hasSecurityAccessTokenConcern&&(i+=12)),!t.hasSecurityAccessTokenConcern&&i<n.length-12&&(t.hasSecurityAccessTokenConcern=m(n,"CCESS_TOKEN",i+1),t.hasSecurityAccessTokenConcern&&(i+=10)));break;case"D":t.hasForwardSlash&&t.hasHttp&&a&&!t.hasFileSharingConcern&&i<n.length-12&&(t.hasFileSharingConcern=m(n,"ROPBOX.COM/",i+1),t.hasFileSharingConcern&&(i+=10));break;case"F":!t.hasFileUrl&&i<n.length-7&&(t.hasFileUrl=m(n,"ILE://",i+1),t.hasFileUrl&&(i+=5));break;case"%":t.hasPercentage||(t.hasPercentage=!0),!t.hasAtSign&&i<n.length-3&&(t.hasAtSign="4"===n.charAt(i+1)&&"0"===n.charAt(i+2),t.hasAtSign&&(i+=1));break;case"M":!t.hasFormatChars&&i<n.length-12&&(t.hasFormatChars=m(n,"IME-VERSION",i+1),t.hasFormatChars&&(i+=10));break;case"H":!t.hasHttp&&i<n.length-8&&(t.hasHttp=m(n,"TTP://",i+1)||m(n,"TTPS://",i+1),t.hasHttp&&(i+=5));break;case"S":t.hasForwardSlash&&t.hasHttp&&!t.hasSecuritySignatureConcern&&i<n.length-9&&(t.hasSecuritySignatureConcern=m(n,"IGNATURE",i+1),t.hasSecuritySignatureConcern&&(i+=7))}}return t}(c);if(!f.hasAlphabets)return d;if(f.hasForwardSlash&&i&&a&&(f.hasHttp||f.hasFileUrl)&&d.push({Concern:18,EventName:e,BaseType:n,FieldName:s}),f.hasFileUrl&&a&&d.push({Concern:8,EventName:e,BaseType:n,FieldName:s}),f.hasFileSharingConcern&&d.push({Concern:8,EventName:e,BaseType:n,FieldName:s}),f.hasSecurityAccessTokenConcern&&d.push({Concern:22,EventName:e,BaseType:n,FieldName:s}),f.hasSecuritySignatureConcern&&d.push({Concern:23,EventName:e,BaseType:n,FieldName:s}),f.hasBackslash){var _=function(e,t,n,a){var i=a.match(kr);if(!i)return null;var r=[],o=i[0];return o.length>4&&-1===o.search(/:\\U00/)&&-1===o.search(/(\\)+SOFTWARE(\\)+MICROSOFT(\\)+/)&&r.push({Concern:4,EventName:e,BaseType:t,FieldName:n}),r}(e,n,s,f.valueToCheck);_&&(d=d.concat(_))}f.hasFormatChars&&Mr.test(f.valueToCheck)&&d.push({Concern:1,EventName:e,BaseType:n,FieldName:s}),f.hasDot&&(_=function(e,t,n,a){for(var i=a.indexOf(".");-1!==i&&a.length>i;){var r=a.indexOf(".",i+1),s=a.indexOf("_",i+1),c=a.length;r>0&&s>0?c=Math.min(s,r):r>0?c=r:s>0&&(c=s);var d=c-i;if(d>=3&&d<=5&&o.search(a.substring(i+1,i+d)))return{Concern:7,EventName:e,BaseType:t,FieldName:n};i=r}return null}(e,n,s,f.valueToCheck),_&&d.push(_));var h=!1;if(f.hasAtSign&&(f.hasDot||f.hasUnderscore||f.hasPercentage)&&(h=Lr.test(f.valueToCheck))){var b=f.valueToCheck.match(Lr)[0];h&&d.push({Concern:p(b),EventName:e,BaseType:n,FieldName:s})}var g=function(e,n,a,i){for(var r=[],o=!1,s=0;s<t.length;s++){var c=t[s],d=c.stringValue;if(d&&-1!==i.indexOf(d))r.push({Concern:c.concern,EventName:e,BaseType:n,FieldName:a});else{var u=c.stringIsolatedWord;if(u&&l(i,u))r.push({Concern:c.concern,EventName:e,BaseType:n,FieldName:a}),o=o||19===c.concern;else{var f=c.regexpValue;f&&f.test(i)&&r.push({Concern:c.concern,EventName:e,BaseType:n,FieldName:a})}}}return[r,o]}(e,n,s,f.valueToCheck);g[0]&&g[0].length>0&&(d=d.concat(g[0]));var v=g[1];if(!h){if(!v&&void 0!==r&&r.length>0){for(var y=!1,S=0;S<r.length;S++)if(l(c,r[S])){y=!0;break}y&&d.push({Concern:21,EventName:e,BaseType:n,FieldName:s})}f.valueToCheck.length>10&&(me(f.valueToCheck,"_SSPI")&&!me(f.valueToCheck,"*_SSPI")||me(f.valueToCheck,"_AD")&&!me(f.valueToCheck,"*_AD"))&&d.push({Concern:p(f.valueToCheck),EventName:e,BaseType:n,FieldName:s})}return d}})}return e.prototype.initialize=function(e){},e}(),Tr=function(e){function t(){var n=e.call(this)||this;n.identifier="PrivacyGuardPlugin",n.priority=499,n.version="3.2.2";var a,i,r,o,s,c,d,l,u,f,p,m=null,_=null,h=null;return Object(mt.e)(t,n,function(e,t){function n(e){(a=new Pr).initialize(e),e.notificationEventName&&ve(e.notificationEventName)&&(o=e.notificationEventName),e.summaryEventName&&ve(e.summaryEventName)&&(s=e.summaryEventName),e.iKey&&ve(e.iKey)&&(r=e.iKey),a.setEnabled(!1!==e.enabled),c=!1!==e.useEventFieldPrefix,d=!0===e.useAbsoluteFieldName}function b(t,n,i,r){if(!e.isEnabled())return[];var o=[];return se(r)||pe(r,function(e,r){var s=e;d&&i&&i.length>0&&(s=i+"."+e),ve(r)?(p++,o=o.concat(a.getAllPrivacyConcerns(t,n,s,r))):r&&le(r)&&(o=o.concat(b(t,n,s,r)))}),o}function g(){a=null,i=null,r=null,o="PrivacyConcern",s="PrivacyGuardSummary",c=!0,d=!1,l=0,u=0,f=0,p=0}function v(e){switch(e){case 0:return"None";case 6:return"FieldNameImpliesLocation";case 11:return"InternalEmailAddress";case 15:return"OutOfScopeIdentifier";case 14:return"MachineName";case 20:return"UserDomain";case 12:return"IPAddress";case 5:return"ExternalEmailAddress";case 21:return"UserName";case 19:return"UserAlias";case 4:return"Directory";case 18:return"Url";case 7:return"FileNameOrExtension";case 1:return"Content";case 8:return"FileSharingUrl";case 17:return"Security";case 22:return"AccessToken";case 23:return"Signature"}return"Missing String value for "+e}g(),e.initialize=function(a,r,o){t.initialize(a,r,o);var s=a.extensionConfig[e.identifier];s?(i=r,n(m||s),se(_)||e.setEnabled(_),se(h)||e.updateCommonContext(h)):(xt(r.logger,1,73,"Configuration not provided, PrivacyGuard disabled."),t.setInitialized(!1))},e.reset=function(e){(m=e)&&n(m)},e.isEnabled=function(){return a&&a.isEnabled()},e.isPrivacyGuardEnabled=function(){return e.isEnabled()},e.setEnabled=function(e){return _=e,a&&a.setEnabled(e)},e.updateCommonContext=function(e){h=e,a&&a.updateCommonContext(h)},e.processTelemetry=function(t,n){if(e.isEnabled()&&t.name!==o&&t.name!==s)if(t.data){var a;f++,ve(t.baseType)?a=t.baseType:t.data&&t.data.baseType&&ve(t.data.baseType)&&(a=t.data.baseType);var i=b(t.name,a,"",t.data);i.length>0&&e.notifyConcerns(i)}else u++;e.processNext(t,n)},e.sendSummaryEvent=function(e){var t={name:s,ext:{metadata:{privTags:33554432,privLevel:110}}};t.data=c?{PG_ConcernsNotified:l,PG_EventsIgnored:u,PG_EventsInspected:f,PG_FieldsInspected:p}:{ConcernsNotified:l,EventsIgnored:u,EventsInspected:f,FieldsInspected:p},r&&(t.iKey=r),i.track(t),e&&(l=0,u=0,f=0,p=0)},e.notifyConcerns=function(e){for(var t=0,n=e;t<n.length;t++){var a=n[t],s={name:o,ext:{metadata:{privTags:33554432,privLevel:110}}};s.data=c?{PG_EventName:a.EventName,PG_FieldName:a.FieldName,PG_TypeAsText:v(a.Concern),PG_BaseType:a.BaseType}:{EventName:a.EventName,FieldName:a.FieldName,TypeAsText:v(a.Concern),BaseType:a.BaseType},r&&(s.iKey=r),i.track(s),l++}},e._doTeardown=function(e,t){g()}}),n}return Object(B.e)(t,e),t.prototype.initialize=function(e,t,n){},t}(wn);function Ur(e){return e?e[0].toUpperCase()+e.substr(1):e}function Fr(e){return e&&e.replace(/(membership\|urn(%3a|:)spo(%3a|:)guest#)([^@]+)(@[^@]+)$/i,function(e,t,n,a,i,r){return"".concat(t).concat(function(e){if(!e||0===e.length)return 0;for(var t=5381,n=0;n<e.length;n++)t=(t<<5)+t+e.charCodeAt(n),t&=t;return t}(i)).concat(r)})}function Hr(e,t){var n=t.Session,a=t.Version,i=t.OSName,r=t.OSVersion,o=t.Market,c=t.UserId,d=t.Manifest,l=s(t,["Session","Version","OSName","OSVersion","Market","UserId","Manifest"]),u=e.getSemanticContext();if(n&&e.setContext("AppInfo.Session",n),d&&e.setContext("AppInfo.Manifest",d),a&&u.setAppVersion(a),u.setUserLanguage(o||""),c){var f=Fr(c);u.setUserId(f)}for(var p in i&&u.setDeviceOsName(i),r&&u.setDeviceOsVersion(r),l)if(Object.prototype.hasOwnProperty.call(l,p)){if(null==l[p])continue;var m=Ur(p);e.setContext(m,l[p])}}var Rr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.identifier="StringifyProperties",t.version="1.0",t}return r(t,e),t._stringifyObject=function(e){for(var n in e)if(void 0===e[n]||null===e[n]||"object"==typeof e[n])t._stringifyObject(e[n]);else try{e[n]=e[n].toString()}catch(t){e[n]="StringifyProperties toString error"}},t.prototype.processTelemetry=function(e,n){n=this._getTelCtx(n),t._stringifyObject(e.data),this.processNext(e,n)},t}(wn),Nr=new RegExp("[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@((?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)","gi"),Br={defaultPIIScrubber:function(e){return e.includes("@")&&(e=e.replace(Nr,"[SCRUBBED EMAIL]")),e},truncate:function(e){return e.substring(0,20)+"[SCRUBBED]"},drop:function(e){return""}},jr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.identifier="DataScrubber",t.version="1.0",t._config={},t}return r(t,e),t.prototype.initialize=function(t,n,a){e.prototype.initialize.call(this,t,n,a),this._config=this._getTelCtx().getExtCfg(this.identifier)},t.prototype.processTelemetry=function(e,t){if(t=this._getTelCtx(t),this._config.scrubberFieldMap)for(var n=0,a=Object.keys(this._config.scrubberFieldMap);n<a.length;n++){var i=a[n],r=this._config.scrubberFieldMap[i],o=Br[i];r&&o&&this.scrubEvent(e,o,r)}this.processNext(e,t)},t.prototype.scrubEvent=function(e,t,n){this._scrubObject(e.data||{},t,n)},t.prototype._scrubObject=function(e,t,n){if(this._scrubFields(e,t,n.fields),n.nestedFields)for(var a=0,i=Object.keys(n.nestedFields);a<i.length;a++){var r=i[a];"object"==typeof e[r]&&this._scrubObject(e[r],t,n.nestedFields[r])}},t.prototype._scrubFields=function(e,t,n){for(var a=0,i=n;a<i.length;a++){var r=i[a];"string"==typeof e[r]&&(e[r]=t(e[r]))}},t}(wn),Vr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.identifier="DebugTelemetry",t.version="1.0",t}return r(t,e),t._getEventId=function(e){var t,n,a,i,r;return[e.name,null===(t=e.data)||void 0===t?void 0:t.Name,null===(n=e.data)||void 0===n?void 0:n.PG_FieldName,null===(a=e.data)||void 0===a?void 0:a.Scenario,null===(i=e.data)||void 0===i?void 0:i.WebLog_EventType,null===(r=e.data)||void 0===r?void 0:r.ResultType].reduce(function(e,t){return e?e.concat(t?"".concat(" ").concat(t):""):t})||"ev_<unknown?>"},t._flattenAndStringifyEvent=function(e,t){var n={};if(t<=0)return e;for(var a=function(t){Object.keys(e).forEach(function(a){var i=e[a];"object"==typeof i?1===t?n[a]=JSON.stringify(e[a]):Object.keys(i).forEach(function(e){n["".concat(a,".").concat(e)]=i[e]}):n[a]=e[a]}),e=o({},n),n={}},i=t;i>0;i--)a(i);return e},t._logGroup=function(e,t,n,a){t?console.groupCollapsed("%c".concat(e),n):console.group("%c".concat(e),n);try{a()}catch(e){console.error(e)}console.groupEnd()},t._logTable=function(e,n,a){t._logGroup(e,a,"font-size:12px;font-weight:bold",function(){console.table(n)})},t._logEvent=function(e){var n=t._getEventId(e);t._logGroup(n,!0,"font-size:12px;font-weight:bold;border:1px solid gray;padding:2px;border-radius:5px;",function(){var n=t._flattenAndStringifyEvent(e.ext||{},2),a=t._flattenAndStringifyEvent(e.data||{},2);t._logTable("Data Fields",a,!1),t._logTable("Ext Fields",n,!0),console.log("Raw event:\n%o",e)})},t.prototype.processTelemetry=function(e,n){n=this._getTelCtx(n),t._logEvent(e),this.processNext(e,n)},t}(wn),zr=ue;function Gr(e,t,n){return function(a){e[t]=a,n()}}var Kr=function(){function e(t){var n=0,a=null,i=[];function r(){if(i.length>0){var e=i.slice();i=[],setTimeout(function(){for(var t=0,n=e.length;t<n;++t)try{e[t]()}catch(e){}},0)}}function o(e){0===n&&(a=e,n=1,r())}function s(e){0===n&&(a=e,n=2,r())}Object(mt.e)(e,this,function(t){t.then=function(t,o){return new e(function(s,c){!function(t,o,s,c){i.push(function(){var i;try{(i=1===n?zr(t)?t(a):a:zr(o)?o(a):a)instanceof e?i.then(s,c):2!==n||zr(o)?s(i):c(i)}catch(e){return void c(e)}}),0!==n&&r()}(t,o,s,c)})},t.catch=function(e){return t.then(null,e)}}),function(){if(!zr(t))throw new TypeError("ESPromise: resolvedFunc argument is not a Function");try{t(o,s)}catch(e){s(e)}}()}return e.resolve=function(t){return t instanceof e?t:t&&zr(t.then)?new e(function(e,n){try{t.then(e,n)}catch(e){n(e)}}):new e(function(e){e(t)})},e.reject=function(t){return new e(function(e,n){n(t)})},e.all=function(t){if(t&&t.length)return new e(function(e,n){try{for(var a=[],i=0,r=0;r<t.length;r++){var o=t[r];o&&zr(o.then)?(i++,o.then(Gr(a,r,function(){0==--i&&e(a)}),n)):a[r]=o}0===i&&setTimeout(function(){e(a)},0)}catch(e){n(e)}})},e.race=function(t){return new e(function(e,n){if(t&&t.length)try{for(var a=function(a){var i=t[a];i&&zr(i.then)?i.then(e,n):setTimeout(function(){e(i)},0)},i=0;i<t.length;i++)a(i)}catch(e){n(e)}})},e}(),Wr=0,qr=[],Qr=[],Yr=[];function Jr(){return(new Date).getTime()}var Xr,Zr=function(){function e(t,n){var a=0,i=(t||"<unnamed>")+"."+Wr;function r(e){var t=Object(V.e)();t&&t.QUnit&&console&&console.log("ESPromiseScheduler["+i+"] "+e)}function o(e){n&&n.warnToConsole("ESPromiseScheduler["+i+"] "+e)}Wr++,Object(mt.e)(e,this,function(e){var t=null,n=0;function s(e,t){for(var n=0;n<e.length;n++)if(e[n].id===t)return e.splice(n,1)[0];return null}e.scheduleEvent=function(e,c,d){var l=i+"."+n;n++,c&&(l+="-("+c+")");var u=l+"{"+a+"}";a++;var f,p,m,_={evt:null,tm:Jr(),id:u,isRunning:!1,isAborted:!1};return _.evt=t?(f=_,p=t,m=new Kr(function(e,t){var n=Jr()-p.tm,a=p.id;r("["+l+"] is waiting for ["+a+":"+n+" ms] to complete before starting -- ["+Qr.length+"] waiting and ["+qr.length+"] running"),f.abort=function(e){f.abort=null,s(Qr,l),f.isAborted=!0,t(new Error(e))},p.evt.then(function(n){s(Qr,l),S(f).then(e,t)},function(n){s(Qr,l),S(f).then(e,t)})}),Qr.push(f),m):S(_),(t=_).evt._schId=u,_.evt;function h(e){for(var t=Jr(),n=t-6e5,a=e.length,i=0;i<a;){var r=e[i];if(r&&r.tm<n){var s=null;r.abort?(s="Aborting ["+r.id+"] due to Excessive runtime ("+(t-r.tm)+" ms)",r.abort(s)):s="Removing ["+r.id+"] due to Excessive runtime ("+(t-r.tm)+" ms)",o(s),e.splice(i,1),a--}else i++}}function b(e,n){var a=!1,i=s(qr,e);if(i||(i=s(Yr,e),a=!0),i){i.to&&(clearTimeout(i.to),i.to=null);var c=Jr()-i.tm;n?a?o("Timed out event ["+e+"] finally complete -- "+c+" ms"):r("Promise ["+e+"] Complete -- "+c+" ms"):(Yr.push(i),o("Event ["+e+"] Timed out and removed -- "+c+" ms"))}else r("Failed to remove ["+e+"] from running queue");t&&t.id===e&&(t=null),h(qr),h(Qr),h(Yr)}function g(e,t){return function(n){return b(e,!0),t&&t(n),n}}function v(e,t,n,a){t.then(function(t){return t instanceof Kr?(r("Event ["+e+"] returned a promise -- waiting"),v(e,t,n,a),t):g(e,n)(t)},g(e,a))}function y(e,t){var n=e.id;return new Kr(function(a,i){r("Event ["+n+"] Starting -- waited for "+(e.wTm||"--")+" ms"),e.isRunning=!0,e.abort=function(t){e.abort=null,e.isAborted=!0,b(n,!1),i(new Error(t))};var o=t(n);o instanceof Kr?(d&&(e.to=setTimeout(function(){b(n,!1),i(new Error("Timed out after ["+d+"] ms"))},d)),v(n,o,function(t){r("Event ["+n+"] Resolving after "+(Jr()-e.tm)+" ms"),a(t)},i)):(r("Promise ["+n+"] Auto completed as the start action did not return a promise"),a())})}function S(t){var n=Jr();return t.wTm=n-t.tm,t.tm=n,t.isAborted?Kr.reject(new Error("["+l+"] was aborted")):(qr.push(t),y(t,e))}}})}return e.incomplete=function(){return qr},e.waitingToStart=function(){return Qr},e}();function $r(e){return ye(e)&&e>=1&&e<=2}!function(e){e[e.LocalStorage=1]="LocalStorage",e[e.SessionStorage=2]="SessionStorage",e[e.IndexedDb=3]="IndexedDb"}(Xr||(Xr={}));var eo="AWTEvents";function to(e,t){if(e)for(var n=Ae(e),a=0;a<n.length;a++){var i=n[a];if(!t(e[i],i))break}}function no(e){var t=!0;return to(e,function(e,n){return e&&(t=!1),t}),t}function ao(e,t){for(var n=1,a=0,i=function(){var e=[],i=t[n];if(to(i,function(t,n){return e.push(n),++a<10}),a>0){for(var r=0;r<e.length;r++)delete i[e[r]];return{value:!0}}n++};n<=e&&a<10;){var r=i();if("object"==typeof r)return r.value}return a>0}var io=$r,ro=function e(t,n){Object(mt.e)(e,this,function(e){var a=null,i=eo,r=null,o=null,s=null,c=5e6,d=null,l=null;function u(e,t){return{key:e,db:t}}function f(e,t){void 0===t&&(t=!0);var n=null;if(a){var i=a.getItem(e);if(i)try{n=JSON.parse(i)}catch(t){a.removeItem(e)}}return t&&!n&&(n={events:{1:{},2:{},3:{}},lastAccessTime:0}),u(e,n)}function p(e,t){void 0===t&&(t=!0);var n=!0,i=e.db;if(i){t&&(i.lastAccessTime=(new Date).getTime());for(var r=1;r<=2;r++)if(!no(i.events[r])){n=!1;break}}try{if(n)a&&a.removeItem(e.key);else{var o=JSON.stringify(i);if(o.length>c)return!1;a&&a.setItem(e.key,o)}}catch(e){return!1}return!0}e.id=n,a=function(e){var t=Object(V.e)()||{},n=null;try{if(n=t[e]){var a="__storage_test__";n.setItem(a,a),n.removeItem(a)}}catch(e){(function(e,t){var n=!1;return t instanceof DOMException&&(22!==t.code&&"QuotaExceededError"!==t.name&&1014!==t.code&&"NS_ERROR_DOM_QUOTA_REACHED"!==t.name||e&&0!==e.length&&(n=!0)),n})(n,e)||(n=null)}return n}(t)||null,e.initialize=function(t){if(!a)return!1;var n=t.storageConfig||{};return c=n.maxStorageSizeInBytes>0?n.maxStorageSizeInBytes:c,i=n.storageKey||eo,r=e.id||t.id||pa(),l=i+"."+r,d=i+"Version",o=t.itemCtx.getCfg().instrumentationKey,s=Ia(o)||o,function(){if(a){for(var e=a.getItem(d),t=[],n=f(l),r=!1,o=0;o<a.length;o++){var c=a.key(o);if(0===c.indexOf(i)&&c!==d){if("3"!==e){t.push(u(c,null));continue}var m=f(c,!1),_=m.db;if(_){if((new Date).getTime()-_.lastAccessTime>6e5){for(var h=1,b=function(){var e=_.events[h],t=n.db.events[h];to(e,function(n,a){return(Ia(n.iKey)||n.iKey)===s&&(t[a]=n,delete e[a]),!0}),h++};h<=2;)b();r=!0,t.push(m)}}else t.push(u(c,null))}}for(o=0;o<t.length;o++)p(t[o],!1);r&&p(n),a.setItem(d,"3")}}(),!0},e.supportsSyncRequests=function(){return!0},e.getAllEvents=function(){try{var e=[],t=f(l,!1).db;if(t)for(var n=t.events,a=2;a>=1;a--)to(n[a],function(t){return t&&(Ia(t.iKey)||t.iKey)===s&&e.push(t),!0});return Kr.resolve(e)}catch(e){return Kr.reject(e)}},e.addEvent=function(e,t,n){try{var a=f(l);t.id=t.id||pa(),io(t.persistence)||(t.persistence=1);for(var i=t.persistence,r=t.id,o=a.db.events;;){if(o[i][r]=t,p(a))return Kr.resolve(t);if(delete o[i][r],!ao(i,o))return Kr.reject(new Error("Unable to free up event space"))}}catch(e){return Kr.reject(e)}},e.removeEvents=function(e){try{var t=f(l,!1),n=t.db;if(n){var i=n.events;try{for(var r=0;r<e.length;++r){var o=e[r];delete i[o.persistence][o.id]}if(p(t))return Kr.resolve(e)}catch(e){}e=function(e){var t=[],n=f(e,!1),i=n.db;if(i){var r=i.events;try{for(var o=1;o<=2;o++)to(r[o],function(e,n){return e&&t.push(e),!0})}catch(e){}a&&a.removeItem(n.key)}return t}(t.key)}return Kr.resolve(e)}catch(e){return Kr.reject(e)}},e.clear=function(){try{var e=[],t=f(l,!1),n=t.db;if(n){for(var a=n.events,i=function(t){var n=a[t];to(n,function(t){return t&&(Ia(t.iKey)||t.iKey)===s&&(delete n[t.id],e.push(t)),!0})},r=2;r>=1;r--)i(r);p(t)}return Kr.resolve(e)}catch(e){return Kr.reject(e)}},e.teardown=function(){try{var e=f(l,!1),t=e.db;t&&(t.lastAccessTime=0,p(e,!1))}catch(e){}}})},oo="DBError: Unable to open database",so="Database is not open",co="DBError: Failed to delete the database",lo=["indexedDB"],uo=ue,fo=ve;function po(e,t){Xe("QUnit")&&console&&console.log("IndexedDbHelper ["+e+"] "+t)}function mo(e,t,n){e&&e.warnToConsole("IndexedDbHelper ["+t+"] "+n)}function _o(e,t,n,a){return function(i){n(new Error(t)),po(e,"["+a+"] event rejected")}}var ho=[];function bo(e,t){for(var n=null,a=0;a<ho.length;a++)if((n=ho[a]).name===e)return n;return n={name:e,sch:new Zr("IndexedDbHelper["+e+"]",t),dbHdl:[],add:function(t){n.dbHdl.push(t),po(e,"- dbOpened (add) -- hdls ["+n.dbHdl.length+"]")},remove:function(t){for(var a=n.dbHdl,i=0;i<a.length;i++)if(a[i]===t){a.splice(i,1);break}po(e,"- dbClosed (remove) -- hdls ["+n.dbHdl.length+"]")},isOpen:function(){return n.dbHdl.length>0},openHdl:function(){return n.dbHdl.length>0?n.dbHdl[0]:null}},ho.push(n),n}var go=function e(t){Object(mt.e)(e,this,function(e){var n=function(){var e=Object(V.e)()||{},t=null;if(e)try{for(var n=0;n<lo.length;n++)if((t=e[lo[n]])&&uo(t.open))return t}catch(e){t=null}return t||null}()||null;function a(e,n){var a=e.db.transaction(n,"readwrite");return a.onabort=function(){mo(t,e.dbName,"txn.onabort")},a.onerror=function(){mo(t,e.dbName,"txn.onerror")},a.oncomplete=function(){po(e.dbName,"txn.oncomplete")},{db:e,store:a.objectStore(n),tx:a,tbl:n,openCursor:function(t,a){return r(e,n,t,a)},newTransaction:function(t){return i(e,n,t)}}}function i(e,t,n){if(!e||!e.db)return Kr.reject(new Error(so));try{var i=n(a(e,t));return i instanceof Kr?i:Kr.resolve(i)}catch(e){return Kr.reject(e)}}function r(e,t,n,i){if(!e||!e.db)return Kr.reject(new Error(so));var r=null;return n&&fo(n)?r=new vo(n):n&&n.isMatch&&(r=n),new Kr(function(n,o){var s=[],c=null,d=null;r&&r.keyRange&&(d=r.keyRange());var l=a(e,t);(c=d?l.store.openCursor(d):l.store.openCursor()).onerror=_o(l.db.dbName,"DBError: Failed to Open Cursor",o,"openCursor"),c.onsuccess=function(e){var t=e.target.result;if(t){var a={store:l,cursor:t,continue:function(){t.continue()},done:function(){n(s)}},c=t.value;if(!r||r.isMatch(c))if(i)try{switch(i(a,c,s)){case 2:n(s);break;case 1:break;default:a.continue()}}catch(e){o(e)}else s.push(c),a.continue();else a.continue()}else n(s)}})}function o(e,t,n,a){return bo(e).sch.scheduleEvent(n,t,a)}e.isAvailable=function(){return!!n},e.openDb=function(e,a,s,c){return o(e,"openDb",function(o){return new Kr(function(d,l){var u=!1;function f(t,n,o,s,c){var d={db:n,dbName:e,dbVersion:a,ctx:null,isNew:s,txn:o?o.transaction:null};return c||(d.openStore=function(e,t){return i(d,e,t)},d.openCursor=function(e,t,n){return r(d,e,t,n)}),d}var p=bo(e);if(null==n)l(new Error("No available storage factory"));else if(p.isOpen()){var m=f(0,p.openHdl(),null,!1);s(m).then(d,l)}else{var _=n.open(e,a);_.onblocked=function(n){mo(t,e,"Db Open Blocked event ["+o+"] - "+(_.error||"")),l(new Error(oo))},_.onerror=function(n){mo(t,e,"Db Open Error event ["+o+"] - "+(_.error||"")),l(new Error(oo))},_.onupgradeneeded=function(t){po(e,"Db Open Create/Upgrade needed event ["+o+"]");try{var n=t.target.result;if(!n)return void l(new Error(oo));!function(e,t){var n=f(0,e,t,!0,!0);if(c)u=!0,c(n).then(function(){n.txn||(n.txn=t.transaction)},function(e){try{t.transaction&&t.transaction.abort()}finally{l(e)}});else try{t.transaction&&t.transaction.abort()}finally{l(new Error("DBError: Database upgrade required"))}}(n,_)}catch(t){_o(e,oo,l,o)(t)}},_.onsuccess=function(n){var a=n.target.result;a?function(n,a){var i=bo(e);i.add(n),n.onabort=function(a){mo(t,e,"onabort -- closing the Db"),i.remove(n)},n.onerror=function(a){mo(t,e,"onerror -- closing the Db"),i.remove(n)},n.onclose=function(a){mo(t,e,"onclose -- closing the Db"),i.remove(n)},n.onversionchange=function(a){mo(t,e,"onversionchange -- force closing the Db"),n.close(),i.remove(n)};var r,o=null;i.dbHdl.length>0&&(o=i.dbHdl[0]),r=f(0,o,a,u);try{s(r).then(function(e){d(e)},l)}catch(e){l(e)}}(a,_):l(new Error(oo))}}})})},e.closeDb=function(e){o(e,"closeDb",function(t){var n=bo(e),a=n.dbHdl,i=a.length;if(i>0){for(var r=0;r<i;r++)a[r].close();n.dbHdl=[]}return Kr.resolve(1)})},e.deleteDb=function(e){return null==n?Kr.resolve(!1):o(e,"deleteDb",function(a){var i=bo(e),r=i.dbHdl,o=r.length;if(o>0){mo(t,e,"Db is open ["+o+"] force closing");for(var s=0;s<o;s++)r[s].close();i.dbHdl=[]}return new Kr(function(i,r){setTimeout(function(){try{po(e,"["+a+"] starting");var o=n.deleteDatabase(e);o.onerror=function(n){mo(t,e,"["+a+"] error!!"),r(new Error(co))},o.onblocked=function(n){mo(t,e,"["+a+"] blocked!!"),r(new Error(co))},o.onupgradeneeded=function(n){mo(t,e,"["+a+"] upgrade needed!!"),r(new Error(co))},o.onsuccess=function(t){po(e,"["+a+"] complete"),i(!0)},po(e,"["+a+"] started")}catch(n){mo(t,e,"["+a+"] threw - "+n),r(new Error(co+" - "+n))}},0)})})},e.getDbDetails=function(e){return o(e,"getDbDetails",function(t){return null!=n&&n.databases?new Kr(function(t,a){n.databases().then(function(n){for(var i=0;i<n.length;i++)if(n[i].name===e)return void t(n[i]);a(new Error("DBError: Database does not exist"))},a)}):Kr.reject(new Error("DBError: Feature not supported"))},2e3)}})},vo=function e(t){var n=[],a=null;Object(mt.e)(e,this,function(e){e.keyRange=function(){return a},e.parseQuery=function(t){if(n=[],t)for(var i=t.split(";"),r=0;r<i.length;r++){var o=i[r],s=o.indexOf("=");if(-1!==s){var c=o.substring(0,s),d=o.substring(s+1);0===c.indexOf("#")&&(c=c.substring(1),a||(a=IDBKeyRange.bound(d,d+""))),e.startsWith(c,d)}}},e.startsWith=function(e,t){n.push({name:e,value:t,type:0})},e.contains=function(e,t){n.push({name:e,value:t,type:1})},e.isMatch=function(e){if(!n||0===n.length)return!0;if(!e)return!1;for(var t=0;t<n.length;t++){var a=n[t],i=e[a.name];if(i)if(0===a.type){if(0!==i.indexOf(a.value))return!1}else if(1===a.type&&-1===i.indexOf(a.value))return!1}return!0},t&&e.parseQuery(t)})},yo=1008e4,So="DBError: Unable to add event",Do="Evts",Io="iKey",xo=$r;function Co(){return(new Date).getTime()}function Oo(e){return e.openStore(Io,function(t){return new Kr(function(n,a){var i,r={iKey:e.ctx.iKey,tm:Co()},o=t.store.put(r);o.onsuccess=function(e){n(o.result.toString())},o.onerror=function(e){a(new Error(So))},o.onerror=(i=a,function(e){return i(new Error("DBError: Unable to update iKey"))})})})}function wo(e){for(var t=[],n=2;n>=1;n--)for(var a=0;a<e.length;a++){var i=e[a];i&&i.evt.persistence===n&&t.push(i.evt)}return t}function Eo(e){return function(t){return e.continue()}}function Ao(e){var t=e.cursor.delete();return t.onerror=Eo(e),t.onsuccess=Eo(e),1}function Lo(e,t,n){return e.openCursor(Do,t,function(e,t,a){return n(t)?(a.push(t),Ao(e)):0})}var ko=function e(t){Object(mt.e)(e,this,function(e){var n=null,a=null,i="Unknown",r=null,o=null,s=null,c=-1,d=0;function l(e){return n.openDb(a,1,function(t){return new Kr(function(n,a){var c={iKey:i,storageId:r,iKeyPrefix:function(){return o},evtKeyPrefix:function(){return s}};t.ctx=c,Oo(t).then(function(){e(t).then(n,a)},a)})},function(e){return new Kr(function(t,n){var a;(a=e.db).objectStoreNames.contains(Do)||a.createObjectStore(Do,{keyPath:"key"}).createIndex("EvntId","key",{unique:!1}),a.objectStoreNames.contains(Io)||a.createObjectStore(Io,{keyPath:"iKey"}).createIndex("iKey","iKey",{unique:!0}),t()})})}function u(e,t,n){return new Kr(function(a,i){function r(t,n){(function(e,t){return new Kr(function(n,a){var i=0,r=e.ctx.evtKeyPrefix();function o(){n(i)}function s(e,t){return new Kr(function(n){var a=e.store.delete(t.key);a.onsuccess=function(e){i++,n()},a.onerror=function(e){n()}})}e.openCursor(Do,"#key="+r,function(e,n,a){return n.evt.persistence<=t&&0===n.key.indexOf(r)&&(function(e,t){for(var n=0;n<e.length;n++)if(t.tm<e[n].tm)return void e.splice(n,0,t);e.push(t)}(a,n),a.length>10&&a.splice(a.length-1,1)),0}).then(function(t){0!==t.length?e.openStore(Do,function(e){for(var n=[],a=0;a<t.length;a++)n.push(s(e,t[a]));return Kr.all(n).then(o,o)}):o()},function(){n(0)})})})(e,t).then(function(e){e>0&&(d-=e),n(e)},function(e){n(0)})}function o(e){a(t.evt)}function s(){e.openStore(Do,function(s){var c=s.store.put(t);c.onsuccess=function(i){n&&Oo(e).then(o,o),d++,a(t.evt)},c.onerror=function(o){function s(n){0===n&&i(new Error(So)),u(e,t,!1).then(function(e){a(t.evt)},function(){i(new Error(So))})}n?r(1,function(e){e>0?s(e):t.evt.persistence>=2?r(2,function(e){s(e)}):i(new Error(So))}):i(new Error(So))}})}c>0&&d>=c?r(1,function(e){0===e?t.evt.persistence>=2?r(2,function(e){s()}):i(new Error(So)):s()}):s()})}e.id=t,e.initialize=function(t){var d=t.itemCtx.diagLog();if(!(n=new go(d)).isAvailable())return n=null,!1;var u=t.itemCtx.getCfg(),f=t.storageConfig||{};return a=f.indexedDbName||"AppInsightEvents.1",i=u.instrumentationKey||i,r=e.id||t.id||pa(),s=(o=i+"::")+r+"::",c=f.maxStorageItems>0?f.maxStorageItems:c,l(function(e){return e.isNew?Kr.resolve(!0):function(e){return new Kr(function(t,n){(function(e){return new Kr(function(t,n){var a=!1;e.openCursor(Io,null,function(e,t,n){var i=t.tm;return Co()-i<yo?0:(a=!0,2)}).then(function(){if(a){var i={};Lo(e,null,function(e){if(!e||!e.evt||!e.evt.iKey)return!0;var t=e.tm;return Co()-t>yo||(i[e.evt.iKey]=1,!1)}).then(function(){var a=[];e.openCursor(Io,null,function(e,t,n){var r=t.tm;return Co()-r<yo||i[t.iKey]?0:(a.push(t),Ao(e))}).then(function(){t(a)},n)},n)}else t([])},n)})})(e).then(function(){(function(e){return e.openCursor(Do,"#key="+e.ctx.iKeyPrefix(),function(t,n){var a,i=n.key;if(0===i.indexOf(e.ctx.iKeyPrefix())&&-1===i.indexOf(e.ctx.evtKeyPrefix())&&(a=n.tm,Co()-a>6e5)){n.key=e.ctx.evtKeyPrefix()+n.id;var r=t.store.store.put(n);return r.onerror=Eo(t),r.onsuccess=function(e){try{Ao(t)}catch(e){t.continue()}},1}return 0})})(e).then(t,t)},n)})}(e)}).then(function(e){},function(e){d.warnToConsole("IndexedDbProvider failed to initialize - "+(e||"<unknown>")),n=null}),!0},e.supportsSyncRequests=function(){return!1},e.getAllEvents=function(){return null!=n&&n.isAvailable()?l(function(e){return new Kr(function(t,n){(function(e,t){return e.openCursor(Do,t,function(e,t,n){return n.push(t),0})})(e,"#key="+e.ctx.evtKeyPrefix()).then(function(e){d=e.length,t(wo(e))},n)})}):Kr.resolve([])},e.addEvent=function(e,t,a){return null!=n&&n.isAvailable()?(t.id=t.id||pa(),xo(t.persistence)||(t.persistence=1),l(function(n){var a=e||t.id,i={key:n.ctx.evtKeyPrefix()+a,id:a,evt:t,tm:Co(),v:1};return u(n,i,!0)})):Kr.resolve(t)},e.removeEvents=function(e){if(null==n||!n.isAvailable())return Kr.resolve([]);var t=[];return new Kr(function(n,a){l(function(n){return n.openCursor(Do,"#key="+n.ctx.iKey,function(n,a,i){if(-1!==function(e,t){for(var n=t.length,a=0;a<n;a++)if(e===t[a].id)return a;return-1}(a.id,e)){var r=n.cursor.delete();return r.onerror=Eo(n),r.onsuccess=function(){t.push(a.evt),n.continue()},1}return 0})}).then(function(e){d-=t.length,n(t)},function(e){d-=t.length,n(t)})})},e.clear=function(){return null!=n&&n.isAvailable()?new Kr(function(e,t){l(function(e){return Lo(e,"#key="+e.ctx.evtKeyPrefix(),function(t){return 0===t.key.indexOf(e.ctx.evtKeyPrefix())})}).then(function(t){d=0,e(wo(t))},t)}):Kr.resolve([])},e.teardown=function(){n&&n.closeDb(a)}})},Mo=$r,Po=function(e){function t(){var n=e.call(this)||this;return n.identifier="LocalStorage",n.priority=1009,n.version="3.2.2",Object(mt.e)(t,n,function(e,t){var n,a,i,r;function o(){n=!1,a=!1,i=null,r=[]}function s(e,t){i||(i=new Zr("LocalStorage")),i.scheduleEvent(function(e){return t(e)},e)}function c(t){Et(e.core,function(){return"LocalStorageChannel:_sendStoredEventsToNextPlugin"},function(){s("sendToNext",function(n){return t.provider.getAllEvents().then(function(n){for(var a=0;a<n.length;a++)try{var i=n[a];(Ia(i.iKey)||i.iKey)===t.tenantId&&e.processNext(i,t.coreRootCtx.createNew())}catch(e){}})})},function(){return{iKeyConfig:t}})}function d(t,n){Et(e.core,function(){return"LocalStorageChannel:_removeEvents"},function(){s("removeEvents",function(e){var a=[];return xe(n,function(e){(Ia(e.iKey)||e.iKey)===t.tenantId&&a.push(e)}),a.length>0?t.provider.removeEvents(a).then(function(e){}).catch(function(e){}):Kr.resolve()})},function(){return{iKeyConfig:t,events:n}})}function l(e){var t=new ko;return t.initialize(e)||(t=null),t}function u(e,t){var n=new ro(e);return n.initialize(t)||(n=null),n}o(),e.initialize=function(a,o,s,f){Et(o,function(){return"LocalStorageChannel.initialize"},function(){n||(t.initialize(a,o,s),t.setInitialized(!1),n=!0,i=new Zr("LocalStorage",o.logger)),function(t,n,a,i){var o=e.identifier,s=t.extensionConfig=t.extensionConfig||[],f=s[o]=s[o]||{};f.providers||(f.providers=[Xr.LocalStorage,Xr.IndexedDb]);var p=function(t,n,a,i){t&&(t.extensionConfig=t.extensionConfig||[]),!i&&n&&(i=n.getProcessTelContext().getNext());var r=null,o=e._getTelCtx().getNext();return o&&(r=o.getPlugin()),new an(i,t,n,r)}(t,n,0,i),m={itemCtx:p,storageConfig:f,id:e.id},_=function(e){for(var t=e.storageConfig.providers,n=null,a=0;!n&&a<t.length&&a<5;)switch(t[a++]){case Xr.LocalStorage:n=u("localStorage",e);break;case Xr.SessionStorage:n=u("sessionStorage",e);break;case Xr.IndexedDb:n=l(e)}return n}(m);if(_){var h={iKey:t.instrumentationKey,tenantId:Ia(t.instrumentationKey)||t.instrumentationKey,minPersistenceCacheLevel:1,coreRootCtx:p,providerContext:m,provider:_};Mo(f.minPersistenceLevel||-1)&&(h.minPersistenceCacheLevel=f.minPersistenceLevel),r.push(h),n.addNotificationListener({eventsSent:function(e){d(h,e)},eventsDiscarded:function(e,t){d(h,e)}}),c(h)}}(a,o,0,f)},function(){return{coreConfig:a,core:o,extensions:s,pluginChain:f}})},e.processTelemetry=function(t,i){var o,c,d=t;if(n&&!a){i=e._getTelCtx(i),Aa(t,e.identifier);var l=null;xe(r,function(e){e.iKey===t.iKey&&(l=e)});var u=l?l.provider:null;if(d.sync||!u)return void e.processNext(d,i);d.id=d.id||pa(),$r(d.persistence)||(d.persistence=1),o=l,!((c=d).sync||c.persistence<o.minPersistenceCacheLevel)&&s("processTelemetry",function(e){return u.addEvent(d.id,d,i)})}e.processNext(d,i)},e.pause=function(){a=!0},e.resume=function(){Et(e.core,function(){return"LocalStorageChannel:resume"},function(){a=!1,xe(r,function(e){e.provider&&c(e)})})},e._doTeardown=function(e,t){xe(r,function(e){var t=e.provider;t&&t.teardown()}),o()},e.flush=function(e,t){void 0===e&&(e=!0)}}),n}return Object(B.e)(t,e),t}(wn),To="MicrosoftApplicationsTelemetryDeviceId",Uo=function(){function e(t,n,a){var i,r,s,c,d,l=this;this.logEvent=function(e){var t,n,a,i,r,s;if(!((null===(t=l._configOverrides)||void 0===t?void 0:t.reduceRumoneLogging)&&(null===(n=e.eventName)||void 0===n?void 0:n.indexOf("RUMOneDataUpload"))>-1)||"SPAppBar"!==(null===(i=null===(a=e.data)||void 0===a?void 0:a.dictionary)||void 0===i?void 0:i.ScenarioId)&&""!==(null===(s=null===(r=e.data)||void 0===r?void 0:r.dictionary)||void 0===s?void 0:s.ScenarioId)){var c;e.vector&&(c=new L({root:e.vector.root,current:e.vector.parent},e.vector.current));var d,u=function(e){for(var t={CorrelationVector:e.vector.toString(),WebLog_FullName:e.eventName,WebLog_EventType:O[e.eventType]},n=e.eventName.split(","),a=0,i=n;a<i.length;a++){var r=i[a];r&&(t["WebLog_Type_".concat(r)]=1)}var o=e.data,s=e.context;if(s)for(var c in s)if(Object.prototype.hasOwnProperty.call(s,c)){if(null==(l=s[c]))continue;t[f=Ur(c)]=l}if(o)for(var d in o)if(Object.prototype.hasOwnProperty.call(o,d)){var l;if(null==(l=o[d]))continue;var u=e.metadata[d];if(u){var f=u.isPrefixingDisabled?Ur(d):"".concat(Ur(u.definedInName),"_").concat(d),p=u.type;if(4===p){for(var m in l)if(Object.prototype.hasOwnProperty.call(l,m)){var _=l[m];if(null!=_&&""!==_){var h=void 0;if("object"==typeof _)try{h=JSON.stringify(_)}catch(e){h=_}else h=_;t["".concat(f,"_").concat(m.replace(/\./g,"_"))]=h}}}else t[f]=6===p?u.typeRef[l]:l}}return{name:e.isEventTypePrefixingDisabled?n[n.length-2]:"ev_".concat(n[n.length-2]),values:t}}(e),f=u.name,p=u.values,m=o(o({},p),{CorrelationVector:null==c?void 0:c.toString()});m.Name&&("AppChrome.PageOpenedInTeamsVivaConnections1PAppContext"===(d=m.Name)||"SPO.DashboardWebPart.Load"===d||"AdaptiveCardExtension.CardAction"===d||"TeamsNavigation.Navigation.ClickedInTeamsviva1pAppContext"===d||"TeamsSiteHeader.RefreshButtonClicked"===d||"TeamsSiteHeader.CopyLinkButtonClicked.successful"===d||"TeamsSiteHeader.GoToBrowserButtonClicked"===d)&&(m.baseType="vivaanalytics");var _=f.toLowerCase();l._logger.track({name:_,data:m})}},this._context=n,this._configOverrides=a,this._postChannel=new wr,this._propertyStore=null==a?void 0:a.propertyStorageOverride,this._logger=new ka,this._propertiesPlugin=new Ri;var u=new Tr,f=new Rr,p=new jr,m=new Po,_={env:n.Environment,populateBrowserInfo:!0,populateOperatingSystemInfo:!0},h={storageKey:"odsp_1ds_offline",indexedDbName:"odsp_1ds_offline",providers:[Xr.IndexedDb,Xr.LocalStorage],maxStorageItems:1e4},b={scrubberFieldMap:o({defaultPIIScrubber:e._getDefaultScrubbingFields()},null==a?void 0:a.scrubberFieldMap)},g=[this._postChannel];(null==a?void 0:a.enableStorageChannel)&&g.unshift(m);var v=o({instrumentationKey:t,enableCompoundKey:!0,channels:[g],extensionConfig:(i={PrivacyGuardPlugin:{notificationEventName:"ev_privacyguard",iKey:t}},i[this._propertiesPlugin.identifier]=_,i[p.identifier]=b,i[m.identifier]=h,i)},a),y=function(e,t,n){l._propertiesPlugin.setProperty(e,t)};this._ariaContextShim={setContext:y,getSemanticContext:function(){return{setAppLanguage:function(e){return y("AppInfo.Language",e)},setAppVersion:function(e){return y("AppInfo.Version",e)},setUserLanguage:function(e){return y("UserInfo.Language",e)},setUserId:function(e){return y("UserInfo.Id",e)},setDeviceOsName:function(e){return y("DeviceInfo.OsName",e)},setDeviceOsVersion:function(e){return y("DeviceInfo.OsVersion",e)}}}};var S=(null===(r=this._propertyStore)||void 0===r?void 0:r.getProperty("AppInfo.Language"))||"undefined"!=typeof document&&(null===(s=null===document||void 0===document?void 0:document.documentElement)||void 0===s?void 0:s.lang)||"",D=(null===(c=this._logger.getCookieMgr())||void 0===c?void 0:c.get(To))||(null===(d=this._propertyStore)||void 0===d?void 0:d.getProperty(To))||"";(null==a?void 0:a.unShimUpdateContext)?(this._propertiesPlugin.initialize(v,this._logger,[]),this._initializeProperties(n)):(Hr(this._ariaContextShim,n),this._propertiesPlugin.setProperty("Debug.NativeStringify","function stringify() { [native code] }"===String(JSON.stringify)),this._propertiesPlugin.setProperty("Debug.IsWorker",!!self.WorkerGlobalScope),this._propertiesPlugin.setProperty("AppInfo.Language",S),this._propertiesPlugin.setProperty("DeviceInfo.Id",D));var I=[this._propertiesPlugin];if((null==a?void 0:a.disableDataStringify)||(f.initialize(v,this._logger,[]),I=I.concat(f)),(null==a?void 0:a.disableDataScrubbing)||(p.initialize(v,this._logger,[]),I=I.concat(p)),(null==a?void 0:a.enablePrivacyGuard)&&(I=I.concat(u)),(null==a?void 0:a.isDebug)&&(I=I.concat(new Vr)),!(null==a?void 0:a.unShimUpdateContext)){this._propertiesPlugin.initialize(v,this._logger,[]);var x=this._getPrefixedUserId();this._propertiesPlugin.getPropertiesContext().user.localId=x,this._propertiesPlugin.getPropertiesContext().app.ver=n.Version,this._propertiesPlugin.getPropertiesContext().app.locale=S}this._logger.initialize(v,I)}return e._getDefaultScrubbingFields=function(){return{fields:["CustomerPromise_extraData_Veto","CustomerPromise_extraData_Endpoint","CustomerPromise_extraData_Product","CustomerPromise_extraData_Pillar","CustomerPromise_extraData_errorMessage","CustomerPromise_extraData_errorStack","caughtError_Stack","Error","ErrorCode","Qos_extraData_stack","Qos_extraData_trace","Trace_message","Veto"]}},e.prototype.updateContext=function(e){var t;this._context=o(o({},this._context),e),(null===(t=this._configOverrides)||void 0===t?void 0:t.unShimUpdateContext)?this._updateProperties(e):Hr(this._ariaContextShim,e)},e.prototype.flush=function(e,t){this._logger.flush(e,t)},e.prototype.setOffline=function(e){e?this._postChannel.pause():this._postChannel.resume(),this._propertiesPlugin.setProperty("Debug.IsOffline",e)},e.prototype._initializeProperties=function(e){var t,n,a,i;this._updateProperties(e);var r=(null===(t=this._propertyStore)||void 0===t?void 0:t.getProperty("AppInfo.Language"))||"undefined"!=typeof document&&(null===(n=null===document||void 0===document?void 0:document.documentElement)||void 0===n?void 0:n.lang)||"";this._propertiesPlugin.setProperty("AppInfo.Language",r);var o=(null===(a=this._logger.getCookieMgr())||void 0===a?void 0:a.get(To))||(null===(i=this._propertyStore)||void 0===i?void 0:i.getProperty(To))||"";this._propertiesPlugin.setProperty("DeviceInfo.Id",o),this._propertiesPlugin.setProperty("Debug.IsWorker",!!self.WorkerGlobalScope),this._propertiesPlugin.getPropertiesContext().user.localId=this._getPrefixedUserId(),this._propertiesPlugin.getPropertiesContext().app.ver=e.Version,this._propertiesPlugin.getPropertiesContext().app.locale=r},e.prototype._updateProperties=function(e){var t=this,n=e.Session,a=e.Version,i=e.OSName,r=e.OSVersion,c=e.Market,d=e.UserId,l=e.Manifest,u=s(e,["Session","Version","OSName","OSVersion","Market","UserId","Manifest"]),f=o({"AppInfo.Session":n,"AppInfo.Manifest":l,"AppInfo.Version":a,"UserInfo.Language":c||"","UserInfo.Id":d&&Fr(d),"DeviceInfo.OsName":i,"DeviceInfo.OsVersion":r},u);Object.keys(f).forEach(function(e){var n=f[e];null!=n&&t._propertiesPlugin.setProperty(Ur(e),n)})},e.prototype._getUserIdPrefix=function(){var e,t,n,a,i;return"Consumer"===(null===(e=this._context)||void 0===e?void 0:e.AccountType)||"ConsumerAnonymous"===(null===(t=this._context)||void 0===t?void 0:t.AccountType)||"ConsumerOnSPO"===(null===(n=this._context)||void 0===n?void 0:n.AccountType)?"m:":"Business"===(null===(a=this._context)||void 0===a?void 0:a.AccountType)||"BusinessAnonymous"===(null===(i=this._context)||void 0===i?void 0:i.AccountType)?"i:":"c:"},e.prototype._getPrefixedUserId=function(){var e=this._context.UserId;if(e&&e.length>2&&":"!==e[1]){var t=this._getUserIdPrefix();return"".concat(t).concat(e)}return e},e}(),Fo=function(){function e(e){var t=N(e.context),n=o({endpointUrl:e.context.oneDsCollectorUrl,isDebug:"true"===(null===window||void 0===window?void 0:window.sessionStorage.getItem("EnableConsoleTelemetryDebug"))},e.loggerConfig);this._oneDSLogger=new Uo(e.tenantToken,t,n)}return e.init=function(t,n,a,i){var r=new e({tenantToken:t,context:n,loggerConfig:a});return r.attach(null!=i?i:x),r},e.prototype.updateContext=function(e){var t=N(e);this._oneDSLogger.updateContext(t)},e.prototype.flush=function(e,t){this._oneDSLogger.flush(e,t)},e.prototype.attach=function(e){var t=this;return e.addLogHandler(this._oneDSLogger.logEvent).forEach(this._oneDSLogger.logEvent),this._handlerRemover=function(){e.removeLogHandler(t._oneDSLogger.logEvent)},function(){t._handlerRemover&&t._handlerRemover()}},e.prototype.disposeHandler=function(){this._handlerRemover&&this._handlerRemover()},e}(),Ho=function(){var e=this;this._dataStore={},this.getProperty=function(t){return e._dataStore[t]},this.setProperty=function(t,n){return e._dataStore[t]=n}}},"odsp.1ds_1787":function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"t",function(){return s});var a=n("odsp.1ds_3294"),i=n("odsp.1ds_43"),r=((Object(i.e)()||{}).Symbol,(Object(i.e)()||{}).Reflect,a.e,function(e,t){return r=a.t.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t[a.c](n)&&(e[n]=t[n])},r(e,t)});function o(e,t){function n(){this.constructor=e}typeof t!==a.s&&null!==t&&Object(i.n)("Class extends value "+String(t)+" is not a constructor or null"),r(e,t),e[a.l]=null===t?Object(i.t)(t):(n[a.l]=t[a.l],new n)}function s(e,t){for(var n=0,a=t.length,i=e.length;n<a;n++,i++)e[i]=t[n];return e}},"odsp.1ds_1947":function(e,t,n){"use strict";(function(e){var a;n.d(t,"e",function(){return O});var i,r="undefined",o="prototype",s="function",c="_dynClass",d="_unknown_",l=Object,u=l.getPrototypeOf,f=l.getOwnPropertyNames,p=(typeof globalThis!==r&&(i=globalThis),i||typeof self===r||(i=self),i||typeof window===r||(i=window),i||typeof e===r||(i=e),i||{}),m=p.__dynProto$Gbl||(p.__dynProto$Gbl={o:(a={},a.setInstFuncs=!0,a.useBaseInst=!0,a),n:1e3});function _(e,t){return e&&l.prototype.hasOwnProperty.call(e,t)}function h(e){return e&&(e===l.prototype||e===Array.prototype)}function b(e){return h(e)||e===Function.prototype}function g(e){var t;if(e){if(u)return u(e);var n=e.__proto__||e.prototype||(e.constructor?e.constructor.prototype:null);t=e._dyn__proto__||n,_(e,"_dyn__proto__")||(delete e._dynInstProto,t=e._dyn__proto__=e._dynInstProto||e._dyn__proto__,e._dynInstProto=n)}return t}function v(e,t){var n=[];if(f)n=f(e);else for(var a in e)"string"==typeof a&&_(e,a)&&n.push(a);if(n&&n.length>0)for(var i=0;i<n.length;i++)t(n[i])}function y(e,t,n){return"constructor"!==t&&typeof e[t]===s&&(n||_(e,t))}function S(e){throw new TypeError("DynamicProto: "+e)}function D(e,t){for(var n=e.length-1;n>=0;n--)if(e[n]===t)return!0;return!1}function I(e,t,n,a){var i=null;if(e&&_(n,c)){var r=e._dynInstFuncs||{};if((i=(r[n._dynClass]||{})[t])||S("Missing ["+t+"] "+s),!i._dynInstChk&&!1!==r._dynInstChk){for(var o=!_(e,t),d=g(e),l=[];o&&d&&!b(d)&&!D(l,d);){var u=d[t];if(u){o=u===a;break}l.push(d),d=g(d)}try{o&&(e[t]=i),i._dynInstChk=1}catch(e){r._dynInstChk=!1}}}return i}function x(e,t,n){var a=t[e];return a===n&&(a=g(t)[e]),typeof a!==s&&S("["+e+"] is not a "+s),a}function C(e,t){return _(e,o)?e.name||t||d:((e||{}).constructor||{}).name||t||d}function O(e,t,n,a){_(e,o)||S("theClass is an invalid class definition.");var i=e.prototype;(function(e,t){if(u){for(var n=[],a=g(t);a&&!b(a)&&!D(n,a);){if(a===e)return!0;n.push(a),a=g(a)}return!1}return!0})(i,t)||S("["+C(e)+"] not in hierarchy of ["+C(t)+"]");var r=null;_(i,c)?r=i._dynClass:(r="_dynCls$"+C(e,"_")+"$"+m.n,m.n++,i._dynClass=r);var s=O._dfOpts,d=!!s.useBaseInst;d&&a&&void 0!==a.useBaseInst&&(d=!!a.useBaseInst);var l=function(e){var t={};return v(e,function(n){!t[n]&&y(e,n,!1)&&(t[n]=e[n])}),t}(t),f=function(e,t,n,a){function i(e,t,n){var i=t[n];if(i._isDynProxy&&a){var r=e._dynInstFuncs||{};!1!==r._dynInstChk&&(i=(r[t._dynClass]||{})[n]||i)}return function(){return i.apply(e,arguments)}}var r={};v(n,function(e){r[e]=i(t,n,e)});for(var o=g(e),s=[];o&&!b(o)&&!D(s,o);)v(o,function(e){!r[e]&&y(o,e,!u)&&(r[e]=i(t,o,e))}),s.push(o),o=g(o);return r}(i,t,l,d);n(t,f);var p=!!u&&!!s.setInstFuncs;p&&a&&(p=!!a.setInstFuncs),function(e,t,n,a,i){if(!h(e)){var r=n._dynInstFuncs=n._dynInstFuncs||{},o=r[t]=r[t]||{};!1!==r._dynInstChk&&(r._dynInstChk=!!i),v(n,function(t){y(n,t,!1)&&n[t]!==a[t]&&(o[t]=n[t],delete n[t],(!_(e,t)||e[t]&&!e[t]._isDynProxy)&&(e[t]=function(e,t){var n=function(){return(I(this,t,e,n)||x(t,e,n)).apply(this,arguments)};return n._isDynProxy=1,n}(e,t)))})}}(i,r,t,l,!1!==p)}O._dfOpts=m.o}).call(this,n("odsp.1ds_2304"))},"odsp.1ds_2030":function(e,t,n){"use strict";n.d(t,"s",function(){return a}),n.d(t,"d",function(){return i}),n.d(t,"u",function(){return r}),n.d(t,"l",function(){return o}),n.d(t,"c",function(){return s}),n.d(t,"o",function(){return c}),n.d(t,"t",function(){return d}),n.d(t,"r",function(){return l}),n.d(t,"e",function(){return u}),n.d(t,"n",function(){return f}),n.d(t,"a",function(){return p}),n.d(t,"i",function(){return m});var a="function",i="object",r="undefined",o="prototype",s="hasOwnProperty",c="default",d=Object,l=d[o],u=d.assign,f=d.create,p=d.defineProperty,m=l[s]},"odsp.1ds_2304":function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},"odsp.1ds_3294":function(e,t,n){"use strict";n.d(t,"s",function(){return a}),n.d(t,"d",function(){return i}),n.d(t,"u",function(){return r}),n.d(t,"l",function(){return o}),n.d(t,"c",function(){return s}),n.d(t,"o",function(){return c}),n.d(t,"t",function(){return d}),n.d(t,"r",function(){return l}),n.d(t,"e",function(){return u}),n.d(t,"n",function(){return f}),n.d(t,"a",function(){return p}),n.d(t,"i",function(){return m});var a="function",i="object",r="undefined",o="prototype",s="hasOwnProperty",c="default",d=Object,l=d[o],u=d.assign,f=d.create,p=d.defineProperty,m=l[s]},"odsp.1ds_3632":function(e,t,n){"use strict";(function(e){n.d(t,"e",function(){return r}),n.d(t,"n",function(){return o}),n.d(t,"t",function(){return s});var a=n("odsp.1ds_2030"),i=null;function r(t){void 0===t&&(t=!0);var n=!1===t?null:i;return n||(typeof globalThis!==a.u&&(n=globalThis),n||typeof self===a.u||(n=self),n||typeof window===a.u||(n=window),n||typeof e===a.u||(n=e),i=n),n}function o(e){throw new TypeError(e)}function s(e){var t=a.n;if(t)return t(e);if(null==e)return{};var n=typeof e;function i(){}return n!==a.d&&n!==a.s&&o("Object prototype may only be an Object:"+e),i[a.l]=e,new i}}).call(this,n("odsp.1ds_2304"))},"odsp.1ds_43":function(e,t,n){"use strict";(function(e){n.d(t,"e",function(){return r}),n.d(t,"n",function(){return o}),n.d(t,"t",function(){return s});var a=n("odsp.1ds_3294"),i=null;function r(t){return void 0===t&&(t=!0),i&&t||(typeof globalThis!==a.u&&globalThis&&(i=globalThis),typeof self!==a.u&&self&&(i=self),typeof window!==a.u&&window&&(i=window),typeof e!==a.u&&e&&(i=e)),i}function o(e){throw new TypeError(e)}function s(e){var t=a.n;if(t)return t(e);if(null==e)return{};var n=typeof e;function i(){}return n!==a.d&&n!==a.s&&o("Object prototype may only be an Object:"+e),i[a.l]=e,new i}}).call(this,n("odsp.1ds_2304"))},"odsp.1ds_577":function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n("odsp.1ds_2030"),i=n("odsp.1ds_3632"),r=((Object(i.e)()||{}).Symbol,(Object(i.e)()||{}).Reflect,a.e,function(e,t){return r=a.t.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t[a.c](n)&&(e[n]=t[n])},r(e,t)});function o(e,t){function n(){this.constructor=e}typeof t!==a.s&&null!==t&&Object(i.n)("Class extends value "+String(t)+" is not a constructor or null"),r(e,t),e[a.l]=null===t?Object(i.t)(t):(n[a.l]=t[a.l],new n)}}}]),define("odsp.1ds.lib",[],{});