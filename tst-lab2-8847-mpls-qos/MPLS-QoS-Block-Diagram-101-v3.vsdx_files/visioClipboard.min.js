var visioClipboard;!function(){var e={3796:function(e,t){"use strict";function r(e){for(var t="";t.length<e;){var r=16*Math.random();t+=(r|=0).toString(16)}return t}var a=function(){function e(){}return e.generate=function(){var e=[];e.push(r(8)),e.push(r(4));var t="4"+r(3);e.push(t);var a=r(4),o=parseInt(a[0],10);return o&=3,a=(o|=8).toString(16)+a.substr(1),e.push(a),e.push(r(12)),e.join("-")},e.normalizeLower=function(t,r){return t?e._normalizeBrackets(t.toLowerCase(),r):""},e.normalizeUpper=function(t,r){return t?e._normalizeBrackets(t.toUpperCase(),r):""},e._normalizeBrackets=function(e,t){var r=e.match(/^\{(.*)\}$/);return r?t?r[0]:r[1]:t?"{"+e+"}":e},e}();a.Empty="00000000-0000-0000-0000-000000000000",t.Z=a},9506:function(e){e.exports=function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,r){return t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t(e,r)}function r(e,a,o){return r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}()?Reflect.construct:function(e,r,a){var o=[null];o.push.apply(o,r);var n=new(Function.bind.apply(e,o));return a&&t(n,a.prototype),n},r.apply(null,arguments)}function a(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var n=Object.hasOwnProperty,i=Object.setPrototypeOf,s=Object.isFrozen,c=Object.getPrototypeOf,l=Object.getOwnPropertyDescriptor,d=Object.freeze,u=Object.seal,p=Object.create,m="undefined"!=typeof Reflect&&Reflect,f=m.apply,g=m.construct;f||(f=function(e,t,r){return e.apply(t,r)}),d||(d=function(e){return e}),u||(u=function(e){return e}),g||(g=function(e,t){return r(e,a(t))});var h,S=W(Array.prototype.forEach),y=W(Array.prototype.pop),C=W(Array.prototype.push),b=W(String.prototype.toLowerCase),v=W(String.prototype.toString),E=W(String.prototype.match),w=W(String.prototype.replace),_=W(String.prototype.indexOf),P=W(String.prototype.trim),I=W(RegExp.prototype.test),T=(h=TypeError,function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return g(h,t)});function W(e){return function(t){for(var r=arguments.length,a=new Array(r>1?r-1:0),o=1;o<r;o++)a[o-1]=arguments[o];return f(e,t,a)}}function A(e,t,r){r=r||b,i&&i(e,null);for(var a=t.length;a--;){var o=t[a];if("string"==typeof o){var n=r(o);n!==o&&(s(t)||(t[a]=n),o=n)}e[o]=!0}return e}function L(e){var t,r=p(null);for(t in e)f(n,e,[t])&&(r[t]=e[t]);return r}function x(e,t){for(;null!==e;){var r=l(e,t);if(r){if(r.get)return W(r.get);if("function"==typeof r.value)return W(r.value)}e=c(e)}return function(e){return console.warn("fallback value for",e),null}}var D=d(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),M=d(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),N=d(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),F=d(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),U=d(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),O=d(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),G=d(["#text"]),R=d(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),J=d(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),k=d(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),j=d(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),z=u(/\{\{[\w\W]*|[\w\W]*\}\}/gm),H=u(/<%[\w\W]*|[\w\W]*%>/gm),V=u(/\${[\w\W]*}/gm),B=u(/^data-[\-\w.\u00B7-\uFFFF]/),K=u(/^aria-[\-\w]+$/),q=u(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),$=u(/^(?:\w+script|data):/i),X=u(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Y=u(/^html$/i),Z=function(){return"undefined"==typeof window?null:window};return function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z(),o=function(e){return t(e)};if(o.version="2.4.1",o.removed=[],!r||!r.document||9!==r.document.nodeType)return o.isSupported=!1,o;var n=r.document,i=r.document,s=r.DocumentFragment,c=r.HTMLTemplateElement,l=r.Node,u=r.Element,p=r.NodeFilter,m=r.NamedNodeMap,f=void 0===m?r.NamedNodeMap||r.MozNamedAttrMap:m,g=r.HTMLFormElement,h=r.DOMParser,W=r.trustedTypes,Q=u.prototype,ee=x(Q,"cloneNode"),te=x(Q,"nextSibling"),re=x(Q,"childNodes"),ae=x(Q,"parentNode");if("function"==typeof c){var oe=i.createElement("template");oe.content&&oe.content.ownerDocument&&(i=oe.content.ownerDocument)}var ne=function(t,r){if("object"!==e(t)||"function"!=typeof t.createPolicy)return null;var a=null,o="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(o)&&(a=r.currentScript.getAttribute(o));var n="dompurify"+(a?"#"+a:"");try{return t.createPolicy(n,{createHTML:function(e){return e},createScriptURL:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+n+" could not be created."),null}}(W,n),ie=ne?ne.createHTML(""):"",se=i,ce=se.implementation,le=se.createNodeIterator,de=se.createDocumentFragment,ue=se.getElementsByTagName,pe=n.importNode,me={};try{me=L(i).documentMode?i.documentMode:{}}catch(e){}var fe={};o.isSupported="function"==typeof ae&&ce&&void 0!==ce.createHTMLDocument&&9!==me;var ge,he,Se=z,ye=H,Ce=V,be=B,ve=K,Ee=$,we=X,_e=q,Pe=null,Ie=A({},[].concat(a(D),a(M),a(N),a(U),a(G))),Te=null,We=A({},[].concat(a(R),a(J),a(k),a(j))),Ae=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Le=null,xe=null,De=!0,Me=!0,Ne=!1,Fe=!1,Ue=!1,Oe=!1,Ge=!1,Re=!1,Je=!1,ke=!1,je=!0,ze=!1,He=!0,Ve=!1,Be={},Ke=null,qe=A({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),$e=null,Xe=A({},["audio","video","img","source","image","track"]),Ye=null,Ze=A({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Qe="http://www.w3.org/1998/Math/MathML",et="http://www.w3.org/2000/svg",tt="http://www.w3.org/1999/xhtml",rt=tt,at=!1,ot=null,nt=A({},[Qe,et,tt],v),it=["application/xhtml+xml","text/html"],st=null,ct=i.createElement("form"),lt=function(e){return e instanceof RegExp||e instanceof Function},dt=function(t){st&&st===t||(t&&"object"===e(t)||(t={}),t=L(t),ge=ge=-1===it.indexOf(t.PARSER_MEDIA_TYPE)?"text/html":t.PARSER_MEDIA_TYPE,he="application/xhtml+xml"===ge?v:b,Pe="ALLOWED_TAGS"in t?A({},t.ALLOWED_TAGS,he):Ie,Te="ALLOWED_ATTR"in t?A({},t.ALLOWED_ATTR,he):We,ot="ALLOWED_NAMESPACES"in t?A({},t.ALLOWED_NAMESPACES,v):nt,Ye="ADD_URI_SAFE_ATTR"in t?A(L(Ze),t.ADD_URI_SAFE_ATTR,he):Ze,$e="ADD_DATA_URI_TAGS"in t?A(L(Xe),t.ADD_DATA_URI_TAGS,he):Xe,Ke="FORBID_CONTENTS"in t?A({},t.FORBID_CONTENTS,he):qe,Le="FORBID_TAGS"in t?A({},t.FORBID_TAGS,he):{},xe="FORBID_ATTR"in t?A({},t.FORBID_ATTR,he):{},Be="USE_PROFILES"in t&&t.USE_PROFILES,De=!1!==t.ALLOW_ARIA_ATTR,Me=!1!==t.ALLOW_DATA_ATTR,Ne=t.ALLOW_UNKNOWN_PROTOCOLS||!1,Fe=t.SAFE_FOR_TEMPLATES||!1,Ue=t.WHOLE_DOCUMENT||!1,Re=t.RETURN_DOM||!1,Je=t.RETURN_DOM_FRAGMENT||!1,ke=t.RETURN_TRUSTED_TYPE||!1,Ge=t.FORCE_BODY||!1,je=!1!==t.SANITIZE_DOM,ze=t.SANITIZE_NAMED_PROPS||!1,He=!1!==t.KEEP_CONTENT,Ve=t.IN_PLACE||!1,_e=t.ALLOWED_URI_REGEXP||_e,rt=t.NAMESPACE||tt,t.CUSTOM_ELEMENT_HANDLING&&lt(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ae.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&lt(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ae.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Ae.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Fe&&(Me=!1),Je&&(Re=!0),Be&&(Pe=A({},a(G)),Te=[],!0===Be.html&&(A(Pe,D),A(Te,R)),!0===Be.svg&&(A(Pe,M),A(Te,J),A(Te,j)),!0===Be.svgFilters&&(A(Pe,N),A(Te,J),A(Te,j)),!0===Be.mathMl&&(A(Pe,U),A(Te,k),A(Te,j))),t.ADD_TAGS&&(Pe===Ie&&(Pe=L(Pe)),A(Pe,t.ADD_TAGS,he)),t.ADD_ATTR&&(Te===We&&(Te=L(Te)),A(Te,t.ADD_ATTR,he)),t.ADD_URI_SAFE_ATTR&&A(Ye,t.ADD_URI_SAFE_ATTR,he),t.FORBID_CONTENTS&&(Ke===qe&&(Ke=L(Ke)),A(Ke,t.FORBID_CONTENTS,he)),He&&(Pe["#text"]=!0),Ue&&A(Pe,["html","head","body"]),Pe.table&&(A(Pe,["tbody"]),delete Le.tbody),d&&d(t),st=t)},ut=A({},["mi","mo","mn","ms","mtext"]),pt=A({},["foreignobject","desc","title","annotation-xml"]),mt=A({},["title","style","font","a","script"]),ft=A({},M);A(ft,N),A(ft,F);var gt=A({},U);A(gt,O);var ht=function(e){C(o.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=ie}catch(t){e.remove()}}},St=function(e,t){try{C(o.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){C(o.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!Te[e])if(Re||Je)try{ht(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},yt=function(e){var t,r;if(Ge)e="<remove></remove>"+e;else{var a=E(e,/^[\r\n\t ]+/);r=a&&a[0]}"application/xhtml+xml"===ge&&rt===tt&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var o=ne?ne.createHTML(e):e;if(rt===tt)try{t=(new h).parseFromString(o,ge)}catch(e){}if(!t||!t.documentElement){t=ce.createDocument(rt,"template",null);try{t.documentElement.innerHTML=at?"":o}catch(e){}}var n=t.body||t.documentElement;return e&&r&&n.insertBefore(i.createTextNode(r),n.childNodes[0]||null),rt===tt?ue.call(t,Ue?"html":"body")[0]:Ue?t.documentElement:n},Ct=function(e){return le.call(e.ownerDocument||e,e,p.SHOW_ELEMENT|p.SHOW_COMMENT|p.SHOW_TEXT,null,!1)},bt=function(t){return"object"===e(l)?t instanceof l:t&&"object"===e(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},vt=function(e,t,r){fe[e]&&S(fe[e],(function(e){e.call(o,t,r,st)}))},Et=function(e){var t,r;if(vt("beforeSanitizeElements",e,null),(r=e)instanceof g&&("string"!=typeof r.nodeName||"string"!=typeof r.textContent||"function"!=typeof r.removeChild||!(r.attributes instanceof f)||"function"!=typeof r.removeAttribute||"function"!=typeof r.setAttribute||"string"!=typeof r.namespaceURI||"function"!=typeof r.insertBefore||"function"!=typeof r.hasChildNodes))return ht(e),!0;if(I(/[\u0080-\uFFFF]/,e.nodeName))return ht(e),!0;var a=he(e.nodeName);if(vt("uponSanitizeElement",e,{tagName:a,allowedTags:Pe}),e.hasChildNodes()&&!bt(e.firstElementChild)&&(!bt(e.content)||!bt(e.content.firstElementChild))&&I(/<[/\w]/g,e.innerHTML)&&I(/<[/\w]/g,e.textContent))return ht(e),!0;if("select"===a&&I(/<template/i,e.innerHTML))return ht(e),!0;if(!Pe[a]||Le[a]){if(!Le[a]&&_t(a)){if(Ae.tagNameCheck instanceof RegExp&&I(Ae.tagNameCheck,a))return!1;if(Ae.tagNameCheck instanceof Function&&Ae.tagNameCheck(a))return!1}if(He&&!Ke[a]){var n=ae(e)||e.parentNode,i=re(e)||e.childNodes;if(i&&n)for(var s=i.length-1;s>=0;--s)n.insertBefore(ee(i[s],!0),te(e))}return ht(e),!0}return e instanceof u&&!function(e){var t=ae(e);t&&t.tagName||(t={namespaceURI:rt,tagName:"template"});var r=b(e.tagName),a=b(t.tagName);return!!ot[e.namespaceURI]&&(e.namespaceURI===et?t.namespaceURI===tt?"svg"===r:t.namespaceURI===Qe?"svg"===r&&("annotation-xml"===a||ut[a]):Boolean(ft[r]):e.namespaceURI===Qe?t.namespaceURI===tt?"math"===r:t.namespaceURI===et?"math"===r&&pt[a]:Boolean(gt[r]):e.namespaceURI===tt?!(t.namespaceURI===et&&!pt[a])&&!(t.namespaceURI===Qe&&!ut[a])&&!gt[r]&&(mt[r]||!ft[r]):!("application/xhtml+xml"!==ge||!ot[e.namespaceURI]))}(e)?(ht(e),!0):"noscript"!==a&&"noembed"!==a||!I(/<\/no(script|embed)/i,e.innerHTML)?(Fe&&3===e.nodeType&&(t=e.textContent,t=w(t,Se," "),t=w(t,ye," "),t=w(t,Ce," "),e.textContent!==t&&(C(o.removed,{element:e.cloneNode()}),e.textContent=t)),vt("afterSanitizeElements",e,null),!1):(ht(e),!0)},wt=function(e,t,r){if(je&&("id"===t||"name"===t)&&(r in i||r in ct))return!1;if(Me&&!xe[t]&&I(be,t));else if(De&&I(ve,t));else if(!Te[t]||xe[t]){if(!(_t(e)&&(Ae.tagNameCheck instanceof RegExp&&I(Ae.tagNameCheck,e)||Ae.tagNameCheck instanceof Function&&Ae.tagNameCheck(e))&&(Ae.attributeNameCheck instanceof RegExp&&I(Ae.attributeNameCheck,t)||Ae.attributeNameCheck instanceof Function&&Ae.attributeNameCheck(t))||"is"===t&&Ae.allowCustomizedBuiltInElements&&(Ae.tagNameCheck instanceof RegExp&&I(Ae.tagNameCheck,r)||Ae.tagNameCheck instanceof Function&&Ae.tagNameCheck(r))))return!1}else if(Ye[t]);else if(I(_e,w(r,we,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==_(r,"data:")||!$e[e])if(Ne&&!I(Ee,w(r,we,"")));else if(r)return!1;return!0},_t=function(e){return e.indexOf("-")>0},Pt=function(t){var r,a,n,i;vt("beforeSanitizeAttributes",t,null);var s=t.attributes;if(s){var c={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Te};for(i=s.length;i--;){var l=r=s[i],d=l.name,u=l.namespaceURI;if(a="value"===d?r.value:P(r.value),n=he(d),c.attrName=n,c.attrValue=a,c.keepAttr=!0,c.forceKeepAttr=void 0,vt("uponSanitizeAttribute",t,c),a=c.attrValue,!c.forceKeepAttr&&(St(d,t),c.keepAttr))if(I(/\/>/i,a))St(d,t);else{Fe&&(a=w(a,Se," "),a=w(a,ye," "),a=w(a,Ce," "));var p=he(t.nodeName);if(wt(p,n,a)){if(!ze||"id"!==n&&"name"!==n||(St(d,t),a="user-content-"+a),ne&&"object"===e(W)&&"function"==typeof W.getAttributeType)if(u);else switch(W.getAttributeType(p,n)){case"TrustedHTML":a=ne.createHTML(a);break;case"TrustedScriptURL":a=ne.createScriptURL(a)}try{u?t.setAttributeNS(u,d,a):t.setAttribute(d,a),y(o.removed)}catch(e){}}}}vt("afterSanitizeAttributes",t,null)}},It=function e(t){var r,a=Ct(t);for(vt("beforeSanitizeShadowDOM",t,null);r=a.nextNode();)vt("uponSanitizeShadowNode",r,null),Et(r)||(r.content instanceof s&&e(r.content),Pt(r));vt("afterSanitizeShadowDOM",t,null)};return o.sanitize=function(t){var a,i,c,d,u,p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((at=!t)&&(t="\x3c!--\x3e"),"string"!=typeof t&&!bt(t)){if("function"!=typeof t.toString)throw T("toString is not a function");if("string"!=typeof(t=t.toString()))throw T("dirty is not a string, aborting")}if(!o.isSupported){if("object"===e(r.toStaticHTML)||"function"==typeof r.toStaticHTML){if("string"==typeof t)return r.toStaticHTML(t);if(bt(t))return r.toStaticHTML(t.outerHTML)}return t}if(Oe||dt(p),o.removed=[],"string"==typeof t&&(Ve=!1),Ve){if(t.nodeName){var m=he(t.nodeName);if(!Pe[m]||Le[m])throw T("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof l)1===(i=(a=yt("\x3c!----\x3e")).ownerDocument.importNode(t,!0)).nodeType&&"BODY"===i.nodeName||"HTML"===i.nodeName?a=i:a.appendChild(i);else{if(!Re&&!Fe&&!Ue&&-1===t.indexOf("<"))return ne&&ke?ne.createHTML(t):t;if(!(a=yt(t)))return Re?null:ke?ie:""}a&&Ge&&ht(a.firstChild);for(var f=Ct(Ve?t:a);c=f.nextNode();)3===c.nodeType&&c===d||Et(c)||(c.content instanceof s&&It(c.content),Pt(c),d=c);if(d=null,Ve)return t;if(Re){if(Je)for(u=de.call(a.ownerDocument);a.firstChild;)u.appendChild(a.firstChild);else u=a;return Te.shadowroot&&(u=pe.call(n,u,!0)),u}var g=Ue?a.outerHTML:a.innerHTML;return Ue&&Pe["!doctype"]&&a.ownerDocument&&a.ownerDocument.doctype&&a.ownerDocument.doctype.name&&I(Y,a.ownerDocument.doctype.name)&&(g="<!DOCTYPE "+a.ownerDocument.doctype.name+">\n"+g),Fe&&(g=w(g,Se," "),g=w(g,ye," "),g=w(g,Ce," ")),ne&&ke?ne.createHTML(g):g},o.setConfig=function(e){dt(e),Oe=!0},o.clearConfig=function(){st=null,Oe=!1},o.isValidAttribute=function(e,t,r){st||dt({});var a=he(e),o=he(t);return wt(a,o,r)},o.addHook=function(e,t){"function"==typeof t&&(fe[e]=fe[e]||[],C(fe[e],t))},o.removeHook=function(e){if(fe[e])return y(fe[e])},o.removeHooks=function(e){fe[e]&&(fe[e]=[])},o.removeAllHooks=function(){fe={}},o}()}()},4749:function(e){var t=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return t()}try{return __global__||t()}finally{delete Object.prototype.__global__}}()},51:function(e,t,r){"use strict";e.exports=r(585)()?globalThis:r(4749)},585:function(e){"use strict";e.exports=function(){return"object"==typeof globalThis&&!!globalThis&&globalThis.Array===Array}},1531:function(e,t,r){"use strict";r.r(t),r.d(t,{__assign:function(){return n},__asyncDelegator:function(){return P},__asyncGenerator:function(){return _},__asyncValues:function(){return I},__await:function(){return w},__awaiter:function(){return f},__classPrivateFieldGet:function(){return x},__classPrivateFieldIn:function(){return M},__classPrivateFieldSet:function(){return D},__createBinding:function(){return h},__decorate:function(){return s},__esDecorate:function(){return l},__exportStar:function(){return S},__extends:function(){return o},__generator:function(){return g},__importDefault:function(){return L},__importStar:function(){return A},__makeTemplateObject:function(){return T},__metadata:function(){return m},__param:function(){return c},__propKey:function(){return u},__read:function(){return C},__rest:function(){return i},__runInitializers:function(){return d},__setFunctionName:function(){return p},__spread:function(){return b},__spreadArray:function(){return E},__spreadArrays:function(){return v},__values:function(){return y}});var a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},a(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var n=function(){return n=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};function i(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(r[a[o]]=e[a[o]])}return r}function s(e,t,r,a){var o,n=arguments.length,i=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n<3?o(i):n>3?o(t,r,i):o(t,r))||i);return n>3&&i&&Object.defineProperty(t,r,i),i}function c(e,t){return function(r,a){t(r,a,e)}}function l(e,t,r,a,o,n){function i(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,c=a.kind,l="getter"===c?"get":"setter"===c?"set":"value",d=!t&&e?a.static?e:e.prototype:null,u=t||(d?Object.getOwnPropertyDescriptor(d,a.name):{}),p=!1,m=r.length-1;m>=0;m--){var f={};for(var g in a)f[g]="access"===g?{}:a[g];for(var g in a.access)f.access[g]=a.access[g];f.addInitializer=function(e){if(p)throw new TypeError("Cannot add initializers after decoration has completed");n.push(i(e||null))};var h=(0,r[m])("accessor"===c?{get:u.get,set:u.set}:u[l],f);if("accessor"===c){if(void 0===h)continue;if(null===h||"object"!=typeof h)throw new TypeError("Object expected");(s=i(h.get))&&(u.get=s),(s=i(h.set))&&(u.set=s),(s=i(h.init))&&o.push(s)}else(s=i(h))&&("field"===c?o.push(s):u[l]=s)}d&&Object.defineProperty(d,a.name,u),p=!0}function d(e,t,r){for(var a=arguments.length>2,o=0;o<t.length;o++)r=a?t[o].call(e,r):t[o].call(e);return a?r:void 0}function u(e){return"symbol"==typeof e?e:"".concat(e)}function p(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function m(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function f(e,t,r,a){return new(r||(r=Promise))((function(o,n){function i(e){try{c(a.next(e))}catch(e){n(e)}}function s(e){try{c(a.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,s)}c((a=a.apply(e,t||[])).next())}))}function g(e,t){var r,a,o,n,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;n&&(n=0,s[0]&&(i=0)),i;)try{if(r=1,a&&(o=2&s[0]?a.return:s[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,s[1])).done)return o;switch(a=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,a=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],a=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}var h=Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]};function S(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||h(t,e,r)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],a=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function C(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var a,o,n=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=n.next()).done;)i.push(a.value)}catch(e){o={error:e}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return i}function b(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(C(arguments[t]));return e}function v(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var a=Array(e),o=0;for(t=0;t<r;t++)for(var n=arguments[t],i=0,s=n.length;i<s;i++,o++)a[o]=n[i];return a}function E(e,t,r){if(r||2===arguments.length)for(var a,o=0,n=t.length;o<n;o++)!a&&o in t||(a||(a=Array.prototype.slice.call(t,0,o)),a[o]=t[o]);return e.concat(a||Array.prototype.slice.call(t))}function w(e){return this instanceof w?(this.v=e,this):new w(e)}function _(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a,o=r.apply(e,t||[]),n=[];return a={},i("next"),i("throw"),i("return"),a[Symbol.asyncIterator]=function(){return this},a;function i(e){o[e]&&(a[e]=function(t){return new Promise((function(r,a){n.push([e,t,r,a])>1||s(e,t)}))})}function s(e,t){try{(r=o[e](t)).value instanceof w?Promise.resolve(r.value.v).then(c,l):d(n[0][2],r)}catch(e){d(n[0][3],e)}var r}function c(e){s("next",e)}function l(e){s("throw",e)}function d(e,t){e(t),n.shift(),n.length&&s(n[0][0],n[0][1])}}function P(e){var t,r;return t={},a("next"),a("throw",(function(e){throw e})),a("return"),t[Symbol.iterator]=function(){return this},t;function a(a,o){t[a]=e[a]?function(t){return(r=!r)?{value:w(e[a](t)),done:!1}:o?o(t):t}:o}}function I(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},a("next"),a("throw"),a("return"),t[Symbol.asyncIterator]=function(){return this},t);function a(r){t[r]=e[r]&&function(t){return new Promise((function(a,o){!function(e,t,r,a){Promise.resolve(a).then((function(t){e({value:t,done:r})}),t)}(a,o,(t=e[r](t)).done,t.value)}))}}}function T(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var W=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function A(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&h(t,e,r);return W(t,e),t}function L(e){return e&&e.__esModule?e:{default:e}}function x(e,t,r,a){if("a"===r&&!a)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?a:"a"===r?a.call(e):a?a.value:t.get(e)}function D(e,t,r,a,o){if("m"===a)throw new TypeError("Private method is not writable");if("a"===a&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===a?o.call(e,r):o?o.value=r:t.set(e,r),r}function M(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},4154:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promises=void 0;var r={},a="promises";t.promises=function(){return void 0===r[a]&&(r[a]="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&"function"==typeof Promise.resolve(0).then),r[a]}},1503:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initEwaUtils=t.ewaUtils=void 0;var a=r(6149),o={isChangeGateEnabled:function(e){return!1}};t.ewaUtils=function(){return o},t.initEwaUtils=function(e){if(!e)throw new Error("the 'ewaUtils' argument is missing");(0,a.setChangeGatesManager)({isChangeGateEnabled:e.isChangeGateEnabled}),o=e}},6253:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=void 0,t.getNewGuid=function(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},r="undefined"!=typeof self?self:window,a=r.crypto||r.msCrypto;if(a){t.crypto=!0;try{return a.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: ".concat(JSON.stringify(e)))}}var o=!1,n=r.performance;try{n&&n.now&&n.now()!==1/0&&(o=!0)}catch(e){t.exceptions.push("perfNow: ".concat(JSON.stringify(e)))}for(var i=0;i<e.length;i+=1){try{if(o){t.perfNow=!0;var s=Math.floor(100*n.now())%10;(s<0||s>9)&&(s=0);for(var c=0;c<s;c+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: ".concat(JSON.stringify(e)))}e[i]=Math.floor(16*Math.random())}return t}(e),r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var a=15&e[r];return r+=1,("x"===t?a:3&a|8).toString(16)})),t]}},7452:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isReplaceChildrenSupported=t.replaceChildren=void 0,t.replaceChildren=function(e){if(e)if((0,t.isReplaceChildrenSupported)(e))e.replaceChildren();else for(;e.lastChild;)e.removeChild(e.lastChild)},t.isReplaceChildrenSupported=function(e){return!!e.replaceChildren}},698:function(e,t,r){"use strict";t.tP=t.c6=t.WN=t.Gu=t.M$=t.P6=t.A=void 0;var a=r(8931);t.P6=a;var o=r(6998);Object.defineProperty(t,"M$",{enumerable:!0,get:function(){return o.ULS}}),Object.defineProperty(t,"Gu",{enumerable:!0,get:function(){return o.TraceLevel}}),Object.defineProperty(t,"WN",{enumerable:!0,get:function(){return o.LogCategory}}),r(4154);var n=r(1244);t.c6=n;var i=r(1503);Object.defineProperty(t,"tP",{enumerable:!0,get:function(){return i.initEwaUtils}});r(6967),r(6205);var s=r(6253);Object.defineProperty(t,"A",{enumerable:!0,get:function(){return s.getNewGuid}});r(5242),r(7452)},6998:function(e,t){"use strict";var r,a;Object.defineProperty(t,"__esModule",{value:!0}),t.NulLogger=t.ConsoleLogger=t.ULS=t.LogCategory=t.TraceLevel=void 0,(a=t.TraceLevel||(t.TraceLevel={}))[a.Error=10]="Error",a[a.Warning=15]="Warning",a[a.Info=50]="Info",a[a.Verbose=100]="Verbose",a[a.Spam=200]="Spam",(r=t.LogCategory||(t.LogCategory={}))[r.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",t.ULS={getFromExternalLogger:function(e){var t=e;return{ULS:{trace:function(e,r,a){return t.traceTag(0,e,r,a)},traceTag:function(e,r,a,o){return t.traceTag(e,r,a,o)},debugTrace:function(e,r,a){return t.debugTraceTag(0,e,r,a)},debugTraceTag:function(e,r,a,o){return t.debugTraceTag(e,r,a,o)},assert:function(e,r,a){return t.assertTag(0,e,r,a)},assertTag:function(e,r,a,o){return t.assertTag(e,r,a,o)},shipAssert:function(e,r,a){return t.shipAssertTag(0,e,r,a)},shipAssertTag:function(e,r,a,o){return t.shipAssertTag(e,r,a,o)},dnmTrace:function(e,r,a){return t.dnmTraceTag(0,e,r,a)},dnmTraceTag:function(e,r,a,o){return t.dnmTraceTag(e,r,a,o)}}}}};var o=function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,a){console.assert(r,"shipAssertTag:",e,t,a)},e.prototype.assertTag=function(e,t,r,a){console.assert(r,"assertTag",e,t,a)},e.prototype.traceTag=function(e,t,r,a){console.log("traceTag",e,a,t,r)},e.prototype.dnmTraceTag=function(e,t,r,a){console.log("dnmTraceTag",e,a,t,r)},e.prototype.debugTraceTag=function(e,t,r,a){console.log("debugTraceTag",e,a,t,r)},e}();t.ConsoleLogger=o;var n=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e.prototype.dnmTraceTag=function(){},e}();t.NulLogger=n},1244:function(e,t){"use strict";function r(){var e="undefined"!=typeof self?self:window;return e.performance&&e.performance.now?e.performance.now():Date.now()}function a(e,t,a){e[t]=r()-a}Object.defineProperty(t,"__esModule",{value:!0}),t.timeStamp=t.failure=t.success=t.end=t.mark=t.start=void 0,t.start=function(e){var t=r(),o=e,n=t,i={},s=function(e,t,r){return function(e,t,r,o,n,i){a(e,"end",r);var s={sessionName:t,result:o?"success":"failure",message:i,marks:e};n(JSON.stringify(s))}(i,o,n,e,t,r)};return i.start=0,{mark:function(e){return function(e){return a(i,e,n)}(e)},end:function(e){return s(!0,e)},success:function(e,t){return s(!0,e,t)},failure:function(e,t){return s(!1,e,t)}}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=r},5242:function(e,t){"use strict";var r,a;Object.defineProperty(t,"__esModule",{value:!0}),t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=void 0,(a=t.TextAreaVirtualKeyboardPolicy||(t.TextAreaVirtualKeyboardPolicy={})).Auto="auto",a.Manual="manual",(r=t.TextAreaInputMode||(t.TextAreaInputMode={})).None="none",r.Text="text",r.Tel="tel",r.Url="url",r.Email="email",r.Numeric="numeric",r.Decimal="decimal",r.Search="search"},6967:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatchFactory=void 0;var r=function(){return Date.now()};t.initStopwatchFactory=function(e,t){return void 0===t&&(t=1),"undefined"!=typeof self&&self.performance&&self.performance.now&&(r=function(){return self.performance.now()}),function(a){var o=r(),n=a;return{reset:function(e){null!=e&&(n=e),o=r()},stop:function(a){var i=r()-o,s=JSON.stringify({Target:n,Duration:i.toFixed(t),StopInfo:a});e(s)}}}}},6205:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=void 0;var r=function(){function e(){this.counters={},this.timers={},this.events={}}return e.prototype.getJsonForLogging=function(){return'{"Events":'+this.getEventsLoggableString()+',"Counters":'+this.getCountersLoggableString()+',"Timers":'+this.getTimersLoggableString()+"}"},e.prototype.addEvent=function(e,t){null!=e&&null!=t&&(this.events[e]=t)},e.prototype.clearEvents=function(){this.events={}},e.prototype.getEventsLoggableString=function(){return JSON.stringify(this.events)},e.prototype.incrementCounter=function(e){null!=e&&(this.counters.hasOwnProperty(e)?this.counters[e]+=1:this.counters[e]=1)},e.prototype.getCountersLoggableString=function(){return JSON.stringify(this.counters)},e.prototype.clearCounters=function(){this.counters={}},e.prototype.startTimer=function(e){null!=e&&(this.timers[e]={name:e,startTime:Date.now(),endTime:void 0,isRunning:!0,duration:void 0})},e.prototype.endTimer=function(e){null!=e&&this.timers.hasOwnProperty(e)&&(this.timers[e].endTime=Date.now(),this.timers[e].isRunning=!1,this.timers[e].duration=this.timers[e].endTime-this.timers[e].startTime)},e.prototype.getTimerDuration=function(e){return null==e?"-1":this.timers.hasOwnProperty(e)&&void 0!==this.timers[e].duration?this.timers[e].duration:"-1"},e.prototype.getTimersLoggableString=function(){return JSON.stringify(this.timers)},e}();t.TelemetryCollector=r},8931:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calcHashCode=t.decodeHtml=t.getQueryParameterByName=t.chainFallbackPromises=t.retry=t.getPerfWatchMarkName=t.getStringifiedError=t.defaultToJSONResultWhenStringifyFails=t.forEachPromise=void 0,t.forEachPromise=function(e,t,r){return e.reduce((function(e,a){return e.then((function(){return r&&r.stop?Promise.resolve(void 0):t(a,r)}))}),Promise.resolve(void 0))},t.defaultToJSONResultWhenStringifyFails="...",t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(a(e))}catch(e){return t.defaultToJSONResultWhenStringifyFails}};var r=5;function a(e,t){if(void 0===t&&(t=0),t<0||t>r)return e;if(null==e||"object"!=typeof e)return e;var o={};Object.getOwnPropertyNames(e).forEach((function(t){"stack"!==t&&t.toUpperCase()!==t&&(o[t]=e[t])}));var n=Object.getPrototypeOf(e);n&&"object"==typeof n&&Object.keys(n).forEach((function(t){"stack"!==t&&t.toUpperCase()!==t&&(o[t]=e[t])}));var i={};return Object.keys(o).forEach((function(e){i[e]=a(o[e],t+1)})),i}var o=new RegExp("".concat("\\W","+"),"g");t.getPerfWatchMarkName=function(e){if(!e)return"";var t=e.trim().substring(0,200).trim().replace(o,"_").substring(0,80);return t&&t.length>0&&"_"===t.substr(t.length-1,1)&&(t=t.substr(0,t.length-1)),t&&t.length>0&&"_"===t.substr(0,1)&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got ".concat(t)));for(var r=Promise.reject(),a=function(t){r=r.catch((function(r){return e(t,r)}))},o=1;o<=t;o+=1)a(o);return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();for(var r=t(e[0]),a=function(a){var o=e[a];r=r.catch((function(){return t(o)}))},o=1;o<e.length;o+=1)a(o);return r},t.getQueryParameterByName=function(e,t){var r=new RegExp("[?&]".concat(t,"(=([^&#]*)|&|#|$)")).exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;for(var t=5381,r=t,a=e.length,o=0;o<a&&(t=4294967295&((t<<5)+t^e.charCodeAt(o)),o!==a-1);o+=2)r=4294967295&((r<<5)+r^e.charCodeAt(o+1));var n=t+35685*r+(23896*r<<16)&4294967295;return n<0&&(n+=4294967296),n}},4859:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4587:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.isChangeGateEnabled=t.setChangeGatesManager=void 0,t.setChangeGatesManager=function(e){r=e},t.isChangeGateEnabled=function(e){return!r||r.isChangeGateEnabled(e)}},6149:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(1531);a.__exportStar(r(4587),t),a.__exportStar(r(4859),t)},6867:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var a=r(6938);function o(){return void 0===a.globalThis.__get_change_gate_dictionary_variable?{}:a.globalThis.__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=o,t.isChangeGateEnabled=function(e){var t;return null===(t=o()[e])||void 0===t||t},t.setChangeGateDictionaryGetter=function(e){var t=a.globalThis.__get_change_gate_dictionary_variable;return a.globalThis.__get_change_gate_dictionary_variable=e,t}},3018:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var a=r(6938),o={};function n(){return void 0===a.globalThis.__get_feature_gate_dictionary_variable?o:a.globalThis.__get_feature_gate_dictionary_variable()}function i(e,t){var r;return null!==(r=n()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=n,t.getStringFeatureGate=i,t.getBooleanFeatureGate=function(e,t){var r,a=null===(r=i(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===a||"false"!==a&&t},t.getNumberFeatureGate=function(e,t){var r,a=null===(r=i(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===a)return t;if("infinity"===a||"+infinity"===a)return 1/0;if("-infinity"===a)return-1/0;var o=parseFloat(a);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){var r,a=null===(r=i(e))||void 0===r?void 0:r.trim();if(void 0===a)return t;var o=parseInt(a,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){var t=a.globalThis.__get_feature_gate_dictionary_variable;return a.globalThis.__get_feature_gate_dictionary_variable=e,t}},6938:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var a=r(51);t.globalThis=a},1902:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(1531);a.__exportStar(r(3018),t),a.__exportStar(r(7575),t),a.__exportStar(r(6867),t),a.__exportStar(r(1727),t),a.__exportStar(r(6804),t),a.__exportStar(r(3031),t)},7575:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var a=r(3018);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,a.getBooleanFeatureGate)(t,r);case"number":return(0,a.getNumberFeatureGate)(t,r);case"string":return(0,a.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},1727:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var a=r(6867);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,a.isChangeGateEnabled)(e)}}},6804:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var a=r(1531),o=r(6867);function n(e){var t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((function(){var r=void 0!==t?t():{};return a.__assign(a.__assign({},r),e)})),t}t.overrideChangeGates=n,t.overrideTypedChangeGates=function(e,t){return n(t)}},3031:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var a=r(1531),o=r(3018);function n(e){for(var t,r,n={},i=0,s=Object.keys(e);i<s.length;i++){var c=s[i];n[c]=null===(t=e[c])||void 0===t?void 0:t.toString()}var l=null!==(r=(0,o.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,o.setFeatureGateDictionaryGetter)((function(){return a.__assign(a.__assign({},l()),n)})),l}t.overrideFeatureGates=n,t.overrideTypedFeatureGates=function(e,t){return n(t)}}},t={};function r(a){var o=t[a];if(void 0!==o)return o.exports;var n=t[a]={exports:{}};return e[a].call(n.exports,n,n.exports,r),n.exports}r.d=function(e,t){for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a={};!function(){"use strict";r.r(a),r.d(a,{Base64Image:function(){return po},ClipboardData:function(){return lo},ClipboardManager:function(){return vo},ImageDimension:function(){return mo},PackageCopyError:function(){return $a},PackagePasteError:function(){return qa},PasteSessionInfo:function(){return Xa},SvgData:function(){return uo},testCopy:function(){return Wo},testPaste:function(){return Ao}});var e,t=r(1531),o=r(698);function n(){return e}function i(t){if(!t)throw new Error("The 'logger' argument is missing");e=o.M$.getFromExternalLogger(t)}var s,c,l,d,u,p,m="",f=".";function g(e,t){return h(e,[t])}function h(e,t){if(!function(e){return!(!e||"object"!=typeof e||!("reason"in e))&&!!function(e){if(!e&&0!==e)return!1;var t=Number(e);return!isNaN(t)&&t.toString()===e.toString()}(e.reason)}(e))return!1;if(!t||!Array.isArray(t)||t.length<1)return!1;var r=e.reason;return t.indexOf(r)>=0}function S(e){if(e&&"object"==typeof e){if(y(e.reason))return!0;if(e.innerError&&"string"==typeof e.innerError)try{if(y(JSON.parse(e.innerError).reason))return!0}catch(e){}}if("string"==typeof e)try{if(y(JSON.parse(e).reason))return!0}catch(e){}return!1}function y(e){return e===c.LocalStorageInitilizationInaccessible}(p=s||(s={}))[p.SystemClipboard=0]="SystemClipboard",p[p.FullAccessClipboardAndInMemory=3]="FullAccessClipboardAndInMemory",p[p.InMemory=4]="InMemory",p[p.LocalStorage=5]="LocalStorage",p[p.SystemClipboardAndLocalStorage=6]="SystemClipboardAndLocalStorage",p[p.SystemClipboardAndInMemory=7]="SystemClipboardAndInMemory",p[p.AsyncSystemClipboard=8]="AsyncSystemClipboard",p[p.AsyncSystemClipboardAndLocalStorage=9]="AsyncSystemClipboardAndLocalStorage",function(e){e[e.UnsupportedClipboardStrategyType=0]="UnsupportedClipboardStrategyType",e[e.UnsupportedClipboardStorageType=1]="UnsupportedClipboardStorageType",e[e.ClipboardIsInaccessible=2]="ClipboardIsInaccessible",e[e.SetClipboardItems=3]="SetClipboardItems",e[e.GetClipboardItems=5]="GetClipboardItems",e[e.NoGetOperationResultMessage=7]="NoGetOperationResultMessage",e[e.NoSetOperationResultMessage=8]="NoSetOperationResultMessage",e[e.ClearClipboardItems=9]="ClearClipboardItems",e[e.MissingBrowserExtensionCapability=10]="MissingBrowserExtensionCapability",e[e.NoBrowserExtensionsInConfiguration=11]="NoBrowserExtensionsInConfiguration",e[e.NoAvailableBrowserExtensions=12]="NoAvailableBrowserExtensions",e[e.UnavailableBrowserExtension=13]="UnavailableBrowserExtension",e[e.NoBrowserExtensionWithGetClipboardDataCommand=14]="NoBrowserExtensionWithGetClipboardDataCommand",e[e.SelectClipboardStrategy=15]="SelectClipboardStrategy",e[e.IframeInitialization=16]="IframeInitialization",e[e.UnsupportedOperationCode=26]="UnsupportedOperationCode",e[e.RejectingPendingPastePromiseDueToNewPasteOperation=27]="RejectingPendingPastePromiseDueToNewPasteOperation",e[e.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation=28]="RejectingPendingCutCopyPromiseDueToNewCutCopyOperation",e[e.RejectingBlockedSyncCutCopyPromise=29]="RejectingBlockedSyncCutCopyPromise",e[e.IframeInitializationTimeout=30]="IframeInitializationTimeout",e[e.ClipboardStrategyNotInitialized=33]="ClipboardStrategyNotInitialized",e[e.UnexpectedClipboardTextHtmlContentLength=34]="UnexpectedClipboardTextHtmlContentLength",e[e.InvalidClipboardStrategyType=35]="InvalidClipboardStrategyType",e[e.CreateWindowRPCServer=36]="CreateWindowRPCServer",e[e.RefreshMetadata=37]="RefreshMetadata",e[e.DeserializedMetadata=38]="DeserializedMetadata",e[e.SerializedMetadata=39]="SerializedMetadata",e[e.LocalStorageInitilizationInaccessible=40]="LocalStorageInitilizationInaccessible",e[e.LocalStorageInitilizationNoKey=41]="LocalStorageInitilizationNoKey",e[e.IframeProxyGeneralError=42]="IframeProxyGeneralError",e[e.IframeProxyEmptyResultMessage=43]="IframeProxyEmptyResultMessage"}(c||(c={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.CopyFlowHandlerNotFound=1]="CopyFlowHandlerNotFound",e[e.FetchCopyFlowHandlerFailed=2]="FetchCopyFlowHandlerFailed",e[e.FetchSourceItemFailed=3]="FetchSourceItemFailed",e[e.BeforeSerializeFailed=4]="BeforeSerializeFailed",e[e.SerializeFailed=5]="SerializeFailed",e[e.SerializeResultNotValid=6]="SerializeResultNotValid",e[e.AsyncSerializeFailed=7]="AsyncSerializeFailed",e[e.SaveToTheClipboardFailed=8]="SaveToTheClipboardFailed",e[e.InspectClipboardFailed=9]="InspectClipboardFailed",e[e.ClipboardIsInaccessible=10]="ClipboardIsInaccessible",e[e.SuccessiveCutCopyOverridingPendingCutCopy=11]="SuccessiveCutCopyOverridingPendingCutCopy",e[e.BlockedSynchronousCutCopy=12]="BlockedSynchronousCutCopy",e[e.CopyOperationCancelled=13]="CopyOperationCancelled",e[e.UnknownCopyErrorType=14]="UnknownCopyErrorType"}(l||(l={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.PasteFlowHandlerNotFound=1]="PasteFlowHandlerNotFound",e[e.FetchPasteFlowHandlerFailed=2]="FetchPasteFlowHandlerFailed",e[e.FailedToReadFromClipboard=3]="FailedToReadFromClipboard",e[e.InspectClipboardFailed=4]="InspectClipboardFailed",e[e.ReadFromClipboardReturnNullOrUndefined=5]="ReadFromClipboardReturnNullOrUndefined",e[e.ClipboardIsEmpty=6]="ClipboardIsEmpty",e[e.DeserializeOperationFailed=7]="DeserializeOperationFailed",e[e.ClipboardIsInaccessible=8]="ClipboardIsInaccessible",e[e.SuccessivePasteOverridingPendingPaste=9]="SuccessivePasteOverridingPendingPaste",e[e.FileReaderResultIsEmpty=10]="FileReaderResultIsEmpty",e[e.FileReaderFailed=11]="FileReaderFailed",e[e.UnknownPasteError=12]="UnknownPasteError",e[e.DeferredPasteRejectedBecauseOtherCopyCompleted=13]="DeferredPasteRejectedBecauseOtherCopyCompleted",e[e.DeferredPasteRejectedBecauseOtherCopyStarted=14]="DeferredPasteRejectedBecauseOtherCopyStarted",e[e.DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext=15]="DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext"}(d||(d={})),function(e){e[e.FailedToClearClipboard=0]="FailedToClearClipboard"}(u||(u={}));var C,b=function(e){function r(t,a,i){var s=this,c=r.augmentParameterValue(t);if((s=e.call(this,c)||this).name=r.augmentParameterValue(a),s.errorName=s.name,s.name?n().ULS.traceTag(596456211,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"Error '".concat(s.name,"': ").concat(c)):n().ULS.traceTag(596456212,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"Error message: ".concat(c)),i){s.innerError=i;var l=s.innerError.message;l||(l=s.innerError.name);var d=r.augmentParameterValue(l);d.length>0&&n().ULS.traceTag(596456213,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"Inner error message: ".concat(d))}return s.stack||(s.stack=(new Error).stack),s}return(0,t.__extends)(r,e),r.augmentParameterValue=function(e){return e&&"string"==typeof e?e.trim():m},r}(Error),v=function(e){function r(t,r){return e.call(this,t,"NoValidKeyError",r)||this}return(0,t.__extends)(r,e),r}(b),E=function(e){function r(t,a,o){var n=this,i=b.augmentParameterValue(a),s=r.getDefaultMessage(i),c=b.augmentParameterValue(t);return 0===c.length&&(c=s),(n=e.call(this,c,"MissingArgumentError",o)||this).name=i,n}return(0,t.__extends)(r,e),r.getDefaultMessage=function(e){var t="Missing argument";return e.length>0&&(t="Missing argument: '".concat(e,"'")),t},r}(b),w=function(e){function r(t,a,o,n){var i=this,s=b.augmentParameterValue(a),c=o;c||(c=m);var l=r.getDefaultMessage(s,c),d=b.augmentParameterValue(t);return 0===t.length&&(d=l),(i=e.call(this,d,"InvalidArgumentError",n)||this).name=s,i.value=c,i}return(0,t.__extends)(r,e),r.getDefaultMessage=function(e,t){return e.length>0?"Invalid '".concat(e,"' argument: '").concat(t,"'"):"Invalid argument"},r}(b),_=function(e){function r(t,r){return e.call(this,t,"InvalidOperationError",r)||this}return(0,t.__extends)(r,e),r}(b),P=(C=b,(0,t.__extends)((function(e,t){return C.call(this,e,"UnsupportedError",t)||this}),C),function(e){function r(t,r,a,o,n){return e.call(this,"".concat(t,". Data version: ").concat(r,", Infra version: ").concat(a,", blockMismatchDataVersion: ").concat(o),"MismatchVersionError",n)||this}return(0,t.__extends)(r,e),r}(b)),I=function(e){function r(t,r,a,o){return e.call(this,"".concat(t,". Duration in clipboard (ms) : ").concat(r,", TTL (ms): ").concat(a),"TTLClipboardDataError",o)||this}return(0,t.__extends)(r,e),r}(b),T=function(e){function r(t,r,a,o){return e.call(this,"".concat(t,". Data User Hash : ").concat(r,", infra User Hash: ").concat(a),"UserHashMismatchError",o)||this}return(0,t.__extends)(r,e),r}(b),W=function(e){function r(t,r){return e.call(this,t,"UnexpectedError",r)||this}return(0,t.__extends)(r,e),r}(b);function A(e,t){return function(e,t){return void 0!==e&&"number"==typeof e&&e>=0&&e<Object.keys(t).length/2}(e,t)?t[e]:m}var L=function(e){function r(t,r,a,o,n){var i=e.call(this,r||"reason=".concat(t),a,o)||this;return i.reason=t,n&&(i.errorName=n),i}return(0,t.__extends)(r,e),r}(b),x=function(e){function r(t,r,a){return e.call(this,t,r,"CopyError",a,A(t,l))||this}return(0,t.__extends)(r,e),r}(L),D=function(e){function r(t,r,a){return e.call(this,t,r,"PasteError",a,A(t,d))||this}return(0,t.__extends)(r,e),r}(L),M=function(e){function r(t,r,a){return e.call(this,t,r,"CancelError",a,A(t,u))||this}return(0,t.__extends)(r,e),r}(L),N=function(e){function r(t,r,a){return e.call(this,t,r,"ClipboardPlatformError",a,A(t,c))||this}return(0,t.__extends)(r,e),r}(L);function F(e){if(e&&Array.isArray(e)&&0!==e.length){var t=0,r=void 0;if(e.forEach((function(e){if(t+=1,e)try{e()}catch(e){n().ULS.traceTag(596456216,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"rethrowAfterAllActions: callback action #".concat(t," threw an exception: ").concat(e.message)),r||(r=new _(e.message,e))}else n().ULS.traceTag(596456215,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"rethrowAfterAllActions: callback action #".concat(t," is empty"))})),r)throw r}else n().ULS.traceTag(596456214,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"rethrowAfterAllActions: no actions to execute")}function U(){return O}!function(e){(0,t.__extends)((function(t,r,a){return e.call(this,t,r,"SharedClipboardError",a,A(t,c))||this}),e)}(L);var O={userAgent:function(){return window&&window.navigator?window.navigator.userAgent:m},appVersion:function(){return window&&window.navigator?window.navigator.appVersion:m}},G={},R=new RegExp("(\\bTrident/| MSIE )"),J=16.16299,k=17.17123,j=new RegExp("\\bEdge/(\\d+\\.\\d+)\\b");function z(){if(void 0===G.isIEProperty){G.isIEProperty=!1;var e=U();if(e&&e.userAgent&&"function"==typeof e.userAgent){var t=e.userAgent();if(t){var r=t.match(R);r&&2===r.length&&(G.isIEProperty=!0)}}}return G.isIEProperty}function H(){if(void 0===G.isEdgeProperty){G.isEdgeProperty=!1,G.isEdgeWithTextHtmlClipboardSupportProperty=!1,G.isEdgeVersionWithTextHtmlWrapperSupportProperty=!1;var e=U();if(e&&e.appVersion&&"function"==typeof e.appVersion){var t=e.appVersion();if(t){var r=t.match(j);if(r&&2===r.length){G.isEdgeProperty=!0;var a=Number(r[1]);isNaN(a)||(a>=J&&(G.isEdgeWithTextHtmlClipboardSupportProperty=!0),a>=k&&(G.isEdgeVersionWithTextHtmlWrapperSupportProperty=!0))}}}}return G.isEdgeProperty}var V,B,K,q,$,X=function(e,t,r,a){e.postMessage(t,r,a)},Y="copy",Z="cut",Q="paste",ee="copy",te="paste",re=function(e,t,r,a){return void 0===a&&(a=!1),e.addEventListener(t,r,a),function(){e.removeEventListener(t,r,a)}},ae="text/plain",oe="Text",ne="text/html",ie="image/png",se="metadata/is-last-copy-was-external",ce="metadata/ccp-infra-version",le="copyId",de=(V={items:{}},{getData:function(){return V},getItem:function(e){},setItem:function(e,t){throw new _("Cannot set an item with clipboard data format '".concat(e,"' in an immutable empty clipboard (content is ").concat(t&&t.length>0?"not ":m,"empty)"))},hasDeferredItem:function(e){return!1},getDeferredItem:function(e){},get:function(){return Ce(void 0)}});function ue(){return de}function pe(e){return e&&e.items?Object.keys(e.items).length:0}function me(e){return pe(e&&e.getData())}function fe(e){void 0===e&&(e=void 0);var t=e;t||(t={items:{}});var r=function(e){return ge(t,e)},a={getItem:r,setItem:function(e,r){!function(e,t,r){if(!e)throw new E(m,"clipboardItemsData");if(!e.items)throw new w(m,"clipboardItemsData.items");e.items[t]=r}(t,e,r)},hasDeferredItem:function(e){var t=r(e);return t&&t.length>0},getDeferredItem:function(e){return Promise.resolve(r(e))},getData:function(){return t},get:function(){return Ce(t)}};return a}function ge(e,t){if(!e)throw new E(m,"clipboardItemsData");if(!e.items)throw new w(m,"clipboardItemsData.items");return e.items[t]}function he(e,t){if(!e||0===e.length||!t||!t.trim())return m;var r=void 0;return e.forEach((function(e){e.clipboardDataFormat===t&&(r=e.data)})),r||m}function Se(e){return he(e,ae)}function ye(e){var t=[];return e&&(t=e.get()),0===t.length&&t.push({clipboardDataFormat:ae,data:m}),t}function Ce(e){var t=[];if(0===pe(e))return t;for(var r in e.items){var a=ge(e,r);a||(a=m);var o={clipboardDataFormat:r,data:a,deferred:!1};t.push(o)}return t}($=B||(B={}))[$.SystemClipboard=0]="SystemClipboard",$[$.InMemory=2]="InMemory",$[$.LocalStorage=3]="LocalStorage",$[$.AsyncSystemClipboard=4]="AsyncSystemClipboard",function(e){e[e.None=0]="None",e[e.Cut=1]="Cut",e[e.Copy=2]="Copy",e[e.Paste=4]="Paste",e[e.Values=16]="Values",e[e.Formatting=32]="Formatting",e[e.Formulas=64]="Formulas",e[e.DragDropCells=128]="DragDropCells",e[e.DragDropNoErrMsg=256]="DragDropNoErrMsg",e[e.Transpose=512]="Transpose",e[e.Link=1024]="Link",e[e.PictureInCell=2048]="PictureInCell",e[e.PasteValues=20]="PasteValues",e[e.PasteFormatting=36]="PasteFormatting",e[e.PasteFormulas=68]="PasteFormulas",e[e.PasteTranspose=516]="PasteTranspose",e[e.PasteLink=1028]="PasteLink",e[e.PastePictureInCell=2052]="PastePictureInCell"}(K||(K={})),function(e){e[e.NoError=0]="NoError",e[e.LocalStorageInaccessible=1]="LocalStorageInaccessible"}(q||(q={}));var be="BulsEndpointUrl",ve="usid",Ee="-",we=Ae(),_e=!1,Pe=1,Ie=3600,Te=2;function We(){if(!_e)throw new _("First initialize the settings via initializeSharedClipboardSettingsFromWindow() or initializeSharedClipboardSettings()");return we}function Ae(){return{whitelistOriginComponents:!1,sharedClipboardHostingApp:m,sharedClipboardHostingApps:[],sharedClipboardHostingEnvironments:[],sharedClipboardSchemaVersion:Pe,sharedClipboardExpirationInMinutes:Ie,clipboardPromiseTimeoutInMinutes:Te,remoteLoggerPath:m}}function Le(){var e=m;return window&&window.location&&window.location.origin?(e=window.location.origin)||(e=m):(n().ULS.traceTag(595932950,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"windowLocation.getWindowLocation: is window exist: ".concat(!!window,". is window.location exist: ").concat(window&&!!window.location,". is window.location.origin exist ").concat(window&&window.location&&!!window.location.origin,". is window.location.protocol exist ").concat(window&&window.location&&!!window.location.protocol,". is window.location.hostname exist ").concat(window&&window.location&&!!window.location.hostname,". is window.location.port exist ").concat(window&&window.location&&!!window.location.port)),window&&window.location&&window.location.protocol&&window.location.hostname&&(e=window.location.protocol+"//"+window.location.hostname,window.location.origin=e)),{origin:e}}var xe,De,Me="://",Ne="http",Fe="https",Ue=".",Oe="/",Ge=":",Re=new RegExp("^\\d+$"),Je=!1;function ke(e){if(!e)throw new E(m,"origin");var t=e.trim().toLowerCase(),r=m,a=t.split(Me,3);if(!a||0===a.length||!a[0]||a[0]!==Ne&&a[0]!==Fe)throw new w("Missing protocol","origin",e);if(1===a.length)throw new w("Missing domain","origin",e);if(a.length>2)throw new w("'".concat(Me,"' should appear once"),"origin",e);var i=a[1];if(!i)throw new w("Missing domain","origin",e);if(r=a[0]+Me,!(a=(i=i.trim()).trim().split(Oe,3))||0===a.length||!a[0]||!a[0].trim())throw new w("Missing domain","origin",e);if(a.length>2)throw new w("The last part of the origin should be the domain","origin",e);if(2===a.length&&a[1])throw new w("The last part of the origin should be the domain","origin",e);if(!(a=i.split(Ge,3))||0===a.length||!a[0]||!a[0].trim())throw new w("Missing domain","origin",e);if(a.length>2||2===a.length&&(!a[1]||!a[1].trim()))throw new w("The last part of the origin should be the domain and an optional port number","origin",e);if(r+=i=a[0].trim(),2===a.length){var s=a[1].trim(),c=Re.exec(s);if(!c||1!==c.length)throw new w("Invalid port number","origin",e);var l=Number(s);if(isNaN(l))throw new w("Invalid port number","origin",e);r+=Ge+s}return n().ULS.traceTag(596452423,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"getValidatedOrigin: origin = '".concat(e,"'; validated origin = '").concat(r,"'")),r}function je(e){Ve();var t=e.split(Me,2),r=t[0],a=ze(t[1]),o={protocol:r};if(o.environment=He(e,a,De),a.length<=o.environment.length+1)throw new w("Missing app component","origin",e);if(a.charAt(o.environment.length)!==Ue)throw new w("Missing a domain separator after the environment component","origin",e);var n=a.substr(o.environment.length+Ue.length);if(o.app=He(e,n,xe),o.app.length<n.length&&n.charAt(o.app.length)!==Ee)throw new w("When the Office Online app name is not the domain prefix, '".concat(Ee,"' should precede it"),"origin",e);return o}function ze(e){if(!e)throw new E(m,"stringToReverse");for(var t=e.length,r=m,a=t-1;a>=0;a-=1)r+=e.charAt(a);return r}function He(e,t,r){if(!t)throw new E(m,"reversedValidatedHostname");if(!r)throw new E(m,"reversedStringsToLengthMap");var a=t.length,o=Object.keys(r).filter((function(e){var o=r[e];return o<=a&&t.substr(0,o)===e}));if(o&&o.length>0)return ze(o[0]);throw new w("Invalid origin","validatedOrigin",e)}function Ve(){if(!Je){var e=We();e.whitelistOriginComponents&&(xe=Be(e.sharedClipboardHostingApps),De=Be(e.sharedClipboardHostingEnvironments),Je=!0)}}function Be(e){var t={};return e&&Array.isArray(e)&&0!==e.length?(e.forEach((function(e){t[ze(e)]=e.length})),t):t}function Ke(){return $e()}function qe(e){if(!e)throw new E(m,"id");var t=e.trim().toLowerCase();if(0===t.length)throw new w(m,"id");return t}function $e(){return(Math.random()+1).toString(36).substring(7)}function Xe(e,t,r,a,o){var n={id:e,operationCode:t,destination:r,userHash:a,clipboardItemsData:o};return Ze(n),n}var Ye=function(){function e(){}return e.localStorageData="localStorage/data",e.localStorageMetadata="localStorage/metadata",e.initIframe="initIframe",e}(),Ze=function(e){if(!e)throw new E(m,"clipboardOperationMessage");if(!e.id||0===e.id.trim().length)throw new E(m,"id");if(!e.operationCode)throw new E(m,"operationCode");if(!e.destination)throw new E(m,"destination");if("get"!==(t=e.operationCode)&&"set"!==t&&"init"!==t)throw new w(m,"operationCode",e.operationCode);var t;if("set"!==e.operationCode&&e.clipboardItemsData)throw new w("'".concat(e.operationCode,"' expects no clipboard items"),"clipboardItemsData")};function Qe(e,t,r,a,o){var n={id:e,operationCode:t,failed:r,error:a,clipboardItemsData:o};return et(n),n}var et=function(e){if(!e)throw new E(m,"clipboardOperationResultMessage");for(var t=!1,r=0,a=["failed","error","clipboardItemsData","operationCode","id","userHash"];r<a.length;r++){var i=a[r];if(e.hasOwnProperty(i)){t=!0;break}}if(!t)throw new v("clipboardOperationResultMessage has no valid key");if(!e.id||0===e.id.trim().length)throw n().ULS.traceTag(553747865,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"Missing argument 'id'. keys: ".concat(JSON.stringify(Object.keys(e)),", isConstructorObject: ").concat(e.constructor===Object,", operationCode: ").concat(e.operationCode,", id: ").concat(e.id,", failed: ").concat(e.failed,", error: ").concat(e.error,".")),new E(m,"id");if(!e.operationCode)throw new E(m,"operationCode");if("getresult"!==e.operationCode&&"setresult"!==e.operationCode&&"initresult"!==e.operationCode&&"unknownresult"!==e.operationCode&&"getMetadata_longPollingresult"!==e.operationCode)throw new w(m,"operationCode",e.operationCode);if(e.failed){if(!e.error)throw new w("A failed '".concat(e.operationCode,"' operation expects a non-empty error argument"),"error");if(e.clipboardItemsData)throw new w("A failed '".concat(e.operationCode,"' operation does not expect a clipboardItemsData argument"),"clipboardItemsData")}else{if(e.error)throw new w("'".concat(e.operationCode,"' expects an empty error argument"),"error");if("unknownresult"===e.operationCode)throw new w("'".concat(e.operationCode,"' can only be used with a failure message"),"operationCode")}if("getresult"===e.operationCode||"getMetadata_longPollingresult"===e.operationCode){if(!e.failed&&!e.clipboardItemsData)throw new w("'".concat(e.operationCode,"' expects a clipboardItems argument"),"clipboardItemsData")}else if(e.clipboardItemsData)throw new w("'".concat(e.operationCode,"' expects no clipboardItemsData argument"),"clipboardItemsData")};function tt(e){if(!e||0===e.trim().length)throw new w(m,"className",e);return function(){var t=!1;function r(t){return"".concat(e,":").concat(t,": already disposed")}return{dispose:function(){t=!0},logIfDisposed:function(e){return t&&n().ULS.traceTag(596456217,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,r(e)),t},throwIfDisposed:function(e){if(t)throw new _(r(e))}}}()}var rt=function(){function e(e,t,r){this.clipboardStrategyType=e,this.clipboardCapabilities=t,this.clipboardDataProcessor=r,this.disposableImplementationExtension=tt("".concat(e))}return e.prototype.initialize=function(e){var t=this;return e.then((function(e){return t.clipboardStorage=e,n().ULS.traceTag(596453007,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"Clipboard strategy type '".concat(t.clipboardStrategyType,"' was initialized.")),Promise.resolve(t)}),(function(e){return n().ULS.traceTag(596453008,o.WN.msoulscat_ES_EWAJS,S(e)?o.Gu.Info:o.Gu.Error,"Failed to initialize clipboard strategy type '".concat(t.clipboardStrategyType,"'. Error: ").concat(o.P6.getStringifiedError(e))),Promise.reject(e)}))},e.prototype.set=function(e,t){try{return this.disposableImplementationExtension.throwIfDisposed("set"),this.clipboardStorage?(this.clipboardDataProcessor&&this.clipboardDataProcessor.preSetProcess(e),this.clipboardStorage.set(e,t)):(n().ULS.shipAssertTag(596121485,o.WN.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.set: this.clipboardStorage should be defined"),Promise.reject(new N(c.ClipboardStrategyNotInitialized)))}catch(e){return Promise.reject(new N(c.SetClipboardItems,"Failed in (clipboard ".concat(this.clipboardStrategyType,").set"),e))}},e.prototype.get=function(e){var t=this;try{return this.disposableImplementationExtension.throwIfDisposed("get"),this.clipboardStorage?this.clipboardStorage.get(e).then((function(e){return t.clipboardDataProcessor&&t.clipboardDataProcessor.postGetProcess(e),Promise.resolve(e)})):(n().ULS.shipAssertTag(596121486,o.WN.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.get: this.clipboardStorage should be defined"),Promise.reject(new N(c.ClipboardStrategyNotInitialized)))}catch(e){return Promise.reject(new N(c.GetClipboardItems,"Failed in (clipboard ".concat(this.clipboardStrategyType,").get"),e))}},e.prototype.onSystemClipboardChangedExternally=function(e){try{return this.disposableImplementationExtension.throwIfDisposed("onSystemClipboardChangedExternally"),this.clipboardStorage?this.clipboardCapabilities.systemClipboard?Promise.resolve():this.clipboardStorage.set(ue(),e):(n().ULS.shipAssertTag(595882508,o.WN.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.onSystemClipboardChangedExternally: this.clipboardStorage should be defined"),Promise.reject(new N(c.ClipboardStrategyNotInitialized)))}catch(e){return Promise.reject(new N(c.ClearClipboardItems,"Failed in (clipboard ".concat(this.clipboardStrategyType,").onSystemClipboardChangedExternally"),e))}},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.clipboardStorage&&this.clipboardStorage.dispose(),this.disposableImplementationExtension.dispose())},e}(),at=!!window.performance&&!!window.performance.now&&!!window.performance.timing;function ot(e){var t=e;return t&&0!==t.trim().length||(t=Ke()),new ct(t)}function nt(){return at?window.performance.now():Date.now()}function it(e){return at?new Date(e+window.performance.timing.navigationStart):new Date(e)}function st(e,t,r){if(!r)throw new E(m,"creationTimestamp");return"".concat(e?"Fulfilled":"Still unfulfilled"," after ").concat(e?t?t-r:"?":nt()-r,"ms")}var ct=function(){function e(t){var r=this;this.isFulfilled=!1,this.fulfillmentTimestamp=void 0,this.rejected=!1,this.id=qe(t),e.sequenceId+=1,this.sequenceId=e.sequenceId,this.creationTimestamp=nt(),n().ULS.traceTag(596456225,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"Deferred promise: creating deferred promise #".concat(this.sequenceId," with id '").concat(this.id,"' on ").concat(it(this.creationTimestamp))),this.promise=new Promise((function(e,t){n().ULS.traceTag(596456226,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"Deferred promise: registering callback for promise #".concat(r.sequenceId," with id '").concat(r.id,"' on ").concat(it(nt()))),r.internalResolve=e,r.internalReject=t}))}return e.prototype.fulfilled=function(){return this.isFulfilled},e.prototype.resolve=function(e){this.markAsFulfilled("resolve"),this.internalResolve?this.internalResolve(e):n().ULS.traceTag(596456257,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"Deferred promise - resolve: the resolve for deferred promise #".concat(this.sequenceId," with id '").concat(this.id,"' is not tracked with a callback"))},e.prototype.reject=function(e){this.markAsFulfilled("reject"),this.internalReject?this.internalReject(e):n().ULS.traceTag(596456260,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"Deferred promise - reject: the reject for deferred promise #".concat(this.sequenceId," with id '").concat(this.id,"' is not tracked with a callback"))},e.prototype.markAsFulfilled=function(e){this.fulfillmentCheck(e)||(this.isFulfilled=!0,this.rejected="resolve"!==e,this.fulfillmentTimestamp=nt(),n().ULS.traceTag(596456261,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"Deferred promise: marking promise #".concat(this.sequenceId," with id '").concat(this.id,"' as fulfilled (").concat(this.rejected?"rejected":"resolved","). ").concat(st(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp))))},e.prototype.fulfillmentCheck=function(e){return n().ULS.traceTag(596456258,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"Deferred promise: asked to ".concat(e," deferred promise #").concat(this.sequenceId," with id '").concat(this.id,"'")),this.isFulfilled&&n().ULS.traceTag(596456259,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"Deferred promise: cannot ".concat(e," deferred promise #").concat(this.sequenceId," with id '").concat(this.id,"' since it was ").concat(this.rejected?"rejected":"resolved"," already on ").concat(it(this.fulfillmentTimestamp),". ").concat(st(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp))),this.isFulfilled},e.sequenceId=0,e}(),lt=function(){function e(){this.deferredResultMessagePromiseCache={}}return e.prototype.getDeferredPromise=function(e){var t=qe(e);return this.deferredResultMessagePromiseCache[t]},e.prototype.getPromise=function(e){var t=this.getDeferredPromise(e);if(t)return n().ULS.traceTag(596456218,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"Deferred promise cache: found a deferred promise with id '".concat(e,"'.")),t.promise;n().ULS.traceTag(596456219,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"Deferred promise cache: there is no deferred promise with id '".concat(e,"'."))},e.prototype.addNewPromise=function(e){var t=ot(e);if(this.getDeferredPromise(t.id))throw new w("A deferred promise already exists in the cache for the specified id","id",t.id);var r=qe(t.id);return this.deferredResultMessagePromiseCache[r]=t,n().ULS.traceTag(596456220,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"Deferred promise cache: added a new deferred promise with id '".concat(t.id,"'.")),t},e.prototype.getLength=function(){var e=0;for(var t in this.deferredResultMessagePromiseCache)e+=1;return e},e.prototype.delete=function(e){if(this.getDeferredPromise(e)){var t=qe(e);delete this.deferredResultMessagePromiseCache[t],n().ULS.traceTag(596456222,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"Deferred promise cache: deleted id '".concat(e,"'."))}else n().ULS.traceTag(596456221,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"Deferred promise cache: no need to delete an item with id '".concat(e,"' since this id is not associated with an existing deferred promise."))},e.prototype.clear=function(){if(n().ULS.traceTag(596456223,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"Deferred promise cache: clearing ".concat(this.getLength()," items from the cache")),this.deferredResultMessagePromiseCache)for(var e in this.deferredResultMessagePromiseCache){var t=this.deferredResultMessagePromiseCache[e];if(t)try{t.reject()}catch(t){n().ULS.traceTag(596456224,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"Deferred promise cache: clear failed to reject promise id '".concat(e,"' with this exception: ").concat(t.message,". Ignoring."))}}this.deferredResultMessagePromiseCache={}},e}();var dt="initmessageid",ut="CreatorOrigin";function pt(e){if(!e)throw new E(m,"remoteWindow");if(!("window"in e)||!e.window)throw new E(m,"remoteWindow.window");if(!("windowOrigin"in e)||!e.windowOrigin)throw new E(m,"remoteWindow.windowOrigin");var t=function(e){Ve();var t=ke(e),r=ke(Le().origin);if(t===r)return t;if(!We().whitelistOriginComponents)throw new _("validateOriginForReceivedMessage: Caller origin '".concat(e,"' doesn't match the current window's origin '").concat(r,"'"));var a=je(t),o=je(r);if(a.protocol!==o.protocol)throw new _("validateRemoteWindowOrigin: Caller origin's protocol '".concat(a.protocol,"' doesn't match the current window origin's protocol '").concat(o.protocol,"'"));if(a.environment!==o.environment)throw new _("validateRemoteWindowOrigin: Caller origin's environment '".concat(a.environment,"' doesn't match the current window origin's environment '").concat(o.environment,"'"));return t}(e.windowOrigin);return{window:e.window,windowOrigin:t}}var mt=function(){function e(e,t,r,a){this.serializer=e,this.deserializer=t,this.remoteWindow=r,this.remoteWindow=r,this._disposableImplementationExtension=tt(a)}return Object.defineProperty(e.prototype,"disposableImplementationExtension",{get:function(){return this._disposableImplementationExtension},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){var e=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(F([function(){e.sender&&e.sender.dispose()},function(){e.receiver&&e.receiver.dispose()}]),this.disposableImplementationExtension.dispose())},e.prototype.postMessage=function(e){if(this.disposableImplementationExtension.throwIfDisposed("postMessage"),!e)throw new E(m,"outgoingMessage");if(!this.sender){var t="WindowRPCBase::postMessage - this.sender should be defined";throw n().ULS.shipAssertTag(596121484,o.WN.msoulscat_ES_EWAJS,!1,t),new _(t)}this.sender.postMessage(e)},e}();function ft(){return gt}var gt={addEventListener:function(e,t){return window.addEventListener(e,t)},removeEventListener:function(e,t){return window.removeEventListener(e,t)}},ht="message",St=function(){function e(e,t,r){var a=this;if(this.deserializer=e,this.handler=t,this.windowMessageHandler=function(e){return a.onMessageReceived(e)},!e)throw new E(m,"deserializer");if(!t)throw new E(m,"handler");if(!r)throw new E(m,"windowRPC");this.disposableImplementationExtension=tt("WindowRPCReceiverInternal"),this.remoteWindow=pt(r.remoteWindow),ft().addEventListener(ht,this.windowMessageHandler)}return e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(ft().removeEventListener(ht,this.windowMessageHandler),this.disposableImplementationExtension.dispose())},e.prototype.shouldFilterMessageEvent=function(e){try{if(!e.origin||!e.source)return n().ULS.traceTag(596452370,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"Window RPC Receiver: ignoring messages from unspecified window sources."),!0;if(e.source===window)return n().ULS.traceTag(596452371,o.WN.msoulscat_ES_EWAJS,o.Gu.Verbose,"Window RPC Receiver: ignoring messages from this window to itself."),!0;if(this.remoteWindow.window&&e.source!==this.remoteWindow.window)return n().ULS.traceTag(596452372,o.WN.msoulscat_ES_EWAJS,o.Gu.Verbose,"Window RPC Receiver: ignoring messages from windows other than the assigned remote window."),!0;if(e.origin.toLowerCase()!==this.remoteWindow.windowOrigin)return n().ULS.traceTag(596452373,o.WN.msoulscat_ES_EWAJS,o.Gu.Verbose,"Window RPC Receiver: ignoring messages from windows with an origin that differs from remote window origin."),!0}catch(e){return!0}return!1},e.prototype.onMessageReceived=function(e){if(!this.shouldFilterMessageEvent(e)){var t=void 0;try{t=this.deserializer.deserialize(e.data)}catch(e){n().ULS.traceTag(596452374,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"Window RPC Receiver: unable to deserialize incoming message. ".concat(o.P6.getStringifiedError(e)));try{this.handler.handleDeserializationError(e)}catch(e){n().ULS.traceTag(596452184,o.WN.msoulscat_ES_EWAJS,o.Gu.Error,"Window RPC Receiver: unable to handle deserialization error. ".concat(o.P6.getStringifiedError(e)))}return}if(t)try{this.handler.handleMessage(t).catch((function(e){n().ULS.traceTag(595985880,o.WN.msoulscat_ES_EWAJS,o.Gu.Error,"Window RPC Receiver: unable to process incoming message. ".concat(o.P6.getStringifiedError(e)))}))}catch(e){n().ULS.traceTag(596452186,o.WN.msoulscat_ES_EWAJS,o.Gu.Error,"Window RPC Receiver: unable to process incoming message. ".concat(o.P6.getStringifiedError(e)))}else n().ULS.traceTag(596452185,o.WN.msoulscat_ES_EWAJS,o.Gu.Error,"Window RPC Receiver: the incoming message is empty")}},e}(),yt=function(){function e(e,t,r){if(void 0===r&&(r=!1),this.serializer=e,this.delayedQueueEnabled=r,!e)throw new E(m,"serializer");if(!t)throw new E(m,"windowRPC");this.disposableImplementationExtension=tt("WindowRPCSenderInternal"),this.remoteWindow=pt(t.remoteWindow)}return e.prototype.postMessage=function(e){if(!e)throw new E(m,"outgoingMessage");if(!this.remoteWindow.window)throw new _("Configure the remote window");if(!this.remoteWindow.window.postMessage)throw new _("The remote window does not support postMessage");var t=this.serializer.serialize(e);X(this.remoteWindow.window,t,this.remoteWindow.windowOrigin)},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},e}(),Ct="OfficeOnlineCCP_",bt=Ct+"Metadata_",vt=Ct+"Data_",Et="_LocalStorageChangedFlag";function wt(e){return bt+e}var _t,Pt=function(){this.copyStatus=_t.Started,this.isTimestampStoredInSystemClipboard=!1,this.isAsyncSerializeFailed=!1,this.succeededPopulatingSystemClipboardSync=void 0,this.succeededPopulatingSystemClipboardAsync=void 0},It=function(){function e(){this.startTime=o.c6.timeStamp()}return e.prototype.profilingMessage=function(e){var t=o.c6.timeStamp()-this.startTime;return"onPasteProfiling: ".concat(e,", pasteId: ").concat(this.id,", timeMS: ").concat(t.toFixed())},e}();function Tt(e){var r=void 0;return e&&e.lastCopy&&(r=(0,t.__assign)({},e.lastCopy)),{lastCopy:r}}!function(e){e[e.Started=1]="Started",e[e.SynchronousPhaseCompleted=2]="SynchronousPhaseCompleted",e[e.Completed=3]="Completed"}(_t||(_t={}));var Wt=function(){function e(e){this.localStorageKey=e;try{if(!localStorage)throw new Error("LocalStorageClipboardStorage.ctor: localStorage == null")}catch(e){throw new N(c.LocalStorageInitilizationInaccessible,"LocalStorageClipboardStorage.ctor: failed access to localStorage",e)}if(!e)throw new N(c.LocalStorageInitilizationNoKey,"LocalStorageClipboardStorage.ctor: localStorageKey must be defined");this.clipboardStorageType=B.LocalStorage,this.disposableImplementationExtension=tt("LocalStorageClipboardStorage")}return e.prototype.get=function(e){this.disposableImplementationExtension.throwIfDisposed("get"),n().ULS.traceTag(595716238,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"localStorageClipboardStorage.get: commandParameters.id='".concat(e?e.id:m,"'"));var t=localStorage.getItem(this.localStorageKey);if(!t)return Promise.resolve(ue());try{var r=JSON.parse(t);if(!r||0===pe(r))return Promise.resolve(ue());var a=fe(r);return Promise.resolve(a)}catch(e){return Promise.resolve(ue())}},e.prototype.set=function(e,t){this.disposableImplementationExtension.throwIfDisposed("set"),n().ULS.traceTag(595716239,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"localStorageClipboardStorage.set: item count=".concat(me(e),"'; commandParameters.id='").concat(t?t.id:m,"'")),0===me(e)?localStorage.removeItem(this.localStorageKey):localStorage.setItem(this.localStorageKey,JSON.stringify(e.getData()));var r="".concat(this.localStorageKey+Et),a=Ke();return n().ULS.traceTag(595654546,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"localStorageClipboardStorage.set: set local storage value. eventFalgKey = ".concat(r,". eventFlagValue = ").concat(a)),localStorage.setItem(r,a),Promise.resolve()},e.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[ae,ne,"data/shadow-workbook"]},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},e}(),At=function(e){function r(t){return e.call(this,s.LocalStorage,{browserStorage:!0,systemClipboard:!1,inMemory:!1},t)||this}return(0,t.__extends)(r,e),r}(rt),Lt=function(){function e(e,t,r){this.localStorageKeyToWatch=e,this.clipboardStrategy=t,this.listener=r,this.maxTimeToWaitInMilliseconds=2e3,this.lastLocalStorageValue=null,window.addEventListener("storage",this.onStorageChanged.bind(this)),this.raiseMetadataChangedEvent()}return e.prototype.onStorageChanged=function(e){var t=this;n().ULS.shipAssertTag(595716249,o.WN.msoulscat_ES_EWAJS,null!=e,"e should not be null"),n().ULS.traceTag(595716288,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"LocalStorageKeyChangeTracker.onStorageChanged:got storage change event. e.key = ".concat(e.key,". localStorageKeyToWatch = ").concat(this.localStorageKeyToWatch,". lastLocalStorageValue = ").concat(this.lastLocalStorageValue)),e.key===this.localStorageKeyToWatch&&(this.raiseMetadataChangedEvent(),n().ULS.traceTag(595716289,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"LocalStorageKeyChangeTracker.onStorageChanged: raised metadata change event. lastLocalStorageValue = ".concat(this.lastLocalStorageValue)),this.isLocalStorageValueChanged()||this.waitForLocalStorageValueToChange(this.maxTimeToWaitInMilliseconds).then((function(){t.raiseMetadataChangedEvent()}),(function(){n().ULS.traceTag(595716295,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"LocalStorageKeyChangeTracker.onStorageChanged: got rejected promise.")})))},e.prototype.raiseMetadataChangedEvent=function(){var e=this;return n().ULS.traceTag(595715525,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: starting raiseMetadataChangedEvent. lastLocalStorageValue = ".concat(this.lastLocalStorageValue)),this.clipboardStrategy.get({userHash:0}).then((function(t){e.listener(t),n().ULS.traceTag(595716232,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: sent message. lastLocalStorageValue = ".concat(e.lastLocalStorageValue))}),(function(e){n().ULS.traceTag(595716233,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: failed to get metadata from clipboardStorage")}))},e.prototype.isLocalStorageValueChanged=function(){var e=localStorage.getItem(this.localStorageKeyToWatch),t=this.lastLocalStorageValue!==e;return n().ULS.traceTag(595715526,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"LocalStorageKeyChangeTracker.isLocalStorageValueChanged: lastLocalStorageValue = ".concat(this.lastLocalStorageValue,". currentLocalStorageValue = ").concat(e)),this.lastLocalStorageValue=e,t},e.prototype.waitForLocalStorageValueToChange=function(e){var t=this;if(n().ULS.traceTag(595715527,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: start waitForLocalStorageValueToChange. lastLocalStorageValue = ".concat(this.lastLocalStorageValue)),this.isLocalStorageValueChanged())return n().ULS.traceTag(595715528,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving because value was changed. lastLocalStorageValue = ".concat(this.lastLocalStorageValue)),Promise.resolve();var r=ot(),a=new Date,i=setInterval((function(){var s=(new Date).getTime()-a.getTime();n().ULS.traceTag(595715529,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: call by setInterval. startTime = ".concat(a,". elapseTime = ").concat(s,". lastLocalStorageValue = ").concat(t.lastLocalStorageValue)),t.isLocalStorageValueChanged()?(clearInterval(i),n().ULS.traceTag(595716234,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving. startTime = ".concat(a,". elapseTime = ").concat(s,". lastLocalStorageValue = ").concat(t.lastLocalStorageValue)),r.resolve()):s>e&&(clearInterval(i),n().ULS.traceTag(595716235,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: rejecting. startTime = ".concat(a,". elapseTime = ").concat(s,". lastLocalStorageValue = ").concat(t.lastLocalStorageValue)),r.reject())}),200);return r.promise},e}(),xt=r(1902),Dt="\n",Mt="\r",Nt=new RegExp("(".concat(Dt).concat(Mt,")|(").concat(Mt).concat(Dt,")|(").concat(Mt,")"),"g"),Ft=new RegExp("(".concat("\t",")"),"g"),Ut=10240,Ot=new RegExp("<","g"),Gt=new RegExp(">","g"),Rt="table",Jt="tr",kt="td",jt="Version:0.9".concat(Dt,"StartHTML:0000000").concat(100).concat(Dt,"EndHTML:{EndHTML0}").concat(Dt,"StartFragment:0000000").concat(134).concat(Dt,"EndFragment:{EndFragm}").concat(Dt,"<html>").concat(Dt,"<body>").concat(Dt).concat("\x3c!--StartFragment--\x3e").concat(Dt),zt="".concat("\x3c!--EndFragment--\x3e").concat(Dt,"</body>").concat(Dt,"</html>"),Ht="0000000000",Vt="data-ccp-timestamp";function Bt(e){return e?e.replace(Nt,Dt):e}function Kt(e){return e?e.length<=Ut?e:e.substr(0,Ut):m}function qt(e){var t=[],r=e.getElementsByTagName("td");if(r.length>0){t.push(r[0].innerText);for(var a=1;a<r.length;a+=1)t.push("\t"),t.push(r[a].innerText)}return t.join("")}var $t,Xt,Yt=function(){function e(e,t,r){if(this.clipboardPlatformEnvironment=e,this.applicationHost=t,this.inProgressCopyContext=void 0,this.deferredPasteData=void 0,!r)throw new E(m,"logger");i(r),n().ULS.shipAssertTag(596456157,o.WN.msoulscat_ES_EWAJS,!!e,"CopyPasteInfra.copyPasteFlowManager.ctor: missing 'clipboardPlatformEnvironment' argument"),n().ULS.shipAssertTag(596456158,o.WN.msoulscat_ES_EWAJS,!!t,"CopyPasteInfra.copyPasteFlowManager.ctor: missing 'applicationHost' argument"),this.metadataManager=e.getMetadataManager(),this.metadataManager.addMetadataChangeListener("CopyPasteFlowManagerOnMetadataChangedListener",this.onMetadataChanged.bind(this)),n().ULS.shipAssertTag(596456156,o.WN.msoulscat_ES_EWAJS,!!this.metadataManager,"CopyPasteInfra.copyPasteFlowManager.ctor: metadataManager is not valid")}return Object.defineProperty(e.prototype,"clipboardStrategy",{get:function(){if(this.clipboardPlatformEnvironment)return this.clipboardPlatformEnvironment.getClipboardStrategy();throw new _("clipboardPlatformEnvironment is missing")},enumerable:!1,configurable:!0}),e.prototype.onCopy=function(e){var t,r,a=this;if(!e)return Promise.reject(new x(l.MissingArgumentError,"Missing commandParameters argument",new E(m,"commandParameters")));t=new Pt;try{t.id=$e(),n().ULS.traceTag(595937123,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CopyPasteFlowManager.onCopy: copy ".concat(t.id," started.")),t.sessionId=this.applicationHost.getSessionId(),t.commandParameters=e;var i=this.getCopyFlowHandler(t);t.sourceItem=this.getSourceItem(i,t),this.clearInProgressCopyIfNeeded(t),this.inProgressCopyContext=t,r=this.serialize(i,t),n().ULS.traceTag(595937152,o.WN.msoulscat_ES_EWAJS,o.Gu.Verbose,"CopyPasteFlowManager.onCopy: updating metadata for copy id ".concat(t.id," after serialize.")),this.metadataManager.updateMetadata({lastCopy:t})}catch(r){return t?n().ULS.traceTag(595734742,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CopyPasteFlowManager.onCopy: catching error for copy id ".concat(t.id," during serialize.")):n().ULS.traceTag(595734743,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"CopyPasteFlowManager.onCopy: catching error and no copy context during serialize."),this.copyCompleteCleanup(t,e),Promise.reject(r)}try{return Promise.all([this.setClipboardSync(r.synchronousResult,e,t).then((function(){return a.rejectIfCopyCancelled(t)})).then((function(){t.copyStatus=_t.SynchronousPhaseCompleted,n().ULS.traceTag(595937153,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CopyPasteFlowManager.onCopy: updating metadata for copy id ".concat(t.id," after status changed to SynchronousPhaseCompleted.")),a.metadataManager.updateMetadata({lastCopy:t})})).catch((function(e){if(t?n().ULS.traceTag(595734744,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CopyPasteFlowManager.onCopy: catch error for copy id ".concat(t.id,".")):n().ULS.traceTag(595734745,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"CopyPasteFlowManager.onCopy: no copy context."),e&&e.reason){var r=e.reason;if(r===l.SuccessiveCutCopyOverridingPendingCutCopy||r===l.BlockedSynchronousCutCopy||r===l.CopyOperationCancelled)return n().ULS.traceTag(595734746,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"CopyPasteInfra.copyPasteFlowManager.onCopy: synchronous copy failed to populate the clipboard. Rejecting the promise: ".concat(o.P6.getStringifiedError(e),". Call stack: ").concat(e.stack?e.stack:"NA")),Promise.reject(e)}return n().ULS.traceTag(596456159,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"CopyPasteInfra.copyPasteFlowManager.onCopy: synchronous copy failed to populate the clipboard. Ignoring this failure since the active selection will allow for the required functionality: ".concat(o.P6.getStringifiedError(e),". Call stack: ").concat(e.stack?e.stack:"NA")),a.metadataManager.updateMetadata({lastCopy:t}),Promise.resolve()})),this.rejectIfCopyCancelled(t).then((function(){return a.setClipboardAsync(r.asynchronousResult,e,t)}))]).then((function(){return a.rejectIfCopyCancelled(t)})).then((function(){return a.copyCompleteCleanup(t,e),t}),(function(r){n().ULS.traceTag(595734747,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CopyPasteFlowManager.onCopy: got error for copy id ".concat(t.id,"."));var i=r;return a.copyCompleteCleanup(t,e),i||(n().ULS.shipAssertTag(595854806,o.WN.msoulscat_ES_EWAJS,!1,"copyPasteFlowManager.onCopy: promise rejected without error"),i=new x(l.UnknownCopyErrorType,"copyPasteFlowManager.onCopy failed without specified error")),i.copyContext=t,Promise.reject(i)}))}catch(r){return this.copyCompleteCleanup(t,e),n().ULS.traceTag(596456160,o.WN.msoulscat_ES_EWAJS,o.Gu.Error,"CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to store content in the clipboard. Exception: ".concat(o.P6.getStringifiedError(r),". Call stack: ").concat(r.stack?r.stack:"NA")),Promise.reject(new x(l.SaveToTheClipboardFailed,"Failed to store content in the clipboard (with an exception): ".concat(r.message),r))}},e.prototype.onPaste=function(e){var t=this,r=new It;try{if(!e)return Promise.reject(new D(d.MissingArgumentError,"Missing commandParameters argument",new E(m,"commandParameters")));e.isTimestampStoredInSystemClipboard=!0,r.id=Ke(),r.sessionId=this.applicationHost.getSessionId(),r.commandParameters=e,r.clipboardItems=ue(),r.isClipboardInaccessible=!1,n().ULS.traceTag(595685636,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,r.profilingMessage("start"));var a=this.metadataManager.getCachedMetadata();r.copyContextSnapshot=a.lastCopy,this.applicationHost.initializePasteContext(r),r.copyContextSnapshot?n().ULS.traceTag(595937154,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CopyPasteFlowManager.onPaste: paste started for copy id ".concat(r.copyContextSnapshot.id)):n().ULS.traceTag(595730637,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CopyPasteFlowManager.onPaste: paste started and copy context is null");var i=void 0;return e.skipClipboardAccess?(n().ULS.traceTag(595685637,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,r.profilingMessage("skipClipboardAccess")),i=Promise.resolve()):i=this.readFromClipboard(r,e).then((function(e){return n().ULS.traceTag(595685638,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,r.profilingMessage("readFromClipboard_then")),r.clipboardItems=e,Promise.resolve()}),(function(e){return e&&e.reason&&e.reason===d.ClipboardIsInaccessible?(r.isClipboardInaccessible=!0,Promise.resolve()):Promise.reject(e)})),i.then((function(){return t.readClipboardItemsAgainIfMetadataNotSync(r,e)})).then((function(){return n().ULS.traceTag(595685639,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,r.profilingMessage("getPasteFlowHandler")),t.getPasteFlowHandler(r)})).then((function(e){return e.beforePaste&&e.beforePaste(r),e})).then((function(a){if(n().ULS.traceTag(595685640,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,r.profilingMessage("getPasteFlowHandler_then")),r.copyContextSnapshot&&r.copyContextSnapshot.copyStatus!==_t.Completed&&a.shouldWaitForCopyToComplete(r)){n().ULS.traceTag(595937155,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CopyPasteFlowManager.onPaste: pasteFlowHandler ask to waiting for copy (".concat(r.copyContextSnapshot.id,") to complete. current status ").concat(r.copyContextSnapshot.copyStatus,". copy session id is ").concat(r.copyContextSnapshot.sessionId)),n().ULS.traceTag(595683427,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,r.profilingMessage("onDeferredPasteStarted")),a.onDeferredPasteStarted(r);var i=t.continueWhenCopyComplete(e,r).then((function(e){return n().ULS.traceTag(595685642,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,r.profilingMessage("onDeferredPasteCompleted")),a.onDeferredPasteCompleted(r),r.copyContextSnapshot=t.metadataManager.getCachedMetadata().lastCopy,r.clipboardItems=e,a}),(function(e){return a.onDeferredPasteCompleted(r),n().ULS.traceTag(595882504,o.WN.msoulscat_ES_EWAJS,o.Gu.Error,"CopyPasteFlowManager.onPaste: got error while wait for deferred paste to complete. error: [".concat(e,"]")),Promise.reject(e)}));return n().ULS.traceTag(595685643,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,r.profilingMessage("continueWhenCopyComplete")),t.testHook("continueWhenCopyComplete"),i}return n().ULS.traceTag(595940941,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CopyPasteFlowManager.onPaste: not wait for copy(".concat(r.copyContextSnapshot&&r.copyContextSnapshot.id,") to complete. is copyContextSnapshot defined: ").concat(void 0!==r.copyContextSnapshot,". copyStatus: ").concat(r.copyContextSnapshot&&r.copyContextSnapshot.copyStatus)),a})).then((function(e){return t.deserialize(e,r)})).then((function(){n().ULS.traceTag(595685644,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,r.profilingMessage("deserialize_then")),r.clipboardItems&&"1"===r.clipboardItems.getItem(se)&&(n().ULS.traceTag(595685645,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,r.profilingMessage("onSystemClipboardChangedExternally")),t.onSystemClipboardChangedExternally())})).then((function(){var e=r.clipboardItems;if(void 0!==e){var t=e.getItem(ne);if(void 0!==t){var a=function(e){if(e&&e.trim()){var t=(new DOMParser).parseFromString(e,"text/html");(0,xt.isChangeGateEnabled)("OfficeVSO:8472105_EnablePasteHtmlTelemetry")&&function(e){if(e){var t=e.getElementsByTagName("table"),r=e.querySelector("table table"),a=e.getElementsByTagName("ol"),i=e.getElementsByTagName("ul"),s=e.getElementsByTagName("a"),c=e.getElementsByTagName("img"),l={tableTags:t.length,nestedTableTags:r?1:0,orderedListTags:a.length,unorderedListTags:i.length,linkTags:s.length,imageTags:c.length};n().ULS.traceTag(507872212,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"htmlClipboardItem.logPasteHtmlStructureTelemetry | tagCountInfo: ".concat(JSON.stringify(l)))}}(t);var r=function(e){for(var t=e.getElementsByTagName("meta"),r=0;r<t.length;r+=1){var a=t[r];if("ProgId"===a.getAttribute("name")){var i=a.getAttribute("content");if(null!==i){if(i.length>64)return void n().ULS.shipAssertTag(595683460,o.WN.msoulscat_ES_EWAJS,!1,"ProgID longer than 64 characters");if(i.startsWith("Word"))return"Word Desktop";if(i.startsWith("Excel"))return"Excel Desktop";if(i.startsWith("PowerPoint"))return"PowerPoint Desktop";if(i.startsWith("OneNote"))return"OneNote Desktop";n().ULS.traceTag(595683457,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"htmlClipboardItem.getOfficeDesktopOrigin: unrecognized ProgId content")}return}}}(t);if(void 0!==r)return r;var a=function(e){if(null!==e&&null!==e.body&&null!==e.body.children&&0!==e.body.children.length){var t=e.body.children[0];if(null!=t&&null!=t.classList)for(var r=0;r<t.classList.length;r+=1){var a=t.classList[r];if(a.startsWith("SCXO"))return"OneNote Online";if(a.startsWith("SCXP"))return"PowerPoint Online";if(a.startsWith("SCXW"))return"Word Online"}}}(t);return void 0!==a?a:function(e){if(null===e)return!1;var t=e.getElementsByTagName("b");if(0===t.length)return!1;var r=t[0];return!(null==r||null==r.id||null==r.id.startsWith||!r.id.startsWith("docs-internal-guid-"))}(t)?"Google Docs":void 0}}(t);void 0!==a&&(r.externalAppSource=a)}}})).then((function(){return r})).catch((function(e){var t=e;return t||(n().ULS.shipAssertTag(595858762,o.WN.msoulscat_ES_EWAJS,!1,"copyPasteFlowManager.onPaste: promise rejected without error"),t=new D(d.UnknownPasteError,"copyPasteFlowManager.onPaste failed without specified error")),t.pasteContext=r,Promise.reject(t)}))}catch(e){return n().ULS.shipAssertTag(596456161,o.WN.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard. Exception: ".concat(o.P6.getStringifiedError(e))),Promise.reject(new D(d.FailedToReadFromClipboard,"Failed to read data from the clipboard (with an exception): ".concat(e.message),e,r))}},e.prototype.onCancelCopy=function(e){try{if(this.inProgressCopyContext?(this.inProgressCopyContext.markForCancellation=!0,n().ULS.traceTag(595734748,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CopyPasteFlowManager.onCancelCopy: canceling copy for copy id ".concat(this.inProgressCopyContext.id,"."))):n().ULS.traceTag(595734749,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CopyPasteFlowManager.onCancelCopy: no inProgressCopyContext."),!e)return Promise.resolve();this.metadataManager.clear();var t=ue(),r={isKeyboardEvent:!1,silentClipboardAccessFailures:!0,commandType:K.Copy};return this.clipboardStrategy.set(t,r).catch((function(e){return n().ULS.traceTag(596456162,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"CopyPasteInfra.copyPasteFlowManager.onCancelCopy: Failed to clear the clipboard: ".concat(o.P6.getStringifiedError(e),". Call stack: ").concat(e.stack?e.stack:"NA")),Promise.reject(new M(u.FailedToClearClipboard,"Failed to clear the clipboard: ".concat(e.message),e))}))}catch(e){return n().ULS.traceTag(596456163,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"CopyPasteInfra.copyPasteFlowManager.onCancelCopy: Failed to clear the clipboard. Exception: ".concat(o.P6.getStringifiedError(e))),Promise.reject(new M(u.FailedToClearClipboard,"Failed to clear the clipboard (with an exception): ".concat(e.message),e))}},e.prototype.onSystemClipboardChangedExternally=function(){return(0,t.__awaiter)(this,void 0,void 0,(function(){var e;return(0,t.__generator)(this,(function(t){switch(t.label){case 0:return this.onCancelCopy(!1),this.metadataManager.updateMetadata({lastCopy:void 0}),e={isKeyboardEvent:!1,silentClipboardAccessFailures:!0,commandType:K.Copy},[4,this.clipboardStrategy.onSystemClipboardChangedExternally(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.readClipboardItemsAgainIfMetadataNotSync=function(e,t){var r=this,a=!1;return this.metadataManager.getMetadataSyncPromise().then((function(t){t&&t.lastCopy?(e.copyContextSnapshot&&(a=t.lastCopy.id!==e.copyContextSnapshot.id||t.lastCopy.copyStatus!==e.copyContextSnapshot.copyStatus),e.copyContextSnapshot=t.lastCopy,n().ULS.traceTag(595937158,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"MetadataManager.readClipboardItemsAgainIfMetadataNotSync: metadata is sync. copy id = ".concat(e.copyContextSnapshot.id,". copy status = ").concat(e.copyContextSnapshot.copyStatus,". isMetadataChanged = ").concat(a))):n().ULS.traceTag(595937025,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"MetadataManager.readClipboardItemsAgainIfMetadataNotSync: metadata or metadata.lastCopy are not defined. This should be possible only when the last copy was external (i.e. there is no previous copy operation in xlo). do nothing")})).then((function(){return a?r.readRichClipboardOnly(e,t,e.clipboardItems):Promise.resolve(e.clipboardItems)})).then((function(t){return e.clipboardItems=t,e}))},e.prototype.getCopyFlowHandler=function(e){var t;try{t=this.applicationHost.getCopyFlowHandler(e)}catch(e){throw n().ULS.shipAssertTag(596456192,o.WN.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onCopy: applicationHost.getCopyFlowHandler failed with an exception: ".concat(o.P6.getStringifiedError(e))),new x(l.FetchCopyFlowHandlerFailed,"applicationHost.getCopyFlowHandler failed with an exception: ".concat(e.message),e)}if(!t){var r="CopyPasteInfra.copyPasteFlowManager.onCopy: applicationHost.getCopyFlowHandler should return an object. Try again later, when the CCP infra is loaded.";throw n().ULS.shipAssertTag(596456193,o.WN.msoulscat_ES_EWAJS,!1,r),new x(l.CopyFlowHandlerNotFound,r)}return t},e.prototype.getSourceItem=function(e,t){try{return e.getSourceItem(t)}catch(e){throw n().ULS.shipAssertTag(596456194,o.WN.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onCopy: copyFlowHandler.getSourceItem failed with an exception: ".concat(o.P6.getStringifiedError(e))),new x(l.FetchSourceItemFailed,"applicationHost.getSourceItem failed with an exception: ".concat(e.message),e)}},e.prototype.serialize=function(e,t){try{e.beforeSerialize(t)}catch(e){throw n().ULS.shipAssertTag(596456195,o.WN.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onCopy: copyFlowHandler.beforeSerialize failed with an exception: ".concat(o.P6.getStringifiedError(e))),new x(l.BeforeSerializeFailed,"copyFlowHandler.beforeSerialize failed with an exception: ".concat(e.message),e)}var r;try{r=e.serialize(t)}catch(e){throw n().ULS.shipAssertTag(596456196,o.WN.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onCopy: copyFlowHandler.serialize failed with an exception: ".concat(o.P6.getStringifiedError(e))),new x(l.SerializeFailed,"copyFlowHandler.serialize failed with an exception: ".concat(e.message),e)}if(!r)throw n().ULS.shipAssertTag(596456197,o.WN.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onCopy: copyFlowHandler.serialize should return a non null result"),new x(l.SerializeResultNotValid,"copyFlowHandler.serialize should return a non null result");return r},e.prototype.setClipboardSync=function(e,t,r){try{r?n().ULS.traceTag(595734750,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CopyPasteFlowManager.setClipboardSync: start setClipboardSync for copy id ".concat(r.id,".")):n().ULS.traceTag(595734751,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"CopyPasteFlowManager.setClipboardSync: no copy context.");var a=e;return a||(a=ue()),this.clipboardStrategy.set(a,t).catch((function(e){if(n().ULS.traceTag(596456198,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to synchronously store content in the clipboard. isKeyboardEvent: ".concat(t.isKeyboardEvent,", Error: ").concat(o.P6.getStringifiedError(e),". Call stack: ").concat(e.stack?e.stack:"NA")),e&&void 0!==e.reason){var r=e;if(r.reason===c.ClipboardIsInaccessible)return Promise.reject(new x(l.ClipboardIsInaccessible,r.message,r));if(r.reason===c.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation)return Promise.reject(new x(l.SuccessiveCutCopyOverridingPendingCutCopy,"A successive Cut/Copy user event occurred before the last Cut/Copy browser event fired: ".concat(r.message),r));if(r.reason===c.RejectingBlockedSyncCutCopyPromise)return Promise.reject(new x(l.BlockedSynchronousCutCopy,"In the user Cut/Copy operation, the async part occurred before its predecessor sync Cut/Copy browser event fired: ".concat(r.message),r))}return Promise.reject(new x(l.SaveToTheClipboardFailed,"Failed to synchronously store content in the clipboard: ".concat(e.message),e))})).then((function(){r.succeededPopulatingSystemClipboardSync=t.isTimestampStoredInSystemClipboard}))}catch(e){return n().ULS.shipAssertTag(596456199,o.WN.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to synchronously store content in the clipboard. Exception: ".concat(o.P6.getStringifiedError(e),". Call stack: ").concat(e.stack?e.stack:"NA")),Promise.reject(new x(l.SaveToTheClipboardFailed,"Failed to synchronously store content in the clipboard (with an exception): ".concat(e.message),e))}},e.prototype.setClipboardAsync=function(e,r,a){var i=this;return n().ULS.traceTag(595734752,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CopyPasteFlowManager.setClipboardAsync: start setClipboardAsync for copy id ".concat(a.id,".")),e?e.then((function(e){try{if(i.isEmptyClipboard(e))return Promise.resolve();var s=r.stopwatch;r.stopwatch=void 0;var d=(0,t.__assign)({},r);return d.isTimestampStoredInSystemClipboard=!1,r.stopwatch=s,r.isKeyboardEvent&&(d.isKeyboardEvent=!1,d.silentClipboardAccessFailures=!0),i.clipboardStrategy.set(e,d).catch((function(e){return n().ULS.traceTag(596456200,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to asynchronously store content in the clipboard: ".concat(o.P6.getStringifiedError(e),". Call stack: ").concat(e.stack?e.stack:"NA")),e&&void 0!==e.reason&&e.reason===c.ClipboardIsInaccessible?Promise.resolve():Promise.reject(new x(l.SaveToTheClipboardFailed,"Failed to asynchronously store content in the clipboard: ".concat(e&&e.message),e))})).then((function(){a.succeededPopulatingSystemClipboardAsync=d.isTimestampStoredInSystemClipboard}))}catch(e){return n().ULS.shipAssertTag(596456201,o.WN.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to asynchronously store content in the clipboard. Exception: ".concat(o.P6.getStringifiedError(e),". Call stack: ").concat(e.stack?e.stack:"NA")),Promise.reject(new x(l.SaveToTheClipboardFailed,"Failed to asynchronously store content in the clipboard (with an exception): ".concat(e.message),e))}}),(function(e){return a.isAsyncSerializeFailed=!0,n().ULS.traceTag(596456202,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to asynchronously serialize the content - Marking copyContext.isAsyncSerializeFailed as true. Error: ".concat(o.P6.getStringifiedError(e),". Call stack: ").concat(e&&e.stack?e.stack:"NA")),Promise.reject(new x(l.AsyncSerializeFailed,"Failed to asynchronously serialize the content. Error: ".concat(e?e.message:"..."),e))})):(n().ULS.traceTag(595734753,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CopyPasteFlowManager.setClipboardAsync: no clipboardItemsPromise. resolving promise for copy id ".concat(a.id,".")),Promise.resolve())},e.prototype.isEmptyClipboard=function(e){return e?0===me(e)&&(n().ULS.traceTag(596456204,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CopyPasteInfra.copyPasteFlowManager.onCopy: the async serialization result does not contain items."),!0):(n().ULS.traceTag(596456203,o.WN.msoulscat_ES_EWAJS,o.Gu.Error,"CopyPasteInfra.copyPasteFlowManager.onCopy: the async serialization result is undefined."),!0)},e.prototype.readFromClipboard=function(e,t){n().ULS.traceTag(595685646,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,e.profilingMessage("readFromClipboard")),e.copyContextSnapshot&&(t.isTimestampStoredInSystemClipboard=e.copyContextSnapshot.isTimestampStoredInSystemClipboard);var r=this.clipboardStrategy.get(t);return n().ULS.traceTag(595685647,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,e.profilingMessage("readFromClipboard_ret")),r?r.then((function(t){return n().ULS.traceTag(595685648,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,e.profilingMessage("readFromClipboard_then")),t?Promise.resolve(t):(n().ULS.traceTag(596456206,o.WN.msoulscat_ES_EWAJS,o.Gu.Error,"CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard. Intercepted a missing clipboard item collection"),Promise.reject(new D(d.FailedToReadFromClipboard,"Failed to read data from the clipboard. Intercepted a missing clipboard item collection",new D(d.ClipboardIsEmpty,m))))}),(function(e){if(n().ULS.traceTag(596456207,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard: ".concat(o.P6.getStringifiedError(e),". Call stack: ").concat(e.stack?e.stack:"NA")),t.isPasteCommandFromRecoveryUI&&t.pasteRecoveryCachedClipboardItems)return n().ULS.traceTag(577249542,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CopyPasteInfra.copyPasteFlowManager.onPaste: Returning 'pasteRecoveryCachedClipboardItems'"),Promise.resolve(t.pasteRecoveryCachedClipboardItems);var r=e;return g(e,c.ClipboardIsInaccessible)?Promise.reject(new D(d.ClipboardIsInaccessible,r.message,r)):g(e,c.RejectingPendingPastePromiseDueToNewPasteOperation)?Promise.reject(new D(d.SuccessivePasteOverridingPendingPaste,"A successive Paste user event occurred before the last Paste browser event fired: ".concat(r.message),r)):Promise.reject(new D(d.FailedToReadFromClipboard,"Failed to read data from the clipboard: ".concat(e.message),e))})):(n().ULS.shipAssertTag(596456205,o.WN.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard. clipboardStrategy.get() did not return an object"),Promise.reject(new D(d.FailedToReadFromClipboard,"Failed to read data from the clipboard. clipboardStrategy.get() did not return an object",new D(d.ReadFromClipboardReturnNullOrUndefined,m))))},e.prototype.getPasteFlowHandler=function(e){var t;try{t=this.applicationHost.getPasteFlowHandler(e)}catch(e){throw n().ULS.shipAssertTag(596456208,o.WN.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onPaste: applicationHost.getPasteFlowHandler failed. Exception: ".concat(o.P6.getStringifiedError(e))),new D(d.FetchPasteFlowHandlerFailed,"applicationHost.getPasteFlowHandler failed with an exception: ".concat(e.message),e)}if(!t){var r="CopyPasteInfra.copyPasteFlowManager.onPaste: applicationHost.getPasteFlowHandler should return an object. Try again later, when the CCP infra is loaded.";throw n().ULS.shipAssertTag(596456209,o.WN.msoulscat_ES_EWAJS,!1,r),new D(d.PasteFlowHandlerNotFound,r)}return t},e.prototype.deserialize=function(e,t){return n().ULS.traceTag(595683456,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,t.profilingMessage("deserialize")),e.deserialize(t).catch((function(e){var t=o.P6.getStringifiedError(e);return n().ULS.traceTag(596456210,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"CopyPasteInfra.copyPasteFlowManager.onPaste: Deserialization failed: ".concat(t,".")),Promise.reject(new D(d.DeserializeOperationFailed,"Deserialization failed: ".concat(t),e))}))},e.prototype.copyCompleteCleanup=function(e,t){e?(n().ULS.traceTag(595734754,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CopyPasteFlowManager.copyCompleteCleanup: start copy complete for copy id ".concat(e.id,".")),t&&(e.isTimestampStoredInSystemClipboard=t.isTimestampStoredInSystemClipboard),e&&this.inProgressCopyContext&&e.id===this.inProgressCopyContext.id?(this.inProgressCopyContext=void 0,e.copyStatus=_t.Completed,n().ULS.traceTag(595937159,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CopyPasteFlowManager.copyCompleteCleanup: updating metadata for copy id ".concat(e.id," after copy completed.")),this.metadataManager.updateMetadata({lastCopy:e})):n().ULS.traceTag(595734755,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CopyPasteFlowManager.copyCompleteCleanup: not setting copy status to complete state for copy id ".concat(e.id,"."))):n().ULS.traceTag(595734784,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"CopyPasteFlowManager.copyCompleteCleanup: no copy context.")},e.prototype.readRichClipboardOnly=function(e,t,r){return t.skipSystemClipboardAccess=!0,this.readFromClipboard(e,t).then((function(e){return n().ULS.traceTag(595937160,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CopyPasteFlowManager.readRichClipboardOnly: get clipboard items."),e}),(function(e){return n().ULS.traceTag(595940942,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"CopyPasteFlowManager.readRichClipboardOnly: reading form rich clipboard failed with error: ".concat(o.P6.getStringifiedError(e),". use clipboard items from the first read as fallback.")),Promise.resolve(r)}))},e.prototype.continueWhenCopyComplete=function(e,t){var r=this;if(!t||!t.copyContextSnapshot)return Promise.resolve(void 0);if(t.copyContextSnapshot.copyStatus===_t.Completed)return Promise.resolve(void 0);if(this.deferredPasteData&&this.deferredPasteData.copyContextId!==t.copyContextSnapshot.id&&(n().ULS.shipAssertTag(595937161,o.WN.msoulscat_ES_EWAJS,!1,"CopyPasteFlowManager.continueWhenCopyComplete: deferred paste for another copy(".concat(this.deferredPasteData.copyContextId," !== ").concat(t.copyContextSnapshot.id,") exist, this is not expected as we should clean deferred paste data when new copy started(both same and cross session)")),this.rejectDeferredPasteData(d.DeferredPasteRejectedBecauseOtherCopyCompleted)),!this.deferredPasteData){var a=this.metadataManager.getCachedMetadata();if(a&&a.lastCopy&&a.lastCopy.copyStatus===_t.Completed&&a.lastCopy.id===t.copyContextSnapshot.id)return n().ULS.traceTag(595937162,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CopyPasteFlowManager.continueWhenCopyComplete: copy ".concat(a.lastCopy.id," already completed, not need for waiting any longer, reading the rich clipboard items")),this.readRichClipboardOnly(t,e,t.clipboardItems);var i=ot(),s=i.promise.then((function(){return r.readRichClipboardOnly(t,e,t.clipboardItems)}));this.deferredPasteData={copyContextId:t.copyContextSnapshot.id,copyCompleteDeferredPromise:i,readClipboardPromise:s,numberOfDeferredPaste:0,createdDate:new Date}}return this.deferredPasteData.numberOfDeferredPaste+=1,n().ULS.traceTag(595937163,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CopyPasteFlowManager.continueWhenCopyComplete: new deferred paste created for copy id: ".concat(this.deferredPasteData.copyContextId,". number of deferred paste for this copy is: ").concat(this.deferredPasteData.numberOfDeferredPaste,". first deferred paste created time: ").concat(this.deferredPasteData.createdDate.toUTCString())),this.deferredPasteData.readClipboardPromise},e.prototype.rejectDeferredPasteData=function(e){if(this.deferredPasteData){n().ULS.traceTag(595937164,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CopyPasteFlowManager.rejectDeferredPasteData: reject deferred pastes for copy id: ".concat(this.deferredPasteData.copyContextId,". number of deferred paste for this copy is: ").concat(this.deferredPasteData.numberOfDeferredPaste,". first deferred paste created time: ").concat(this.deferredPasteData.createdDate.toUTCString(),". totalTime = ").concat((new Date).getTime()-this.deferredPasteData.createdDate.getTime(),"ms"));var t=this.deferredPasteData.copyCompleteDeferredPromise;this.deferredPasteData=void 0,t.reject(new D(e,"CopyPasteFlowManager.rejectDeferredPasteData: reject deferred paste"))}},e.prototype.resolveDeferredPasteData=function(){if(this.deferredPasteData){n().ULS.traceTag(595937165,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CopyPasteFlowManager.resolveDeferredPasteData: resolve deferred pastes for copy id: ".concat(this.deferredPasteData.copyContextId,". number of deferred paste for this copy is: ").concat(this.deferredPasteData.numberOfDeferredPaste,". first deferred paste created time: ").concat(this.deferredPasteData.createdDate.toUTCString(),". totalTime = ").concat((new Date).getTime()-this.deferredPasteData.createdDate.getTime(),"ms"));var e=this.deferredPasteData.copyCompleteDeferredPromise;this.deferredPasteData=void 0,e.resolve()}},e.prototype.rejectIfCopyCancelled=function(e){return e?n().ULS.traceTag(595734785,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CopyPasteFlowManager.rejectIfCopyCancelled: start rejectIfCopyCancelled for copy id ".concat(e.id,".")):n().ULS.traceTag(595734786,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"CopyPasteFlowManager.rejectIfCopyCancelled: no copy context."),e&&e.markForCancellation?(n().ULS.traceTag(595734787,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CopyPasteFlowManager.rejectIfCopyCancelled: reject for copy id ".concat(e.id,".")),Promise.reject(new x(l.CopyOperationCancelled,"CopyPasteFlowManager.rejectIfCopyCancelled: Rejecting since copyContext with id ".concat(e.id," is marked for cancellation")))):(e&&n().ULS.traceTag(595734788,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CopyPasteFlowManager.rejectIfCopyCancelled: resolve for copy id ".concat(e.id,".")),Promise.resolve())},e.prototype.clearInProgressCopyIfNeeded=function(e){e&&e.markForCancellation||!this.inProgressCopyContext||e&&this.inProgressCopyContext.id===e.id||(n().ULS.traceTag(595937166,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CopyPasteFlowManager.clearInProgressCopyIfNeeded: cancel previous in-progress copy (id = ".concat(this.inProgressCopyContext.id,") as new copy started (").concat(e.id,")")),this.inProgressCopyContext.markForCancellation=!0,this.inProgressCopyContext=void 0)},e.prototype.onMetadataChanged=function(e){e&&e.lastCopy?(n().ULS.traceTag(595937167,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CopyPasteFlowManager.onMetadataChanged: the status of copy id ".concat(e.lastCopy.id," from session ").concat(e.lastCopy.sessionId," changed to ").concat(e.lastCopy.copyStatus)),this.clearInProgressCopyIfNeeded(e.lastCopy),this.deferredPasteData&&e.lastCopy.id!==this.deferredPasteData.copyContextId&&(n().ULS.traceTag(595734789,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CopyPasteFlowManager.onMetadataChanged: reject deferred paste because copy id ".concat(e.lastCopy.id," is not equal to ").concat(this.deferredPasteData.copyContextId)),this.rejectDeferredPasteData(d.DeferredPasteRejectedBecauseOtherCopyStarted)),e.lastCopy.copyStatus===_t.Completed&&this.onCopyCompletedSuccessfully(e.lastCopy)):(n().ULS.traceTag(595734790,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CopyPasteFlowManager.onMetadataChanged: no metadata or no metadata.lastCopy"),this.deferredPasteData&&(n().ULS.traceTag(595724049,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CopyPasteFlowManager.onMetadataChanged: reject deferred paste because metadata update without copy context"),this.rejectDeferredPasteData(d.DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext)))},e.prototype.onCopyCompletedSuccessfully=function(e){e?n().ULS.traceTag(595734791,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CopyPasteFlowManager.onCopyCompletedSuccessfully: start onCopyCompletedSuccessfully for copy id ".concat(e.id,".")):n().ULS.traceTag(595734792,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"CopyPasteFlowManager.onCopyCompletedSuccessfully: no copy context."),this.deferredPasteData&&e&&e.copyStatus===_t.Completed&&e.id===this.deferredPasteData.copyContextId&&this.resolveDeferredPasteData()},e.prototype.testHook=function(e){},e}();r(8931);var Zt,Qt={serializeMetadata:function(e){if(!e)return"{}";try{var t={},r=function(e){if(e)try{if(!e.id)throw new N(c.SerializedMetadata,"MetadataSerializer.serializeCopyContext: copyContext.id is not defined");if(!e.sessionId)throw new N(c.SerializedMetadata,"MetadataSerializer.serializeCopyContext: copyContext.sessionId is not defined");if(void 0===e.copyStatus)throw new N(c.SerializedMetadata,"MetadataSerializer.serializeCopyContext: copyContext.copyStatus is not defined");return{id:e.id,sessionId:e.sessionId,sourceItem:Xt.serializeSourceItem(e.sourceItem),commandParameters:Xt.serializeCommandParameters(e.commandParameters),copyStatus:e.copyStatus,isTimestampStoredInSystemClipboard:e.isTimestampStoredInSystemClipboard,isAsyncSerializeFailed:e.isAsyncSerializeFailed,asyncClipboardItemsKeys:e.asyncClipboardItemsKeys,syncClipboardItemsKeys:e.syncClipboardItemsKeys}}catch(e){return void n().ULS.traceTag(595945243,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"MetadataSerializer.serializeCopyContext: failed to serialized copyContext: ".concat(o.P6.getStringifiedError(e)))}}(e.lastCopy);return r&&(t.copyContext=r),JSON.stringify(t)}catch(e){return n().ULS.traceTag(595945242,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"MetadataSerializer.serializeMetadata: failed to serialized metadata: ".concat(o.P6.getStringifiedError(e))),"{}"}},deserializeMetadata:function(e){if(!e)return{};try{var t=JSON.parse(e),r={};return t.copyContext&&(r.lastCopy=function(e){if(e)try{if(!e.id)throw new N(c.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.id is not defined");if(!e.sessionId)throw new N(c.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.sessionId is not defined");if(!e.copyStatus)throw new N(c.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.copyStatus is not defined");if(!e.sourceItem)throw new N(c.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.sourceItem is not defined");if(!e.commandParameters)throw new N(c.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.commandParameters is not defined");var t=new Pt;return t.id=e.id,t.sessionId=e.sessionId,t.copyStatus=e.copyStatus,t.isTimestampStoredInSystemClipboard=e.isTimestampStoredInSystemClipboard,t.isAsyncSerializeFailed=e.isAsyncSerializeFailed,t.sourceItem=Xt.deserializeSourceItem(e.sourceItem),t.commandParameters=Xt.deserializeCommandParameters(e.commandParameters),t.asyncClipboardItemsKeys=e.asyncClipboardItemsKeys,t.syncClipboardItemsKeys=e.syncClipboardItemsKeys,t}catch(e){return void n().ULS.traceTag(595945245,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"MetadataSerializer.deserializeMetadata: failed to deserialized copyContext with error: ".concat(o.P6.getStringifiedError(e),"."))}}(t.copyContext)),r}catch(e){n().ULS.traceTag(595945244,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"MetadataSerializer.deserializeMetadata: failed to deserialized metadata with error: ".concat(o.P6.getStringifiedError(e)))}return{}}};var er,tr,rr,ar={},or={},nr={getCachedMetadata:function(){return n().ULS.traceTag(595730648,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"MetadataManager.getCachedMetadata: get cached metadata with value: ".concat(dr(ar))),Tt(ar)},updateMetadata:function(e){n().ULS.traceTag(595730652,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"MetadataManager.updateMetadata: start update metadata with metadata : ".concat(dr(e)));var r=(0,t.__assign)((0,t.__assign)({},ar),e),a=fe();a.setItem("metadata",er.serializeMetadata(r)),n().ULS.traceTag(595730653,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"MetadataManager.updateMetadata: schedule metadata with value: ".concat(dr(r))),cr(a,r)},clear:function(){n().ULS.traceTag(595730654,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"MetadataManager.clear: start clear metadata");cr(fe(),{})},addMetadataChangeListener:function(e,t){e||n().ULS.traceTag(595936158,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"MetadataManager.addMetadataChangeListener: expected listenerId to be define"),t||n().ULS.traceTag(595936159,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"MetadataManager.addMetadataChangeListener: expected listener to be define"),or[e]&&n().ULS.traceTag(595936160,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"MetadataManager.addMetadataChangeListener: listener with same listenerId(".concat(e," already exist.")),or[e]=t},removeMetadataChangeListener:function(e){e||n().ULS.traceTag(595936161,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"MetadataManager.addMetadataChangeListener: expected listenerId to be define"),or[e]?delete or[e]:n().ULS.traceTag(595936162,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"MetadataManager.removeMetadataChangeListener: can't find listener with listenerId = ".concat(e,"."))},getMetadataSyncPromise:function(){return rr&&(0,xt.isChangeGateEnabled)("OfficeVSO:2594435_ArtCCPWaitForCopyToComplete")?(n().ULS.traceTag(595937174,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"MetadataManager.getMetadataSyncPromise: metadata not sync, return deferred promise."),rr.deferredPromise.promise.then((function(e){return n().ULS.traceTag(595937175,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"MetadataManager.getMetadataSyncPromise: sync promise resolved."),e}))):(n().ULS.traceTag(595937173,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"MetadataManager.getMetadataSyncPromise: metadata is sync, return resolved promise."),Promise.resolve(Tt(ar)))},isMetadataSync:function(){return!rr}};function ir(e){try{if(e&&0!==me(e)){var t=e.getItem("metadata");ar=er.deserializeMetadata(t),n().ULS.traceTag(595730650,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"MetadataManager.onMetadataChanged: set cached metadata with value ".concat(dr(ar)))}else n().ULS.traceTag(595730649,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"MetadataManager.onMetadataChanged: set empty cached metadata because clipboardItems were not found"),ar={}}catch(e){n().ULS.traceTag(595945248,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"MetadataManager.onMetadataChanged: failed to parse metadata string with error: ".concat(o.P6.getStringifiedError(e))),ar={}}sr(Tt(ar))}function sr(e){for(var t in n().ULS.traceTag(595730651,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"MetadataManager.updateListenerForMetadataChanged: update listeners with metadata : ".concat(dr(e))),or){var r=or[t];r&&r(e)}}function cr(e,t){var r=Ke();rr?rr.metadataSyncMessageId=r:(rr={metadataSyncMessageId:r,deferredPromise:ot()},n().ULS.traceTag(595937176,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"MetadataManager.scheduleMetadataUpdate: _syncMetadata created. ".concat(rr.metadataSyncMessageId))),n().ULS.traceTag(595937177,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"MetadataManager.scheduleMetadataUpdate: set metadata request was sent with message id ".concat(r,".")),setTimeout((function(){Zt.set(e,{}).then((function(){ar=t,n().ULS.traceTag(595937178,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"MetadataManager.scheduleMetadataUpdate: set metadata successfully. messageId=".concat(r,". _syncMetadata.metadataSyncMessageId = ").concat(rr&&rr.metadataSyncMessageId,". newMetadata = ").concat(dr(t))),lr(r)}),(function(e){n().ULS.traceTag(595945250,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"MetadataManager.updateMetadata: failed to update metadata store with error: ".concat(o.P6.getStringifiedError(e))),lr(r)}))}),0)}function lr(e){if(n().ULS.traceTag(595730655,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"MetadataManager.notifyMetadataSyncIfNeeded: start notifyMetadataSyncIfNeeded with messageId: ".concat(e)),rr&&rr.metadataSyncMessageId===e){var t=rr;rr=void 0;var r=Tt(ar);n().ULS.traceTag(595730656,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"MetadataManager.notifyMetadataSyncIfNeeded: resolve with metadata: ".concat(dr(r))),sr(r),t.deferredPromise.resolve(r)}}function dr(e){return e?e.lastCopy?"copyContext.id=".concat(e.lastCopy.id):"copy context is null":"metadata is null"}var ur="ccp_infra_version=['|\"](\\d+)['|\"]",pr=function(){function e(e,t,r){this.ttlInMs=t,this.blockMismatchDataVersion=r,e?this.userHash=o.P6.calcHashCode(e):(this.userHash=1565411791,n().ULS.traceTag(595903939,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"userId not exist!. Use default ID"))}return e.prototype.wrapTextWithDataSignature=function(e,r,a,o,n){void 0===o&&(o="null");var i,s,c,l,d,u={ccp_infra_version:3,ccp_infra_timestamp:a,ccp_infra_user_hash:this.userHash,ccp_infra_copy_id:o};return(i=null!==n&&0!==Object.keys(n).length?(0,t.__assign)((0,t.__assign)({},u),n):u)[Vt]=a,s=e,c=r,d="",(l=i)&&(d=Object.keys(l).reduce((function(e,t){return t?"".concat(e," ").concat(t,"='").concat(l[t],"'"):e}),"")),"<".concat(c).concat(d,">").concat(s,"</").concat(c,">")},e.prototype.ensureDataSignatureInHtmlItem=function(e){if(0!==me(e)){var t=ye(e),r=he(t,ne),a=he(t,le),i=he(t,"metadata/additional-signature-data-attributes"),s=null;if(i!==m&&(s=JSON.parse(i)),r){if(void 0!==this.getRegExIntValue(r,ur))return;e.setItem(ne,this.wrapTextWithDataSignature(r,"div",Date.now(),a,s))}else{var l=(u=Se(t),g=function(e){return e?e.replace(Nt,"</".concat(kt,"></").concat(Jt,"><").concat(Jt,"><").concat(kt,">")):e}((p=(f=u)?f.replace(Ot,"&lt;").replace(Gt,"&gt;"):m)?p.replace(Ft,"</".concat(kt,"><").concat(kt,">")):p),"<".concat(Rt,"><").concat(Jt,"><").concat(kt,">").concat(g,"</").concat(kt,"></").concat(Jt,"></").concat(Rt,">")),d=this.wrapTextWithDataSignature(l,"pre",Date.now(),a,s);e.setItem(ne,function(e){if(!H()||H()&&G.isEdgeVersionWithTextHtmlWrapperSupportProperty)return e;var t=10,r=jt.length+e.length+zt.length,a=(r-zt.length).toString();if(a.length<t&&(a=Ht.substr(0,t-a.length)+a),a.length!==t){var i="addClipboardWrapperForEdge: the string representation of the opening bracket position of the End Fragment xml comment is ".concat(a.length," but it should be ").concat(t);throw n().ULS.shipAssertTag(596128536,o.WN.msoulscat_ES_EWAJS,!1,i),new N(c.UnexpectedClipboardTextHtmlContentLength,i)}var s=(r-7).toString();if(s.length<t&&(s=Ht.substr(0,t-s.length)+s),s.length!==t)throw i="addClipboardWrapperForEdge: the string representation of the opening bracket position of the End Html tag is ".concat(s.length," but it should be ").concat(t),n().ULS.shipAssertTag(596128537,o.WN.msoulscat_ES_EWAJS,!1,i),new N(c.UnexpectedClipboardTextHtmlContentLength,i);var l=jt.replace("{EndHTML0}",s).replace("{EndFragm}",a)+e+zt;return n().ULS.shipAssertTag(596128538,o.WN.msoulscat_ES_EWAJS,l.length===r,"addClipboardWrapperForEdge: The resulting text/html payload length of ".concat(l.length," differs from the expected length of ").concat(r)),l}(d))}}var u,p,f,g},e.prototype.extractSignatureData=function(e){if(pe(e)>0){var t=ge(e,ne),r=this.getRegExIntValue(t,ur);if(void 0===r)return this.parsePreSignatureData(t);if(this.blockMismatchDataVersion&&3!==r)throw n().ULS.traceTag(595902983,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"clipboardDataManager.extractSignatureData: block mismatch version. dataVer = ".concat(r,", CCPInfraVersion = ").concat(3)),new P("ClipboardDataManagerImpl.extractSignatureData",r,3,this.blockMismatchDataVersion);return r<3?(n().ULS.traceTag(595902986,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"clipboardDataManager.extractSignatureData: got data with older version then app version: dataVer = ".concat(r,", CCPInfraVersion = ").concat(3,". Converting to the data")),this.parseOldSignatureData(t)):(r>3&&n().ULS.traceTag(595900176,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"clipboardDataManager.extractSignatureData: got data with newer version then app version: dataVer = ".concat(r,", CCPInfraVersion = ").concat(3,". ( It's OK - Should be forward compatibility)")),this.parseCurrentVersionSignatureData(t))}},e.prototype.parseCurrentVersionSignatureData=function(e){var t=this.getRegExIntValue(e,"\\s+ccp_infra_timestamp=['|\"](\\d+)['|\"]"),r=this.getRegExIntValue(e,"\\s+ccp_infra_user_hash=['|\"](\\d+)['|\"]");if(void 0!==t&&void 0!==r){var a=this.getRegExStringValue(e,"\\s+ccp_infra_copy_id=['|\"]([\\w-]+)['|\"]");return a&&n().ULS.traceTag(595183181,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"clipboardDataManager.parseCurrentVersionSignatureData: copy ID of legacy paste cross session : ".concat(a)),{ccp_infra_version:3,ccp_infra_timestamp:t,ccp_infra_user_hash:r,ccp_infra_copy_id:a||""}}n().ULS.traceTag(595902985,o.WN.msoulscat_ES_EWAJS,o.Gu.Error,"clipboardDataManager.extractSignatureData: Failed to extract SignatureData. textHtmlItem: ".concat(e))},e.prototype.parseOldSignatureData=function(e){return this.parseCurrentVersionSignatureData(e)},e.prototype.parsePreSignatureData=function(e){var t=function(e){var t=function(e,t){if(e&&e.trim()){if(!t||!t.trim())throw new E(m,"attributeName");var r=new RegExp("".concat(t,"=['\"](\\d+)['\"]"),"i").exec(e);if(r&&!(r.length<2))return r[1]}}(e,Vt);if(t&&t.trim()){var r=Number(t);if((r||0===r)&&!isNaN(r))return r}}(e);if(n().ULS.traceTag(595723668,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"clipboardDataManager.parsePreSignatureData: dataTimeStamp=".concat(t)),t){if(this.blockMismatchDataVersion)throw n().ULS.traceTag(595899270,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"clipboardDataManager.parsePreSignatureData: block mismatch version. block pre signature data"),new P("ClipboardDataManagerImpl.extractSignatureData",NaN,3,this.blockMismatchDataVersion);var r={ccp_infra_version:3,ccp_infra_timestamp:t,ccp_infra_user_hash:0};return n().ULS.traceTag(595723669,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"clipboardDataManager.parsePreSignatureData"),r}},e.prototype.validateTTL=function(e){if(e&&this.ttlInMs){var t=Date.now()-e.ccp_infra_timestamp;if(t>this.ttlInMs)throw n().ULS.traceTag(595899858,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"Time elapsed (".concat(t," ms) from setting Clipboard (").concat(e.ccp_infra_timestamp,") is greater then TTL (").concat(this.ttlInMs," ms) - return error")),new I("clipboardDataManager.validateTTL validation failed",t,this.ttlInMs)}},e.prototype.validateUserHash=function(e){if(e&&e.ccp_infra_user_hash!==this.userHash)throw n().ULS.traceTag(595723670,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"clipboardDataManager.validateUserHash: user hash mismatch detected. throw error"),new T("clipboardDataManager.validateUserHash validation failed",e?e.ccp_infra_user_hash:0,this.userHash)},e.prototype.setMetaDataVersionItem=function(e){if(0!==me(e)){e.setItem(ce,JSON.stringify({ccp_infra_version:3}))}},e.prototype.validateMetaDataVersionItem=function(e){if(e&&me(e)>0){var t=ge(e.getData(),ce),r=void 0;try{r=JSON.parse(t)}catch(e){if(!this.blockMismatchDataVersion)return;throw n().ULS.traceTag(595899272,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"clipboardDataManager.validateMetaDataVersionItem: failed parse SignatureMetaData. error = ".concat(e)),new W("ClipboardDataManagerImpl.validateMetaDataVersionItem: failed parse SignatureMetaData. SignatureMetaData text = ".concat(t))}if(this.blockMismatchDataVersion&&3!==r.ccp_infra_version)throw n().ULS.traceTag(595899203,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"clipboardDataManager.validateMetaDataVersionItem: block mismatch version. dataVer = ".concat(r.ccp_infra_version,", CCPInfraVersion = ").concat(3)),new P("ClipboardDataManagerImpl.validateMetaDataVersionItem",r.ccp_infra_version,3,this.blockMismatchDataVersion)}},e.prototype.createClipboardDataProcessor=function(e){var t=this;return n().ULS.traceTag(595723671,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"clipboardDataManager.createClipboardDataProcessor: get called. validateUserHash=".concat(e)),{preSetProcess:this.ensureDataSignatureInHtmlItem.bind(this),postGetProcess:function(r){if(n().ULS.traceTag(595723672,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"clipboardDataManager.createClipboardDataProcessor.postGet: get called. validateUserHash=".concat(e)),r){var a=t.extractSignatureData(r.getData());n().ULS.traceTag(595723673,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"clipboardDataManager.createClipboardDataProcessor.postGet: clipboardItems not empty. validateUserHash=".concat(e)),a&&r.setItem(le,a.ccp_infra_copy_id),t.validateTTL(a),e&&(n().ULS.traceTag(595723674,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"clipboardDataManager.createClipboardDataProcessor.postGet: going to validate user hash. validateUserHash=".concat(e)),t.validateUserHash(a))}}.bind(this)}},e.prototype.createDualClipboardDataProcessor=function(e){var t=this;return n().ULS.traceTag(595723675,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"clipboardDataManager.createDualClipboardDataProcessor: get called."),{preSetProcess:this.ensureDataSignatureInHtmlItem.bind(this),postGetProcess:function(e){n().ULS.traceTag(595723676,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"clipboardDataManager.createDualClipboardDataProcessor.postGet: get called."),e&&e.clipboardItemsData&&(e.signatureData=t.extractSignatureData(e.clipboardItemsData),e.signatureData&&(e.clipboardItemsData.items[le]=e.signatureData.ccp_infra_copy_id),t.validateTTL(e.signatureData))}.bind(this),validateUserHash:e?this.validateUserHash.bind(this):function(){}}},e.prototype.createClipboardMetaDataProcessor=function(){return{preSetProcess:this.setMetaDataVersionItem.bind(this),postGetProcess:this.validateMetaDataVersionItem.bind(this)}},e.prototype.getRegExStringValue=function(e,t){var r=new RegExp(t,"g").exec(e);if(r&&r.length&&r.length>1)return r[1]},e.prototype.getRegExIntValue=function(e,t){var r=this.getRegExStringValue(e,t);if(r){var a=Number(r);return isNaN(a)?void 0:a}},e}(),mr=function(e){function r(t,r,a){var o=e.call(this,t,r,a,"WindowRPCClientInternal")||this;return o.pushMessageListeners={},o}return(0,t.__extends)(r,e),r.prototype.init=function(e){var t,r;return this.deferredResultMessagePromiseCache=new lt,this.sender=(t=this.serializer,new yt(t,this)),this.receiver=(r=this.deserializer,new St(r,this,this)),this.postInitMessage(e).catch((function(e){return n().ULS.traceTag(596129250,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"Init failure or timeout. Error: ".concat(o.P6.getStringifiedError(e))),g(e,c.IframeInitializationTimeout)?Promise.reject(e):Promise.reject(new N(c.IframeInitialization,"failed to init the Shared Clipboard",e))}))},r.prototype.registerPushMessageListener=function(e,t){this.pushMessageListeners[e]=t},r.prototype.postInitMessage=function(e){var t=Xe(dt,"init",Ye.initIframe);if(!this.deferredResultMessagePromiseCache){var r="RPC Client - postInitMessage: this.deferredResultMessagePromiseCache should be defined";return n().ULS.shipAssertTag(596121487,o.WN.msoulscat_ES_EWAJS,!1,r),Promise.reject(new _(r))}var a=this.postMessage(t),i=this.deferredResultMessagePromiseCache.getDeferredPromise(t.id),s=Date.now();return setTimeout((function(){if(i&&!i.fulfilled()){var e=Date.now(),t="initialization started on ".concat(new Date(s)," and timed out on ").concat(new Date(e)," after ").concat(e-s," ms");n().ULS.traceTag(596129251,o.WN.msoulscat_ES_EWAJS,o.Gu.Error,t),i.reject(new N(c.IframeInitializationTimeout,t))}}),e),a},r.prototype.postMessage=function(t){try{if(!t)throw new E(m,"outgoingMessage");if(n().ULS.shipAssertTag(596452175,o.WN.msoulscat_ES_EWAJS,!!t.id,"postMessage: outgoingMessage.id must be defined"),e.prototype.postMessage.call(this,t),!this.deferredResultMessagePromiseCache){var r="RPC Client - postMessage: this.deferredResultMessagePromiseCache should be defined";throw n().ULS.shipAssertTag(596121488,o.WN.msoulscat_ES_EWAJS,!1,r),new _(r)}return this.deferredResultMessagePromiseCache.addNewPromise(t.id).promise}catch(e){return Promise.reject(new _("Unable to post message for operation '".concat(t?t.operationCode:void 0,"'"),e))}},r.prototype.handleMessage=function(e){n().ULS.traceTag(596452376,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"RPC Client - handleMessage: incomingMessage.id='".concat(e&&e.id,"'; incomingMessage.operationCode='").concat(e&&e.operationCode,"'; incomingMessage.failed='").concat(e&&e.failed,"'; incomingMessage.error='").concat(e&&e.error,"'; incomingMessage.clipboardItems.length=").concat(pe(e&&e.clipboardItemsData)));var t=this.pushMessageListeners[e.operationCode];if(t)return t(e.clipboardItemsData),Promise.resolve();if(!this.deferredResultMessagePromiseCache){var r="RPC Client - handleMessage: this.deferredResultMessagePromiseCache should be defined";return n().ULS.shipAssertTag(596121489,o.WN.msoulscat_ES_EWAJS,!1,r),Promise.reject(new _(r))}var a="initresult"===e.operationCode?dt:e.id,i=this.deferredResultMessagePromiseCache.getDeferredPromise(a);return i?(this.deferredResultMessagePromiseCache.delete(a),e.failed?i.reject(e.error):i.resolve(e),Promise.resolve()):(n().ULS.traceTag(596452377,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,a===e.id?"RPC Client - handleMessage: no deferred promise with id '".concat(e.id,"'; dropping this result."):"RPC Client - handleMessage: no deferred promise with id '".concat(a,"' for message id '").concat(e.id,"'; dropping this result.")),Promise.resolve())},r.prototype.handleDeserializationError=function(e){return!e||"NoValidKeyError"!==e.errorName||this.deferredResultMessagePromiseCache&&0!==this.deferredResultMessagePromiseCache.getLength()?(n().ULS.traceTag(596452379,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"RPC Client - handleDeserializationError. There are ".concat(this.deferredResultMessagePromiseCache?this.deferredResultMessagePromiseCache.getLength():0," deferred promise(s) in the cache. Error: ").concat(o.P6.getStringifiedError(e))),Promise.resolve()):(n().ULS.traceTag(542687372,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"RPC Client - handleDeserializationError. Error: ".concat(o.P6.getStringifiedError(e))),Promise.resolve())},r.prototype.dispose=function(){var t=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(F([function(){t.deferredResultMessagePromiseCache&&t.deferredResultMessagePromiseCache.clear()}]),e.prototype.dispose.call(this))},r}(mt),fr=[],gr="load",hr="clipboard",Sr="clipboard/shared.aspx",yr="corrid",Cr={initialized:!1,origin:m,src:m,deferredPromise:void 0},br=void 0;function vr(){return Cr}function Er(){if(br){try{br()}catch(e){}br=void 0}}var wr=void 0;function _r(e){return wr||(wr=vr()),wr.initialized||(wr.origin=function(e){Ve();var t=ke(e),r=t.split(Me);if(!r||2!==r.length||!r[0]||!r[1])throw new w("Invalid origin","parentOrigin",e);var a=We(),i=m;if(a.whitelistOriginComponents){var s=r[0]+Me;if(!(r=r[1].split(Ue))||r.length<2||!r[0])throw new w("Invalid origin","parentOrigin",e);r.splice(0,1,a.sharedClipboardHostingApp),i=s+r.join(Ue)}else i=t;return n().ULS.traceTag(596452424,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"getSharedClipboardValidatedOrigin: app's origin = '".concat(e,"'; Shared Clipboard iframe origin = '").concat(i,"' components=").concat(JSON.stringify(r))),i}(e),wr.src=function(e){var t=vr().origin,r=t;"/"!==t.charAt(t.length-1)&&(r+="/"),r+=Sr,e&&(r+="?".concat(encodeURIComponent(ut),"=").concat(encodeURIComponent(e)));var a=[];fr.forEach((function(e){(0,xt.isChangeGateEnabled)(e)||a.push({key:e,value:"1"})}));var i=function(){if(!$t)throw new _("ClipboardPlatformSettings is not ready. Call ClipboardPlatformEnvironment.init(...).");return $t}();i&&(i.sessionId&&a.push({key:ve,value:i.sessionId}),i.bulsEndpointUrl&&a.push({key:be,value:i.bulsEndpointUrl}));var s=(0,o.A)(),c=s[0],l=s[1];return n().ULS.traceTag(595722560,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"getValidatedIframeSrc.getValidatedIframeSrc: Generate correlation if for loading the shared clipboard frame. CorrelationId: ".concat(c," newGuidLogging: ").concat(l)),a.push({key:yr,value:c}),a.push({key:"NoAuth",value:"true"}),a.length>0&&a.forEach((function(e){r+=r.indexOf("?")>=0?"&":"?",r+="".concat(encodeURIComponent(e.key),"=").concat(encodeURIComponent(e.value))})),r}(e),wr.initialized=!0),wr.origin}function Pr(){if(!wr)return Promise.reject("state in undefined, please make sure to call initialize first");var e=function(){if(!vr().initialized)throw new _("getIframe: the initialize function should be called beforehand");var e=document.getElementsByTagName("iframe");if(e&&0!==e.length){n().ULS.traceTag(595952723,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"getIframe: found ".concat(e.length," iframes"));for(var t=0;t<e.length;t+=1){var r=e[t];if(r&&r.id&&r.id===hr)return r}n().ULS.traceTag(595952724,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"getIframe: the CCP iframe does not exist")}else n().ULS.traceTag(595952722,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"getIframe: found no iframes")}();e&&(n().ULS.traceTag(596448770,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"ensureIframeWindow: The CCP iframe exists. Removing the iframe and re-adding it. iframe.src ".concat(void 0!==e.src&&void 0!==wr.src&&e.src.toLowerCase()===wr.src.toLowerCase()?"===":"!=="," src; deferredPromise ").concat(void 0===wr.deferredPromise?"does not exist":"exists","; The iframe's content window ").concat(void 0===e.contentWindow?"does not exist":"exists",".")),function(e){if(!e)throw new E(m,"iframe");n().ULS.traceTag(595952725,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"removeIframe: removing the CCP iframe"),Er(),e.parentNode&&e.parentNode.removeChild(e)}(e),e=void 0);var t=wr.deferredPromise,r=t?t.id:m;if(t){Er(),wr.deferredPromise=void 0;var a="ensureIframeWindow: the CCP iframe does not exist and the deferred promise of its content window should not exist as well. Rejecting deferred promise id '".concat(r,"' and creating a new one");n().ULS.shipAssertTag(596453587,o.WN.msoulscat_ES_EWAJS,!1,a),t.reject(new _(a)),t=void 0}wr.deferredPromise=ot(Ke()),r=(t=wr.deferredPromise).id;try{e=function(){var e=document.createElement("iframe");return e.style.display="none",e.id=hr,n().ULS.shipAssertTag(595952726,o.WN.msoulscat_ES_EWAJS,!br,"createIframe: the last shared clipboard iframe's onload event listener should have been removed. Removing it and registering a new event listener."),Er(),br=re(e,gr,(function(e){return function(e){n().ULS.traceTag(595952727,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CCP iframe onload event: Entering"),Er();var t=vr().deferredPromise;if(t){var r=t.id;try{vr().deferredPromise=void 0;var a=e.target;if(!a){var i="CCP iframe onload event: the CCP iframe should exist when its onload event is called. Rejecting deferred promise id '".concat(r,"'");return n().ULS.shipAssertTag(595952729,o.WN.msoulscat_ES_EWAJS,!1,i),void t.reject(new _(i))}if(!a.contentWindow)return i="CCP iframe onload event: the contentWindow of the CCP iframe does not exist. Rejecting deferred promise id '".concat(r,"'"),n().ULS.shipAssertTag(595952730,o.WN.msoulscat_ES_EWAJS,!1,i),void t.reject(new _(i));n().ULS.traceTag(595952732,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CCP iframe onload event: resolving deferred promise id '".concat(r,"' with the iframe")),t.resolve(a)}catch(e){i="iframeOnLoad: an error has occurred: [".concat(o.P6.getStringifiedError(e),"]. Rejecting deferred promise id '").concat(r,"'"),n().ULS.traceTag(595952733,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,i),t.reject(new _(i,e))}}else n().ULS.shipAssertTag(595952728,o.WN.msoulscat_ES_EWAJS,!1,"CCP iframe onload event: the CCP iframe does not have a matching deferred promise to notify subscribers when the iframe loaded")}(e)})),e.src=vr().src,e}(),document.getElementsByTagName("body")[0].appendChild(e)}catch(e){return a="ensureIframeWindow: unable to create and/or add a CCP iframe. Dropping tentative deferred promise id '".concat(r,"'"),n().ULS.traceTag(596453588,o.WN.msoulscat_ES_EWAJS,o.Gu.Error,a),wr.deferredPromise=void 0,Er(),Promise.reject(new _(a,e))}return t&&!t.fulfilled()?t.promise:(Er(),e.contentWindow?(wr.deferredPromise=void 0,Promise.resolve(e)):(n().ULS.shipAssertTag(596453589,o.WN.msoulscat_ES_EWAJS,!1,"ensureIframeWindow: the iframe's content window should exist. Deferred promise id = '".concat(r,"'")),Promise.reject(new _("ensureIframeWindow: the iframe's content window should exist. Deferred promise id = '".concat(r,"'")))))}var Ir,Tr;function Wr(){if(Tr)return Tr.promise;Tr=ot(Ke());try{var e=_r(Le().origin);Ir=function(e,t){return new mr(function(e){if(!e)throw new E(m,"validator");return{serialize:function(t){return function(e,t){if(!e)throw new E(m,"outgoingMessage");if(!t)throw new E(m,"validator");return t(e),function(e){var t;try{t=JSON.stringify(e)}catch(t){throw new w("Serialization failed","outgoingMessage","".concat(Object.keys(e).length," properties"),t)}return n().ULS.traceTag(596452375,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"The length of the serialized message is ".concat(t.length)),t}(e)}(t,e)}}}(Ze),function(e){if(!e)throw new E(m,"validator");return{deserialize:function(t){return function(e,t){if(!e)throw new E(m,"incomingMessage");if(!t)throw new E(m,"validator");if(0===e.length)throw new w("An empty message is invalid","incomingMessage");var r,a=e.trim();if(0===a.length)throw new w("A message cannot contain only spaces","incomingMessage");try{r=JSON.parse(a)}catch(t){throw new w("Deserialization failed","incomingMessage","Contains ".concat(e.length.toString()," characters"),t)}if(!r)throw new w("Deserialization returned nothing","incomingMessage");return t(r),r}(t,e)}}}(et),{window:void 0,windowOrigin:e})}(e),o.P6.retry((function(e,t){return function(e,t){if(!Ir){var r="clipboardIframeLoader::initializeIframe - windowRPCClient should be defined";return n().ULS.shipAssertTag(595947544,o.WN.msoulscat_ES_EWAJS,!1,r),Promise.reject(new _(r))}var a=o.c6.start("Iframe_initialize_".concat(e));o.c6.mark(a,"start"),Ir.remoteWindow.window=void 0;var i=function(r){var i=g(r,c.IframeInitializationTimeout)?" due to a timeout of approx. ".concat(t," ms"):m;o.c6.mark(a,"finish_error"),o.c6.failure(a,(function(e){return n().ULS.traceTag(596452419,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,e)}),"Attempt #".concat(e," failed to initialize an iframe ").concat(i,". ").concat(e<3?"Retrying...":"No more retries!",". Error: ").concat(o.P6.getStringifiedError(r)))},s=ot();return Pr().then((function(r){if(o.c6.mark(a,"iframe_loaded"),o.c6.mark(a,"iframe_waiting_for_idb_init"),!Ir){var s="clipboardIframeLoader::initializeIframe - windowRPCClient should be defined";n().ULS.shipAssertTag(595947545,o.WN.msoulscat_ES_EWAJS,!1,s);var c=new _(s);return i(c),Promise.reject(c)}return r.contentWindow?(Ir.remoteWindow.window=r.contentWindow,Ir.init(t).then((function(){return o.c6.mark(a,"iframe_idb_init_complete"),o.c6.mark(a,"finish"),o.c6.success(a,(function(e){return n().ULS.traceTag(596452418,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,e)}),"Attempt #".concat(e," initialized iframe")),Promise.resolve()}))):(s="clipboardIframeLoader::initializeIframe - remoteWindow.contentWindow should be defined",n().ULS.shipAssertTag(595903557,o.WN.msoulscat_ES_EWAJS,!1,s),c=new _(s),i(c),Promise.reject(c))})).then((function(){s.resolve()}),(function(e){i(e),s.reject(e)})),s.promise}(e,2e4+(g(t,c.IframeInitializationTimeout)?5e3:0)*(e-1))}),3).then((function(){Tr.resolve(Ir)}),(function(e){Tr.reject(e)}))}catch(e){Tr.reject(e)}return Tr.promise}var Ar=function(){function e(){this.initialized=!1}return e.prototype.innerInitialize=function(){var e=this;return Wr().then((function(t){return e.initialized=!0,e.windowRPCClient=t,e}))},e.prototype.registerPushMessageListener=function(e,t){this.windowRPCClient&&this.windowRPCClient.registerPushMessageListener(e,t)},e.prototype.postMessage=function(e,t){if(!this.initialized)return Promise.reject(new N(c.IframeInitialization));var r=o.c6.start("BaseIframeProxy_".concat(t));o.c6.mark(r,"start");var a=function(e){return o.c6.mark(r,"finish_error"),o.c6.failure(r,(function(e){return n().ULS.traceTag(596452188,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,e)}),"Failed in BaseIframeProxy.postMessage. Error: ".concat(o.P6.getStringifiedError(e))),Promise.reject(new N(c.IframeProxyGeneralError,"Failed in BaseIframeProxy.postMessage",e))};if(!this.windowRPCClient){var i="BaseIframeProxy.postMessage - this.windowRPCClient should be defined";return n().ULS.shipAssertTag(595944461,o.WN.msoulscat_ES_EWAJS,!1,i),a(new _(i))}return this.windowRPCClient.postMessage(e).then((function(e){return n().ULS.shipAssertTag(595944462,o.WN.msoulscat_ES_EWAJS,!!e,"BaseIframeProxy.postMessage: postMessage must have returned a result message"),e?e.failed?Promise.reject(new N(c.IframeProxyGeneralError,"BaseIframeProxy.postMessage: the operation failed. Error: ".concat(e.error))):(o.c6.mark(r,"finish"),o.c6.success(r,(function(e){return n().ULS.traceTag(596452187,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,e)})),Promise.resolve(e)):Promise.reject(new N(c.IframeProxyEmptyResultMessage,"BaseIframeProxy.postMessage: postMessage succeeded but returned nothing"))})).catch((function(e){return a(e)}))},e}(),Lr=function(){function e(e){this.localStorageKey=e}return e.prototype.initialize=function(e){var t=this;return new Lt(this.localStorageKey,e,(function(e){t._onMetadataChangedListener&&t._onMetadataChangedListener(e)})),Promise.resolve()},e.prototype.setOnMetadataChangedListener=function(e){n().ULS.traceTag(595716297,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"LocalStorageKeyTrackerMetadataWatcher.setOnMetadataChangedListener: start setOnMetadataChangedListener"),n().ULS.shipAssertTag(595716298,o.WN.msoulscat_ES_EWAJS,!!e,"LocalStorageKeyTrackerMetadataWatcher.setOnMetadataChangedListener: expect listener to be defined."),this._onMetadataChangedListener=e},e}(),xr=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),r.prototype.initialize=function(t){var r=this;return e.prototype.innerInitialize.call(this).then((function(){r.registerPushMessageListener("getMetadata_longPollingresult",(function(e){r._onMetadataChangedListener&&r._onMetadataChangedListener(fe(e))}))}))},r.prototype.setOnMetadataChangedListener=function(e){n().ULS.traceTag(595730647,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"LongPollingMetadataWatcher.setOnMetadataChangedListener: start setOnMetadataChangedListener"),n().ULS.shipAssertTag(595944466,o.WN.msoulscat_ES_EWAJS,!!e,"LongPollingMetadataWatcher.setOnMetadataChangedListener: expect listener to be defined."),this._onMetadataChangedListener=e},r}(Ar),Dr=function(e){function r(t){return e.call(this,s.SystemClipboard,{browserStorage:!1,systemClipboard:!0,inMemory:!1},t)||this}return(0,t.__extends)(r,e),r}(rt),Mr=!0;function Nr(){return Mr}function Fr(){Mr=!1}var Ur=!0;function Or(){return Ur}function Gr(){Ur=!1}function Rr(){var e=void 0;try{e=window.clipboardData}catch(e){n().ULS.traceTag(595985225,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"ieSystemClipboard.getDataTransfer: An error occurred when attempting to access window.clipboardData. Error: ".concat(o.P6.getStringifiedError(e)))}return e}function Jr(){if(n().ULS.shipAssertTag(596455701,o.WN.msoulscat_ES_EWAJS,z(),"The browser must be IE"),!z())throw new _("The browser must be IE")}function kr(e){return!!e}function jr(e){if(e){var t=void 0;try{t=e.clipboardData}catch(e){throw n().ULS.traceTag(595985224,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"systemClipboard.getDataTransfer: An error occurred when attempting to access rawEvent.clipboardData. Error: ".concat(o.P6.getStringifiedError(e))),e}return t}n().ULS.traceTag(596456320,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"A clipboard event parameter is missing")}function zr(e,t,r,a){var i=!1;try{var s=jr(r);if(!s||!kr(s))return n().ULS.traceTag(596456264,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"setData - programmatic ".concat(Y," and ").concat(Z," is broken. There is no valid data transfer object. clipboardDataFormat = '").concat(e,"'")),!1;!1===(i=s.setData(e,t))&&n().ULS.traceTag(596456265,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"setData returned false for '".concat(e,"'."))}catch(t){n().ULS.traceTag(596456266,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"setData with '".concat(e,"' threw an exception: ").concat(o.P6.getStringifiedError(t)))}return void 0===i&&(i=!0),i}function Hr(e,t,r,a){if(Jr(),!a&&!Nr()&&!Or())return n().ULS.traceTag(596456269,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"setData - programmatic ".concat(Y," and ").concat(Z," clipboard access is not supported. rawEvent is empty = ").concat(!!r)),!1;var i=Rr();if(!i||!kr(i))return n().ULS.traceTag(596456270,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"setData - ".concat(Y," and ").concat(Z," is broken. There is no valid global data transfer object. Do not try again to fetch it. clipboardDataFormat = '").concat(e,"'")),a||(n().ULS.shipAssertTag(596456271,o.WN.msoulscat_ES_EWAJS,Nr()&&Or(),"setData - programmatic ".concat(Y," and ").concat(Z," is broken because the global data transfer object was previously available and now it's not available. isBeforeFirstProgrammaticAccess = '").concat(Nr(),"'. isProgrammaticAccessSupported = '").concat(Or(),"'. clipboardDataFormat = '").concat(e,"'")),Fr(),Gr()),!1;var s,c=e;c===ae&&(c=oe);try{!1===(s=i.setData(c,t))&&n().ULS.traceTag(596456272,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"setData returned false for '".concat(c,"'."))}catch(e){n().ULS.traceTag(596456273,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"setData with '".concat(c,"' threw an exception: ").concat(e.message))}return!a&&Nr()&&(Fr(),!1===s&&Gr()),void 0===s&&(s=!0),s}function Vr(){return Nr()&&Hr(ae,m,void 0,!1),!!Or()||(n().ULS.traceTag(596456274,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"document.execCommand - programmatic clipboard access is not allowed for '".concat(Y,"' and '").concat(Z,"'.")),!1)}var Br={execCommandCopy:function(){var e;try{e=document.execCommand(Y,!1,null)}catch(e){n().ULS.traceTag(596456262,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"document.execCommand('".concat(Y,"') threw an exception. This is a browser bug. Ignoring. Exception: ").concat(e.message))}return void 0===e&&(e=!0),e},execCommandCut:function(){var e;try{e=document.execCommand(Z,!1,null)}catch(e){n().ULS.traceTag(596456263,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"document.execCommand('".concat(Z,"') threw an exception. This is a browser bug. Ignoring. Exception: ").concat(e.message))}return void 0===e&&(e=!0),e},setData:zr,defaultClipboardDataFormat:ae},Kr={execCommandCopy:function(){if(Jr(),!Vr())return!1;try{document.execCommand(Y,!1,null)}catch(e){n().ULS.traceTag(596456267,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"document.execCommand('".concat(Y,"') threw an exception. This is a browser bug. Ignoring. Exception: ").concat(e.message))}return!0},execCommandCut:function(){if(Jr(),!Vr())return!1;try{document.execCommand(Z,!1,null)}catch(e){n().ULS.traceTag(596456268,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"document.execCommand('".concat(Z,"') threw an exception. This is a browser bug. Ignoring. Exception: ").concat(e.message))}return!0},setData:Hr,defaultClipboardDataFormat:oe},qr=void 0;function $r(e,t,r,a){return Xr().setData(e,t,r,a)}function Xr(){return void 0===qr&&(qr=Br),qr}z()&&(qr=Kr);var Yr="command",Zr="getClipboardData",Qr="getAvailableCommands",ea=void 0,ta={};function ra(){if(void 0===ea&&(ea=!1,"chrome"in window)){var e=window.chrome;e&&("runtime"in e&&e.runtime?"sendMessage"in e.runtime&&e.runtime.sendMessage?ea=!0:n().ULS.traceTag(596455703,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"chrome.runtime.sendMessage is not available"):n().ULS.traceTag(596455704,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"chrome.runtime is not available"))}return ea}function aa(e){if(!e||!e.items)return Promise.reject(new D(d.ClipboardIsInaccessible,"getImageDataUrlFromClipboardData: clipboardData is undefined=".concat(!e," clipboardData.items is undefined=").concat(!e.items)));for(var t=0;t<e.items.length;t+=1){var r=e.items[t].type&&e.items[t].type.startsWith("image");if(r||n().ULS.traceTag(528859143,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"Non-image type read from System Clipboard. File Type is "+e.items[t].type),"file"===e.items[t].kind&&r)return oa(e.items[t].getAsFile())}return Promise.resolve(m)}function oa(e){var t=o.c6.start("ImageFile_Read_From_Clipboard"),r=e?e.size:-1,a=ot(),i=new FileReader;return i.onload=function(){i.result?(o.c6.success(t,(function(e){return n().ULS.traceTag(595911452,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,na(e,r))})),a.resolve(i.result.toString())):(o.c6.failure(t,(function(e){return n().ULS.traceTag(595911453,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,na(e,r))})),a.reject(new D(d.FileReaderResultIsEmpty,"getImageDataUrlFromClipboardData: FileReader result is null or undefined")))},i.onerror=function(){o.c6.failure(t,(function(e){return n().ULS.traceTag(595911454,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,na(e,r))})),a.reject(new D(d.FileReaderFailed,"getImageDataUrlFromClipboardData: FileReader failed"))},o.c6.mark(t,"Starting_readAsDataURL"),i.readAsDataURL(e),a.promise}function na(e,t){var r=JSON.parse(e);return r.filesize=t,JSON.stringify(r)}function ia(e,t,r){if(Jr(),!r&&!Nr()&&!Or())return n().ULS.traceTag(596456327,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"getData - programmatic ".concat(Q," clipboard access is not supported. rawEvent is empty = ").concat(!!t)),Promise.resolve(m);var a=Rr();if(!a||!kr(a))return n().ULS.traceTag(596456328,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"getData - ".concat(Q," is broken. There is no valid global data transfer object. Do not try again to fetch it. clipboardDataFormat = '").concat(e,"'")),r||(n().ULS.shipAssertTag(596456329,o.WN.msoulscat_ES_EWAJS,Nr()&&Or(),"getData - programmatic ".concat(Q," is broken because the global data transfer object was previously available and now it's not available. isBeforeFirstProgrammaticAccess = '").concat(Nr(),"'. isProgrammaticAccessSupported = '").concat(Or(),"'. clipboardDataFormat = '").concat(e,"'")),Fr(),Gr()),Promise.resolve(m);var i=e;i===ae&&(i=oe);var s=m;try{(s=a.getData(i))||(s=m),n().ULS.traceTag(596456330,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"getData('".concat(i,"') returned ").concat(s.length," characters"))}catch(e){n().ULS.traceTag(596456331,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"getData with '".concat(i,"' threw an exception. This is a browser bug. Ignoring. Exception: ").concat(e.message))}if(!r&&Nr()&&(Fr(),s===m)){if(zr(e," ",void 0))return ia(e,void 0,!1).then((function(t){return t===m?Gr():zr(e,m,void 0),Promise.resolve(s)}));Gr()}return Promise.resolve(s)}var sa={init:function(){},execCommandPaste:function(){var e;try{e=document.execCommand(Q,!1,null)}catch(e){n().ULS.traceTag(596456322,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"document.execCommand('".concat(Q,"') threw an exception. This is a browser bug. Ignoring. Exception: ").concat(e.message))}return void 0===e&&(e=!0),e},getData:function(e,t,r){var a=m;try{var i=jr(t);if(!i||!kr(i))return Promise.resolve(a);if(e===ie)return aa(i);(a=i.getData(e))||(a=m),n().ULS.traceTag(596456323,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"getData('".concat(e,"') returned ").concat(a.length," characters"))}catch(t){n().ULS.traceTag(596456324,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"getData with '".concat(e,"' threw an exception. This is a browser bug. Ignoring. Exception:: ").concat(o.P6.getStringifiedError(t)))}return Promise.resolve(a)},browserExtensionPaste:function(){return Promise.reject(new N(c.NoBrowserExtensionsInConfiguration))}},ca={init:function(){},execCommandPaste:function(){if(Jr(),Nr()&&ia(ae,void 0,!1),!Or())return n().ULS.traceTag(596456325,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"document.execCommand - programmatic clipboard '".concat(Q,"' access is not allowed in this session.")),!1;try{document.execCommand(Q,!1,null)}catch(e){n().ULS.traceTag(596456326,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"document.execCommand('".concat(Q,"') threw an exception. This is a browser bug. Ignoring. Exception: ").concat(e.message))}return!0},getData:ia,browserExtensionPaste:function(){return Promise.reject(new N(c.NoBrowserExtensionsInConfiguration))}},la={init:function(){!function(){var e=Ba().getChromeExtensionIds();if(0!==e.length){var t={};t[Yr]=Qr,e.forEach((function(e){window.chrome.runtime.sendMessage(e,t,void 0,(function(t){var r=window.chrome.runtime.lastError;if(t&&Array.isArray(t)&&0!==t.length&&!r)ta[e]=t;else{var a=m;r&&"message"in r&&"string"==typeof r.message&&(a=r.message),n().ULS.traceTag(589947074,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"chromeSystemClipboard - '".concat(Qr,"': browser extension '").concat(e,"' is not available. Error: ").concat(a))}}))}))}}()},execCommandPaste:function(){var e=!1;try{void 0===(e=document.execCommand(Q,!1,null))&&(e=!0)}catch(e){n().ULS.traceTag(596455698,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"Chrome: document.execCommand('".concat(Q,"') threw an exception. This is a browser bug. Ignoring. Exception: ").concat(e.message))}return e},getData:function(e,t,r){var a=m;try{var i=jr(t);if(!i||!kr(i))return Promise.resolve(a);if(e===ie)return aa(i);(a=i.getData(e))||(a=m),n().ULS.traceTag(596455699,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"Chrome: getData('".concat(e,"') returned ").concat(a.length," characters"))}catch(t){n().ULS.traceTag(596455700,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"Chrome: getData with '".concat(e,"' threw an exception. This is a browser bug. Ignoring. Exception:: ").concat(o.P6.getStringifiedError(t)))}return Promise.resolve(a)},browserExtensionPaste:function(){return function(){if(!ra())return Promise.reject(new N(c.MissingBrowserExtensionCapability));var e=function(){for(var e in ta)if(ta[e].includes(Zr))return e;return null}();if(!e)return Promise.reject(new N(c.NoBrowserExtensionWithGetClipboardDataCommand));var t={};return t[Yr]="getClipboardData",function(e,t){return new Promise((function(r,a){var i=!0;window.chrome.runtime.sendMessage(e,t,void 0,(function(t){var o=window.chrome.runtime.lastError;if(!t||"object"!=typeof t||Array.isArray(t)||o){i=!1;var n=m;o&&"message"in o&&"string"==typeof o.message&&(n=o.message),a(new N(c.UnavailableBrowserExtension,"chromeSystemClipboard - '".concat(Zr,"': browser extension '").concat(e,"' is not available. Error: ").concat(n)))}else{i=!1;var s=t,l=s.html,d=s.img,u=s.text,p=function(e,t,r){var a=!!e,o=!!t,n=!!r,i=e.includes("<img src=");return o&&!n||o&&a&&i}(l,d,u);r({text:u,html:p?d:l})}})),setTimeout((function(){i&&(n().ULS.traceTag(589947076,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"chromeSystemClipboard - getPasteWithExtensionPromise reject the promise after timeout. chromeExtenstionsInfo: '".concat(ta,"'")),a(new N(c.UnavailableBrowserExtension,"chromeSystemClipboard - '".concat(Zr,"': browser extension '").concat(e,"' is not available. Timeout after : ").concat(2e3," ms"))))}),2e3)}))}(e,t).then((function(t){if(!t)return Promise.reject(new N(c.NoAvailableBrowserExtensions));n().ULS.traceTag(589947075,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"chromeSystemClipboard - paste by browser extension '".concat(e,"'"));var r=fe();return r.setItem(ae,t.text),r.setItem(ne,t.html),r.setItem("metadata/chrome-extension-id",e),r}))}()}},da=void 0;function ua(){return void 0===da&&(da=ra()?la:sa),da}z()&&(da=ca);var pa,ma=r(9506),fa=function(e,t){if(ha(e))e.replaceChildren(t);else{for(;e.firstChild;)e.removeChild(e.firstChild);ga(e,t)}},ga=function(e,t){if(Sa(e))e.append(t);else if("string"==typeof t){var r=document.createTextNode(t);e.appendChild(r)}else e.appendChild(t)},ha=function(e){return!!e.replaceChildren},Sa=function(e){return!!e.append},ya="ccpContentEditable";function Ca(){var e=document.getSelection();if(e&&e.getRangeAt&&"function"==typeof e.getRangeAt&&!(e.rangeCount<1))return e.getRangeAt(0)}function ba(e,t,r){void 0===r&&(r=void 0),n().ULS.shipAssertTag(596444114,o.WN.msoulscat_ES_EWAJS,!1===t&&!r||!0===t&&(!!r||r===m),"enableClipboardEvents: useTextHtmlContentCandidate = '".concat(t,"', textHtmlContentCandidate is ").concat(r||r===m?m:"not ","provided"));var a=document.activeElement&&document.activeElement.id;a||n().ULS.traceTag(595719625,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"hiddenContentEditableDiv.enableClipboardEvents: activeElementIdToRestore must to be define");var i=function(e,t){var r=wa();if(r&&r.tagName&&"div"!==r.tagName.toLowerCase()&&(r.parentElement&&r.parentElement.removeChild(r),r=void 0),r||(r=function(){var e=document.createElement("div");return function(e){e.id=ya,e.contentEditable="true",Ia()&&(e.contentEditable="false"),e.spellcheck=!1,e.setAttribute("autocomplete","off"),e.setAttribute("autocorrect","off"),e.setAttribute("autocapitalize","off"),e.setAttribute("aria-hidden","true"),e.tabIndex=-1,e.style.display="inline-block",e.style.position="absolute",e.style.fontSize="10",e.style.height="0px",e.style.width="0px",e.style.top="0px",e.style.left="0px",e.style.zIndex="-100",e.style.overflow="hidden",e.onmousemove=function(){e.onmousemove=null,n().ULS.assertTag(595957699,o.WN.msoulscat_ES_EWAJS,!1,"contentEditableElement.onmousemove: Mouse move event is not expected on element '".concat(ya,"'. it should be covered by other elements"))}}(e),document.body.appendChild(e),e}()),z()){var a=t;e?a||(a=m):a=Pa().outerHTML,r.innerHTML=ma.sanitize(a)}else fa(r,e?null!=t?t:m:Pa());return r}(t,r);a&&a===i.id&&(a=void 0),i.focus();var s=document.getSelection();if(s){s.removeAllRanges();var c=document.createRange();c.selectNodeContents(i),s.addRange(c)}return e&&va(!0),a}function va(e){if(Ia()){var t=wa();t&&(t.contentEditable=e?"true":"false")}}function Ea(){var e=wa();if(!e)return!1;try{var t=e.clientLeft+e.scrollWidth/2,r=e.clientTop+e.scrollTop/2,a=document.elementFromPoint(t,r);return!!a&&(a.id===e.id||!!a.parentElement&&a.parentElement.id===e.id)}catch(e){return n().ULS.traceTag(595957534,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"isContentEditableElementVisibleToUser: hit test failed with error: ".concat(o.P6.getStringifiedError(e))),!1}}function wa(){return document.getElementById(ya)}function _a(){var e=wa();e&&(z()?e.innerHTML=ma.sanitize(Pa().outerHTML):fa(e,Pa()))}function Pa(){var e=document.createElement("span");return e.innerText=f,e}function Ia(){return!z()}var Ta=function(e,t){return void 0===t&&(t=!1),pa?pa.getBooleanFeatureGate(e,t):t},Wa=function(){function e(e){this.lastDeferredCutCopyPromise=void 0,this.removeLastCutCopyEventListenerCallback=void 0,this.lastDeferredPastePromise=void 0,this.selectedRangeToRestore=void 0,this.removeLastPasteEventListenerCallback=void 0,this.activeElementIdToRestore=void 0,this.skipFilesIfPlainTextExists=e,this.clipboardStorageType=B.SystemClipboard,this.disposableImplementationExtension=tt("SystemClipboardStorage"),ua().init()}return e.prototype.get=function(e){var t=this;if(this.disposableImplementationExtension.throwIfDisposed("get"),n().ULS.traceTag(596449096,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"SystemClipboardStorage.get: isKeyboardEvent = '".concat(e.isKeyboardEvent,"'")),e.skipSystemClipboardAccess){n().ULS.traceTag(596124883,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"SystemClipboardStorage.get: Skipping system clipboard access");var r=re(document,te,(function(e){return t.skipSystemClipboardPasteHandler(e,r)}),!0);return this.removeLastPasteEventListenerCallback=r,Promise.resolve(ue())}if(this.lastDeferredPastePromise&&!this.lastDeferredPastePromise.fulfilled()){var a=this.lastDeferredPastePromise,i="There exists a pending deferred promise with id '".concat(a.id,"', representing an active ").concat(Q," event. Scheduling a rejection to execute after the current operation.");n().ULS.traceTag(596455680,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,i),window.setTimeout((function(){a.reject(new N(c.RejectingPendingPastePromiseDueToNewPasteOperation,i))}),0)}this.clearPasteCallbackConfiguration(this.lastDeferredPastePromise,!0,!1);var s=ot();this.lastDeferredPastePromise=s;var l=s.id,d=re(document,te,(function(r){return t.pasteHandler(r,s,e.isKeyboardEvent,d)}),!0);this.removeLastPasteEventListenerCallback=d,this.selectedRangeToRestore=Ca(),this.activeElementIdToRestore=ba(!0,!1);try{var u=!1;if(e.isKeyboardEvent||(u=ua().execCommandPaste()),e.isKeyboardEvent);else if(!u)return this.clearPasteCallbackConfiguration(s,!0,!0),e.isAsyncSystemClipboardEnabled&&Ta("Microsoft.Office.Excel.EnableAsyncClipboardApiWithExtensionRemoval",!1)?Promise.reject(new N(c.ClipboardIsInaccessible,"Reject the Promise if not keyboard event in SystemClipboardStorage.get. Deferred promise id = '".concat(l,"'"))):ua().browserExtensionPaste().then((function(r){return(0,xt.isChangeGateEnabled)("OfficeVSO:8362261_IsChromiumExtPasteTelemetryEnabled")&&(e.isChromiumExtension=!0),e.clearSystemClipboard&&t.clearSystemClipboard(),r}),(function(r){return e.clearSystemClipboard&&t.clearSystemClipboard(),Promise.reject(new N(c.ClipboardIsInaccessible,"document.execCommand(".concat(Q,") failed in SystemClipboard.get. Deferred promise id = '").concat(l,"'"),r))}))}catch(e){return this.clearPasteCallbackConfiguration(s,!0,!1),Promise.reject(new N(c.GetClipboardItems,"Failed in SystemClipboard.get. Deferred promise id = '".concat(l,"'"),e))}return s.promise.then((function(r){return e.clearSystemClipboard&&t.clearSystemClipboard(),r}),(function(r){return e.clearSystemClipboard&&t.clearSystemClipboard(),g(r,c.RejectingPendingPastePromiseDueToNewPasteOperation)?Promise.reject(r):Promise.reject(new N(c.GetClipboardItems,"Failed in SystemClipboard.get. Deferred promise id = '".concat(l,"'"),r))}))},e.prototype.set=function(t,r){var a=this;if(this.disposableImplementationExtension.throwIfDisposed("set"),n().ULS.traceTag(596449097,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"SystemClipboardStorage.set: isKeyboardEvent = '".concat(r.isKeyboardEvent,"'; cutCopyPasteFlags = '").concat(r.commandType,"'")),n().ULS.shipAssertTag(595932513,o.WN.msoulscat_ES_EWAJS,!r.skipSystemClipboardAccess,"SystemClipboardStorage.set: skipSystemClipboardAccess shouldn't be used using set of SystemClipboardStorage as we have to set the timestamp metadata in the html in order to support last copy item scenario. "),z()&&!r.isKeyboardEvent){if(r.silentClipboardAccessFailures&&Nr())return n().ULS.traceTag(596455681,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"Aborting attempt to store content in the clipboard since silentClipboardAccessFailures is on and the user did not select Allow access in IE's clipboard access dialog"),Promise.resolve();if(!Nr()&&!Or())return n().ULS.traceTag(596455682,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"Aborting attempt to store content in the clipboard since the user selected Dont Allow in IE's clipboard access dialog. Use the active selection."),Promise.resolve()}if(this.lastDeferredCutCopyPromise&&!this.lastDeferredCutCopyPromise.fulfilled()){var i=this.lastDeferredCutCopyPromise,s="There exists a pending deferred promise with id '".concat(i.id,"', representing an active ").concat(Z,"/").concat(Y," event. Scheduling a rejection to execute after the current operation.");n().ULS.traceTag(596455683,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,s),window.setTimeout((function(){i.reject(new N(r.isKeyboardEvent?c.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation:c.RejectingBlockedSyncCutCopyPromise,s))}),0)}this.clearCutCopyCallbackConfiguration(this.lastDeferredCutCopyPromise,!0,!1);var l=ot();this.lastDeferredCutCopyPromise=l;var d=l.id;try{var u=ye(t),p=e.getClipboardCutCopyEventType(r.commandType),f=re(document,p,(function(e){r.isTimestampStoredInSystemClipboard=!0,a.cutCopyHandler(e,l,u,r.isKeyboardEvent,r.commandType,f)}));this.removeLastCutCopyEventListenerCallback=f;var g=m;z()&&(g=he(u,ne)),this.selectedRangeToRestore=Ca(),this.activeElementIdToRestore=ba(!1,!!g,g);var S=!1;if(z()&&r.isKeyboardEvent||(S=r.commandType===K.Cut?Xr().execCommandCut():Xr().execCommandCopy()),r.isKeyboardEvent);else if(!S)return this.clearCutCopyCallbackConfiguration(l,!0,!0),!z()||Nr()||Or()||(n().ULS.traceTag(596455684,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"Aborting attempt to store content in the clipboard since the user selected Dont Allow in IE's clipboard access dialog. Use the active selection. Deferred promise id = '".concat(d,"'")),l.resolve()),Promise.resolve()}catch(e){return this.clearCutCopyCallbackConfiguration(l,!0,!1),Promise.reject(new N(c.SetClipboardItems,"Failed in SystemClipboard.set. Deferred promise id = '".concat(d,"'"),e))}return l.promise.catch((function(e){return e&&h(e,[c.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation,c.RejectingBlockedSyncCutCopyPromise])?Promise.reject(e):Promise.reject(new N(c.SetClipboardItems,"Failed in SystemClipboard.set. Deferred promise id = '".concat(d,"'"),e))}))},e.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[ae,ne,ie]},e.prototype.cutCopyHandler=function(e,t,r,a,i,s){var l=this;try{if(n().ULS.traceTag(596449098,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"SystemClipboardStorage.cutCopyHandler: isKeyboardEvent = '".concat(a,"'; cutCopyPasteFlags = '").concat(i,"'; bubbles = '").concat(e.bubbles,"'; eventPhase = '").concat(e.eventPhase,"'")),s(),this.removeLastCutCopyEventListenerCallback===s&&(this.removeLastCutCopyEventListenerCallback=void 0),this.disposableImplementationExtension.logIfDisposed("cutCopyHandler"))return;if(n().ULS.shipAssertTag(596455686,o.WN.msoulscat_ES_EWAJS,!!t,"SystemClipboardStorage.cutCopyHandler: the deferred promise parameter is missing. isKeyboardEvent = '".concat(a,"'; cutCopyPasteFlags = '").concat(i,"'")),!t)return;if(n().ULS.traceTag(596455687,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"SystemClipboardStorage.cutCopyHandler: isKeyboardEvent = '".concat(a,"'; cutCopyPasteFlags = '").concat(i,"'; deferred promise id = '").concat(t.id,"'")),n().ULS.shipAssertTag(596455688,o.WN.msoulscat_ES_EWAJS,!t.fulfilled(),"SystemClipboardStorage.cutCopyHandler: deferred promise '".concat(t.id,"' is already fulfilled. isKeyboardEvent = '").concat(a,"'; cutCopyPasteFlags = '").concat(i,"'")),t.fulfilled())return;var d=function(){t.resolve(),l.clearCutCopyCallbackConfiguration(t,!1,!1)},u=he(r,ne);if(u&&z())window.setTimeout(d,0);else{u&&$r(ne,u,e,a);var p=Se(r);$r(Xr().defaultClipboardDataFormat,p,e,a),e.preventDefault(),d()}}catch(e){this.clearCutCopyCallbackConfiguration(t,!1,!1),n().ULS.traceTag(596455689,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"SystemClipboardStorage.cutCopyHandler callback with deferred promise id '".concat(t?t.id:m,"' (fulfilled = '").concat(t?t.fulfilled():m,"') failed with this exception: ").concat(e&&e.message?e.message:"NA",". Call stack: ").concat(e.stack?e.stack:"NA")),t&&t.reject(new N(c.SetClipboardItems,"Failed in SystemClipboard.set > cutCopyHandler callback. Deferred promise id = '".concat(t.id,"'. Error: ").concat(e&&e.message?e.message:"NA"),e))}},e.prototype.pasteHandler=function(e,t,r,a){var i=this,s=!0;try{if(n().ULS.traceTag(596449099,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"SystemClipboardStorage.pasteHandler: isKeyboardEvent = '".concat(r,"'; eventPhase='").concat(e.eventPhase,"'")),e.preventDefault(),a(),this.removeLastPasteEventListenerCallback===a&&(this.removeLastPasteEventListenerCallback=void 0),this.disposableImplementationExtension.logIfDisposed("pasteHandler"))return;if(n().ULS.shipAssertTag(596455690,o.WN.msoulscat_ES_EWAJS,!!t,"SystemClipboardStorage.pasteHandler: the deferred promise parameter is missing. isKeyboardEvent = '".concat(r,"'")),!t)return;if(n().ULS.traceTag(596455691,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"SystemClipboardStorage.pasteHandler: isKeyboardEvent = '".concat(r,"'; deferred promise id = '").concat(t.id,"'")),n().ULS.shipAssertTag(596455692,o.WN.msoulscat_ES_EWAJS,!t.fulfilled(),"SystemClipboardStorage.pasteHandler: deferred promise '".concat(t.id,"' is already fulfilled. isKeyboardEvent = '").concat(r,"'")),t.fulfilled())return;var l=fe(),d=this.getSupportedDataFormats(),u=this.readDataFormats(d,e,r,l);Promise.all(u).then((function(){e.stopPropagation(),s=!1,z()?window.setTimeout((function(){var e,r,a=document.getElementById(ya);if(a&&a.firstChild&&"IMG"===a.firstChild.nodeName){var s=a.firstChild;s&&s.src&&s.src.indexOf("base64")>-1?l.setItem(ie,s.src):n().ULS.traceTag(595907107,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"SystemClipboardStorage.pasteHandler: IE has provided the IMG HTML rather than the image blob, which is unsupported.")}else l.setItem(ne,(r=wa(),n().ULS.shipAssertTag(596444113,o.WN.msoulscat_ES_EWAJS,!!r,"getTextHtmlContent: the content editable element does not exist"),r?ma.sanitize(r.innerHTML):m)),(e=a)&&e.firstChild&&e.firstElementChild&&e.firstElementChild.getAttribute(Vt)&&l.setItem(ae,function(e){var t=[],r=e.getElementsByTagName("tr");if(r.length>0){var a=qt(r[0]);t.push(a);for(var o=1;o<r.length;o+=1){t.push(Mt),t.push(Dt);var n=qt(r[o]);t.push(n)}}return t.join("")}(a));_a(),t.resolve(l),i.clearPasteCallbackConfiguration(t,!1,!1)}),0):(_a(),t.resolve(l),i.clearPasteCallbackConfiguration(t,!1,!1))}))}catch(r){_a();try{s&&e.stopPropagation()}catch(e){n().ULS.traceTag(595985030,o.WN.msoulscat_ES_EWAJS,o.Gu.Error,"SystemClipboardStorage.pasteHandler: failed when performing stopPropagation/preventDefault on the raw event. Failed with an exception: ".concat(o.P6.getStringifiedError(e)))}this.clearPasteCallbackConfiguration(t,!1,!1),n().ULS.traceTag(596455693,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"SystemClipboardStorage.pasteHandler callback with deferred promise id '".concat(t?t.id:m,"' (fulfilled = '").concat(t?t.fulfilled():m,"') failed with an exception: ").concat(r&&r.message?r.message:"NA",". Call stack: ").concat(r.stack?r.stack:"NA")),t&&t.reject(new N(c.GetClipboardItems,"Failed in SystemClipboard.get > pasteHandler callback. Deferred promise id = '".concat(t.id,"'. Error: ").concat(r&&r.message?r.message:"NA"),r))}},e.prototype.isFileFormat=function(e){return e===ie},e.prototype.isPlainTextEmpty=function(e){var t=e.getItem("text/plain");return!t||0===t.length},e.prototype.readDataFormats=function(e,t,r,a){var i=this;if(!this.skipFilesIfPlainTextExists||!r&&function(){var e=U(),t=!1;if(e&&e.userAgent){var r=e.userAgent();r&&r.indexOf("Edg/")>=0&&(t=!0)}return t}())return this.readDataFormatsInternal(e,t,r,a);var s=e.filter((function(e){return i.isFileFormat(e)}));if(0===s.length)return this.readDataFormatsInternal(e,t,r,a);var c=e.filter((function(e){return!i.isFileFormat(e)})),l=this.readDataFormatsInternal(c,t,r,a);return[Promise.all(l).then((function(){if(!i.isPlainTextEmpty(a))return n().ULS.traceTag(595653317,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"SystemClipboardStorage.readDataFormats: skip files loading because clipboard contains plain text"),Promise.resolve();var e=i.readDataFormatsInternal(s,t,r,a);return Promise.all(e)}))]},e.prototype.readDataFormatsInternal=function(e,t,r,a){var i=[];return e.forEach((function(e){i.push(function(e,t,r){return ua().getData(e,t,r)}(e,t,r).then((function(t){n().ULS.traceTag(541646989,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"SystemClipboardStorage.readDataFormatsInternal: Read "+e+" from clipboard"),a.setItem(e,t)})).catch((function(t){n().ULS.traceTag(595653318,o.WN.msoulscat_ES_EWAJS,o.Gu.Error,"SystemClipboardStorage.readDataFormatsInternal: Failed to get data of type [".concat(e,"]. Error [").concat(o.P6.getStringifiedError(t),"]"))})))})),i},e.prototype.skipSystemClipboardPasteHandler=function(e,t){try{t(),e.stopPropagation(),e.preventDefault()}catch(e){n().ULS.traceTag(595993058,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"SystemClipboardStorage.skipSystemClipboardPasteHandler: failed with an exception: ".concat(e&&e.message?e.message:"NA",". Call stack: ").concat(e.stack?e.stack:"NA"))}this.removeLastPasteEventListenerCallback===t&&(this.removeLastPasteEventListenerCallback=void 0)},e.prototype.hasPlainText=function(e){return!!e&&Object.keys(e.getData().items).indexOf(ae)>-1},e.prototype.dispose=function(){var e=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(F([function(){e.lastDeferredCutCopyPromise&&!e.lastDeferredCutCopyPromise.fulfilled()&&(e.lastDeferredCutCopyPromise.reject(),e.lastDeferredCutCopyPromise=void 0,e.removeLastCutCopyEventListenerCallback&&(e.removeLastCutCopyEventListenerCallback(),e.removeLastCutCopyEventListenerCallback=void 0))},function(){e.lastDeferredPastePromise&&!e.lastDeferredPastePromise.fulfilled()&&(e.lastDeferredPastePromise.reject(),e.lastDeferredPastePromise=void 0,e.removeLastPasteEventListenerCallback&&(e.removeLastPasteEventListenerCallback(),e.removeLastPasteEventListenerCallback=void 0))}]),this.disposableImplementationExtension.dispose())},e.getClipboardCutCopyEventType=function(e){if(!e)return ee;if(e===K.Copy)return ee;if(e===K.Cut)return"cut";throw new w(m,"cutCopyPasteFlags",e.toString())},e.prototype.restoreFocusToPreviouslyActiveElement=function(){if(this.activeElementIdToRestore){var e=document.getElementById(this.activeElementIdToRestore);e&&e.focus(),this.activeElementIdToRestore=void 0}},e.prototype.restoreSelection=function(){this.selectedRangeToRestore&&(function(e){if(void 0===e&&(e=void 0),e){var t=document.getSelection();t&&t.removeAllRanges&&"function"==typeof t.removeAllRanges&&t.addRange&&"function"==typeof t.addRange&&(t.removeAllRanges(),t.addRange(e))}}(this.selectedRangeToRestore),this.selectedRangeToRestore=void 0)},e.prototype.clearCutCopyCallbackConfiguration=function(e,t,r){this.restoreFocusToPreviouslyActiveElement(),this.restoreSelection(),n().ULS.shipAssertTag(595957697,o.WN.msoulscat_ES_EWAJS,!Ea(),"SystemClipboardStorage.set: ccpContentEditable is visible to the user during a copy/cut operation, but it should not be visible."),(e===this.lastDeferredCutCopyPromise||e&&this.lastDeferredCutCopyPromise&&e.id===this.lastDeferredCutCopyPromise.id)&&(this.lastDeferredCutCopyPromise=void 0),t&&this.removeLastCutCopyEventListenerCallback&&(r||n().ULS.traceTag(596449290,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"SystemClipboardStorage.set: the ".concat(Z,"/").concat(Y," event listener was not called. Calling removeLastCutCopyEventListenerCallback()")),this.removeLastCutCopyEventListenerCallback(),this.removeLastCutCopyEventListenerCallback=void 0)},e.prototype.clearPasteCallbackConfiguration=function(e,t,r){this.restoreFocusToPreviouslyActiveElement(),this.restoreSelection(),va(!1),n().ULS.shipAssertTag(595957698,o.WN.msoulscat_ES_EWAJS,!Ea(),"SystemClipboardStorage.clearPasteCallbackConfiguration: ccpContentEditable is visible to the user during a paste operation, but it should not be visible"),(e===this.lastDeferredPastePromise||e&&this.lastDeferredPastePromise&&e.id===this.lastDeferredPastePromise.id)&&(this.lastDeferredPastePromise=void 0),t&&this.removeLastPasteEventListenerCallback&&(r||n().ULS.traceTag(596449291,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"SystemClipboardStorage.get: the ".concat(Q," event listener was not called. Calling removeLastPasteEventListenerCallback()")),this.removeLastPasteEventListenerCallback(),this.removeLastPasteEventListenerCallback=void 0)},e.prototype.clearSystemClipboard=function(){var e=ue(),t={isKeyboardEvent:!1,commandType:K.Copy};this.set(e,t).then((function(){n().ULS.traceTag(595935906,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"SystemClipboardStorage.clearSystemClipboard: clear system clipboard succeed")}),(function(){n().ULS.traceTag(595935907,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"SystemClipboardStorage.clearSystemClipboard: clear system clipboard failed")}))},e}(),Aa=function(e){function r(t){return e.call(this,s.InMemory,{browserStorage:!1,systemClipboard:!1,inMemory:!0},t)||this}return(0,t.__extends)(r,e),r}(rt),La=function(){function e(){this.clipboardStorageType=B.InMemory,this.disposableImplementationExtension=tt("InMemoryClipboardStorage")}return e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.inMemoryClipboardItems=void 0,this.disposableImplementationExtension.dispose())},e.prototype.get=function(e){return this.disposableImplementationExtension.throwIfDisposed("get"),this.inMemoryClipboardItems?Promise.resolve(this.inMemoryClipboardItems):Promise.resolve(ue())},e.prototype.set=function(e,t){return this.disposableImplementationExtension.throwIfDisposed("set"),this.inMemoryClipboardItems=e,Promise.resolve()},e.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[ae,ne,"data/shadow-workbook"]},e}(),xa=function(e){function r(t){return e.call(this,s.LocalStorage,{browserStorage:!0,systemClipboard:!1,inMemory:!1},t)||this}return(0,t.__extends)(r,e),r}(rt),Da=function(){function e(e,t,r,a){this.clipboardStrategyType=e,this.clipboardCapabilities=t,this._fullAccessClipboardStrategyType=r,this.dualClipboardDataProcessor=a,this.initialized=!1,this.clipboardStrategyType=e,this.clipboardCapabilities=t,this.disposableImplementationExtension=tt("".concat(e))}return e.prototype.initialize=function(e,t){var r=this;return this.initialized=!1,this.systemClipboardStrategy=void 0,this.fullAccessClipboardStrategy=void 0,e.then((function(e){return r.systemClipboardStrategy=e,t.then((function(e){return r.fullAccessClipboardStrategy=e,r.initialized=!0,Promise.resolve(r)}))}))},e.prototype.set=function(e,t){var r=this;try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.initialized||!this.systemClipboardStrategy)return Promise.reject(new N(c.ClipboardStrategyNotInitialized));var a={systemClipboardOperationResult:Qe(f,"setresult",!1),fullAccessClipboardOperationResult:Qe(f,"setresult",!1)};return this.dualClipboardDataProcessor&&this.dualClipboardDataProcessor.preSetProcess(e),this.systemClipboardStrategy.set(e,t).then((function(){return Promise.resolve(a)}),(function(e){return a.systemClipboardOperationResult.failed=!0,a.systemClipboardOperationResult.clipboardOperationResultError=e,h(e,[c.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation,c.RejectingBlockedSyncCutCopyPromise])?Promise.reject(e):Promise.resolve(a)})).then((function(a){return r.fullAccessClipboardStrategy?r.fullAccessClipboardStrategy.set(e,t).then((function(){return Promise.resolve(a)}),(function(e){return n().ULS.traceTag(595933078,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"Failed to save to fullAccessClipboardStrategy. clipboardStrategyType: '".concat(r.fullAccessClipboardStrategy&&r.fullAccessClipboardStrategy.clipboardStrategyType,"', Command Id: '").concat(t.id?t.id:m,"', Error: ").concat(o.P6.getStringifiedError(e))),a.fullAccessClipboardOperationResult.failed=!0,a.fullAccessClipboardOperationResult.clipboardOperationResultError=e,Promise.resolve(a)})):(a.fullAccessClipboardOperationResult.failed=!0,Promise.resolve(a))})).then((function(e){if(e.systemClipboardOperationResult.failed&&e.fullAccessClipboardOperationResult.failed){var t=e.systemClipboardOperationResult.clipboardOperationResultError;return t||(t=e.fullAccessClipboardOperationResult.clipboardOperationResultError),t?Promise.reject(t):Promise.reject(new N(c.SetClipboardItems,m))}return Promise.resolve()}))}catch(e){return Promise.reject(new N(c.SetClipboardItems,"Failed in system clipboard.set",e))}},e.prototype.get=function(e){var t=this;try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.initialized||!this.systemClipboardStrategy)return Promise.reject(new N(c.ClipboardStrategyNotInitialized));var r={systemClipboardOperationResult:Qe(f,"getresult",!1,void 0,{items:{}}),fullAccessClipboardOperationResult:Qe(f,"getresult",!1,void 0,{items:{}})};return this.systemClipboardStrategy.get(e).then((function(e){return r.systemClipboardOperationResult.clipboardItemsData=e.getData(),t.dualClipboardDataProcessor&&t.dualClipboardDataProcessor.postGetProcess(r.systemClipboardOperationResult),Promise.resolve(r)})).catch((function(a){return n().ULS.traceTag(507904974,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"Failed to get data from systemClipboardStrategy. clipboardStrategyType: '".concat(t.systemClipboardStrategy&&t.systemClipboardStrategy.clipboardStrategyType,"', Command Id: '").concat(e.id?e.id:m,"', Error: ").concat(o.P6.getStringifiedError(a))),r.systemClipboardOperationResult.failed=!0,r.systemClipboardOperationResult.clipboardOperationResultError=a,g(a,c.RejectingPendingPastePromiseDueToNewPasteOperation)?Promise.reject(a):Promise.resolve(r)})).then((function(r){return t.fullAccessClipboardStrategy?t.fullAccessClipboardStrategy.get(e).then((function(e){return r.fullAccessClipboardOperationResult.clipboardItemsData=e.getData(),t.dualClipboardDataProcessor&&t.dualClipboardDataProcessor.postGetProcess(r.fullAccessClipboardOperationResult),Promise.resolve(r)})).catch((function(a){return n().ULS.traceTag(595933079,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"Failed to get from fullAccessClipboardStrategy. clipboardStrategyType: '".concat(t.fullAccessClipboardStrategy&&t.fullAccessClipboardStrategy.clipboardStrategyType,"', Command Id: '").concat(e.id?e.id:m,"', Error: ").concat(o.P6.getStringifiedError(a))),r.fullAccessClipboardOperationResult.failed=!0,r.fullAccessClipboardOperationResult.clipboardOperationResultError=a,Promise.resolve(r)})):(r.fullAccessClipboardOperationResult.failed=!0,Promise.resolve(r))})).then((function(r){if(r.systemClipboardOperationResult.failed||e.skipSystemClipboardAccess){if(r.fullAccessClipboardOperationResult.failed){var a=r.systemClipboardOperationResult.clipboardOperationResultError;return a||(a=r.fullAccessClipboardOperationResult.clipboardOperationResultError),a?Promise.reject(a):Promise.reject(new N(c.GetClipboardItems,m))}return 0===pe(r.fullAccessClipboardOperationResult.clipboardItemsData)?Promise.reject(r.systemClipboardOperationResult.clipboardOperationResultError):t.validateAndReturnFullAccessData(r)}return r.fullAccessClipboardOperationResult.failed?Promise.resolve(fe(r.systemClipboardOperationResult.clipboardItemsData)):!H()||H()&&G.isEdgeWithTextHtmlClipboardSupportProperty?t.pasteSourceReconciliation(r,e):t.pasteSourceReconciliationBasedOnlyOnTextPlain(r)}))}catch(e){return Promise.reject(new N(c.GetClipboardItems,"Failed in system clipboard.get",e))}},e.prototype.onSystemClipboardChangedExternally=function(e){try{return this.disposableImplementationExtension.throwIfDisposed("onSystemClipboardChangedExternally"),this.initialized?this.fullAccessClipboardStrategy?this.fullAccessClipboardStrategy.onSystemClipboardChangedExternally(e):(n().ULS.shipAssertTag(595882509,o.WN.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.onSystemClipboardChangedExternally: this.fullAccessClipboardStrategy should be defined"),Promise.reject(new N(c.ClipboardStrategyNotInitialized))):Promise.reject(new N(c.ClipboardStrategyNotInitialized))}catch(e){return Promise.reject(new N(c.ClearClipboardItems,"Failed in (clipboard ".concat(this.clipboardStrategyType,").onSystemClipboardChangedExternally"),e))}},e.prototype.dispose=function(){var e=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(F([function(){e.systemClipboardStrategy&&e.systemClipboardStrategy.dispose()},function(){e.fullAccessClipboardStrategy&&e.fullAccessClipboardStrategy.dispose()}]),this.disposableImplementationExtension.dispose())},e.prototype.pasteSourceReconciliation=function(e,t){var r=void 0;e.systemClipboardOperationResult.signatureData&&(r=e.systemClipboardOperationResult.signatureData.ccp_infra_timestamp);var a=void 0;return e.fullAccessClipboardOperationResult.signatureData&&(a=e.fullAccessClipboardOperationResult.signatureData.ccp_infra_timestamp),n().ULS.traceTag(595719624,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"systemClipboardAndFullAccessClipboardStrategy.pasteSourceReconciliation: ccpTimestampInSystemClipboard=".concat(r," ccpTimestampInFullAccessClipboard=").concat(a)),r?r>(a||0)?(Ma(e.systemClipboardOperationResult.clipboardItemsData,!0),Promise.resolve(fe(e.systemClipboardOperationResult.clipboardItemsData))):Promise.resolve(fe(e.fullAccessClipboardOperationResult.clipboardItemsData)):t.isTimestampStoredInSystemClipboard?Na(e)?Promise.resolve(fe(e.fullAccessClipboardOperationResult.clipboardItemsData)):Fa(e)?this.validateAndReturnFullAccessData(e):(Ma(e.systemClipboardOperationResult.clipboardItemsData,!1),Promise.resolve(fe(e.systemClipboardOperationResult.clipboardItemsData))):this.validateAndReturnFullAccessData(e)},e.prototype.validateAndReturnFullAccessData=function(e){return this.dualClipboardDataProcessor&&this.dualClipboardDataProcessor.validateUserHash(e.fullAccessClipboardOperationResult.signatureData),Promise.resolve(fe(e.fullAccessClipboardOperationResult.clipboardItemsData))},e.prototype.pasteSourceReconciliationBasedOnlyOnTextPlain=function(e){return 0===pe(e.systemClipboardOperationResult.clipboardItemsData)||0===pe(e.fullAccessClipboardOperationResult.clipboardItemsData)?Promise.resolve(fe(e.systemClipboardOperationResult.clipboardItemsData)):Na(e)?Promise.resolve(fe(e.fullAccessClipboardOperationResult.clipboardItemsData)):Fa(e)?this.validateAndReturnFullAccessData(e):(e.systemClipboardOperationResult.clipboardItemsData.items[se]="1",Promise.resolve(fe(e.systemClipboardOperationResult.clipboardItemsData)))},e}();function Ma(e,t){e.items[se]="1",t&&(e.items["metadata/is-last-copy-was-external-XLO-source"]="1")}function Na(e){var t=Bt(Kt(e.systemClipboardOperationResult.clipboardItemsData.items[ae])),r=e.fullAccessClipboardOperationResult.clipboardItemsData.items[ae];return!!r&&t===Bt(Kt(r))}function Fa(e){return Bt(Kt(e.systemClipboardOperationResult.clipboardItemsData.items[ae]))===Ba().getCopyToClipboardLatencyMessage()}var Ua,Oa=function(e){function r(t){return e.call(this,s.SystemClipboardAndLocalStorage,{browserStorage:!0,systemClipboard:!0,inMemory:!1},s.LocalStorage,t)||this}return(0,t.__extends)(r,e),r}(Da),Ga=function(e){function r(t){return e.call(this,s.SystemClipboardAndInMemory,{browserStorage:!1,systemClipboard:!0,inMemory:!0},s.InMemory,t)||this}return(0,t.__extends)(r,e),r}(Da),Ra=function(e){function r(t){return e.call(this,B.LocalStorage,t)||this}return(0,t.__extends)(r,e),r}(function(e){function r(t,r){var a=e.call(this)||this;if(a.messageDestination=r,!r)throw new E(m,"messageDestination");return a.clipboardStorageType=t,a.disposableImplementationExtension=tt(r),a}return(0,t.__extends)(r,e),r.prototype.initialize=function(){var e=this;return this.innerInitialize().then((function(){return e}))},r.prototype.get=function(e){this.disposableImplementationExtension.throwIfDisposed("get"),n().ULS.traceTag(595947538,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"ClipboardStorageIframeProxy.get: isKeyboardEvent = ".concat(e.isKeyboardEvent,"; silentClipboardAccessFailures = ").concat(e.silentClipboardAccessFailures||!1));var t=Xe(Ke(),"get",this.messageDestination,e.userHash);return this.postMessage(t,"get").then((function(e){return e.clipboardItemsData?Promise.resolve(fe(e.clipboardItemsData)):Promise.resolve(ue())}))},r.prototype.set=function(e,t){var r;return this.disposableImplementationExtension.throwIfDisposed("set"),n().ULS.traceTag(595947541,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"ClipboardStorageIframeProxy.set: isKeyboardEvent = ".concat(t.isKeyboardEvent,"; silentClipboardAccessFailures = ").concat(t.silentClipboardAccessFailures||!1)),r=me(e)>0?Xe(Ke(),"set",this.messageDestination,t.userHash,e.getData()):Xe(Ke(),"set",this.messageDestination),this.postMessage(r,"set").then((function(){}))},r.prototype.clearClipboardNecessary=function(e,t){return function(e,t){return null==e||1===e||null==t||e!==t}(e,t)},r.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[ae,ne,"data/shadow-workbook"]},r.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},r}(Ar)),Ja=function(e){function r(t){return e.call(this,s.AsyncSystemClipboard,{browserStorage:!1,systemClipboard:!0,inMemory:!1},t)||this}return(0,t.__extends)(r,e),r}(rt),ka=function(){function e(){this.webCustomFormatPrefix="web ",this.emptyClipboardReadErrorName="DataError",this.emptyClipboardReadErrorMessage="No valid data on clipboard.",this.clipboardStorageType=B.AsyncSystemClipboard,this.disposableImplementationExtension=tt("AsyncSystemClipboardStorage")}return e.prototype.get=function(e){var r;return(0,t.__awaiter)(this,void 0,void 0,(function(){var a,i,s,l,d,u,p,m,f,g,h,S,y,C,b,v,E,w,_,P=this;return(0,t.__generator)(this,(function(t){switch(t.label){case 0:if(this.disposableImplementationExtension.throwIfDisposed("get"),e.isAsyncClipboardAPI=!0,a=window.performance.now(),i=Ta("Microsoft.Office.Excel.EnableAsyncClipboardApiReadSW",!1),e.skipSystemClipboardAccess)return[2,Promise.resolve(ue())];s=this.getSupportedDataFormats(),l=fe(),t.label=1;case 1:t.trys.push([1,17,18,21]),d={name:"clipboard-read",allowWithoutGesture:!1},t.label=2;case 2:return t.trys.push([2,4,,5]),[4,null===(r=navigator.permissions)||void 0===r?void 0:r.query(d)];case 3:return"denied"===(null==(u=t.sent())?void 0:u.state)?(this.handleClipboardPermissionDeniedError(),[2,Promise.reject(new N(c.ClipboardIsInaccessible,"AsyncSystemClipboardStorage.get - Clipboard permission is denied"))]):("prompt"===(null==u?void 0:u.state)&&(u.onchange=function(){"denied"===(null==u?void 0:u.state)&&P.handleClipboardPermissionDeniedError()}),[3,5]);case 4:return p=t.sent(),n().ULS.traceTag(508651269,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,'AsyncSystemClipboardStorage.get: Failed to query "clipboard-read" permission. Error: '.concat(o.P6.getStringifiedError(p))),[3,5];case 5:return[4,navigator.clipboard.read({unsanitized:[ne]})];case 6:if(!(m=t.sent())||m.length<1)return[2,l];f=0,g=m,t.label=7;case 7:if(!(f<g.length))return[3,16];h=g[f],S=0,y=h.types,t.label=8;case 8:return S<y.length?(C=y[S],s.includes(C)?[4,h.getType(C)]:[3,14]):[3,15];case 9:return b=t.sent(),v=void 0,C!==ie?[3,11]:[4,(I=b,oa(I))];case 10:return v=t.sent(),[3,13];case 11:return[4,b.text()];case 12:v=t.sent(),t.label=13;case 13:E=window.performance.now()-a,n().ULS.traceTag(508703873,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"AsyncSystemClipboardStorage.get: Read successful. DataFormat: '".concat(C,"', TimeInMs: ").concat(E)),(w=C.startsWith(this.webCustomFormatPrefix))&&i?l.setItem(C.replace(this.webCustomFormatPrefix,""),v):w||l.setItem(C,v),t.label=14;case 14:return S++,[3,8];case 15:return f++,[3,7];case 16:return[3,21];case 17:return(_=t.sent()).name===this.emptyClipboardReadErrorName&&_.message===this.emptyClipboardReadErrorMessage?(n().ULS.traceTag(508352130,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"AsyncSystemClipboardStorage.readDataFormats: System clipboard is empty. Error: ".concat(o.P6.getStringifiedError(_))),[2,l]):(n().ULS.traceTag(508843077,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"AsyncSystemClipboardStorage.get: Failed to read data formats from system clipboard. Error: ".concat(o.P6.getStringifiedError(_))),[2,Promise.reject(new N(c.ClipboardIsInaccessible,"AsyncSystemClipboardStorage.get - Clipboard permission is denied or failed to read",_))]);case 18:return e.clearSystemClipboard?[4,this.clearSystemClipboard()]:[3,20];case 19:t.sent(),t.label=20;case 20:return[7];case 21:return[2,l]}var I}))}))},e.prototype.set=function(e,r){var a;return(0,t.__awaiter)(this,void 0,void 0,(function(){var i,s,l,d,u,p,m,f,g,h,S,y,C,b,v,E,w,_=this;return(0,t.__generator)(this,(function(t){switch(t.label){case 0:this.disposableImplementationExtension.throwIfDisposed("set"),r.isAsyncClipboardAPI=!0,i=window.performance.now(),s=Ta("Microsoft.Office.Excel.EnableAsyncClipboardApiWriteSW",!1),l=this.getSupportedDataFormats(),t.label=1;case 1:t.trys.push([1,7,,8]),d={name:"clipboard-write",allowWithoutGesture:!1},t.label=2;case 2:return t.trys.push([2,4,,5]),[4,null===(a=navigator.permissions)||void 0===a?void 0:a.query(d)];case 3:return"denied"===(null==(u=t.sent())?void 0:u.state)?(this.handleClipboardPermissionDeniedError(),[2,Promise.reject(new N(c.ClipboardIsInaccessible,"AsyncSystemClipboardStorage.set - Clipboard permission is denied"))]):("prompt"===(null==u?void 0:u.state)&&(u.onchange=function(){"denied"!==(null==u?void 0:u.state)||_.handleClipboardPermissionDeniedError()}),[3,5]);case 4:return p=t.sent(),n().ULS.traceTag(508651268,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,'AsyncSystemClipboardStorage.set: Failed to query "clipboard-write" permission. Error: '.concat(o.P6.getStringifiedError(p))),[3,5];case 5:if(!(m=ye(e))||m.length<1)return[2];for(f={},g=0,h=m;g<h.length;g++)S=h[g],l.includes(S.clipboardDataFormat)&&(y=he(m,S.clipboardDataFormat),C=new Blob([y],{type:S.clipboardDataFormat}),(b=l.includes("".concat(this.webCustomFormatPrefix).concat(S.clipboardDataFormat)))&&s?f["".concat(this.webCustomFormatPrefix).concat(S.clipboardDataFormat)]=C:b||(f[S.clipboardDataFormat]=C));return v=new ClipboardItem(f,{unsanitized:[ne]}),[4,navigator.clipboard.write([v])];case 6:return t.sent(),E=window.performance.now()-i,n().ULS.traceTag(508703872,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"AsyncSystemClipboardStorage.set: Write successful. TimeInMs: ".concat(E)),r.isTimestampStoredInSystemClipboard=!0,[3,8];case 7:return w=t.sent(),n().ULS.traceTag(508843076,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"AsyncSystemClipboardStorage.set: Failed to write data formats to system clipboard. Error: ".concat(o.P6.getStringifiedError(w))),[2,Promise.reject(new N(c.ClipboardIsInaccessible,"AsyncSystemClipboardStorage.set - Clipboard permission is denied or failed to write",w))];case 8:return[2]}}))}))},e.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[ae,ne,ie,"data/shadow-workbook","web data/shadow-workbook"]},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},e.prototype.clearSystemClipboard=function(){return(0,t.__awaiter)(this,void 0,void 0,(function(){return(0,t.__generator)(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,navigator.clipboard.writeText("")];case 1:return e.sent(),n().ULS.traceTag(508703843,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"AsyncSystemClipboardStorage.clearSystemClipboard: Clipboard cleared"),[3,3];case 2:return e.sent(),n().ULS.traceTag(508703842,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"AsyncSystemClipboardStorage.clearSystemClipboard: Failed to clear system clipboard."),[3,3];case 3:return[2]}}))}))},e.prototype.handleClipboardPermissionDeniedError=function(){n().ULS.traceTag(508831754,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"AsyncSystemClipboardStorage.handleClipboardPermissionDeniedError: system clipboard access is denied.")},e}(),ja=function(e){function r(t){return e.call(this,s.AsyncSystemClipboardAndLocalStorage,{browserStorage:!0,systemClipboard:!0,inMemory:!1},s.LocalStorage,t)||this}return(0,t.__extends)(r,e),r}(Da),za=function(){function e(){this.initialized=!1,this.clipboardStorageType=B.AsyncSystemClipboard,this.disposableImplementationExtension=tt("CombinedSystemClipboardStorage")}return e.prototype.initialize=function(e,r){return(0,t.__awaiter)(this,void 0,void 0,(function(){var a,o,n;return(0,t.__generator)(this,(function(t){switch(t.label){case 0:return this.initialized=!1,[4,Promise.all([e,r])];case 1:return a=t.sent(),o=a[0],n=a[1],this.systemClipboardStorage=o,this.asyncSystemClipboardStorage=n,this.initialized=!0,[2,this]}}))}))},e.prototype.get=function(e){return(0,t.__awaiter)(this,void 0,void 0,(function(){var r,a,i;return(0,t.__generator)(this,(function(t){switch(t.label){case 0:if(this.disposableImplementationExtension.throwIfDisposed("get"),r=window.performance.now(),!this.initialized||!this.asyncSystemClipboardStorage||!this.systemClipboardStorage)return[2,Promise.reject(new N(c.ClipboardStrategyNotInitialized))];t.label=1;case 1:return t.trys.push([1,3,8,9]),[4,this.systemClipboardStorage.get(e)];case 2:return[2,t.sent()];case 3:a=t.sent(),n().ULS.traceTag(508154642,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CombinedSystemClipboardStorage.get | systemClipboardStorage get failed. Error: ".concat(o.P6.getStringifiedError(a))),t.label=4;case 4:return t.trys.push([4,6,,7]),[4,this.asyncSystemClipboardStorage.get(e)];case 5:return[2,t.sent()];case 6:return i=t.sent(),n().ULS.traceTag(507904976,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CombinedSystemClipboardStorage.get | asyncSystemClipboardStorage get failed. Error: ".concat(o.P6.getStringifiedError(i))),[2,Promise.reject(new N(c.ClipboardIsInaccessible,"CombinedSystemClipboardStorage.get - Clipboard permission is denied or failed to read",i))];case 7:return[3,9];case 8:return n().ULS.traceTag(508154640,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CombinedSystemClipboardStorage.get | System clipboard total read time: ".concat(window.performance.now()-r," ms")),[7];case 9:return[2]}}))}))},e.prototype.set=function(e,r){return(0,t.__awaiter)(this,void 0,void 0,(function(){var a,i,s;return(0,t.__generator)(this,(function(t){switch(t.label){case 0:if(this.disposableImplementationExtension.throwIfDisposed("set"),a=window.performance.now(),!this.initialized||!this.asyncSystemClipboardStorage||!this.systemClipboardStorage)return[2,Promise.reject(new N(c.ClipboardStrategyNotInitialized))];t.label=1;case 1:return t.trys.push([1,3,8,9]),[4,this.systemClipboardStorage.set(e,r)];case 2:return t.sent(),[2];case 3:i=t.sent(),n().ULS.traceTag(508154638,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CombinedSystemClipboardStorage.set | systemClipboardStorage set failed. ".concat(o.P6.getStringifiedError(i))),t.label=4;case 4:return t.trys.push([4,6,,7]),[4,this.asyncSystemClipboardStorage.set(e,r)];case 5:return t.sent(),[2];case 6:return s=t.sent(),n().ULS.traceTag(507904975,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CombinedSystemClipboardStorage.set | asyncSystemClipboardStorage set failed. ".concat(o.P6.getStringifiedError(s))),[2,Promise.reject(new N(c.ClipboardIsInaccessible,"CombinedSystemClipboardStorage.set - Clipboard permission is denied or failed to write",s))];case 7:return[3,9];case 8:return n().ULS.traceTag(508154637,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"CombinedSystemClipboardStorage.set | System clipboard total write time: ".concat(window.performance.now()-a," ms")),[7];case 9:return[2]}}))}))},e.prototype.getSupportedDataFormats=function(){var e,r,a,o;return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),(0,t.__spreadArray)((0,t.__spreadArray)([],null!==(r=null===(e=this.systemClipboardStorage)||void 0===e?void 0:e.getSupportedDataFormats())&&void 0!==r?r:[],!0),null!==(o=null===(a=this.asyncSystemClipboardStorage)||void 0===a?void 0:a.getSupportedDataFormats())&&void 0!==o?o:[],!0).reduce((function(e,t){return-1===e.indexOf(t)&&e.push(t),e}),[])},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},e}();function Ha(e){return new Wa(e)}function Va(e,t,r,a,i,l){var d=function(e,t,r){return new pr(e,t,r)}(r,a,i);return function(e,t,r,a){var i=q.NoError;return o.P6.chainFallbackPromises(e,(function(e){return function(e,t,r,a){n().ULS.traceTag(595716231,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"clipboardPlatformEnvironmentFactory.createClipboardEnvironmentComponentsByType: Attempting to create clipboard strategy type '".concat(e.clipboardStrategyType,"'"));var i,l=function(){return function(){switch(e.clipboardStrategyType){case s.SystemClipboard:case s.SystemClipboardAndInMemory:return e;case s.SystemClipboardAndLocalStorage:case s.AsyncSystemClipboardAndLocalStorage:return e.systemClipboardStrategyParameters;default:throw new W("createClipboardEnvironmentComponentsByType: getSystemClipboardParameters couldn't be used for ".concat(e.clipboardStrategyType))}}().skipFilesIfPlainTextExists},d=function(){switch(e.clipboardStrategyType){case s.LocalStorage:return e;case s.SystemClipboardAndLocalStorage:case s.AsyncSystemClipboardAndLocalStorage:return e.localStorageStrategyParameters;default:throw new W("createClipboardEnvironmentComponentsByType: getLocalStorageParameters couldn't be used for ".concat(e.clipboardStrategyType))}},u=function(e){return r.createClipboardDataProcessor(e)},p=function(){return r.createClipboardMetaDataProcessor()},f=function(e){return r.createDualClipboardDataProcessor(e)},g=function(){var e=d();return e.useSharedClipboardIframe?new xr:function(e){return new Lr(e)}(wt(e.sharedClipboardSchemaVersion)+Et)},h=function(e,r){return(r?r.initialize(e):Promise.resolve(void 0)).then((function(){return function(e,t,r){return n().ULS.shipAssertTag(595945246,o.WN.msoulscat_ES_EWAJS,!!e,"MetadataManager.createMetadataManager: expected clipboardStrategy to be defined."),n().ULS.shipAssertTag(595945247,o.WN.msoulscat_ES_EWAJS,!!e,"MetadataManager.createMetadataManager: expected metadataSerializationHelper to be defined."),Zt=e,er=function(e){return Xt=e,Qt}(t),(tr=r)&&tr.setOnMetadataChangedListener(ir),nr}(e,t,r)}))},S=function(){return(new Dr).initialize(Promise.resolve(Ha(l())))},y=function(e){return function(e){return new Aa(e)}(e).initialize(Promise.resolve(new La))},C=function(e){var t={};e.wacCluster&&(t.wacCluster=e.wacCluster.trim()),e.sessionId&&(t.sessionId=e.sessionId),a&&(t.bulsEndpointUrl=a);var r,i=e.sharedClipboardOverrideOrigin?1:0;r={sharedClipboardHostingApp:e.sharedClipboardHostingApp,sharedClipboardHostingApps:e.sharedClipboardHostingApps,sharedClipboardHostingEnvironments:e.sharedClipboardHostingEnvironments,sharedClipboardSchemaVersion:e.sharedClipboardSchemaVersion,sharedClipboardExpirationInMinutes:e.sharedClipboardExpirationInMinutes,clipboardPromiseTimeoutInMinutes:e.sharedClipboardExpirationInMinutes,whitelistOriginComponents:i},_e=!1,function(e){if(!e)throw new E(m,"sharedClipboardSettingsCandidate");var t=Ae();if("number"!=typeof e.sharedClipboardSchemaVersion||isNaN(e.sharedClipboardSchemaVersion)||(t.sharedClipboardSchemaVersion=e.sharedClipboardSchemaVersion),"number"!=typeof e.sharedClipboardExpirationInMinutes||isNaN(e.sharedClipboardExpirationInMinutes)||(t.sharedClipboardExpirationInMinutes=e.sharedClipboardExpirationInMinutes),"number"!=typeof e.clipboardPromiseTimeoutInMinutes||isNaN(e.clipboardPromiseTimeoutInMinutes)||(t.clipboardPromiseTimeoutInMinutes=e.clipboardPromiseTimeoutInMinutes),"string"==typeof e.remoteLoggerPath&&e.remoteLoggerPath&&e.remoteLoggerPath.trim()&&(t.remoteLoggerPath=e.remoteLoggerPath),"number"!=typeof e.whitelistOriginComponents||1!==e.whitelistOriginComponents)return we=t,void(_e=!0);if("string"!=typeof e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp.trim())return n().ULS.traceTag(596124181,o.WN.msoulscat_ES_EWAJS,o.Gu.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApp should be a non empty string"),we=t,void(_e=!0);t.sharedClipboardHostingApp=e.sharedClipboardHostingApp.trim();var r=t.sharedClipboardHostingApp,a=r.indexOf(Ee);a>=0&&(r=r.substr(a+1));try{t.sharedClipboardHostingApps=e.sharedClipboardHostingApps?JSON.parse(e.sharedClipboardHostingApps):void 0}catch(t){n().ULS.traceTag(579737680,o.WN.msoulscat_ES_EWAJS,o.Gu.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps JSON parsing failed. String : "+e.sharedClipboardHostingApps)}if(!t.sharedClipboardHostingApps||!Array.isArray(t.sharedClipboardHostingApps)||0===t.sharedClipboardHostingApps.length||t.sharedClipboardHostingApps.some((function(e){return!e||!e.trim()})))return n().ULS.traceTag(596124182,o.WN.msoulscat_ES_EWAJS,o.Gu.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps should be a JSON string representing an array with at list one app"),t.sharedClipboardHostingApp=m,t.sharedClipboardHostingApps=[],we=t,void(_e=!0);try{t.sharedClipboardHostingEnvironments=e.sharedClipboardHostingEnvironments?JSON.parse(e.sharedClipboardHostingEnvironments):void 0}catch(t){n().ULS.traceTag(579737681,o.WN.msoulscat_ES_EWAJS,o.Gu.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments JSON parsing failed. String : "+e.sharedClipboardHostingEnvironments)}if(!t.sharedClipboardHostingEnvironments||!Array.isArray(t.sharedClipboardHostingEnvironments)||0===t.sharedClipboardHostingEnvironments.length||t.sharedClipboardHostingEnvironments.some((function(e){return!e||!e.trim()})))return n().ULS.traceTag(596124183,o.WN.msoulscat_ES_EWAJS,o.Gu.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments should be a JSON string representing an array with at list one environment"),t.sharedClipboardHostingApp=m,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],we=t,void(_e=!0);if(t.sharedClipboardHostingApps.indexOf(t.sharedClipboardHostingApp)<0){if(t.sharedClipboardHostingApp===r)return n().ULS.traceTag(596124184,o.WN.msoulscat_ES_EWAJS,o.Gu.Error,"sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '".concat(t.sharedClipboardHostingApp,"' should be listed in sharedClipboardHostingApps")),t.sharedClipboardHostingApp=m,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],we=t,void(_e=!0);if(t.sharedClipboardHostingApps.indexOf(r)<0)return n().ULS.traceTag(596124185,o.WN.msoulscat_ES_EWAJS,o.Gu.Error,"sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '".concat(t.sharedClipboardHostingApp,"' or '").concat(r,"' should be listed in sharedClipboardHostingApps")),t.sharedClipboardHostingApp=m,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],we=t,void(_e=!0)}t.whitelistOriginComponents=!0,we=t,_e=!0}(r),function(e){n().ULS.shipAssertTag(595944468,o.WN.msoulscat_ES_EWAJS,!!e,"ClipboardPlatformSettings.setClipboardPlatformSettings: expect clipboardPlatformSettings to be defined."),$t=e}(t)},b=function(e,t){var r,a,o,n=d();return n.useSharedClipboardIframe?(C(n),function(e){return new xa(e)}(t).initialize((r=e?Ye.localStorageMetadata:Ye.localStorageData,new Ra(r)).initialize())):function(e){return new At(e)}(t).initialize(Promise.resolve((a=e?wt(n.sharedClipboardSchemaVersion):(o=n.sharedClipboardSchemaVersion,vt+o),new Wt(a))))},v=function(e,t,r){return Promise.all([e,t]).then((function(e){var t=e[0],a=e[1];return h(a,r).then((function(e){return{dataClipboardStrategy:t,metadataManager:e}}))}))};try{switch(e.clipboardStrategyType){case s.SystemClipboard:return v(S(),y(p()));case s.InMemory:return v(y(u(!1)),y(p()));case s.LocalStorage:return v(b(!1,u(!0)),b(!0,p()),g());case s.AsyncSystemClipboardAndLocalStorage:return v((i=f(!0),new ja(i)).initialize((new Ja).initialize(Promise.resolve((new za).initialize(Promise.resolve(Ha(l())),Promise.resolve(new ka)))),b(!1)),b(!0,p()),g());case s.SystemClipboardAndLocalStorage:return v(function(){return(e=f(!0),new Oa(e)).initialize(S(),b(!1));var e}(),b(!0,p()),g());case s.SystemClipboardAndInMemory:return v(function(){return(e=f(!1),new Ga(e)).initialize(S(),y());var e}(),y(p()))}return Promise.reject(new N(c.UnsupportedClipboardStrategyType,"Clipboard strategy type '".concat(e.clipboardStrategyType,"' is not supported")))}catch(t){return Promise.reject(new N(c.UnsupportedClipboardStrategyType,"failed to create clipboardStrategyType: '".concat(e.clipboardStrategyType,"' with error: ").concat(o.P6.getStringifiedError(t))))}}(e,t,r,a).then((function(t){return n().ULS.traceTag(595716294,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"clipboardPlatformEnvironmentFactory.createClipboardEnvironmentComponentsByType: Clipboard strategy type '".concat(e.clipboardStrategyType,"' was created.")),t.infraInitializationError=i,t})).catch((function(t){var r;(r=S(t))&&(i=q.LocalStorageInaccessible);var a="clipboardPlatformEnvironmentFactory.createClipboardEnvironmentComponentsByType: selectClipboardStrategy: failed to create clipboard strategy type '".concat(e.clipboardStrategyType,"'. Error: ").concat(o.P6.getStringifiedError(t));return n().ULS.traceTag(595716230,o.WN.msoulscat_ES_EWAJS,r?o.Gu.Info:o.Gu.Error,a),Promise.reject(new N(c.SelectClipboardStrategy,a,t))}))}))}(e,t,d,l).then((function(e){return{dataClipboardStrategy:e.dataClipboardStrategy,clipboardDataManager:d,metadataManager:e.metadataManager,infraInitializationError:e.infraInitializationError}}))}function Ba(){return Qa}!function(e){e[e.NotInitialized=0]="NotInitialized",e[e.StateReady=1]="StateReady",e[e.InitializationSucceed=2]="InitializationSucceed"}(Ua||(Ua={}));var Ka,qa,$a,Xa,Ya,Za={initializationStatus:Ua.NotInitialized,stateInitialized:!1,clipboardStrategy:void 0,chromeExtensionIds:[],clipboardPromiseTimeoutInMinutes:Te,copyToClipboardLatencyMessage:"Retrieving data. Wait a few seconds and try to cut or copy again.",metadataManager:void 0,clipboardDataManager:void 0,initializationError:q.NoError},Qa={init:function(e,t,r,a,s,c,l,d,u,p,f,g,h,S,y,C,b,v,w){return Za.lastClipboardPlatformEnvironmentInitializationInfo?Promise.resolve(Za.lastClipboardPlatformEnvironmentInitializationInfo):(e&&(0,o.tP)(e),i(t),r&&Array.isArray(r)?(n().ULS.traceTag(596455702,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"ClipboardPlatformEnvironment.init: chromeExtensionIds = '".concat(JSON.stringify(r),"'")),Za.chromeExtensionIds=function(e){var t=[];if(!e)return t;for(var r=0,a=e;r<a.length;r++){var o=a[r];o&&"string"==typeof o&&o.trim().length>0&&t.push(o)}return t}(r),f&&(Za.copyToClipboardLatencyMessage=f),"number"!=typeof p||isNaN(p)||(Za.clipboardPromiseTimeoutInMinutes=p),Za.initializationStatus=Ua.StateReady,Va(S,h,y,C,b,w).then((function(e){return Za.clipboardDataManager=e.clipboardDataManager,Za.metadataManager=e.metadataManager,Za.clipboardStrategy=e.dataClipboardStrategy,Za.initializationError=e.infraInitializationError,Za.initializationStatus=Ua.InitializationSucceed,Za.lastClipboardPlatformEnvironmentInitializationInfo={clipboardStrategiesToInitialize:S,dataClipboardCapabilities:Za.clipboardStrategy&&Za.clipboardStrategy.clipboardCapabilities,dataClipboardStrategyType:Za.clipboardStrategy&&Za.clipboardStrategy.clipboardStrategyType,infraInitializationError:Za.initializationError},Za.lastClipboardPlatformEnvironmentInitializationInfo}))):Promise.reject(new E(m,"chromeExtensionIds")))},getClipboardStrategy:function(){if(eo(),!Za.clipboardStrategy)throw new _("A clipboard strategy has not been selected. Call selectClipboardStrategy.");return Za.clipboardStrategy},getChromeExtensionIds:function(){return to(),Za.chromeExtensionIds},getClipboardPromiseTimeoutInMinutes:function(){return to(),Za.clipboardPromiseTimeoutInMinutes},getCopyToClipboardLatencyMessage:function(){return to(),Za.copyToClipboardLatencyMessage},getMetadataManager:function(){return eo(),Za.metadataManager},getClipboardDataManager:function(){return eo(),Za.clipboardDataManager},getInitializationError:function(){return eo(),Za.initializationError}};function eo(){if(Za.initializationStatus!==Ua.InitializationSucceed)throw new _("ClipboardPlatformEnvironment is not initialized. Call init(...).")}function to(){if(Za.initializationStatus<Ua.StateReady)throw new _("ClipboardPlatformEnvironment state is not ready. Call init(...).")}!function(e){e.Text="Text",e.TextPlain="text/plain",e.TextJSON="text/json",e.TextHtml="text/html",e.Metadata="metadata",e.ImagePNG="image/png"}(Ka||(Ka={})),function(e){e[e.ExpectedError=0]="ExpectedError",e[e.ClipboardIsInaccessible=1]="ClipboardIsInaccessible",e[e.UnknownError=2]="UnknownError",e[e.UnsupportedClipboardFormat=3]="UnsupportedClipboardFormat",e[e.ClipboardIsEmpty=4]="ClipboardIsEmpty"}(qa||(qa={})),function(e){e[e.ExpectedError=0]="ExpectedError",e[e.ClipboardIsInaccessible=1]="ClipboardIsInaccessible",e[e.UnknownError=2]="UnknownError"}($a||($a={})),function(e){e[e.SameSession=0]="SameSession",e[e.CrossSession=1]="CrossSession",e[e.ExternalImage=2]="ExternalImage"}(Xa||(Xa={})),function(e){e[e.DefaultPasteFlow=0]="DefaultPasteFlow",e[e.TextPasteFlow=1]="TextPasteFlow"}(Ya||(Ya={}));var ro,ao=["ndjpnladcallmjemlbaebfadecfhkepb","ifbmcpbgkhlpfcodhjhdbllhiaomkdej"],oo="",no=["png","jpeg","tiff","gif","jpg"],io=r(3796),so=function(){function e(){}return e.prototype.serializeSourceItem=function(e){return JSON.stringify(e)},e.prototype.serializeCommandParameters=function(e){return e?JSON.stringify(e):oo},e.prototype.deserializeSourceItem=function(e){return JSON.parse(e)},e.prototype.deserializeCommandParameters=function(e){return JSON.parse(e)},e}(),co=function(){function e(e){this._visioController=e}return e.prototype.getSourceItem=function(e){return this._visioController.getClipboardData()},e.prototype.beforeSerialize=function(e){},e.prototype.serialize=function(e){var t=e.sourceItem,r=fe(),a={asynchronousResult:null,synchronousResult:null};if(t.svgData){var o=(new XMLSerializer).serializeToString(t.svgData.svgNode);r.setItem(Ka.TextHtml,o),a={asynchronousResult:this.generateBase64Async(t.CCPID?t.CCPID:oo,t.CCPLogID?t.CCPLogID:oo,o,t.svgData.height,t.svgData.width),synchronousResult:r}}return a},e.prototype.generateBase64Async=function(e,t,r,a,n){var i=this;return new Promise((function(s,c){try{var l=document.createElement("canvas");l.height=a,l.width=n;var d,u=l.getContext("2d");d=i._visioController.isSafariBrowser()?new Blob([r],{type:"image/svg+xml"}):new Blob([r],{type:"image/svg+xml;charset=utf-8"});var p=URL.createObjectURL(d),m=document.createElement("img");m.onload=function(){try{u.drawImage(m,0,0,l.width,l.height),URL.revokeObjectURL(m.src);var r=l.toDataURL("image/png"),a=fe(),n=document.createElement("img");n.setAttribute("src",r),n.setAttribute("class","Visio"),n.setAttribute("Visio-sessionId",i._visioController.getUserSessionID()),n.setAttribute("data-clipservice-ccpid",e),n.setAttribute("data-clipservice-ccplogid",t),n.setAttribute("data-clipservice-dc",i._visioController.getWACDatacenter()),a.setItem(Ka.TextHtml,n.outerHTML),i._visioController.getCCPLogger().traceTag(561860804,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"SVG to base64 converted successfully"),s(a)}catch(e){return i._visioController.getCCPLogger().traceTag(561860805,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"SVG to base64 conversion failed during image load with error:'".concat(e,"'")),c(e)}},m.src=p}catch(e){return i._visioController.getCCPLogger().traceTag(561860806,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"SVG to base64 conversion failed with error:'".concat(e,"'")),c(e)}}))},e}(),lo=function(){},uo=function(){},po=function(){},mo=function(){},fo=function(){function e(e){this._visioController=e}return e.prototype.beforePaste=function(e){},e.prototype.deserialize=function(e){var t=this;try{var r,a=e.clipboardItems,n=new lo;if(e.isClipboardInaccessible)throw new D(d.ClipboardIsInaccessible,"clipboard is not accessible");if(!a)throw new D(d.ReadFromClipboardReturnNullOrUndefined,"clipboardItems is null!");var i=a.getItem(Ka.ImagePNG);if(i)r=i,n.isSameSession=!1,n.pasteSessionType=Xa.ExternalImage;else{var s=a.getItem(Ka.TextHtml);if(!s)throw new D(d.ClipboardIsEmpty,"Html Data is not present in clipboard!");var c=(new DOMParser).parseFromString(s,"text/html");if(!(r=c.images.length>0?c.images[0].src:null))throw new D(d.ClipboardIsEmpty,"No Image source is present in the Html data!");var l=c.images[0].getAttribute("Visio-sessionId");if(l)if(l===this._visioController.getUserSessionID())n.pasteSessionType=Xa.SameSession,n.isSameSession=!0;else{n.pasteSessionType=Xa.CrossSession;var u=this.getRegExStringValue(s,"\\s+ccp_infra_timestamp=['|\"](\\d+)['|\"]");if(u!==oo)try{var p=Number(u);n.timeStamp=isNaN(p)?0:p}catch(e){n.timeStamp=0}n.wacDataCenter=c.images[0].getAttribute("data-clipservice-dc"),n.CCPID=c.images[0].getAttribute("data-clipservice-ccpid"),n.CCPLogID=c.images[0].getAttribute("data-clipservice-ccplogid"),n.isSameSession=!1}else n.pasteSessionType=Xa.ExternalImage,n.isSameSession=!1}if(!this.isBase64Image(r))throw new D(d.ClipboardIsEmpty,"Image src is not Base64!");var m=new po;return this.getImageDimensions(r).then((function(e){return m.imageDimension=e,m.imageExtension=t.getImageExtension(r),m.base64ImageData=r.substring(r.indexOf(",")+1),n.base64Image=m,t._visioController.setClipboardData(n),t._visioController.getCCPLogger().traceTag(561860803,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"image details retrieved successfully"),Promise.resolve()}),(function(e){throw e})).catch((function(e){return Promise.reject(e)}))}catch(e){return Promise.reject(e)}},e.prototype.shouldWaitForCopyToComplete=function(e){return!1},e.prototype.onDeferredPasteStarted=function(e){},e.prototype.onDeferredPasteCompleted=function(e){},e.prototype.isBase64Image=function(e){return/^data:image\/[a-z]+(;[a-z\-]+\=[a-z0-9\-]+)?;base64,\s*[a-z0-9+\/]+={0,2}$/i.test(e)},e.prototype.getImageExtension=function(e){var t=e.match(/[^:\/]\w+(?=;)/i);if(!t||1!==t.length||!this.isSupportedExtension(t[0]))throw new D(d.ClipboardIsEmpty,"Image extension not valid!");return t[0]},e.prototype.getImageDimensions=function(e){return new Promise((function(t,r){var a=new Image,o=new mo;a.onload=function(){o.width=a.width,o.height=a.height,t(o)},a.onerror=function(){r(new D(d.UnknownPasteError,"failed to load the base64 image!"))},a.src=e}))},e.prototype.isSupportedExtension=function(e){return no.indexOf(e)>=0},e.prototype.getRegExStringValue=function(e,t){var r=new RegExp(t,"g").exec(e);return r&&r.length&&r.length>1?r[1]:oo},e}();function go(e,t){return ro&&ro[e]?ro[e]:t}function ho(e){return""===e}function So(e){return null==e}var yo=function(){function e(e){this._visioController=e}return e.prototype.beforePaste=function(e){},e.prototype.deserialize=function(e){try{var t=e.clipboardItems,r=new lo;if(e.isClipboardInaccessible)throw new D(d.ClipboardIsInaccessible,"clipboard is not accessible");if(!t)throw new D(d.ReadFromClipboardReturnNullOrUndefined,"clipboardItems is null!");var a=t.getItem(Ka.TextHtml),o=t.getItem(Ka.TextPlain);if(!a&&!o)throw new D(d.ClipboardIsEmpty,"Html/Text Data is not present in clipboard!");return r.HtmlData=So(a)||ho(a)?void 0:a,r.PlainText=So(o)||ho(o)?void 0:o,this._visioController.setClipboardData(r),Promise.resolve()}catch(e){return Promise.reject(e)}},e.prototype.shouldWaitForCopyToComplete=function(e){return!1},e.prototype.onDeferredPasteStarted=function(e){},e.prototype.onDeferredPasteCompleted=function(e){},e}(),Co=function(){function e(e){this._visioController=e}return e.prototype.getCopyFlowHandler=function(e){return new co(this._visioController)},e.prototype.getPasteFlowHandler=function(e){return"true"===go("VisioWebEditTextContextMenuEnabled","false").toLowerCase()&&this._visioController.getSupportedPasteFlow()===Ya.TextPasteFlow?new yo(this._visioController):new fo(this._visioController)},e.prototype.initializePasteContext=function(e){},e.prototype.getSessionId=function(){return this._visioController.getUserSessionID()},e}(),bo=function(){function e(e,t,r,a){this._copyToClipboardLatencyMessage=t,this._userSessionID=e,this._ccpLogger=r,this._wacDataCenter=a,this._isSafari=function(){if(window&&window.navigator){var e=window.navigator.userAgent.toLowerCase();return e.indexOf("safari")>=0&&e.indexOf("chrome")<0&&e.indexOf("edge")<0}return!1}(),this._supportedPasteFlow=Ya.DefaultPasteFlow}return e.prototype.isChangeGateEnabled=function(e){return!0},e.prototype.getCopyToClipboardLatencyMessage=function(){return this._copyToClipboardLatencyMessage},e.prototype.setClipboardData=function(e){if(this._clipboardData)throw new N(c.SetClipboardItems,"setClipboardData() called before last operation was complete!");this._clipboardData=e},e.prototype.setSupportedPasteFlow=function(e){this._supportedPasteFlow=e},e.prototype.getClipboardData=function(){if(!this._clipboardData)throw new N(c.GetClipboardItems,"GetClipboardData() called with null value of visioController.clipboardData!");var e=this._clipboardData;return this.clearClipboardData(),e},e.prototype.getUserSessionID=function(){return this._userSessionID},e.prototype.getWACDatacenter=function(){return this._wacDataCenter},e.prototype.getCCPLogger=function(){return this._ccpLogger},e.prototype.clearClipboardData=function(){this._clipboardData=void 0},e.prototype.isSafariBrowser=function(){return this._isSafari},e.prototype.getSupportedPasteFlow=function(){return this._supportedPasteFlow},e}(),vo=function(){function e(e,t,r,a,o,n,i){void 0===n&&(n=oo),void 0===i&&(i=oo);var s=this;this._metadataChangeListenerId="VisioMetadataChangeListenerId",this.onMetadataChanged=function(e){s._metadataChangeListener&&s._metadataChangeListener(e)},this._ccpLogger=t,this._visioController=new bo(e,r,t,n),this._applicationHost=new Co(this._visioController),this._metadataChangeListener=o,this._userHash=a,this._bulsEndpointUrl=i,this.initCCPEnvironment()}return e.prototype.getCopyPasteFlowManager=function(){return this._copyPasteFlowManager?Promise.resolve(this._copyPasteFlowManager):this.initCCPEnvironment()},e.prototype.getMetadataManager=function(){return this._metadataManager},e.prototype.getApplicationHost=function(){return this._applicationHost},e.prototype.internalCopy=function(e){return e.id=io.Z.generate(),this.getCopyPasteFlowManager().then((function(t){return t.onCopy(e)}),(function(e){return Promise.reject(e)}))},e.prototype.internalPaste=function(e){return e.id=io.Z.generate(),this.getCopyPasteFlowManager().then((function(t){return t.onPaste(e)}),(function(e){return Promise.reject(e)}))},e.prototype.initCCPEnvironment=function(){return(0,t.__awaiter)(this,void 0,void 0,(function(){var e=this;return(0,t.__generator)(this,(function(t){return[2,this.configureClipBoardEnvironment().then((function(t){return e._metadataManager=t.getMetadataManager(),e._metadataManager.addMetadataChangeListener(e._metadataChangeListenerId,e.onMetadataChanged),e._copyPasteFlowManager=function(e,t,r,a){return new Yt(e,t,r)}(t,e._applicationHost,e._ccpLogger),e._ccpLogger.traceTag(555872907,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"initCCPEnvironment() completed successfully"),Promise.resolve(e._copyPasteFlowManager)}),(function(e){return Promise.reject(e)}))]}))}))},e.prototype.configureClipBoardEnvironment=function(){var e=this;this._clipboardPlatformEnvironment=Ba();var t=new so,r={clipboardStrategyType:s.LocalStorage,useSharedClipboardIframe:!1,sharedClipboardSchemaVersion:1.1},a={clipboardStrategyType:s.SystemClipboard,skipFilesIfPlainTextExists:!1},o=[{clipboardStrategyType:s.SystemClipboardAndLocalStorage,localStorageStrategyParameters:r,systemClipboardStrategyParameters:a},{clipboardStrategyType:s.SystemClipboardAndInMemory}];return this._clipboardPlatformEnvironment.init(void 0,this._ccpLogger,ao,"","","",!1,1,3600,2,this._visioController.getCopyToClipboardLatencyMessage(),"DC2",t,o,void 0,void 0,void 0,void 0,this._bulsEndpointUrl).then((function(){return e._clipboardPlatformEnvironment}),(function(e){throw new N(c.UnsupportedOperationCode,"Clipboard Init failed! with error:'".concat(e.name,"' message: '").concat(e.message,"'"))}))},e.prototype.copy=function(e,t,r,a,n){var i=this,s={id:this._visioController.getUserSessionID(),pKey:"",clipServiceDataType:"Unknown",objectCount:-1,clipServiceDataCenter:"Unknown",uploadToClipService:!1,userHash:this._userHash,commandType:t?K.Cut:K.Copy,isKeyboardEvent:e,silentClipboardAccessFailures:!1,ribbonCommandInfo:null,stopwatch:null};try{this._visioController.setClipboardData(r)}catch(e){return void n($a.UnknownError)}this.internalCopy(s).then((function(e){e instanceof Pt&&!0===e.succeededPopulatingSystemClipboardSync?(i._ccpLogger.traceTag(555872908,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"Internal copy was successful , ready to call copySuccessCallback "),a()):(i._ccpLogger.traceTag(555872909,o.WN.msoulscat_ES_EWAJS,o.Gu.Warning,"failed to populate System Clipboard in Sync manner"),n($a.UnknownError))}),(function(e){n(i.getPackageCopyError(e))}))},e.prototype.paste=function(e,t,r){var a=this,n={id:this._visioController.getUserSessionID(),userHash:this._userHash,isKeyboardEvent:e,commandType:K.Paste,silentClipboardAccessFailures:!1,ribbonCommandInfo:null,stopwatch:null,skipClipboardAccess:!1,clearStateOnFinish:!1,clearSystemClipboard:!1,originalDestination:null,expandDestination:null};this.internalPaste(n).then((function(e){a._ccpLogger.traceTag(555872910,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"InnerPaste() completed successfully");var r=a._visioController.getClipboardData();t(r)}),(function(e){throw e})).catch((function(e){r(a.getPackagePasteError(e))}))},e.prototype.pasteWithSpecificHandler=function(e,t,r,a){var n=this,i={id:this._visioController.getUserSessionID(),userHash:this._userHash,isKeyboardEvent:t,commandType:K.Paste,silentClipboardAccessFailures:!1,ribbonCommandInfo:null,stopwatch:null,skipClipboardAccess:!1,clearStateOnFinish:!1,clearSystemClipboard:!1,originalDestination:null,expandDestination:null};this._visioController.setSupportedPasteFlow(e),this.internalPaste(i).then((function(e){n._ccpLogger.traceTag(512349838,o.WN.msoulscat_ES_EWAJS,o.Gu.Info,"InnerPaste() completed successfully in pasteWithSpecificHandler");var t=n._visioController.getClipboardData();r(t)}),(function(e){throw e})).catch((function(e){a(n.getPackagePasteError(e))}))},e.prototype.initializeAppSettings=function(e){!function(e){ro=e;try{JSON.parse(go("DisabledChangeGates","{}"))}catch(e){}}(e)},e.prototype.getPackagePasteError=function(e){var t=qa.UnknownError;switch(e.reason){case d.MissingArgumentError:case d.PasteFlowHandlerNotFound:case d.FetchPasteFlowHandlerFailed:case d.UnknownPasteError:t=qa.UnknownError;break;case d.FailedToReadFromClipboard:case d.InspectClipboardFailed:case d.SuccessivePasteOverridingPendingPaste:case d.FileReaderResultIsEmpty:case d.FileReaderFailed:case d.DeferredPasteRejectedBecauseOtherCopyCompleted:case d.DeferredPasteRejectedBecauseOtherCopyStarted:case d.DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext:t=qa.ExpectedError;break;case d.DeserializeOperationFailed:e.innerError.reason===d.ClipboardIsInaccessible?t=qa.ClipboardIsInaccessible:e.innerError.reason===d.ClipboardIsEmpty?t=qa.UnsupportedClipboardFormat:e.innerError.reason===d.ReadFromClipboardReturnNullOrUndefined?t=qa.ClipboardIsEmpty:(e.innerError.reason===d.UnknownPasteError||e.innerError.reason===c.SetClipboardItems)&&(t=qa.UnknownError);break;case d.ClipboardIsEmpty:case d.ReadFromClipboardReturnNullOrUndefined:t=qa.ClipboardIsEmpty;break;case d.ClipboardIsInaccessible:t=qa.ClipboardIsInaccessible;break;case c.GetClipboardItems:case c.UnsupportedOperationCode:t=qa.UnknownError}return t},e.prototype.getPackageCopyError=function(e){var t=$a.UnknownError;switch(e.reason){case l.MissingArgumentError:case l.CopyFlowHandlerNotFound:case l.FetchCopyFlowHandlerFailed:case l.FetchSourceItemFailed:case l.BeforeSerializeFailed:case l.SerializeFailed:case l.SerializeResultNotValid:case l.UnknownCopyErrorType:t=$a.UnknownError;break;case l.AsyncSerializeFailed:case l.InspectClipboardFailed:case l.SaveToTheClipboardFailed:case l.SuccessiveCutCopyOverridingPendingCutCopy:case l.BlockedSynchronousCutCopy:case l.CopyOperationCancelled:t=$a.ExpectedError;break;case l.ClipboardIsInaccessible:t=$a.ClipboardIsInaccessible;break;case c.UnsupportedOperationCode:t=$a.UnknownError}return t},e}();function Eo(){console.log("on copy Success!")}function wo(e){console.log(e),alert("copy failed!!")}function _o(e){console.log(e.base64Image)}function Po(e){console.log(e),alert("Paste Failed!")}var Io=new(function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,a){},e.prototype.assertTag=function(e,t,r,a){},e.prototype.traceTag=function(e,t,r,a){},e.prototype.dnmTraceTag=function(e,t,r,a){},e.prototype.debugTraceTag=function(e,t,r,a){},e}()),To=new vo("123456",Io,"Wait copy is in Progress!!",123456,(function(e){console.log(e)}));function Wo(){var e=new lo;To.copy(!1,!1,e,Eo,wo)}function Ao(){To.paste(!1,_o,Po)}}(),visioClipboard=a}();
//# sourceMappingURL=visioClipboard.min.js.map