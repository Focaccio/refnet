function sendPostMessageToHostFrame(n,t){try{if(g_postMessageOrigin==null||window.parent==null)return;t||(t={});var i={MessageId:n,SendTime:Date.now(),Values:t};window.parent.postMessage(JSON.stringify(i),g_postMessageOrigin)}catch(r){}}function registerAndHandleModeSwitchPostMessageFromHostFrame(){window.addEventListener("message",function(n){var i,t,r;try{if(n==null||g_postMessageOrigin==null||n.origin!=g_postMessageOrigin)return;if(i=JSON.parse(n.data),i.MessageId=="Visio_SwitchMode_FromHostFrame"){if(!g_bgEditAppSettings||!backgroundEditAppPageInit){r={IsSuccess:!1,ErrorMsg:"Background edit app settings or edit app is not available"};sendPostMessageToHostFrame(g_modeSwitchPostMessageAckToHost,r);return}t=i.Values;t&&t.toString().length>0&&(g_bgEditAppSettings.VisioModeSwitchClickTime=t.wdModeSwitchTime,g_bgEditAppSettings.VisioPreviousModeIlt=t.prevModeILT,g_bgEditAppSettings.VisioPreviousModeFFS=t.prevModeFFS,t.dct&&(g_bgEditAppSettings.VODCT=t.dct));g_isBackgroundEditAppInitialized||(g_isBackgroundEditAppInitialized=!0,backgroundEditAppPageInit(g_bgEditAppSettings));sendPostMessageToHostFrame(g_modeSwitchPostMessageAckToHost,{IsSuccess:!0});return}i.MessageId=="Host_Unload"&&g_isEditBackgroundSessionUnloadFixEnabled&&g_isEditBackgroundSession&&!g_isBackgroundEditAppInitialized&&sendPostMessageToHostFrame("App_Unloaded")}catch(u){r={IsSuccess:!1,ErrorMsg:u.toString()};sendPostMessageToHostFrame(g_modeSwitchPostMessageAckToHost,r)}})}function makeInitialRequest(n){var i,f,e,r,s,t,h;if(!g_isInitialRequestFired){if(i=n.IsFilelessSession=="True"?!0:!1,f=n.IsAppShellPrebootSession=="True"?!0:!1,(i||f)&&g_makeInitialRequestDelegate==null){g_makeInitialRequestDelegate=function(t){for(var i in t)n[i]=t[i];makeInitialRequest(n)};return}g_isInitialRequestFired=!0;g_makeInitialRequestDelegate=null;e=n.PngBootEnabled=="True"?!0:!1;g_useHostCache="HostBundleSrc"in n&&n.HostBundleSrc!="";r=Sys.Serialization.JavaScriptSerializer.serialize(n.RootQuerySignature);g_fileId=r.substring(1,r.length-1);var c=n.LockPropertiesEnabled=="True"?!0:!1,l=n.BlockLayersBasedOnSettings=="True"?!0:!1,a=n.BlockSolutions=="True"?!0:!1,v=n.BlockThemes=="True"?!0:!1,w=n.CFFRibbonInEditEnabled=="True"?!0:!1,y=n.LocalizedCFFInEditEnabled=="True"?!0:n.Lcid=="1033",o=n.UMLEnabled=="True"?!0:!1,u=n.ZeroByteEditNewOptimizationsEnabled=="True"?!0:!1,p=n.SequencialBootRequestsEnabled=="True"?!0:!1;g_isEditBackgroundSession=n.IsEditBackgroundSession=="True"?!0:!1;g_isEditBackgroundSessionUnloadFixEnabled=n.VisioBootBackgroundSessionUnloadFixEnabled=="True"?!0:!1;s=n.UnifyHighDPIFixEnabled=="True"?!0:!1;g_postMessageOrigin=n.VisioBootstrapperPostMessageOrigin;g_layersLockUnsupported=n.VisioWebEditLayerEnabled=="True"?!1:!0;n.MaxNumberOfShapesPerPage&&(g_maxNumberOfShapesPerPageSupported=n.MaxNumberOfShapesPerPage);y&&(g_listOfSolutionsSupported.splice(0,0,"CFF14"),n.VisioIsMindmapStencilsEnabled=="True"&&g_listOfSolutionsSupported.splice(0,0,"VizJSAddon_MindMap"),n.VisioWebPersistOrgChartSolutionEnabled=="True"&&n.VisioIsOrgChartSolutionSupported=="True"&&g_listOfSolutionsSupported.splice(0,0,"VizJSAddon_Orgchart"));n.VisioWebAdditionalShapeProtectionSupportEnabled=="True"&&(g_supported1DLocksFlag|=ProtectionLocks.LOCK_BEGIN|ProtectionLocks.LOCK_END|ProtectionLocks.LOCK_REPLACE|ProtectionLocks.LOCK_FORMAT|ProtectionLocks.LOCK_SELECT|ProtectionLocks.LOCK_CROP|ProtectionLocks.LOCK_CUSTPROP,g_supportedOther2DLocksFlag|=ProtectionLocks.LOCK_CROP|ProtectionLocks.LOCK_CUSTPROP|ProtectionLocks.LOCK_BEGIN|ProtectionLocks.LOCK_END);n.VisioWebFallbackToPNGEnabled=="False"&&(g_unsupportedFeaturesFlag|=WireFeatures.OptimizedForSVG);n.VisioWebProtectBackgroundSupportEnabled!="True"&&(g_unsupportedFeaturesFlag|=WireFeatures.ProtectBackground);n.VisioWebSDDisabledOnPageSupportEnabled!="True"&&(g_unsupportedFeaturesFlag|=WireFeatures.SDDisabledOnPage);n.VisioWebNegativeShapeDimensionEnabled=="True"&&(g_negative2DShapeDimensionSupported=!0);initHighContrastcolors(n);t=new _wireGetDomRequest;t.DrawingID=g_fileId;t.HighContrastSettings=new _wireHighContrastSetting;t.HighContrastSettings.IsHighContrastMode=g_isInHighContrastMode;t.HighContrastSettings.ForegroundColor=g_foregroundColor;t.HighContrastSettings.BackgroundColor=g_backgroundColor;t.SourceTemplateId=null;t.IsDebugMode=n.DebugMode=="True"?!0:!1;t.IncludeFormulas=n.ClientReCalcEnabled=="True"?!0:!1;n.RequestTemplateId&&(t.SourceTemplateId=n.RequestTemplateId);t.IsBackgroundSession=!1;g_isEditBackgroundSession&&(t.IsBackgroundSession=!0);t.UnsupportedFeatures=new _wireUnsupportedFeatures;n.AppMode=="Edit"&&(t.UnsupportedFeatures.UnsupportedFeaturesFlag=g_unsupportedFeaturesFlag,t.UnsupportedFeatures.NonSinglePageFeature=new _wireNonSinglePageFeatureIn,t.UnsupportedFeatures.NonSinglePageFeature.ZeroPageSupported=g_zeroPageSupported,t.UnsupportedFeatures.NonSinglePageFeature.MoreThanOnePageSupported=!0,t.UnsupportedFeatures.Protection1DFeature=new _wireProtectionFeatureIn,t.UnsupportedFeatures.Protection1DFeature.SupportedProtectionFlag=g_supported1DLocksFlag|g_networkDiagrams1DLocks,o&&(t.UnsupportedFeatures.Protection1DFeature.SupportedProtectionFlag|=g_umlWireframe1DLocks),c?(t.UnsupportedFeatures.Protection2DFeature=new _wireProtectionFeatureIn,t.UnsupportedFeatures.Protection2DFeature.SupportedProtectionFlag=g_supportedBasic2DLocksFlag|g_supportedOther2DLocksFlag|g_networkDiagrams2DLocks,o&&(t.UnsupportedFeatures.Protection2DFeature.SupportedProtectionFlag|=g_umlWireframe2DLocks)):(t.UnsupportedFeatures.Protection2DFeature=new _wireProtectionFeatureIn,t.UnsupportedFeatures.Protection2DFeature.SupportedProtectionFlag=g_supportedBasic2DLocksFlag),t.UnsupportedFeatures.LayersFeature=new _wireLayersFeatureIn,l?(t.UnsupportedFeatures.LayersFeature.SupportedLayerNames=null,t.UnsupportedFeatures.LayersFeature.PrintUnsupported=g_layersPrintUnsupported,t.UnsupportedFeatures.LayersFeature.ActiveUnsupported=g_layersActiveUnsupported,t.UnsupportedFeatures.LayersFeature.LockUnsupported=g_layersLockUnsupported,t.UnsupportedFeatures.LayersFeature.SnapUnsupported=g_layersSnapUnsupported,t.UnsupportedFeatures.LayersFeature.GlueUnsupported=g_layersGlueUnsupported,t.UnsupportedFeatures.LayersFeature.ColorUnsupported=g_layersColorUnsupported,t.UnsupportedFeatures.LayersFeature.TransparencyUnsupported=g_layersTransparencyUnsupported):t.UnsupportedFeatures.LayersFeature.SupportedLayerNames=g_supportedLayerNames,t.UnsupportedFeatures.DataConnectedFeature=new _wireDataConnectedFeatureIn,t.UnsupportedFeatures.SVGNonCompatFeature=new _wireSVGNonCompatFeatureIn,t.UnsupportedFeatures.NegativeShapeDimensionFeature=new _wireNegativeShapeDimensionFeatureIn,t.UnsupportedFeatures.NegativeShapeDimensionFeature.Shape2DSupported=g_negative2DShapeDimensionSupported,t.UnsupportedFeatures.NegativeShapeDimensionFeature.Shape1DSupported=g_negative1DShapeDimensionSupported,t.UnsupportedFeatures.NumberOfShapesFeature=new _wireNumberOfShapesFeatureIn,t.UnsupportedFeatures.NumberOfShapesFeature.MaxNumberOfShapesPerPageSupported=g_maxNumberOfShapesPerPageSupported,t.UnsupportedFeatures.NumberOfPagesFeature=new _wireNumberOfPagesFeatureIn,t.UnsupportedFeatures.NumberOfPagesFeature.MaxNumberOfPagesSupported=g_maxNumberOfPagesSupported,a&&(t.UnsupportedFeatures.SolutionsFeature=new _wireSolutionsFeatureIn,t.UnsupportedFeatures.SolutionsFeature.AllSolutionsSupported=g_solutionsAllSupported,t.UnsupportedFeatures.SolutionsFeature.SolutionsSupported=g_listOfSolutionsSupported),v&&(t.UnsupportedFeatures.ThemingFeature=new _wireThemingFeatureIn,t.UnsupportedFeatures.ThemingFeature.ColorSchemes=g_listOfColorSchemesSupported,n.VisioWebMoreThemesEnabled!="True"?(t.UnsupportedFeatures.ThemingFeature.EffectSchemes=g_listOfEffectSchemesSupportedOld,t.UnsupportedFeatures.ThemingFeature.ConnectorSchemes=g_listOfConnectorSchemesSupportedOld,t.UnsupportedFeatures.ThemingFeature.FontSchemes=g_listOfFontSchemesSupportedOld,t.UnsupportedFeatures.ThemingFeature.ThemeSchemes=g_listOfThemeSchemesSupportedOld):(t.UnsupportedFeatures.ThemingFeature.EffectSchemes=g_listOfEffectSchemesSupported,t.UnsupportedFeatures.ThemingFeature.ConnectorSchemes=g_listOfConnectorSchemesSupported,t.UnsupportedFeatures.ThemingFeature.FontSchemes=g_listOfFontSchemesSupported,t.UnsupportedFeatures.ThemingFeature.ThemeSchemes=g_listOfThemeSchemesSupported)),n.VisioWebProtectBackgroundSupportEnabled!="True"&&(t.UnsupportedFeatures.ProtectBackgroundFeature=new _wireProtectBackgroundFeatureIn),n.VisioWebSDDisabledOnPageSupportEnabled!="True"&&(t.UnsupportedFeatures.SDDisabledOnPageFeature=new _wireSDDisabledOnPageFeatureIn),n.VisioWebFallbackToPNGEnabled=="False"&&(t.UnsupportedFeatures.OptimizedForSVGFeature=new _wireOptimizedForSVGFeatureIn));g_useHostCache=g_useHostCache&&canSendHostCacheBootRequest(n,t);g_useHostCache&&(g_switchToWACRequestsCallback=function(){switchToWACRequests(n,t)});g_initialRequestInvokedTime=new Date;g_useHostCache||e&&!i&&(sendInitDocViewRequest(n,t),g_initialDocViewRequestMade=!0);n.IsEditBackgroundSession==="True"&&(g_backgroundSessionRetryLogicEnabled=!0);n.BackgroundSessionMaxRetryCount&&(g_maxRetryCount=parseInt(n.BackgroundSessionMaxRetryCount,10));n.BackgroundSessionRetryDelayInMillis&&(g_timeoutInMilliSec=parseInt(n.BackgroundSessionRetryDelayInMillis,10));g_initialRequestViewScale=s?n.IsHighDPI=="true"?4:n.IsHighDPI=="false"?2:getViewScale():getViewScale();g_initialDocInfoRequestInvokedTime=new Date;g_useHostCache?n.AppMode==="Edit"&&n.VisioWebHostCacheForEditUseEnabled=="True"?(g_initialHostDocInfoRequest=sendInitRequestHost(n,"edi"+parseInt(g_initialRequestViewScale)+".json",onInitialHostDocInfoRequestCompletedforWRS,t),t.IsValidateIfHostFileDOMCacheValid=!0,g_initialHostDocInfoRequestMade=!0,sendInitDocInfoRequest(n,t,u,OnInitialDocInfoRequestToValidateHostCacheCompleted),t.IsValidateIfHostFileDOMCacheValid=!1):n.AppMode==="Consumption"&&(g_HostBasedBundleValidToUse=!0,g_HostBundleValidityRequestCompleted=!0,n.VisioWebHostCacheForEditUseEnabled=="True"?(g_initialHostDocInfoRequest=sendInitRequestHost(n,"di"+parseInt(g_initialRequestViewScale)+".json",onInitialHostDocInfoRequestCompletedforWRS,t),g_initialHostDocInfoRequestMade=!0):(g_initialDocInfoRequest=sendInitRequestHost(n,"di"+parseInt(g_initialRequestViewScale)+".json",onInitialHostDocInfoRequestCompleted,t),g_initialDocInfoRequestMade=!0)):(p&&g_initialDocViewRequestMade?g_initialDocInfoPendingRequest=function(){sendInitDocInfoRequest(n,t,u,onInitialDocInfoRequestCompleted)}:sendInitDocInfoRequest(n,t,u,onInitialDocInfoRequestCompleted),g_initialDocInfoRequestMade=canSendWacBootRequest(n,t)?!0:!1);g_useHostCache&&(n.AppMode=="Consumption"&&(n.GetHostDocImageUsingPostMessage=="True"?g_getInitialDocImageFromHostFrame=!0:(g_initialDocViewRequest=sendInitRequestHost(n,"fv.json",onInitialHostDocViewRequestCompleted,t),g_initialDocViewRequestMade=!0,g_initialDocImageElement=document.createElement("img"),g_initialDocImageElement.addEventListener("load",function(){g_initialDocImageRequestResponse=getBase64ImageUsingCanvas(g_initialDocImageElement);g_initialDocImageRequestResponse==null&&(g_initialDocImageRequestResponse="",g_initialDocImageRequestFailed=!0);g_initialDocImageResponseTime=new Date;completeHostDocViewRequests(n)}),g_initialDocImageElement.addEventListener("error",function(){g_initialDocImageRequestFailed=!0;g_initialDocImageRequestResponse="";g_initialDocImageResponseTime=new Date;completeHostDocViewRequests(n)}),h=n.HostBundleSrc,g_initialDocImageElement.crossOrigin="anonymous",g_initialDocImageElement.setAttribute("src",h.replace("{0}","fpd.png")),g_initialDocImageRequestMade=!0,g_initialDocImageRequestInvokedTime=new Date)),n.VisioWebHostCacheForEditUseEnabled=="True"&&(g_featureRequestMade=!0,g_FeaturesRequest=sendInitRequestHost(n,"fl.json",onFeaturesRequestCompleted,t)));n.VisioWebEnableGetFeaturesOptimizations=="True"&&sendInitFeaturesRequest(n,t)}}function onFeaturesRequestCompleted(n,t){g_featureRequestCompleted=!0;g_featureResponse=t.responseText;g_featureResponseStatusCode=t.status;t.status==200&&generateSHA256Hash(g_featureResponse,function(n){g_featureResponseHash=n;g_featureResponseHashGenerated=!0},function(n){g_featureResponseHash=null;g_featureResponseHashGenerated=!1;g_featureResponseHashFailureReason=n})}function sendInitDocViewRequest(n,t){var i=getInitRequestWAC(n,!1),r;i.add_completed(onInitialDocViewRequestCompleted);t.PageView=!0;t.ViewScale=2;r=JSON.stringify(t);i.set_body(r);i.invoke()}function sendInitFeaturesRequest(n,t){var i=JSON.parse(JSON.stringify(t)),r,u;g_initialDocFeatureRequestMade=!0;r=getInitRequestWAC(n,!1);r.add_completed(onInitialFeatureRequestCompleted);i.PageView=!1;i.DomJsonRequest=!1;i.FeaturesRequest=!0;i.ForceBypassCache=!1;i.IncludeFormulas=!1;i.HighContrastSettings=null;i.ViewScale=null;i.IsValidateIfHostFileDOMCacheValid=!1;u=JSON.stringify(i);r.set_body(u);r.invoke()}function sendInitDocInfoRequest(n,t,i,r){var c,l,e,u,o,s,h,f,a;if(i)c=n.LocallyDeployedJsonsEnabled=="True"?!0:!1,c?(l=getTemplateJSONFromCDNRequest(n,onInitialDocInfoRequestFromCDNCompleted),n.VisioWebHostCacheForEditUseEnabled=="True"&&(g_initialDocInfoRequest=l)):(f=getInitRequestWAC(n,!0),f.add_completed(r),e=n.ClientReCalcFixForNLDZBCNEnabled=="True"&&n.ClientReCalcEnabled=="True"?!0:!1,u=g_isInHighContrastMode?n.WebServiceBase+(e?g_createNewGetUrlInHCWithFormulas:g_createNewGetUrlInHC):n.WebServiceBase+(e?g_createNewGetUrlWithFormulas:g_createNewGetUrl),u=u.replace("{0}","true"),u=u.replace("{1}","true"),u=u.replace("{2}","false"),u=u.replace("{3}",g_initialRequestViewScale),o="",n.RequestTemplateId&&(o=n.RequestTemplateId),u=u.replace("{4}",o),s=n.ZeroByteCreateNewRequestLcid,u=u.replace("{5}",s?s:""),h=n.CreateNewUICulture,u=u.replace("{6}",h?h:""),u=u.replace("{7}",n.CreateNewDomHTTPCacheVersion),u=u.replace("{8}",n.BuildVersion),u=u.replace("{9}",g_isInHighContrastMode),g_isInHighContrastMode&&(u=u.replace("{10}",g_foregroundColor),u=u.replace("{11}",g_backgroundColor)),f.set_url(u),g_fileId&&(f.get_headers().DrawingID=g_fileId),f.invoke(),n.VisioWebHostCacheForEditUseEnabled=="True"&&(g_initialDocInfoRequest=f));else{if(!canSendWacBootRequest(n,t))return null;f=getInitRequestWAC(n,!1);f.add_completed(r);t.PageView=!1;t.DomJsonRequest=!0;g_backgroundSessionRetryLogicEnabled&&(g_PreservedAppSettings=n,g_PreservedBodyObj=t,g_PreservedIsZeroBytesEditNew=i);t.ViewScale=g_initialRequestViewScale;a=JSON.stringify(t);f.set_body(a);f.invoke();n.VisioWebHostCacheForEditUseEnabled=="True"&&(g_initialDocInfoRequest=f)}}function canSendWacBootRequest(n,t){var i=n.IsEditBackgroundSession==="True";return i&&t.HighContrastSettings&&t.HighContrastSettings.IsHighContrastMode?!1:!0}function canSendHostCacheBootRequest(n,t){var i=n.AppMode==="Edit",r=n.IsEditBackgroundSession==="True";return(i||r)&&t.HighContrastSettings&&t.HighContrastSettings.IsHighContrastMode?!1:!0}function sendInitRequestHost(n,t,i,r){var f=n.HostBundleSrc,u;return f=f.replace("{0}",t),u=new XMLHttpRequest,u.onreadystatechange=function(){u.readyState===4&&i(n,u,r)},u.open("GET",f),u.send(),u}function getTemplateJSONFromCDNRequest(n,t){var f=n.StaticContentHost,e="resources/"+n.CreateNewUICultureBasedLcid+"/",r="",u,i;return n.RequestTemplateId&&(r=n.RequestTemplateId),r==""&&(r="blank"),r=r+".json",u=f+e+r,i=new XMLHttpRequest,i.onreadystatechange=function(){i.readyState===4&&t(i)},i.open("GET",u),i.send(),i}function getInitRequestWAC(n,t){var r=n.SessionId,u=n.BuildVersion,c=n.WebServiceBase+"/v/get",f=n.Canary,e=n.SessionInfo,o=n.AccessToken,s=n.UserType,h=n.WacCluster,l=n.LogHostRequests=="true"?1:0,a=n.RedirectUrlPassedByHeaderEnabled=="True"?!0:!1,i=new Sys.Net.WebRequest;return i.set_url(c),i.get_headers()["X-xhr"]="1",r&&(i.get_headers()["X-UserSessionId"]=r),u&&(i.get_headers()["X-OfficeVersion"]=u),t?i.set_httpVerb("GET"):i.set_httpVerb("POST"),i.get_headers()["Content-Type"]="application/json; charset=utf-8",f&&(i.get_headers()["X-Key"]=f),o&&(i.get_headers()["X-AccessToken"]=o),s&&(i.get_headers()["X-UserType"]=s),h&&(i.get_headers()["X-WacCluster"]=h),l===1&&(i.get_headers()["X-LogHostRequests"]="1"),e&&(i.get_headers().si=e),a&&(i.get_headers()["X-PageUrl"]=window.location.href),i}function initHighContrastcolors(n){var t=document.createElement("div"),i,u,r;t.id="highContrastDetectionDiv";t.setAttribute("aria-hidden","true");i=document.createElement("a");i.setAttribute("href","#");i.id="highContrastDetectionAnchor";t.appendChild(i);document.body.appendChild(t);u=getCurrentStyle(i);g_isInHighContrastMode=u.backgroundImage.toLowerCase().indexOf("highcontrastdetectordefault")==-1;g_isInHighContrastMode&&(r=getCurrentStyle(t),g_foregroundColor=convertRgbRawtToHex(r.color.toLowerCase()),g_backgroundColor=convertRgbRawtToHex(r.backgroundColor.toLowerCase()));n.VisioWebIsFocusTrappedInAppForEmbedFixEnabled==="True"&&document.body.removeChild(t)}function getCurrentStyle(n){var t=null;return(n.ownerDocument&&n.ownerDocument.defaultView&&n.ownerDocument.defaultView.getComputedStyle&&(t=n.ownerDocument.defaultView.getComputedStyle(n,"")),!t&&n.currentStyle)?n.currentStyle:t}function convertRgbRawtToHex(n){if(n.startsWith("rgb(")){var r=n.indexOf("("),t=n.indexOf(","),i=n.lastIndexOf(","),u=n.indexOf(")");if(r!==-1&&t!==-1&&i!==-1&&t!==i&&u!==-1){var f=n.substring(r+1,t),e=n.substring(t+1,i),o=n.substring(i+1,u);return convertRgbToHex(f,e,o)}}return null}function convertRgbToHex(n,t,i){var r=convertToHex(parseInt(i),2),u=convertToHex(parseInt(t),2),f=convertToHex(parseInt(n),2);return"#"+f+u+r}function convertToHex(n,t){for(var i=n.toString(16);i.length<t;)i="0"+i;return i.toLowerCase()}function getDevicePixelRatio(){var n=window.devicePixelRatio;return isNaN(n)&&(n=window.screen.deviceXDPI/window.screen.logicalXDPI,isNaN(n)&&(n=1)),n}function getDensityIndependentPixel(){var n=96,t=window.navigator.platform;switch(t.toLowerCase()){case"iphone":case"ipod":case"ipad":n=163;break;case"linux armv7l":case"linux aarch64":case"linux i686":case"android":n=160;break;default:n=96}return n}function getViewScale(){var n=Math.max(window.screen.availWidth,window.screen.availHeight),t=getDevicePixelRatio(),i=getDensityIndependentPixel();return n/i>=10&&t>1.25?4:2}function docViewDecryptionCompleted(n,t){g_initialDocViewRequestMade&&!g_initialDocViewRequestCompleted&&(g_initialDocViewRequestCompleted=!0,g_initialResponseTime=new Date,g_initialDocViewLoadedFromBrowser=!0,g_useHostCache&&(alert("Assert! Error!"),g_initialDocViewResponseHash=convertBase64toHexaDecimal(t)),g_initialDocViewRequestResponse=n,g_initialDocViewRequestStatusCode=200,g_initialDocViewResponseCallback!=null&&g_initialDocViewResponseCallback(null,null))}function docInfoDecryptionCompleted(n,t){!g_initialDocInfoRequestMade||g_initialDocInfoRequestCompleted||g_initialDocInfoRequestResponse||(g_initialDocInfoRequestCompleted=!0,g_initialDocInfoLoadedFromBrowser=!0,g_initialDocInfoResponseTime=new Date,g_useHostCache&&(g_initialDocInfoResponseHash=convertBase64toHexaDecimal(t)),g_initialDocViewRequestMade||(g_initialResponseTime=g_initialDocInfoResponseTime),g_initialDocInfoRequestResponse=n,g_initialDocInfoRequestStatusCode=200,g_initialDocInfoResponseCallback!=null&&g_initialDocInfoResponseCallback(null,null))}function onInitialDocViewRequestCompleted(n){if(g_initialDocInfoPendingRequest&&g_initialDocInfoPendingRequest(),g_initialDocViewRequestMade&&!g_initialDocViewRequestCompleted){g_initialDocViewRequestCompleted=!0;g_initialResponseTime=new Date;g_initialRequestResponseSessionInfoHeader=n.getResponseHeader("si");g_initialRequestResponseCorrelationId=n.getResponseHeader("X-CorrelationId");g_initialRequestResponseUserSessionId=n.getResponseHeader("X-UserSessionId");g_initialDocViewRequest=n;var t=n.get_responseAvailable();g_initialDocViewRequestResponse=t?n.get_responseData():null;g_initialDocViewRequestStatusCode=t?n.get_statusCode():-1;g_initialDocViewResponseCallback!=null&&g_initialDocViewResponseCallback(null,null)}}function onInitialFeatureRequestCompleted(n){g_initialFeatureRequestCompleted=!0;g_initialResponseTime=new Date;g_initialDocFeaturesRequest=n;var t=n.get_responseAvailable();g_initialFeatureRequestResponse=t?n.get_responseData():null;g_initialFeatureRequestStatusCode=t?n.get_statusCode():-1;g_initialFeatureResponseCallback!=null&&g_initialFeatureResponseCallback(null,null)}function OnInitialDocInfoRequestToValidateHostCacheCompleted(n){if(n.get_statusCode()!==200||!n.get_responseAvailable()||JSON.parse(n.get_responseData()).Status!=0){g_HostBasedBundleValidToUse=!1;g_HostBundleValidityRequestCompleted=!0;makeHostDocInfoReponseCallBackIfRequired();g_switchToWACRequestsCallback();return}g_HostBasedBundleValidToUse=!0;g_HostBundleValidityRequestCompleted=!0;makeHostDocInfoReponseCallBackIfRequired()}function onInitialDocInfoRequestCompleted(n){if(g_initialDocInfoRequestMade&&!g_initialDocInfoRequestCompleted&&!g_initialDocInfoRequestResponse){try{if(g_backgroundSessionRetryLogicEnabled&&(n.get_statusCode()!==200||!n.get_responseAvailable()||JSON.parse(n.get_responseData()).Status!==0)&&g_PreservedAppSettings!=null&&g_PreservedBodyObj!=null&&g_retryCount<g_maxRetryCount){g_retryCount++;setTimeout(sendInitDocInfoRequest,g_timeoutInMilliSec,g_PreservedAppSettings,g_PreservedBodyObj,g_PreservedIsZeroBytesEditNew,onInitialDocInfoRequestCompleted);g_timeoutInMilliSec+=g_timeoutInMilliSec;return}}catch(i){}g_initialDocInfoRequestCompleted=!0;g_initialRequestResponseSessionInfoHeader=n.getResponseHeader("si");g_initialDocInfoResponseTime=new Date;g_initialDocViewRequestMade||(g_initialResponseTime=g_initialDocInfoResponseTime,g_initialRequestResponseCorrelationId=n.getResponseHeader("X-CorrelationId"),g_initialRequestResponseUserSessionId=n.getResponseHeader("X-UserSessionId"));g_initialDocInfoRequest==null&&(g_initialDocInfoRequest=n);var t=n.get_responseAvailable();g_initialDocInfoRequestResponse=t?n.get_responseData():null;g_initialDocInfoRequestStatusCode=t?n.get_statusCode():-1;g_initialDocInfoResponseCallback!=null&&g_initialDocInfoResponseCallback(null,null)}}function onInitialDocInfoRequestFromCDNCompleted(n){!g_initialDocInfoRequestMade||g_initialDocInfoRequestCompleted||g_initialDocInfoRequestResponse||(g_initialDocInfoRequestCompleted=!0,g_initialDocInfoResponseTime=new Date,g_initialDocViewRequestMade||(g_initialResponseTime=g_initialDocInfoResponseTime),g_initialDocInfoRequest==null&&(g_initialDocInfoRequest=n),g_initialDocInfoRequestResponse=n.responseText,g_initialDocInfoRequestStatusCode=n.status,g_initialDocInfoResponseCallback!=null&&g_initialDocInfoResponseCallback(null,null))}function onInitialHostDocViewRequestCompleted(n,t){g_useHostCache&&!g_initialHostDocViewRequestAborted&&((!g_initialDocViewRequestMade||g_initialDocViewRequestCompleted)&&alert("Assert! Error!"),g_initialResponseTime=new Date,g_initialDocViewRequestResponse=t.responseText,g_initialDocViewRequestStatusCode=t.status,g_initialDocViewRequestStatusCode==200?completeHostDocViewRequest(n):(g_initialDocViewResponseHash="",completeHostDocViewRequests(n)))}function completeHostDocViewRequest(n){generateSHA256Hash(g_initialDocViewRequestResponse,function(t){g_initialResponseTime=new Date;g_initialDocViewResponseHash=t;completeHostDocViewRequests(n)},function(t){g_generateSHA256FailReason=t;g_initialDocViewResponseHash="";completeHostDocViewRequests(n)})}function makeHostDocInfoReponseCallBackIfRequired(){g_initialHostDocInfoResponseCallbackMade==!1&&g_initialHostDocInfoResponseCallback!=null&&g_HostBundleValidityRequestCompleted==!0&&g_initialHostDocInfoRequestCompleted==!0&&(g_initialHostDocInfoResponseCallbackMade=!0,g_initialHostDocInfoResponseCallback(null,null))}function onInitialHostDocInfoRequestCompletedforWRS(n,t,i){if(!g_useHostCache||!g_initialHostDocInfoRequestMade||g_initialHostDocInfoRequestCompleted||g_initialHostDocInfoRequestResponse||g_initialHostDocInfoRequestAborted){g_initialHostDocInfoResponseHash="";g_initialHostDocInfoRequestCompleted=!0;makeHostDocInfoReponseCallBackIfRequired();return}g_initialDocInfoResponseTime=new Date;g_initialDocViewRequestMade||(g_initialResponseTime=g_initialDocInfoResponseTime);g_initialHostDocInfoRequestResponse=t.responseText;g_initialHostDocInfoRequestStatusCode=t.status;g_initialHostDocInfoRequestStatusCode==200?generateSHA256Hash(g_initialHostDocInfoRequestResponse,function(n){g_initialHostDocInfoResponseHash=n;g_initialHostDocInfoResponseTime=new Date;g_initialHostDocInfoRequestCompleted=!0;makeHostDocInfoReponseCallBackIfRequired()},function(n){g_generateSHA256FailReason=n;g_initialHostDocInfoResponseHash="";g_initialHostDocInfoRequestCompleted=!0;makeHostDocInfoReponseCallBackIfRequired()}):g_initialHostDocInfoRequestStatusCode==404&&n.HostCacheMissFallbackEnabled=="True"?(g_initialHostDocInfoResponseHash="",g_initialHostDocInfoRequestCompleted=!0,makeHostDocInfoReponseCallBackIfRequired(),switchToWACRequests(n,i)):(g_initialHostDocInfoResponseHash="",g_initialHostDocInfoRequestCompleted=!0,makeHostDocInfoReponseCallBackIfRequired())}function onInitialHostDocInfoRequestCompleted(n,t,i){!g_useHostCache||!g_initialDocInfoRequestMade||g_initialDocInfoRequestCompleted||g_initialDocInfoRequestResponse||g_initialHostDocInfoRequestAborted||(g_initialDocInfoResponseTime=new Date,g_initialDocViewRequestMade||(g_initialResponseTime=g_initialDocInfoResponseTime),g_initialDocInfoRequestResponse=t.responseText,g_initialDocInfoRequestStatusCode=t.status,g_initialDocInfoRequestStatusCode==200?generateSHA256Hash(g_initialDocInfoRequestResponse,function(n){g_initialDocInfoResponseHash=n;g_initialDocInfoResponseTime=new Date;g_initialDocInfoRequestCompleted=!0;g_initialDocInfoResponseCallback!=null&&g_initialDocInfoResponseCallback(null,null)},function(n){g_generateSHA256FailReason=n;g_initialDocInfoResponseHash="";g_initialDocInfoRequestCompleted=!0;g_initialDocInfoResponseCallback!=null&&g_initialDocInfoResponseCallback(null,null)}):g_initialDocInfoRequestStatusCode==404&&n.HostCacheMissFallbackEnabled=="True"?switchToWACRequests(n,i):(g_initialDocInfoResponseHash="",g_initialDocInfoRequestCompleted=!0,g_initialDocInfoResponseCallback!=null&&g_initialDocInfoResponseCallback(null,null)))}function switchToWACRequests(n,t){if(g_useHostCache&&!g_switchToWacRequestMade){g_switchToWacRequestMade=!0;n.VisioWebHostCacheForEditUseEnabled=="True"&&(g_initialHostDocInfoRequest&&(g_initialHostDocInfoRequest.abort(),g_initialHostDocInfoRequestAborted=!0,g_initialHostDocInfoRequestResponse=null,g_initialHostDocInfoRequestStatusCode=0,g_HostBasedBundleValidToUse=!1,g_initialHostDocInfoResponseHash="",g_initialHostDocInfoRequestCompleted=!0,makeHostDocInfoReponseCallBackIfRequired()),t.IsValidateIfHostFileDOMCacheValid=!1);g_initialDocViewRequest&&(g_initialHostDocViewRequestAborted=!0,g_initialDocViewRequest.abort(),g_initialDocViewRequest=null);g_initialDocInfoRequest&&n.VisioWebHostCacheForEditUseEnabled!="True"&&(g_initialHostDocInfoRequestAborted=!0,g_initialDocInfoRequest.abort(),g_initialDocInfoRequest=null);g_initialDocInfoRequestCompleted=!1;g_initialDocViewRequestCompleted=!1;g_initialDocImageRequestCompleted=!1;g_initialDocViewRequestStatusCode=0;g_initialDocInfoRequestStatusCode=0;g_initialDocInfoRequestResponse=null;g_initialDocViewRequestResponse=null;g_initialDocImageElement&&g_initialDocImageElement.setAttribute("src","");var i=n.PngBootEnabled=="True"?!0:!1;g_initialDocViewRequestMade=!1;i&&(sendInitDocViewRequest(n,t),g_initialDocViewRequestMade=!0);n.SequencialBootRequestsEnabled=="True"&&g_initialDocViewRequestMade?g_initialDocInfoPendingRequest=function(){sendInitDocInfoRequest(n,t,!1,onInitialDocInfoRequestCompleted)}:sendInitDocInfoRequest(n,t,!1,onInitialDocInfoRequestCompleted);n.VisioWebHostCacheForEditUseEnabled=="True"&&(g_initialDocInfoRequestMade=canSendWacBootRequest(n,t)?!0:!1);g_useHostCache=!1}}function completeHostDocViewRequests(){g_initialDocViewResponseHash!=null&&g_initialDocImageRequestResponse!=null&&(g_initialDocViewRequestCompleted=!0,g_initialDocImageRequestCompleted=!0,g_initialDocViewResponseCallback!=null&&g_initialDocViewResponseCallback(null,null))}function generateSHA256Hash(n,t,i){var r=window.crypto||window.msCrypto,u;r&&r!=null&&r.subtle&&r.subtle!=null?(u=r.subtle.digest({name:"SHA-256"},convertStringToArrayBufferView(n)),u.then?u.then(function(n){t(convertArrayBufferToHexaDecimal(n))},i):(u.onerror=function(){i("Crypto Operation fired onerror event.")},u.oncomplete=function(n){n.target.result?t(convertArrayBufferToHexaDecimal(n.target.result)):i("Crypto Operation null Result.")})):i("Cryptography API not Supported")}function convertStringToArrayBufferView(n){for(var i=new Uint8Array(n.length),t=0;t<n.length;t++)i[t]=n.charCodeAt(t);return i}function convertBase64ToBytesArray(n){for(var i=window.atob(n),r=new Array(i.length),t=0;t<i.length;t++)r[t]=i.charCodeAt(t);return r}function convertArrayBufferToHexaDecimal(n){for(var t,r=new DataView(n),f=r.byteLength,u="",i=0;i<f;i+=1)t=r.getUint8(i).toString(16),t.length<2&&(t="0"+t),u+=t;return u}function getBase64ImageUsingCanvas(n){var t=document.createElement("canvas"),i,r,u;return!t.getContext||!t.getContext("2d")?null:(t.width=n.width,t.height=n.height,i=t.getContext("2d"),i.drawImage(n,0,0),r=t.toDataURL("image/png"),u=r.replace(/^data:image\/(png|jpg);base64,/,""),u)}function convertBase64toHexaDecimal(n){var r=window.atob(n),u="",t;for(i=0;i<r.length;i++)t=r.charCodeAt(i).toString(16),u+=t.length==2?t:"0"+t;return u.toUpperCase()}function compressToUTF16(n){return null==n?"":_compress(n,15,function(n){return String.fromCharCode(n+32)})+" "}function decompressFromUTF16(n){return null==n?"":""==n?null:_decompress(n.length,16384,function(t){return n.charCodeAt(t)-32})}function _compress(n,t,i){if(null==n)return"";for(var f,e,l={},v={},a="",y="",o="",c=2,w=3,s=2,h=[],r=0,u=0,p=0;p<n.length;p+=1)if(a=n.charAt(p),Object.prototype.hasOwnProperty.call(l,a)||(l[a]=w++,v[a]=!0),y=o+a,Object.prototype.hasOwnProperty.call(l,y))o=y;else{if(Object.prototype.hasOwnProperty.call(v,o)){if(o.charCodeAt(0)<256){for(f=0;f<s;f++)r<<=1,u==t-1?(u=0,h.push(i(r)),r=0):u++;for(e=o.charCodeAt(0),f=0;f<8;f++)r=r<<1|1&e,u==t-1?(u=0,h.push(i(r)),r=0):u++,e>>=1}else{for(e=1,f=0;f<s;f++)r=r<<1|e,u==t-1?(u=0,h.push(i(r)),r=0):u++,e=0;for(e=o.charCodeAt(0),f=0;f<16;f++)r=r<<1|1&e,u==t-1?(u=0,h.push(i(r)),r=0):u++,e>>=1}0==--c&&(c=Math.pow(2,s),s++);delete v[o]}else for(e=l[o],f=0;f<s;f++)r=r<<1|1&e,u==t-1?(u=0,h.push(i(r)),r=0):u++,e>>=1;0==--c&&(c=Math.pow(2,s),s++);l[y]=w++;o=String(a)}if(""!==o){if(Object.prototype.hasOwnProperty.call(v,o)){if(o.charCodeAt(0)<256){for(f=0;f<s;f++)r<<=1,u==t-1?(u=0,h.push(i(r)),r=0):u++;for(e=o.charCodeAt(0),f=0;f<8;f++)r=r<<1|1&e,u==t-1?(u=0,h.push(i(r)),r=0):u++,e>>=1}else{for(e=1,f=0;f<s;f++)r=r<<1|e,u==t-1?(u=0,h.push(i(r)),r=0):u++,e=0;for(e=o.charCodeAt(0),f=0;f<16;f++)r=r<<1|1&e,u==t-1?(u=0,h.push(i(r)),r=0):u++,e>>=1}0==--c&&(c=Math.pow(2,s),s++);delete v[o]}else for(e=l[o],f=0;f<s;f++)r=r<<1|1&e,u==t-1?(u=0,h.push(i(r)),r=0):u++,e>>=1;0==--c&&(c=Math.pow(2,s),s++)}for(e=2,f=0;f<s;f++)r=r<<1|1&e,u==t-1?(u=0,h.push(i(r)),r=0):u++,e>>=1;for(;;){if(r<<=1,u==t-1){h.push(i(r));break}u++}return h.join("")}function _decompress(n,t,i){for(var a,f,e,o,u,s,h=[],c=4,l=4,v=3,y="",w=[],r={val:i(0),position:t,index:1},p=0;p<3;p+=1)h[p]=p;for(f=0,o=Math.pow(2,2),u=1;u!=o;)e=r.val&r.position,r.position>>=1,0==r.position&&(r.position=t,r.val=i(r.index++)),f|=(e>0?1:0)*u,u<<=1;switch(f){case 0:for(f=0,o=Math.pow(2,8),u=1;u!=o;)e=r.val&r.position,r.position>>=1,0==r.position&&(r.position=t,r.val=i(r.index++)),f|=(e>0?1:0)*u,u<<=1;s=String.fromCharCode(f);break;case 1:for(f=0,o=Math.pow(2,16),u=1;u!=o;)e=r.val&r.position,r.position>>=1,0==r.position&&(r.position=t,r.val=i(r.index++)),f|=(e>0?1:0)*u,u<<=1;s=String.fromCharCode(f);break;case 2:return""}for(h[3]=s,a=s,w.push(s);;){if(r.index>n)return"";for(f=0,o=Math.pow(2,v),u=1;u!=o;)e=r.val&r.position,r.position>>=1,0==r.position&&(r.position=t,r.val=i(r.index++)),f|=(e>0?1:0)*u,u<<=1;switch(s=f){case 0:for(f=0,o=Math.pow(2,8),u=1;u!=o;)e=r.val&r.position,r.position>>=1,0==r.position&&(r.position=t,r.val=i(r.index++)),f|=(e>0?1:0)*u,u<<=1;h[l++]=String.fromCharCode(f);s=l-1;c--;break;case 1:for(f=0,o=Math.pow(2,16),u=1;u!=o;)e=r.val&r.position,r.position>>=1,0==r.position&&(r.position=t,r.val=i(r.index++)),f|=(e>0?1:0)*u,u<<=1;h[l++]=String.fromCharCode(f);s=l-1;c--;break;case 2:return w.join("")}if(0==c&&(c=Math.pow(2,v),v++),h[s])y=h[s];else{if(s!==l)return null;y=a+a.charAt(0)}w.push(y);h[l++]=a+y.charAt(0);a=y;0==--c&&(c=Math.pow(2,v),v++)}}var g_initialDocViewRequestMade=!1,g_initialDocFeatureRequestMade=!1,g_initialDocInfoRequestMade=!1,g_initialHostDocInfoRequestMade=!1,g_initialDocImageRequestMade=!1,g_initialHostDocViewRequestAborted=!1,g_initialHostDocInfoRequestAborted=!1,g_initialDocViewRequestCompleted=!1,g_initialFeatureRequestCompleted=!1,g_initialDocInfoRequestCompleted=!1,g_initialHostDocInfoRequestCompleted=!1,g_initialDocImageRequestCompleted=!1,g_initialDocInfoLoadedFromBrowser=!1,g_initialDocViewLoadedFromBrowser=!1,g_useHostCache=!1,g_switchToWacRequestMade=!1,g_getInitialDocImageFromHostFrame=!1,g_isBackgroundEditAppInitialized=!1,g_initialDocInfoResponseHash=null,g_initialHostDocInfoResponseHash=null,g_initialDocViewResponseHash=null,g_initialDocViewRequest=null,g_initialDocFeaturesRequest=null,g_initialDocInfoRequest=null,g_initialHostDocInfoRequest=null,g_initialDocImageElement=null,g_initialDocViewRequestResponse=null,g_initialFeatureRequestResponse=null,g_initialDocViewResponseCallback=null,g_initialFeatureResponseCallback=null,g_initialDocInfoRequestResponse=null,g_initialHostDocInfoRequestResponse=null,g_initialDocInfoResponseCallback=null,g_initialHostDocInfoResponseCallback=null,g_initialHostDocInfoResponseCallbackMade=!1,g_switchToWACRequestsCallback=null,g_makeInitialRequestDelegate=null,g_initialDocInfoPendingRequest=null,g_initialDocImageRequestResponse=null,g_initialRequestResponseSessionInfoHeader=null,g_initialRequestResponseUserSessionId=null,g_initialResponseTime=null,g_initialDocInfoResponseTime=null,g_initialHostDocInfoResponseTime=null,g_initialDocImageResponseTime=null,g_initialRequestInvokedTime=null,g_initialDocInfoRequestInvokedTime=null,g_initialDocImageRequestInvokedTime=null,g_initialDocViewRequestStatusCode=0,g_initialFeatureRequestStatusCode=0,g_initialDocInfoRequestStatusCode=0,g_initialHostDocInfoRequestStatusCode=0,g_HostBasedBundleValidToUse=!1,g_HostBundleValidityRequestCompleted=!1,g_FeaturesRequest=null,g_featureRequestMade=!1,g_featureRequestCompleted=!1,g_featureResponse=null,g_featureResponseStatusCode=0,g_featureResponseHash=null,g_featureResponseHashGenerated=!1,g_featureResponseHashFailureReason=null,g_maxRetryCount=0,g_retryCount=0,g_timeoutInMilliSec=1e3,g_PreservedAppSettings=null,g_PreservedBodyObj=null,g_backgroundSessionRetryLogicEnabled=!1,g_PreservedIsZeroBytesEditNew=!1,g_initialDocImageRequestFailed=!1,g_initialRequestViewScale=null,g_isInHighContrastMode=!1,g_foregroundColor=null,g_backgroundColor=null,g_postMessageOrigin=null,g_zeroPageSupported=!0,g_negative2DShapeDimensionSupported=!1,g_negative1DShapeDimensionSupported=!0,g_isInitialRequestFired=!1,g_instantAppSettingsAvailable,g_isEditBackgroundSessionUnloadFixEnabled=!1,g_isEditBackgroundSession=!1,g_layersPrintUnsupported=!1,g_layersActiveUnsupported=!1,g_layersLockUnsupported=!0,g_layersSnapUnsupported=!1,g_layersGlueUnsupported=!1,g_layersColorUnsupported=!0,g_layersTransparencyUnsupported=!0,g_supportedLayerNames=["Connector","Verbinder","Conector","Lien","Flowchart","Flussdiagramm","Diagrama de flujo","Diagramme de flux","Diagramma di flusso","Spojnice","V\u00fdvojov\u00fd diagram","Forbindelse","Rutediagram","Flussdiagramm","\u0393\u03c1\u03b1\u03bc\u03bc\u03ae \u03c3\u03cd\u03bd\u03b4\u03b5\u03c3\u03b7\u03c2","\u0394\u03b9\u03ac\u03b3\u03c1\u03b1\u03bc\u03bc\u03b1 \u03c1\u03bf\u03ae\u03c2","Yhdistin","Vuokaavio","Lien","\u00d6sszek\u00f6t\u0151","Folyamat\u00e1bra","Connettore","\u30b3\u30cd\u30af\u30bf","\u30d5\u30ed\u30fc\u30c1\u30e3\u30fc\u30c8","\uc5f0\uacb0\uc120","\uc21c\uc11c\ub3c4","Kobling","Flytskjema","Verbindingslijn","Stroomdiagram","Fluxograma","Schem\u0103 logic\u0103","\u0421\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u0430\u044f \u043b\u0438\u043d\u0438\u044f","\u0411\u043b\u043e\u043a-\u0441\u0445\u0435\u043c\u0430","Povezovalnik","Diagram poteka","Koppling","Fl\u00f6desschema","Ba\u011flay\u0131c\u0131","Ak\u0131\u015f grafi\u011fi","\u0421\u043f\u043e\u043b\u0443\u0447\u043d\u0430 \u043b\u0456\u043d\u0456\u044f","\u8fde\u63a5\u7ebf","\u6d41\u7a0b\u56fe","\u9023\u63a5\u5668","\u6d41\u7a0b\u5716","\u0141\u0105cznik","Schemat blokowy","Conex\u00e3o","Fluxograma","Spojnica"],g_solutionsAllSupported=!1,g_listOfSolutionsSupported=["QueueMarkerEvent","LGND"],g_createNewGetUrlInHC="/v/get?DomJsonRequest={0}&isCacheableGetForCreateNew={1}&PageView={2}&ViewScale={3}&SrcTmplId={4}&LCID={5}&UICulture={6}&Version={7}&BuildV={8}&IsHCMode={9}&FColor={10}&BColor={11}",g_createNewGetUrl="/v/get?DomJsonRequest={0}&isCacheableGetForCreateNew={1}&PageView={2}&ViewScale={3}&SrcTmplId={4}&LCID={5}&UICulture={6}&Version={7}&BuildV={8}&IsHCMode={9}",g_createNewGetUrlInHCWithFormulas="/v/get?DomJsonRequest={0}&isCacheableGetForCreateNew={1}&PageView={2}&ViewScale={3}&SrcTmplId={4}&LCID={5}&UICulture={6}&Version={7}&BuildV={8}&IsHCMode={9}&FColor={10}&BColor={11}&includeFormulas=true",g_createNewGetUrlWithFormulas="/v/get?DomJsonRequest={0}&isCacheableGetForCreateNew={1}&PageView={2}&ViewScale={3}&SrcTmplId={4}&LCID={5}&UICulture={6}&Version={7}&BuildV={8}&IsHCMode={9}&includeFormulas=true",g_fileId="",g_listOfColorSchemesSupported=[0,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,65534],g_listOfEffectSchemesSupported=[0,33,34,35,36,37,39,40,41,44,49,59,65534],g_listOfConnectorSchemesSupported=[0,33,34,35,36,37,39,40,41,44,49,59,65534],g_listOfFontSchemesSupported=[0,33,34,35,36,37,39,40,41,44,49,59,65534],g_listOfThemeSchemesSupported=[0,33,34,35,36,37,39,40,41,44,49,59,65534],g_listOfEffectSchemesSupportedOld=[0,33,34,36,37,40,41,59,65534],g_listOfConnectorSchemesSupportedOld=[0,33,34,36,37,40,41,59,65534],g_listOfFontSchemesSupportedOld=[0,33,34,36,37,40,41,59,65534],g_listOfThemeSchemesSupportedOld=[0,33,34,36,37,40,41,59,65534],g_modeSwitchPostMessageAckToHost="Visio_ModeSwitch_ToHost_Ack",g_listOfSVGUnsupportedEffectSchemes=[8,12,13,15,19,23,25,28,48,52,53,54,55,56,57,58];WireFeatures=function(){};WireFeatures.prototype={None:0,NonSinglePage:1,Protection1D:2,Protection2D:4,Layers:8,DataConnected:16,SVGNonCompat:32,NegativeShapeDimension:64,NumberOfShapes:128,NumberOfPages:256,Solutions:512,ProtectBackground:1024,Theming:2048,SDDisabledOnPage:4096,OptimizedForSVG:8192};WireFeatures.registerEnum("WireFeatures",!0);ProtectionLocks=function(){};ProtectionLocks.prototype={LOCK_NONE:0,LOCK_WIDTH:1,LOCK_HEIGHT:2,LOCK_MOVEX:4,LOCK_MOVEY:8,LOCK_ASPRAT:16,LOCK_DELETE:32,LOCK_BEGIN:64,LOCK_END:128,LOCK_ROTATE:256,LOCK_CROP:512,LOCK_VTXEDIT:1024,LOCK_TEXTEDIT:2048,LOCK_FORMAT:4096,LOCK_GROUP:8192,LOCK_WHRECALC:16384,LOCK_SELECT:32768,LOCK_CUSTPROP:65536,LOCK_FROMGROUPFORMAT:131072,LOCK_THEMECOLORS:262144,LOCK_THEMEEFFECTS:524288,LOCK_THEMECONNECTORS:1048576,LOCK_THEMEFONTS:2097152,LOCK_THEMEINDEX:4194304,LOCK_REPLACE:8388608,LOCK_VARIATION:16777216};ProtectionLocks.registerEnum("ProtectionLocks",!0);var g_unsupportedFeaturesFlag=WireFeatures.NonSinglePage|WireFeatures.Protection1D|WireFeatures.Protection2D|WireFeatures.Layers|WireFeatures.DataConnected|WireFeatures.SVGNonCompat|WireFeatures.NegativeShapeDimension|WireFeatures.NumberOfShapes|WireFeatures.NumberOfPages|WireFeatures.Solutions|WireFeatures.Theming,g_networkDiagrams1DLocks=ProtectionLocks.LOCK_FROMGROUPFORMAT|ProtectionLocks.LOCK_THEMECOLORS|ProtectionLocks.LOCK_THEMECONNECTORS|ProtectionLocks.LOCK_THEMEEFFECTS|ProtectionLocks.LOCK_THEMEFONTS|ProtectionLocks.LOCK_THEMEINDEX,g_networkDiagrams2DLocks=ProtectionLocks.LOCK_VTXEDIT|g_networkDiagrams1DLocks,g_umlWireframe1DLocks=ProtectionLocks.LOCK_MOVEX|ProtectionLocks.LOCK_MOVEY|ProtectionLocks.LOCK_DELETE|ProtectionLocks.LOCK_ROTATE|ProtectionLocks.LOCK_WIDTH|ProtectionLocks.LOCK_SELECT|ProtectionLocks.LOCK_VARIATION,g_umlWireframe2DLocks=ProtectionLocks.LOCK_VARIATION,g_supported1DLocksFlag=ProtectionLocks.LOCK_ASPRAT|ProtectionLocks.LOCK_WHRECALC|ProtectionLocks.LOCK_HEIGHT|ProtectionLocks.LOCK_VTXEDIT|ProtectionLocks.LOCK_GROUP|ProtectionLocks.LOCK_TEXTEDIT,g_supportedBasic2DLocksFlag=ProtectionLocks.LOCK_ASPRAT|ProtectionLocks.LOCK_WHRECALC,g_supportedOther2DLocksFlag=ProtectionLocks.LOCK_REPLACE|ProtectionLocks.LOCK_SELECT|ProtectionLocks.LOCK_DELETE|ProtectionLocks.LOCK_ROTATE|ProtectionLocks.LOCK_MOVEX|ProtectionLocks.LOCK_MOVEY|ProtectionLocks.LOCK_TEXTEDIT|ProtectionLocks.LOCK_FORMAT|ProtectionLocks.LOCK_WIDTH|ProtectionLocks.LOCK_HEIGHT|ProtectionLocks.LOCK_GROUP,g_maxNumberOfShapesPerPageSupported=1e3,g_maxNumberOfPagesSupported=50;_wireHighContrastSetting=function(){};_wireHighContrastSetting.prototype={IsHighContrastMode:!1,ForegroundColor:null,BackgroundColor:null};_wireGetDomRequest=function(){};_wireGetDomRequest.prototype={PageID:null,StencilID:null,HighContrastSettings:null,ViewScale:null,PageView:!1,FeaturesRequest:!1,ForceBypassCache:!1,DomJsonRequest:!1,UnsupportedFeatures:null,SourceTemplateID:null,IsBackgroundSession:!1,IsDebugMode:!1,IncludeFormulas:!1,IsValidateIfHostFileDOMCacheValid:!1};_wireNonSinglePageFeatureIn=function(){};_wireNonSinglePageFeatureIn.prototype={ZeroPageSupported:!1,MoreThanOnePageSupported:!1};_wireProtectionFeatureIn=function(){};_wireProtectionFeatureIn.prototype={SupportedProtectionFlag:0};_wireLayersFeatureIn=function(){};_wireLayersFeatureIn.prototype={SupportedLayerNames:null,PrintUnsupported:0,ActiveUnsupported:0,LockUnsupported:0,SnapUnsupported:0,GlueUnsupported:0,ColorUnsupported:0,TransparencyUnsupported:0};_wireDataConnectedFeatureIn=function(){};_wireSVGNonCompatFeatureIn=function(){};_wireNegativeShapeDimensionFeatureIn=function(){};_wireNegativeShapeDimensionFeatureIn.prototype={Shape1DSupported:!1,Shape2DSupported:!1};_wireNumberOfShapesFeatureIn=function(){};_wireNumberOfShapesFeatureIn.prototype={MaxNumberOfShapesPerPageSupported:0};_wireNumberOfPagesFeatureIn=function(){};_wireNumberOfPagesFeatureIn.prototype={MaxNumberOfPagesSupported:0};_wireSolutionsFeatureIn=function(){};_wireSolutionsFeatureIn.prototype={AllSolutionsSupported:!1,SolutionsSupported:null};_wireThemingFeatureIn=function(){};_wireThemingFeatureIn.prototype={ColorSchemes:null,EffectSchemes:null,ConnectorSchemes:null,FontSchemes:null,ThemeSchemes:null};_wireProtectBackgroundFeatureIn=function(){};_wireSDDisabledOnPageFeatureIn=function(){};_wireOptimizedForSVGFeatureIn=function(){};_wireUnsupportedFeatures=function(){};_wireUnsupportedFeatures.prototype={UnsupportedFeaturesFlag:0,NonSinglePageFeature:null,Protection1DFeature:null,Protection2DFeature:null,LayersFeature:null,DataConnectedFeature:null,SVGNonCompatFeature:null,NegativeShapeDimensionFeature:null,NumberOfShapesFeature:null,SolutionsFeature:null,ProtectBackgroundFeature:null,ThemingFeature:null,SDDisabledOnPageFeature:null,OptimizedForSVGFeature:null};g_instantAppSettingsAvailable&&!g_isInitialRequestFired&&makeInitialRequest(g_instantAppSettings);