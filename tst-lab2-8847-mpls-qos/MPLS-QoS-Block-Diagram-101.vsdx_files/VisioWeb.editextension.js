/*
 Microsoft Corporation. All rights reserved.
*/
(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[1],{1078:function(C,H,e){function b(){this.Lab=this.Jn=this.Zyb=this.Rc=this.vAb=null;this.vzb=!0}function n(){this.BRc=this.CRc=null;this.Iff=!1;this.zPc=new lg.a;this.CRc=new k}function k(){return $p.call(this,Tw.a.instance.mc("Common.App.OAuth.IOAuthManager"),!0,qf.AFrameworkApplication.H.J("VisioCacheRequestFlowToken"))||this}function r(u,N){null==N?console.log("Augloop Log:",u):console.log("Augloop Log:",u,N)}function m(u,
N,V){if(wt.Spb&&!N&&!u)return wt.Spb();u=u||{};u=u.random||(u.upg||uc)();u[6]=u[6]&15|64;u[8]=u[8]&63|128;if(N){V=V||0;for(var ka=0;16>ka;++ka)N[V+ka]=u[ka];return N}N=void 0;N=void 0===N?0:N;return(yl[u[N+0]]+yl[u[N+1]]+yl[u[N+2]]+yl[u[N+3]]+"-"+yl[u[N+4]]+yl[u[N+5]]+"-"+yl[u[N+6]]+yl[u[N+7]]+"-"+yl[u[N+8]]+yl[u[N+9]]+"-"+yl[u[N+10]]+yl[u[N+11]]+yl[u[N+12]]+yl[u[N+13]]+yl[u[N+14]]+yl[u[N+15]]).toLowerCase()}function w(){this._augLoopRuntimeManager=new J}function v(u){this.config=u;this.nextMessageId=
0;this.responseCallbacks=new Map;var N=["session","chats"],V=Sp(),ka=[].concat(D.Nh(N),[V]);this.messagesPath=[].concat(D.Nh(ka),["messages"]);this.config.session.submitOperations([new Mh({parentPath:N,items:[{id:V,body:u.chat}]}),new Mh({parentPath:ka,items:[{id:"messages",body:new B}]})])}function x(u){Eb.assign(x,this,u)}function A(u){Eb.assign(A,this,u)}function B(u){Eb.assign(B,this,u)}function E(u){Eb.assign(E,this,u)}function L(u){Eb.assign(L,this,u)}function S(u,N){var V,ka,wa,Ga,la,ab;this.kind=
Hg.SingleItem;this.isStateful=!1;this.id=u;N&&(this.inputTypes=null!==(V=N.inputTypes)&&void 0!==V?V:this.inputTypes,this.outputTypes=null!==(ka=N.outputTypes)&&void 0!==ka?ka:this.outputTypes,this.isStateful=null!==(wa=N.isStateful)&&void 0!==wa?wa:this.isStateful,this.requestedContextTypesRules=null!==(Ga=N.requestedContextTypesRules)&&void 0!==Ga?Ga:this.requestedContextTypesRules,this.definitionOverrideTargetWorkflows=null!==(la=N.definitionOverrideTargetWorkflows)&&void 0!==la?la:this.definitionOverrideTargetWorkflows,
this.correlatedSignals=0!==(null===(ab=N.correlatedSignals)||void 0===ab?void 0:ab.length)?N.correlatedSignals:this.correlatedSignals)}function J(){var u=this;this._telemetryAggregationIntervalSec=30;this._eventHandlerDictionary={};this._sessionCloseReason=null;this._serverAuthenticationState=Bg.NotAuthenticated;this.initialize=function(N){if(u._runtimeInitPromise)jl.sendTraceTag(572838286,nj.dx,Ze.Info,"Runtime already initialized");else{jl.sendTraceTag(572838287,nj.dx,Ze.Info,"Start and initialize augloop runtime ...");
u.checkParametersAndThrow("initialize",N);var V=u.isFeatureEnabled("ModelDownloaderEbrake","None").then(function(Xb){Xb?jl.sendTraceTag(556376070,nj.dx,Ze.Info,"Resource downloader not created due to feature gate"):u.modelDownloaderFromCDN=N.appName&&N.downloadBaseUrl||N.downloadPolymerBaseUrl?new M(N.appName,N.downloadBaseUrl,N.downloadPolymerBaseUrl):void 0});u.inferenceServiceFactory=N.appName&&N.inferenceServiceVersion?ia.createFactory(N.appName,N.inferenceServiceVersion):void 0;u.excelServerParameters=
N.excelServer;u.powerpointParameters=N.powerpoint;var ka={appName:N.appName,appPlatform:"Web",appVersion:N.appVersion,uiLanguage:N.uiLanguage,releaseAudienceGroup:N.releaseAudienceGroup,releaseChannel:N.releaseChannel,releaseCustomAudience:N.releaseCustomAudience,releaseFork:N.releaseFork,sessionId:N.sessionId,flights:N.flights,privateMode:N.privateMode,disabledServiceGroups:N.disabledServiceGroups},wa={onResult:u.onResult.bind(u),onAnnotationResult:u.onAnnotationResult.bind(u),sendTelemetryEvent:u.sendTelemetryEvent.bind(u),
sendDiagnosticTrace:u.sendDiagnosticTrace.bind(u),requestAuthToken:u.requestAuthToken.bind(u),isFeatureEnabled:u.isFeatureEnabled.bind(u),setSessionData:u.setSessionData.bind(u),areLicenseFeaturesEnabled:Q,onInitSession:u.onInitSession.bind(u),overrideSessionInitMessage:u.overrideSessionInitMessage.bind(u)},Ga=V.then(function(){return Aq.init(N.serviceUrl,ka,wa,{telemetryAggregationIntervalSec:u._telemetryAggregationIntervalSec,modelDownloader:u.modelDownloaderFromCDN,inferenceServiceFactory:u.inferenceServiceFactory,
isDeltaGeneratorEnabled:N.isDeltaGeneratorEnabled,disableSyncDeltaSending:N.disableSyncDeltaSending,syncDeltaTimeout:N.syncDeltaTimeout})}).then(function(){return Qk.init(N.serviceUrl,ka,wa)}),la=N.sessionCreationOptions;la||(la={});var ab=la.onServerAuthenticationStateChangeCallback;la.onServerAuthenticationStateChangeCallback=function(Xb){u._serverAuthenticationState=Xb;ab&&ab(Xb);u._bridge&&u.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:new em({serverAuthenticationState:Xb})})};var nb=
la.onSessionClose;la.onSessionClose=function(Xb){u._sessionCloseReason=Xb.reason;nb&&nb(Xb);u._bridge&&u.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:Xb})};var sb=la.onSessionConnect;la.onSessionConnect=function(Xb,Gc,oe,pe){sb&&sb(Xb,Gc,oe,pe);u._bridge&&u.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:new Uj({isSeedingRequired:Xb,sessionUrl:Gc,origin:oe,authToken:pe})})};var Db=la.onSessionReconnect;la.onSessionReconnect=function(){Db&&Db();u._bridge&&u.sendBridgeMessage({bridgeId:"*",
docSessionId:"*",message:new Aj})};var bc=la.onSessionDisconnect;la.onSessionDisconnect=function(Xb){bc&&bc(Xb);u._bridge&&u.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:new Pe({error:Xb})})};u.createSession=function(){u._runtimeInitPromise=Ga.then(function(){var Xb=la&&la.docSessionId||N.sessionId;return Aq.createSession(Object.assign(Object.assign({},la),{docSessionId:Xb}))})};u.createSession()}};this.getSession=function(){return u._runtimeInitPromise};this.setULSLogger=function(N){u.checkParametersAndThrow("setULSLogger",
N&&N.ulsLogger);jl.oFd(N.ulsLogger)};this.setSendOTelEventCallback=function(N){u.checkParametersAndPropertyAndThrow("setSendOTelEventCallback",N&&N.sendOTelEvent,u._sendOTelEventCallback);u._sendOTelEventCallback=N.sendOTelEvent};this.setSendDiagnosticTraceCallback=function(N){u.checkParametersAndPropertyAndThrow("setSendDiagnosticTraceCallback",N&&N.sendDiagnosticTraceCallback,u._sendDiagnosticTraceCallback);u._sendDiagnosticTraceCallback=N.sendDiagnosticTraceCallback};this.setRequestAuthTokenCallback=
function(N){u.checkParametersAndPropertyAndThrow("setRequestAuthTokenCallback",N&&N.requestAuthTokenCallback,u._requestAuthTokenCallback);u._requestAuthTokenCallback=N.requestAuthTokenCallback};this.setIsFeatureEnabledCallback=function(N){u.checkParametersAndPropertyAndThrow("setIsFeatureEnabledCallback",N&&N.featureEnabledCallback,u._featureEnabledCallback);u._featureEnabledCallback=N.featureEnabledCallback};this.registerLocalWorkflow=function(N){u.checkParametersAndThrow("registerLocalWorkflow",
N&&N.workflow);u.checkRuntimeInitAndThrow("registerLocalWorkflow");void u._runtimeInitPromise.then(function(V){V.registerLocalWorkflow(N.workflow)})};this.activateAnnotation=function(N){var V=u.checkParameters("activateAnnotation",N&&N.annotationType)||u.checkRuntimeInit("activateAnnotation");return V?Promise.reject(V):u._runtimeInitPromise.then(function(ka){if(N.config||N.handler||N.stateUpdateHandler)var wa={config:N.config,callback:N.handler,stateUpdateCallback:N.stateUpdateHandler,forceReturnCachedAnnotations:N.forceReturnCachedAnnotations};
return ka.activateAnnotation(N.annotationType,wa)})};this.updateAnnotationConfig=function(N){var V=u.checkParameters("updateAnnotationConfig",N&&N.token&&N.config)||u.checkRuntimeInit("updateAnnotationConfig");return V?Promise.reject(V):u._runtimeInitPromise.then(function(ka){ka.updateAnnotationConfig(N.token,N.config)})};this.releaseAnnotation=function(N){var V=u.checkParameters("releaseAnnotation",N&&N.token)||u.checkRuntimeInit("releaseAnnotation");return V?Promise.reject(V):u._runtimeInitPromise.then(function(ka){return ka.releaseAnnotation(N.token)})};
this.submitOperation=function(N){u.checkParametersAndThrow("submitOperation",N&&N.operation);u.checkRuntimeInit("submitOperation");void u._runtimeInitPromise.then(function(V){V.submitOperation(N.operation)})};this.setSessionDataCallback=function(N){u.checkParametersAndPropertyAndThrow("setSessionDataCallback",N&&(N.sessionDataCallback||N.handler),u._setSessionDataCallback);N.sessionDataCallback?u._setSessionDataCallback=N.sessionDataCallback:N.handler&&(u._setSessionDataCallback=function(V,ka){return N.handler(V,
ka)})};this.setAnnotationResultCallback=function(N){u.checkParametersAndThrow("setAnnotationResultCallback",N&&N.handler);u._annotationResultCallback&&jl.sendTraceTag(537401028,nj.dx,Ze.Error,"setAnnotationResultCallback already called");u._annotationResultCallback=N.handler};this.setAnnotationState=function(N){u.checkParametersAndThrow("setAnnotationState",N&&N.parentPath&&N.id&&N.value);u.checkRuntimeInitAndThrow("setAnnotationState");void u._runtimeInitPromise.then(function(V){V.setAnnotationState(N.parentPath,
N.id,N.value)})};this.setAnnotationMetadata=function(N){u.checkParametersAndThrow("setAnnotationMetadata",N&&N.parentPath&&N.id&&N.value);u.checkRuntimeInitAndThrow("setAnnotationMetadata");void u._runtimeInitPromise.then(function(V){V.setAnnotationMetadata(N.parentPath,N.id,N.value)})};this.setInitSessionCallback=function(N){u.checkParametersAndPropertyAndThrow("setInitSessionCallback",N&&N.initSessionCallback,u._initSessionCallback);u._initSessionCallback=N.initSessionCallback};this.setSessionInitOverrideCallback=
function(N){u.checkParametersAndPropertyAndThrow("setSessionInitOverrideCallback",N&&N.handler,u._sessionInitOverrideCallback);u._sessionInitOverrideCallback=N.handler};this.setMessageBridge=function(N){u.checkParametersAndPropertyAndThrow("setSessionInitOverrideCallback",N&&N.bridge,u._bridge);u._bridge=N.bridge;u._bridge.registerMessageReceivedCallback(u.onBridgeMessage.bind(u))};this.forceReconnectSession=function(N){var V=u.checkParameters("forceReconnectSession",N)||u.checkRuntimeInit("forceReconnectSession");
return V?Promise.reject(V):u._runtimeInitPromise.then(function(ka){N.excelServerParameters&&(u.excelServerParameters=N.excelServerParameters);return ka.forceReconnect()})};this.setSessionCloseCallback=function(N){var V=u.checkParameters("setSessionCloseCallback",N&&N.callback)||u.checkRuntimeInit("setSessionCloseCallback");return V?Promise.reject(V):u._runtimeInitPromise.then(function(ka){ka.setSessionCloseCallback(N.callback)})};this.submitCustomMessage=function(N){var V=u.checkParameters("submitCustomMessage",
N&&N.message)||u.checkRuntimeInit("submitCustomMessage");return V?Promise.reject(V):u._runtimeInitPromise.then(function(ka){return ka.submitCustomMessage(N.message)})};this.submitLargeBinaryDataMessage=function(N){var V=u.checkParameters("submitLargeBinaryDataMessage",N&&N.message)||u.checkRuntimeInit("submitLargeBinaryDataMessage");return V?Promise.reject(V):Km.typeGuard(N.message)?u._runtimeInitPromise.then(function(ka){return ka.submitLargeBinaryDataMessage(N.message)}):Promise.reject("submitLargeBinaryDataMessage only supports MicroSyncMessage")};
this.requestBinaryDataForBlob=function(N){var V=u.checkParameters("requestBinaryDataForBlob",N&&N.blob)||u.checkRuntimeInit("requestBinaryDataForBlob");return V?Promise.reject(V):u._runtimeInitPromise.then(function(ka){return ka.requestBinaryDataForBlob(N.blob)})};this.closeSession=function(){var N=u.checkRuntimeInit("closeSession");return N?Promise.reject(N):u._runtimeInitPromise.then(function(V){V.close()})};this.startNewSession=function(){if(!u.createSession)throw jl.sendTraceTag(537408074,nj.dx,
Ze.Error,"startNewSession called before runtime init"),Error("startNewSession called before runtime init");u.createSession();u._sessionCloseReason=null};this.submit=function(N){u.checkParametersAndThrow("submit",N&&N.inputSchema&&N.input);u.checkRuntimeInitAndThrow("submit");void u._runtimeInitPromise.then(function(){Qk.submit(N.inputSchema,N.input,N.correlationVector)})};this.addEventHandler=function(N){u.checkParametersAndThrow("addEventHandler",N&&N.schemaName&&N.handler);var V=u._eventHandlerDictionary[N.schemaName]||
[];V.push(N.handler);u._eventHandlerDictionary[N.schemaName]=V};this.removeEventHandler=function(N){u.checkParametersAndThrow("removeEventHandler",N&&N.schemaName&&N.handler);var V=u._eventHandlerDictionary[N.schemaName];Array.isArray(V)&&(N=V.indexOf(N.handler),0<=N&&V.splice(N,1))};this.registerSimpleRemoteWorkflow=function(N){var V=u.checkParameters("registerSimpleRemoteWorkflow",N&&N.name&&N.lambdaRemote)||u.checkRuntimeInit("registerSimpleRemoteWorkflow");return V?Promise.reject(V):u._runtimeInitPromise.then(function(){return Qk.registerSimpleRemoteWorkflow(N.name,
N.lambdaBefore,N.lambdaRemote,N.lambdaAfter)})};this.registerSimpleLocalWorkflow=function(N){var V=u.checkParameters("registerSimpleLocalWorkflow",N&&N.name&&N.lambda)||u.checkRuntimeInit("registerSimpleLocalWorkflow");return V?Promise.reject(V):u._runtimeInitPromise.then(function(){return Qk.registerSimpleLocalWorkflow(N.name,N.lambda)})};this.registerReduceWorkflow=function(){return Promise.resolve()};this.registerSchemas=function(){return Promise.resolve()};this.onResult=function(N,V,ka,wa){var Ga=
u._eventHandlerDictionary[ka];if(Ga){Ga=D.makeIterator(Ga);for(var la=Ga.next();!la.done;la=Ga.next())(la=la.value)&&la({inputSchema:N,input:V,outputSchema:ka,output:wa})}};this.onAnnotationResult=function(N){u._annotationResultCallback&&u._annotationResultCallback(N)};this.requestAuthToken=function(N){return u._requestAuthTokenCallback?(u._requestAuthTokenCallback(N)||Promise.resolve("")).then(function(V){return Promise.resolve({Token:V||""})}):Promise.resolve({Token:""})};this.sendTelemetryEvent=
function(N,V,ka,wa,Ga,la,ab,nb){u._sendOTelEventCallback&&(la=u._sendOTelEventCallback,N={telemetryProperties:{ariaTenantToken:N,nexusTenantToken:-1},eventName:V.split("_").join("."),dataFields:R(ka),eventFlags:{dataCategories:ab,diagnosticLevel:nb,samplingPolicy:1}},wa&&(N.eventContract={name:wa,dataFields:R(Ga,wa.split(".").slice(-1)[0])}),la.call(u,N))};this.sendDiagnosticTrace=function(N,V,ka){u._sendDiagnosticTraceCallback&&u._sendDiagnosticTraceCallback(N,V,ka)};this.isFeatureEnabled=function(N){return N?
0===N.indexOf("Microsoft.Office.AugLoop.")&&u._featureEnabledCallback?(N=N.slice(25),Promise.resolve(u._featureEnabledCallback(N))):Promise.resolve(!1):Promise.resolve(!1)};this.setSessionData=function(N,V,ka){u._setSessionDataCallback&&u._setSessionDataCallback(N,V,ka)};this.overrideSessionInitMessage=function(N){return u._sessionInitOverrideCallback?u._sessionInitOverrideCallback(N):0===N.clientMetadata.appName.indexOf("Excel")&&u.excelServerParameters?u.overrideExcelSessionInitMessage(N):0===N.clientMetadata.appName.indexOf("PowerPoint")&&
u.powerpointParameters?u.overridePowerPointSessionInitMessage(N):N};this.overrideExcelSessionInitMessage=function(N){for(var V={cluster:u.excelServerParameters.wacCluster,restUrl:u.excelServerParameters.ecsRestUrl,ecsId:u.excelServerParameters.ecsSessionId,ecsOperationUrl:u.excelServerParameters.ecsOperationUrl,workbookMetadataVersion:u.excelServerParameters.metadataVersion,serverEventVersion:u.excelServerParameters.serverEventVersion,permissionFlags:u.excelServerParameters.permissionFlags,configurations:u.excelServerParameters.configurations,
collabUserListVersion:u.excelServerParameters.userListVersion,collabStateId:u.excelServerParameters.collabStateId,accessToken:u.excelServerParameters.accessToken,accessTokenTTL:u.excelServerParameters.accessTokenTTL,supportCustomMessages:u.excelServerParameters.supportCustomMessages},ka=D.makeIterator(Object.keys(N)),wa=ka.next();!wa.done;wa=ka.next())wa=wa.value,V[wa]=N[wa];return new Z(V)};this.overridePowerPointSessionInitMessage=function(N){for(var V={downloadUrl:u.powerpointParameters.downloadUrl,
getItemsEndPoint:u.powerpointParameters.getItemsEndPoint,documentOpenType:u.powerpointParameters.documentOpenType},ka=D.makeIterator(Object.keys(N)),wa=ka.next();!wa.done;wa=ka.next())wa=wa.value,V[wa]=N[wa];return new K(V)};this.onInitSession=function(){return u._initSessionCallback?u._initSessionCallback():Promise.resolve()};this.checkParameters=function(N,V){if(!V)return N+=" called with invalid parameters",jl.sendTraceTag(537408075,nj.dx,Ze.Error,N),Error(N)};this.checkParametersAndThrow=function(N,
V){if(N=u.checkParameters(N,V))throw N;};this.checkParametersAndPropertyAndThrow=function(N,V,ka){u.checkParametersAndThrow(N,V);if(ka)throw N+=" already called",jl.sendTraceTag(537408076,nj.dx,Ze.Error,N),Error(N);};this.checkRuntimeInit=function(N){if(!u._runtimeInitPromise)return N+=" called before runtime init",jl.sendTraceTag(537408077,nj.dx,Ze.Error,N),Error(N)};this.checkRuntimeInitAndThrow=function(N){if(N=u.checkRuntimeInit(N))throw N;};this.sendBridgeMessage=function(N){u._bridge.sendMessage(JSON.stringify(new uk(N)))};
this.onBridgeMessage=function(N){try{var V=JSON.parse(N),ka=V.bridgeId,wa=V.docSessionId,Ga=V.message,la=Eb.getTypeNameFor(Ga);jl.sendTraceTag(509092291,nj.dx,Ze.Info,"Received "+la);null!=u._sessionCloseReason&&u.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:new Ve({reason:u._sessionCloseReason})});if(xh.typeGuard(Ga)){var ab=u.activateAnnotation({annotationType:Ga.annotationType,config:Ga.config,handler:function(bc){u.sendBridgeMessage({bridgeId:ka,docSessionId:wa,message:new xk({annotationType:Ga.annotationType,
ops:[bc]})})},forceReturnCachedAnnotations:Ga.forceReturnCachedAnnotations}).then(function(bc){return new cj({messageId:Ga.messageId,token:bc.token})});u.sendResponseAcrossBridge(ab,Ga,ka,wa)}else if(Te.typeGuard(Ga)){for(var nb=D.makeIterator(Ga.ops),sb=nb.next();!sb.done;sb=nb.next())u.submitOperation({operation:sb.value});u.sendBridgeMessage({bridgeId:ka,docSessionId:wa,response:new yg({messageId:Ga.messageId})});jl.sendTraceTag(509092288,nj.dx,Ze.Info,"Responded to "+la)}else if(wg.typeGuard(Ga)){var Db=
u.releaseAnnotation({token:Ga.token}).then(function(bc){return new Vj({messageId:Ga.messageId,lastRelease:bc})});u.sendResponseAcrossBridge(Db,Ga,ka,wa)}else ki.typeGuard(Ga)?u.submitCustomMessage({message:Ga.customMessage}).then(function(bc){yg.typeGuard(bc)?(bc.messageId=Ga.messageId,jl.sendTraceTag(508432467,nj.dx,Ze.Info,"Responded to "+la)):jl.sendTraceTag(508420946,nj.dx,Ze.Error,"Unexpeced response type from SubmitCustomMessage");u.sendBridgeMessage({bridgeId:ka,docSessionId:wa,response:bc})}).catch(function(bc){jl.sendTraceTag(508436636,
nj.dx,Ze.Error,bc.message);u.sendBridgeMessage({bridgeId:ka,docSessionId:wa,response:new Kh({messageId:Ga.messageId,error:bc.message})})}):xg.typeGuard(Ga)?u.sendBridgeMessage({bridgeId:ka,docSessionId:wa,message:new em({serverAuthenticationState:u._serverAuthenticationState})}):jl.sendTraceTag(509092259,nj.dx,Ze.Warning,"Did not respond to "+la+" with Id "+Ga.messageId)}catch(bc){jl.sendTraceTag(509092363,nj.dx,Ze.Error,bc.message),u.sendBridgeMessage({bridgeId:"unknown",docSessionId:"unknown",response:new Kh({messageId:"unknown",
error:bc.message})})}};this.sendResponseAcrossBridge=function(N,V,ka,wa){N.catch(function(Ga){return new Kh({messageId:V.messageId,error:Ga.message})}).then(function(Ga){u.sendBridgeMessage({bridgeId:ka,docSessionId:wa,response:Ga});jl.sendTraceTag(508937624,nj.dx,Ze.Info,"Responded to "+Eb.getTypeNameFor(V))}).catch(function(Ga){jl.sendTraceTag(508937623,nj.dx,Ze.Error,Ga.message)})}}function Q(){return Promise.resolve(!1)}function R(u,N){for(var V=[],ka=D.makeIterator(Object.keys(u)),wa=ka.next();!wa.done;wa=
ka.next())if(wa=wa.value,void 0!==u[wa]&&null!==u[wa]){var Ga=u[wa];"string"===typeof Ga?Ga=0:"boolean"===typeof Ga?Ga=1:"number"===typeof Ga?Ga=2:(jl.sendTraceTag(572838285,nj.dx,Ze.Warning,"Unsupported data field type"),Ga=void 0);V.push({name:N?N+"."+wa:wa,dataType:Ga,value:u[wa],classification:4})}return V}function F(u){Eb.assign(F,this,u)}function K(u){Eb.assign(K,this,u)}function I(u){Eb.assign(I,this,u)}function Y(u){Eb.assign(Y,this,u)}function X(u){Eb.assign(X,this,u)}function ca(u){Eb.assign(ca,
this,u)}function W(u){Eb.assign(W,this,u)}function P(u){Eb.assign(P,this,u)}function T(u){Eb.assign(T,this,u)}function Z(u){Eb.assign(Z,this,u)}function ia(){}function na(u,N){this.DBd=u;this.result=N}function ba(u){for(var N=D.makeIterator(Object.keys(u)),V=N.next();!V.done;V=N.next())V=V.value,this[V]=new na(V,u[V])}function ea(){this.map={}}function oa(u,N,V){this.session=u;this.onnxObject=V;this.modelName=N}function sa(u,N,V,ka){function wa(Ga){return Ga instanceof V?Ga:new V(function(la){la(Ga)})}
return new (V||(V=Promise))(function(Ga,la){function ab(Db){try{sb(ka.next(Db))}catch(bc){la(bc)}}function nb(Db){try{sb(ka["throw"](Db))}catch(bc){la(bc)}}function sb(Db){Db.done?Ga(Db.value):wa(Db.value).then(ab,nb)}sb((ka=ka.apply(u,N||[])).next())})}function M(u,N,V,ka){var wa=this;this.dbName="ALModels_db";this.osName="ALModels_os";this.dbVersion=2;this.isPolymerSupported=!!V;this.baseURL="https://"+N+"/web/"+u;this.polymerBaseURL=this.isPolymerSupported?"https://"+V:"";this.checkIdbByFeatures=
null===ka||void 0===ka?void 0:ka.checkIdbByFeatures;var Ga=new Pc({operationName:"CreateModelDownloader",success:!0,resultDescription:""});Ga.start();this.isBrowserIdbCompatible().then(function(la){if(la){var ab=0,nb=0,sb=0,Db;la=new Promise(function(Xb,Gc){Db=setTimeout(function(){Gc(Error("Took longer than 10000 ms"))},1E4)});var bc=wa.accessDB().then(function(Xb){var Gc=Xb.transaction(wa.osName,"readwrite");return Gc.objectStore(wa.osName).openCursor().then(function md(pe){sb++;if(pe){var yf=pe.value;
yf.Pub||(yf.Pub=0);yf.Pub++;5<yf.Pub?(nb++,yf=pe.delete()):(ab++,yf=pe.update(yf));return yf.then(function(){return pe.continue()}).then(md)}return Gc.done})});wa.initPromise=Promise.race([la,bc]).catch(function(Xb){Ga.success=!1;Ga.resultDescription+=Xb.message+" "}).then(function(){Ga.dimension0=""+sb;Ga.dimension1=""+ab;Ga.dimension2=""+nb;clearTimeout(Db);wa.closeDBAndEndLog(Ga,"initializing idb storage")})}else Ga.resultDescription="Incompatible browser for IDB",wb.a.info(538706242,wb.b.CoreDefault,
Ga.stop())}).catch(function(){Ga.resultDescription="Issue determining idb compatibility";wb.a.info(536966936,wb.b.CoreDefault,Ga.stop())})}function za(u,N){return N.some(function(V){return u instanceof V})}function xa(){this.inputSchemasToWorkflows=new Map;this.inputSchemasToReduceWorkflows=new Map;this.reduceWorkflowsGroupingKeyExtractors=new Map;this.defaultWorkflowOptions={canProduceNullResult:!1,shouldSendResultsToHost:!0,enabledByDefault:!1,throttleSettings:{shouldBeThrottled:!1},triggerOnRefresh:!1};
this.resultCache=new Fa;this.reduceTimerCache=new Wb;this.lookupTableCache=new Map;this.throttling=new zb;this.lastTileRefreshSeq=-1;this.lastTileRefreshSeqByDocSessionId=new Map;this.tileRefreshByDocSessionIdEnabled=!0}function ua(u,N){var V,ka;if("Tiling.TextTileEvent"===u)return null===(ka=null===(V=N.tile)||void 0===V?void 0:V.metadata)||void 0===ka?void 0:ka.docSessionId;if("ClpSlideTile"===u)return N.docId}function Pa(u,N){var V,ka;return Ua(u,N)?null===(ka=null===(V=N.tile)||void 0===V?void 0:
V.metadata)||void 0===ka?void 0:ka.VDd:-1}function Da(u,N){return Ua(u,N)||"ClpSlideTile"===u&&N&&N.eventType==Ke.SlideTileEventType.Refresh}function Ua(u,N){return"Tiling.TextTileEvent"===u&&N&&N.type==Uo.TextTileEventType.Refresh}function Sa(u){return{category:wi.Schema,schema:{name:u}}}function kb(){this.canaryTextTileEventSubmittedByDocSessionId=new Set;this.stateByDocSessionId=new Map;this.executionQueueByDocSessionId=new Map;this.executionCountByDocSessionId=new Map}function zb(){this.throttleInfoMap=
new Map}function Fa(){this.cache=new Map;this.bucketSizes=new Map}function Za(u,N,V,ka,wa,Ga,la,ab,nb){Array.isArray(ab.authTickets)?gg.updateAuthToken(la,{Tickets:ab.authTickets,DocId:ab.docId}).then(function(){Ea(u,N,V,ka,wa.id,Ga,la,1,ab,nb)}).catch(function(sb){nb({exceptionType:ke.Authentication,message:sb.message})}):Ea(u,N,V,ka,wa.id,Ga,la,1,ab,nb)}function Ea(u,N,V,ka,wa,Ga,la,ab,nb,sb){var Db={payload:N.payload,payloadSchema:V,requestedSchema:ka,clientMetadata:Ga,tokens:gg.getAuthTokenEntries(la,
nb.docId)},bc="";ka&&ka.schema&&(bc=ka.schema.name);var Xb=!1;Pi.addRequest(u,Db,wa,bc,function(Gc,oe){if(!Xb)if(Xb=!0,null!=oe)if(oe.exceptionType===ke.Authentication)try{var pe=JSON.parse(oe.data);0<ab?(wb.a.info(572838108,wb.b.CoreDefault,"Auth token required for remote lambda WebSocket request"),gg.updateAuthToken(la,{Tickets:[pe],DocId:nb.docId}).then(function(){Ea(u,N,V,ka,wa,Ga,la,ab-1,nb,sb)}).catch(function(md){sb({exceptionType:ke.Authentication,message:md.message})})):sb({exceptionType:ke.Authentication,
message:"Remote lambda request retry with authentication token failed"})}catch(md){sb({exceptionType:ke.Authentication,message:md.message})}else sb(Error("Error in remote lambda WebSocket request to "+u+": "+oe));else N.moreResults=!1,sb(null,Gc)})}function Na(){gg=new ub}function $a(u,N,V){this.requestCounter=0;this.activeRequests=[];this.pendingRequests=[];this.requestTimeoutInMs=u;this.workerFactory=N;this.maxActiveRequests=V}function Ba(u,N,V,ka,wa,Ga){this.requestId=u;this.correlationId=N;this.schemaName=
V;this.data=ka;this.callback=wa;this.requestTimeoutInMs=Ga;this.ended=!1;this.startTime=0}function Xa(u,N,V,ka,wa,Ga,la,ab,nb){Array.isArray(ab.authTickets)?Vo.updateAuthToken(la,{Tickets:ab.authTickets,DocId:ab.docId}).then(function(){Oa(u,N,V,ka,wa.id,Ga,la,1,ab,nb)}).catch(function(sb){nb({exceptionType:ke.Authentication,message:sb.message})}):Oa(u,N,V,ka,wa.id,Ga,la,1,ab,nb)}function Oa(u,N,V,ka,wa,Ga,la,ab,nb,sb){var Db={method:"POST",headers:{"content-type":"application/json","X-CorrelationId":wa},
body:JSON.stringify({payload:N.payload,payloadSchema:V,requestedSchema:ka,clientMetadata:Ga,tokens:Vo.getAuthTokenEntries(la,nb.docId)})};tm(u,Db,function(bc,Xb){bc?sb(Error("Fetch error in remote lambda request to "+u+": "+bc)):401===Xb.status?0<ab?(wb.a.info(572838109,wb.b.CoreDefault,"Auth token required for remote lambda request"),Xb.json().then(function(Gc){return Vo.updateAuthToken(la,{Tickets:[Gc],DocId:nb.docId})}).then(function(){Oa(u,N,V,ka,wa,Ga,la,ab-1,nb,sb)}).catch(function(Gc){sb({exceptionType:ke.Authentication,
message:Gc.message})})):sb({exceptionType:ke.Authentication,message:"Remote lambda request retry with authentication token failed"}):Xb.ok?Xb.json().then(function(Gc){if(Array.isArray(Gc))if(0<Gc.length)for(var oe=0,pe=D.makeIterator(Gc),md=pe.next();!md.done;md=pe.next())md=md.value,N.moreResults=++oe<Gc.length,sb(null,md);else sb(Error("No output"));else sb(Error("Did not receive a valid response for remote lambda request"))}).catch(function(Gc){sb({exceptionType:ke.LambdaThrow,message:Gc.message})}):
sb(Error("Remote lambda request failed with status "+Xb.status))})}function Fb(){Vo=new ub}function ub(u){this.tokenCache=new Map;this.requestMap=new Map;this.requestRecordMap=new Map;this.tokenExpirationMs=void 0===u?33E5:u}function Wb(){this.cache=new Map}function Kc(u,N){if(null==u)throw Error("Cannot set exception on null message");u.payload=N;u.payloadSchema=nd;u.messageType=to.Exception}function dc(u,N){if(null==u)return"Invalid message passed";if(null==u.payload)return ke[ke.NoOutput]+": Payload is null";
if(null==u.payload.exceptionType)return"Payload is not an exception";var V=ke[u.payload.exceptionType];V+=u.payload.message?": "+u.payload.message:": No description";return V+=(void 0===N?0:N)&&u.payload.data?"\n"+u.payload.data.toString():""}function eb(u,N,V){var ka=this;this.sessionsByDocSessionId=new Map;this.hasBeenInitialized=this.disableSyncDeltaSending=this.isDeltaGeneratorEnabled=!1;this.settings={dropOnlySequencedSyncsOnReseedEnabled:!0,closeWSBlockedSessionEnabled:!0,sessionOfflineModeEnabled:!0,
annotationsOrderingEnabled:!0,deltaOperationsEnabled:!1,checkIdbByFeatures:!1,improvedWebSocketEnabled:!0,defaultBatchingEnabled:!0,batchingWith20msIntervalEnabled:!0,onAnnotationsSubmittedEnabled:!1,httpFallbackEnabled:!1,closeWorkerOnReliabilityFailureEnabled:!0,sendCloseCallbackOnClientRequestedClose:!0,reduceBatchOperationsEnabled:!1,jsond2ContentTypeEnabled:!1};this.isDownloaderCompatible=function(){if(ka.settings.checkIdbByFeatures)return"undefined"!==typeof Array&&"undefined"!==typeof Array.from&&
"undefined"!==typeof URL&&"undefined"!==typeof URL.createObjectURL?!0:!1;if("undefined"!=typeof navigator&&navigator.userAgent){var Ga=navigator.userAgent;return!Ga.indexOf||0<Ga.indexOf("MSIE ")||0<Ga.indexOf("Trident/")?!1:!0}return!1};this.workerFactory=u||function(Ga){return Ga&&Ga===Si.HttpFallback?new He:new he};var wa=this.createDefaultSessionManagerFactory();this.sessionManagerFactory=function(Ga){for(var la=[],ab=0;ab<arguments.length;++ab)la[ab-0]=arguments[ab];return(null===N||void 0===
N?void 0:N.apply(null,D.Nh(la)))||wa.apply(null,D.Nh(la))};this.sessionFactory=V||function(Ga){return new Xc(Ga)}}function Bb(){return Wp.apply(this,arguments)||this}function Ib(u,N,V){this.isOrderingEnabled=u;this.orderedAnnotationResultsProcessor=null!==N&&void 0!==N?N:new vc;this.unorderedAnnotationResultsProcessor=null!==V&&void 0!==V?V:new wc}function wc(){}function vc(u){this.annotationSequencer=null!==u&&void 0!==u?u:new Ec}function Ec(u,N){this.sequencerFactory=null!==N&&void 0!==N?N:new Wd(void 0===
u?500:u)}function cc(u,N,V,ka){function wa(Ga){return Ga instanceof V?Ga:new V(function(la){la(Ga)})}return new (V||(V=Promise))(function(Ga,la){function ab(Db){try{sb(ka.next(Db))}catch(bc){la(bc)}}function nb(Db){try{sb(ka["throw"](Db))}catch(bc){la(bc)}}function sb(Db){Db.done?Ga(Db.value):wa(Db.value).then(ab,nb)}sb((ka=ka.apply(u,N||[])).next())})}function Wd(u){this.bufferingTimeMs=500;this.workflowIdToSequencersMap=new Map;this.bufferingTimeMs=void 0===u?500:u}function ce(u,N){this.prevSeq=
-1;this.bufferingTimeMs=void 0===u?500:u;this.rejectOutdatedSequenceNumbers=void 0===N?!1:N}function yd(u,N,V){var ka=this;this.executionTrackersByWorkflowNameBySession=new Map;this.workflowsWithSessionAffinity=new Map;this.workflowDefinitionsWithSessionAffinity=[];this.workflowsWithoutSessionAffinity=[];this.pendingScopeExecutionNotificationsByWorkflow=new Map;this.sweepIntervalMs=200;this.sweepTimers=new Map;this.getResourceAsArrayBuffer=function(wa,Ga,la){return ka.modelDownloader?ka.modelDownloader.getResourceAsArrayBuffer(wa,
Ga,la):Promise.reject(Error("Resource Downloader never created"))};this.getResourceAsURL=function(wa,Ga,la){return ka.modelDownloader?ka.modelDownloader.getResourceAsURL(wa,Ga,la):Promise.reject(Error("Resource Downloader never created"))};this.createModel=function(wa){!ka.inferenceService&&ka.inferenceServiceFactory&&(ka.inferenceService=ka.inferenceServiceFactory());return ka.inferenceService?ka.inferenceService.then(function(Ga){return Ga.createModel(wa)}):Promise.reject(Error("Inference Service never created"))};
this.createModelInputs=function(){!ka.inferenceService&&ka.inferenceServiceFactory&&(ka.inferenceService=ka.inferenceServiceFactory());if(ka.inferenceService)return ka.inferenceService.then(function(wa){return wa.createInputs()});throw Error("Inference Service never created");};this.nextSignalId=this.nextAnnotationId=1;this.modelDownloader=u;this.inferenceServiceFactory=N;V.enableDeltas&&(this.deltaHandlers=(new Map).set(Eb.getTypeNameFor(Zh),Ol).set(Eb.getTypeNameFor(Vf),cl),this.itemsForDelta=new Map);
this.enableEarlyJoin=V.enableEarlyJoin||!1;this.site={getResourceAsArrayBuffer:this.getResourceAsArrayBuffer,getResourceAsURL:this.getResourceAsURL,createModel:this.createModel,createModelInputs:this.createModelInputs}}function La(u,N,V){this.itemsContextId=new Set;this.executionState=new Map;this.graphNode=u;this.onContextIdWorkflowExecutionComplete=N;V&&(this.itemsContextId=V.itemsContextId,this.executionState=V.executionState)}function pb(u){this.model=u.model;this.clientMetadata=u.clientMetadata;
this.userContext=u.userContext;this.site=u.site;this.getToken=u.getTokenCallback}function ib(u,N,V,ka){this.originalFlights=u;this.normalizedFlights=N;this.keyValueFlightsMap=V;this.parsedFlightsMap=ka}function fc(u,N){N=void 0===N?[]:N;this.rootItem=this.scopeItem=void 0;this.normalizeFilter=function(V){if(!V)return function(ka){return void 0!==ka};if("function"===typeof V)throw Error("Not implemented yet");if(1!==(V.id?1:0)+(V.ids?1:0)+(V.itemType?1:0)+(V.itemTypes?1:0))throw Error("Exactly one condition expected on IItemFilter");
if(V.itemType)return function(ka){return ka&&Eb.matchesTypesFor(ka.body,[V.itemType])};if(V.itemTypes)return function(ka){return ka&&Eb.matchesTypesFor(ka.body,V.itemTypes)};throw Error("Not implemented yet");};this.items=[].concat(D.Nh(N),[u]);this.scopeItem=new lb(u)}function lb(u){this.item=u;this.operation=u.op;this.delta=u.delta;this.deltas=u.deltas;this.id=Ka(this.itemPath);this.revId=u.revId}function Ma(u){u=gr.call(this,u)||this;u.eventName="AnnotationMetaDataChange";return u}function fb(u){u=
Error.call(this,void 0===u?"ExpectedError":u);this.message=u.message;"stack"in u&&(this.stack=u.stack);this.__proto__=fb.prototype}function Ca(u){Eb.assign(Ca,this,u)}function Va(u){Eb.assign(Va,this,u)}function ob(u){Eb.assign(ob,this,u)}function Hb(u){Eb.assign(Hb,this,u)}function gc(u){Eb.assign(gc,this,u)}function Tc(u){Eb.assign(Tc,this,u)}function Yb(u){Eb.assign(Yb,this,u)}function Qb(u){Eb.assign(Qb,this,u)}function kc(u){Eb.assign(kc,this,u)}function Oc(u){Eb.assign(Oc,this,u)}function Vb(u){Eb.assign(Vb,
this,u)}function $c(u){Eb.assign($c,this,u)}function Cc(u){Eb.assign(Cc,this,u)}function Id(u){Eb.assign(Id,this,u)}function Of(u){Eb.assign(Of,this,u)}function yc(u,N,V,ka,wa){var Ga=lj.call(this)||this;Ga.getSessionStats=u;Ga.clientMetadata=N;Ga.tokenRefreshManager=V;Ga.sendMessage=ka;Ga.options=wa?wa:{};Ga.options.overrideSessionInitMessage=Ga.options.overrideSessionInitMessage||function(la){return la};if(Ga.clientMetadata&&!Ga.clientMetadata.userSystemTimezone)try{Ga.clientMetadata.userSystemTimezone=
Intl.DateTimeFormat().resolvedOptions().timeZone}catch(la){}return Ga}function Hd(){this.timers=new Map}function jk(){}function Xc(u){var N;this.annotationActivationTrackers=new Map;this.annotationCallbacks=new Map;this.annotationResultStates=new Map;this.tokensByAnnotationType=new Map;this.registeredContextTypes=new Set;this.availableContexts=new Map;this.nextSyncSequenceId=1;this.allowGroupSeed=this.allowSeed=!0;this.seedGroupSize=0;this.isSessionClosed=this.hasSessionConnected=!1;this.serverAuthenticationState=
Bg.NotAuthenticated;this.sessionCloseCallbacks=new Map;this.connectCallbacks=new Map;this.reconnectCallbacks=new Map;this.disconnectCallbacks=new Map;this.sessionStateCallbackToken=0;this.workflowGraph=new Je;this.workflowDefinitionManager=new Sf;this.contextIdManager=new ui(To.JsClient,this.workflowGraph);this.workflowItemStorage=new og(this.workflowDefinitionManager);this.pendingConnectCallbacks=[];this.reduceBatchOperationsEnabled=this.onAnnotationsSubmittedEnabled=!1;this.hostCallbacks=u.hostCallbacks;
this.sessionManager=u.sessionManager;this.operationBatchConfig=u.batchOptions?this.getOperationBatchConfig(u.batchOptions):void 0;this.extensionConfigs=u.extensionConfigs;this.clientMetadata=u.clientMetadata;this.userContext=u.userContext;this.localWorkflowManager=u.localWorkflowManager;this.annotationResultsProcessor=u.annotationResultsProcessor;u.workflowRuntimeFactory&&(this.workflowRuntime=u.workflowRuntimeFactory(this.sessionManager));this.localRegisteredWorkflows=u.localRegisteredWorkflows||
[];this.enableRemoteExecutionNotification=u.enableRemoteExecutionNotification||!1;this.networkMode=u.networkMode;this.egress=u.egress;this.serverAuthenticationStateChangeCallback=[];this.onAnnotationsSubmittedEnabled=u.onAnnotationsSubmittedEnabled||!1;this.reduceBatchOperationsEnabled=u.reduceBatchOperationsEnabled||!1;this.sessionManager.on("sessionClose",this.onSessionClose.bind(this));this.sessionManager.on("reconnect",this.onReconnect.bind(this));this.sessionManager.on("connect",this.onConnect.bind(this));
this.sessionManager.on("disconnect",this.onDisconnect.bind(this));this.sessionManager.on("resetNextSyncSequenceId",this.resetNextSyncSequenceId.bind(this));this.sessionManager.on("serverAuthenticationStateChange",this.onServerAuthenticationStateChange.bind(this));this.sessionManager.onMessage(xk.getTypeName(),this.workflowRuntime?this.onAnnotationResultsFromLocal.bind(this):this.onAnnotationResultsFromServer.bind(this));this.sessionManager.onMessage(mn.getTypeName(),this.onAnnotationResultStateMessage.bind(this));
this.sessionManager.onMessage(li.getTypeName(),this.onWorkflowExecutionCompleteMessage.bind(this));u.isDeltaGeneratorEnabled&&(this.enableSyncDeltaSending=!u.disableSyncDeltaSending,this.syncDeltaTimeout=null!==(N=u.syncDeltaTimeout)&&void 0!==N?N:700,this.enableDeltaGenerator());this.setServerAuthenticationStateChangeCallback(this.updateGraphOnAuthStateChange.bind(this))}function ti(u){return!u.items.some(function(N){return N.source&&0===N.source.indexOf("ThirdParty")})}function nh(u,N){N?(u.resultDescription=
N,u.success=!1,wb.a.error(509203144,wb.b.CoreDefault,u.stop())):wb.a.info(509203143,wb.b.CoreDefault,u.stop())}function od(u){var N=Number.POSITIVE_INFINITY,V=0,ka=[];for(u=[u];0<u.length;){var wa=u.pop(),Ga=typeof wa;if("boolean"===Ga)V+=4;else if("string"===Ga)V+=2*wa.length;else if("number"===Ga)V+=8;else if("object"===Ga&&wa&&-1===ka.indexOf(wa))if(wa instanceof Uint8Array)V+=wa.length;else{ka.push(wa);for(var la in wa)u.push(wa[la])}if(V>N)break}return V}function Xg(){var u=this;this.createTextTileDeltasFromItem=
function(N,V){var ka,wa=(new Pc({operationName:"CreateTextTileDeltaFromItem",success:!0})).start();try{if(N)if(N.body){var Ga=N.body;if(Jh.typeGuard(Ga)){var la=Kk(N.id,V),ab=null!==(ka=u.lastSeenTileByTileId.get(la))&&void 0!==ka?ka:new Jh({content:""}),nb=u.createDeltas(ab,Ga);nb&&0!==nb.length?(wa.dimension0=nb.length.toString(),u.lastSeenTileByTileId.set(la,Ga)):(wa.dimension0="0",wa.resultDescription="No delta differences found");wb.a.info(524883087,wb.b.CoreDefault,wa.stop());return nb}wa.success=
!1;wa.resultDescription="Unable to create text tile delta, parent item body is not proper type: expected "+Jh.getTypeName()+", received "+Eb.getTypeNameFor(Ga)}else wa.success=!1,wa.resultDescription="Unable to create text tile delta, parent item has undefined body",wb.a.info(524883086,wb.b.CoreDefault,wa.stop());else wa.success=!1,wa.resultDescription="Unable to create text tile delta, parent item is undefined",wb.a.info(524883085,wb.b.CoreDefault,wa.stop())}catch(sb){wa.success=!1,wa.resultDescription=
"Error creating text tile delta: "+sb,wb.a.info(524883088,wb.b.CoreDefault,wa.stop())}};this.lastSeenTileByTileId=new Map;this.deltaBuilder=new Fc}function Kk(u,N){return N?N.join("\\")+"-"+u:u}function Fc(){this.deltaBuilderHandlers=new Map;this.registerDeltaBuilderHandler(Jh.getTypeName(),ej);this.registerDeltaBuilderHandler(Ih.getTypeName(),pt)}function Vf(u){Eb.assign(Vf,this,u)}function Zh(u){Eb.assign(Zh,this,u)}function Jg(u){Eb.assign(Jg,this,u)}function hh(u){Eb.assign(hh,this,u)}function wh(u){Eb.assign(wh,
this,u)}function Lk(u){Eb.assign(Lk,this,u)}function Rj(u){Eb.assign(Rj,this,u)}function Ih(u){Eb.assign(Ih,this,u)}function Jh(u){Eb.assign(Jh,this,u)}function og(u){this.scopeItemsByContextId=new Map;this.itemsByWorkflowAndContextId=new Map;this.workflowDefinitionManager=u}function ui(u,N){this.nextId=1;this.runtimeKind=u;this.workflowGraph=N}function Sf(){this.workflowDefByWorkflowAndContextId=new Map;this.workflowDefByWorkflow=new Map}function ic(u,N){return void 0===u||null===u||void 0===N||
null===N?!1:0<u.length&&(u===N||0===N.indexOf(u)&&"."===N.charAt(u.length))}function Eg(u){return{id:u.id,kind:u.kind,visibility:u.visibility,collectionScopeType:u.collectionScopeType,inputTypes:u.inputTypes,outputTypes:u.outputTypes,correlatedSignals:u.correlatedSignals}}function yj(u,N,V){var ka=u.get(N);ka||(ka=V(),u.set(N,ka));return ka}function Kn(u,N){this.isActivated=!0;this.upstreamWorkflows=new Set;this.downstreamWorkflows=new Set;this.location=N;this.workflow=Object.assign(Object.assign({},
u),{inputTypes:Array.isArray(u.inputTypes)?u.inputTypes:[],outputTypes:Array.isArray(u.outputTypes)?u.outputTypes:[]})}function Je(){this.graphNodeByLocationAndWorkflowId=new Map}function Ka(u){return Array.isArray(u)?5===u.length?""+u[0]+"\\"+u[1]+"\\"+u[2]+"\\"+u[3]+"\\"+u[4]:4===u.length?""+u[0]+"\\"+u[1]+"\\"+u[2]+"\\"+u[3]:3===u.length?""+u[0]+"\\"+u[1]+"\\"+u[2]:2===u.length?""+u[0]+"\\"+u[1]:1===u.length?u[0]:u.join("\\"):"(malformed path)"}function mb(u,N){return Object.assign(Object.assign({},
N),{parentPath:u})}function yb(u,N){var V=[];u=D.makeIterator(null!==u&&void 0!==u?u:[]);for(var ka=u.next();!ka.done;ka=u.next())if(ka=ka.value,void 0===N||N===ka.cardinality)for(var wa=D.makeIterator(ka.contextTypes),Ga=wa.next();!Ga.done;Ga=wa.next())V.push([Ga.value,ka.cardinality,ka.producerWaitPolicy]);return V}function ac(u,N,V){this.batchesByGroupingKey=new Map;this.getOrderOfMagnitudeDimension=function(ka){return 0>ka?"Negative":0===ka?"0":1===ka?"1":"Magnitude "+ka.toString().length};this.submit=
u;this.onSummary=V;this.reduceBatchOperationsEnabled=N}function lc(u,N,V){this.sendMessage=u;this.annotationType=N;this.options=V;this.token=N+"-"+lc.nextActivationResultBatchId++}function fd(u){Eb.assign(fd,this,u)}function zd(u){Eb.assign(zd,this,u)}function ge(u){Eb.assign(ge,this,u)}function hg(u){Eb.assign(hg,this,u)}function lh(u){Eb.assign(lh,this,u)}function ld(u){Eb.assign(ld,this,u)}function rc(u){Eb.assign(rc,this,u)}function Aa(u){Eb.assign(Aa,this,u)}function Ya(u){Eb.assign(Ya,this,
u)}function cb(u){Eb.assign(cb,this,u)}function Ub(u){Eb.assign(Ub,this,u)}function kd(u,N,V,ka,wa,Ga,la,ab,nb){var sb=Yr.call(this)||this;sb.cvParent=new Lh;sb.logOp=(new Pc({operationName:"SessionState",success:!0})).start();sb.sessionStateChangeLogCountLimiter=new Sb("SessionState");sb.stats=N;N={};sb.allStates=(N[Ed.Initing]=new qd(sb),N[Ed.Running]=new Pf(sb),N[Ed.Disconnected]=new ii(sb),N[Ed.Closed]=new ik(sb),N);sb.setState(Ed.Initing);sb.improvedWebSocketEnabled=la.improvedWebSocketEnabled;
sb.sendCloseCallbackOnClientRequestedClose=la.sendCloseCallbackOnClientRequestedClose;sb.messageEndpoint=new Td("c");sb.messageEndpoint.setClientMetadata(wa);sb.messageEndpoint.setEgress(sb.egress.bind(sb));sb.messageEndpoint.onMessage(Ve.getTypeName(),function(Db,bc){sb.onSessionCloseMessage(Db,bc)});sb.networkWorkerManager=new Vc(u,wa,V,ka,sb.ingress.bind(sb),sb.messageEndpoint.queryEgressCacheSize.bind(sb.messageEndpoint),sb.onConnectionClose.bind(sb),function(){sb.onSessionClose(void 0,"WSNotSupported")},
la,ab,nb);sb.messageQueue=new ji({sendMessage:function(Db,bc,Xb,Gc){return sb.state.sendMessage(Db,bc,Xb,Gc)},sendBytes:sb.sendBytes.bind(sb),canSendMessage:function(){return sb.state.canSendMessage()},dropOnlySequencedSyncsOnReseed:la.dropOnlySequencedSyncsOnReseedEnabled});ka.on("connect",function(Db,bc,Xb,Gc,oe,pe,md){sb.setState(Ed.Running,"",{isSessionReseedingStarted:Db&&bc});sb.emit("connect",Db,Xb,Gc,oe,pe,md)});ka.on("reconnect",function(){return sb.emit("reconnect")});ka.on("serverAuthenticationStateChange",
function(Db){return sb.emit("serverAuthenticationStateChange",Db)});sb.resetNextSyncSequenceId=function(){return sb.emit("resetNextSyncSequenceId")};sb.tokenRefreshManager=Ga;return sb}function Vc(u,N,V,ka,wa,Ga,la,ab,nb,sb,Db){var bc=this;this.logCountLimiter=new Sb(Vc.className);this.permanentlyClosed=this.isWorkerReady=!1;this.lastInitializationAttemptTimeMs=this.currentReconnectAttempt=0;this.offlineInterval=void 0;this.alreadyLoggedReconnectAttempt=!1;this.httpTestsLeft=5;this.workerOpenCount=
this.httpTestsSuccessCount=0;this.testHttpConnection=function(Xb){var Gc=mc.convertWebSocketUrlToHttp(bc.globalUrl),oe=!Xb,pe=null!==Xb&&void 0!==Xb?Xb:(new Pc({operationName:"HttpsTest",resourceId:Gc,success:!1,resultDescription:"",resultSignature:"HttpResponse:"})).start();Xb={method:"POST",headers:{"content-type":"application/json","X-CorrelationId":pe.cv},body:JSON.stringify(mc.createHealthCheckRequest(bc.clientMetadata))};tm(Gc,Xb,function(md,yf){md?(pe.dimension1="HttpErr",pe.resultDescription+=
"HttpErr: "+md.message):yf&&yf.ok?(pe.dimension1="HttpOK",bc.leaveOfflineMode(),bc.httpTestsSuccessCount++,oe&&(pe.success=!0)):(pe.dimension1="HttpNoResp",pe.resultDescription+="HttpStatus: "+(null===yf||void 0===yf?void 0:yf.status));oe&&pe.stop();bc.logCountLimiter.log(function(){wb.a.info(508843780,wb.b.CoreDefault,pe)})})};this.globalUrl=u;this.clientMetadata=N;this.workerFactory=V;this.sessionInitializer=ka;this.ingress=wa;this.queryEgressCacheSize=Ga;this.onConnectionClose=la;this.onDetectedWSBlock=
ab;this.closeWSBlockedSession=nb.closeWSBlockedSessionEnabled;this.sessionOfflineModeEnabled=nb.sessionOfflineModeEnabled;this.improvedWebSocketEnabled=nb.improvedWebSocketEnabled;this.httpFallbackEnabled=nb.httpFallbackEnabled;this.jsond2ContentTypeEnabled=nb.jsond2ContentTypeEnabled;this.closeWorkerOnReliabilityFailureEnabled=nb.closeWorkerOnReliabilityFailureEnabled;this.networkWorkerLogOp=new Pc({operationName:"CreateNetworkWorker",success:!0});this.networkMode=sb?sb:Si.JSWebSockets;this.improvedWebSocketEnabled&&
(this.networkRateSettings=Db)}function lf(u,N,V){N=mc.getCurrentTimeMs()?mc.getCurrentTimeMs()-N:0;var ka=[1E3,2E3,5E3,1E4,6E4];u=ka[Math.max(0,Math.min(ka.length-1,u-1))];u=Math.max(u-N,1E3);return u=V&&0<V?Math.min(5E3,u):u}function Rd(u,N){var V=this,ka,wa,Ga,la,ab;this.logCountLimiter=new Sb(Rd.className);this.egressByteCount=this.egressMessageCount=this.emptyMessageId=0;this.prevSeq=-1;this.pendingQueue=[];this.egressRateLogOp=new Pc({operationName:"NetworkEgressRate",success:!0});this.egressLogOp=
(new Pc({operationName:"NetworkEgressControl",success:!0})).start();this.egressedCache=new Map;this.rpsThreshold=null!==(ka=null===u||void 0===u?void 0:u.rpsThreshold)&&void 0!==ka?ka:150;this.bpsThreshold=null!==(wa=null===u||void 0===u?void 0:u.bpsThreshold)&&void 0!==wa?wa:5E8;this.pendingMaxSize=null!==(Ga=null===u||void 0===u?void 0:u.pendingMaxSize)&&void 0!==Ga?Ga:1E4;this.egressedMaxSize=null!==(la=null===u||void 0===u?void 0:u.egressedMaxSize)&&void 0!==la?la:1E4;this.messageMaxSize=null!==
(ab=null===u||void 0===u?void 0:u.messageMaxSize)&&void 0!==ab?ab:3E6;this.closeWorkerOnReliabilityFailureEnabled=null!==N&&void 0!==N?N:!0;this.initPromise=new Promise(function(nb){V.resolveInitPromise=nb})}function gh(u,N,V){return u instanceof He?new Ie(u):new Uf(u,N,V)}function He(){this.isClosing=!1;this.pendingEgress=[]}function Ie(u){this.remainingRetryAttempts=4;this.isResponseReceived=this.isActiveLongPoll=this.isLongPollSuccessful=this.isAsleep=!1;this.lastEgressTime=0;this.longPollLogOp=
new Pc({operationName:"OnLongPollMessage",success:!0});this.worker=u}function Uf(u,N,V){this.logCountLimiter=new Sb(Uf.className);this.lastEgressTime=this.lastPongTime=this.lastPingTime=0;this.remainingPingFailures=3;this.isPingPongSuccessful=!1;this.pingPongLogOp=(new Pc({operationName:"WebSocketReliabilityManager",success:!0})).start();this.worker=u;this.closeWorkerOnReliabilityFailure=V;this.rateControllerClose=N}function hk(u,N,V){this.requestInProgress=!1;this.queuedRequests=[];if(null==u)throw Error("No request.");
this.fetch=u;this.fetchTimeout=N;this.queueTimeout=V}function ik(){var u=kg.apply(this,arguments)||this;u.stateName=Ed.Closed;u.possibleNextStates=[];return u}function ii(){var u=kg.apply(this,arguments)||this;u.stateName=Ed.Disconnected;u.possibleNextStates=[Ed.Initing,Ed.Closed];return u}function Pf(){var u=kg.apply(this,arguments)||this;u.stateName=Ed.Running;u.possibleNextStates=[Ed.Disconnected,Ed.Closed];return u}function qd(){var u=kg.apply(this,arguments)||this;u.stateName=Ed.Initing;u.possibleNextStates=
[Ed.Running,Ed.Disconnected,Ed.Closed];return u}function kg(u){this.context=u}function Lg(u,N){N&&(u.messageQueue.push(N),u.networkWorkerManager.init(void 0,u.customInitPromise).catch(function(V){wb.a.error(508843788,wb.b.CoreDefault,"Init failed: "+V)}))}function tk(u,N,V,ka){N&&(u.messageQueue.push(N,V,ka),u.networkWorkerManager.init(void 0,u.customInitPromise).catch(function(wa){wa=new Pc({operationName:"WorkerManagerInit",success:!1,resultDescription:""+wa});wb.a.error(508843789,wb.b.CoreDefault,
wa)}))}function gf(u,N,V,ka){N&&(N.cv||(N.cv=u.cvParent.newChild().toString()),u.messageEndpoint.sendMessage(N,function(wa,Ga){wa||Eb.getTypeNameFor(Ga)!==ih.getTypeName()||(u.stats.lastSyncMessage=Date.now());V&&V(wa,Ga)},void 0,ka))}function ji(u){this.logOp=new Pc({operationName:"MessageQueue",success:!0});this.messageQueueLogCountLimiter=new Sb("MessageQueue");this.queue=new zq.a(1E3);this.callbacks=u}function Td(u){this.nextMessageId=1;this.pendingResponseCallbacks=new zj({sweepInterval:5E3});
this.pendingMessageCallbacks=new zj({sweepInterval:5E3});this.messageCallbacks=new Map;this.messageIdPrefix=u;this.source="c"===u?ec.ClientRuntime:ec.Core;this.stats={sendMessageCount:0,sendMessageClientDisconnectedErrors:0,sendMessageErrors:0,sendMessageDurationMsMax:0,processMessageCount:0,processMessageProvisionTokenErrors:0,processMessageErrors:0,processMessageDurationMsMax:0}}function zj(u){this.cache=new Map;this.options=u||{sweepInterval:100};if(void 0!=this.options.idleDurationMs&&0>=this.options.idleDurationMs)throw Error("Idle duration must be positive");
this.interval=this.options.sweepInterval||100;if(0>=this.interval)throw Error("Sweep interval must be a positive number");}function em(u){Eb.assign(em,this,u)}function ki(u){Eb.assign(ki,this,u)}function Aj(u){Eb.assign(Aj,this,u)}function Pe(u){Eb.assign(Pe,this,u)}function Uj(u){Eb.assign(Uj,this,u)}function uk(u){Eb.assign(uk,this,u)}function Ll(u){Eb.assign(Ll,this,u)}function Rc(u){Eb.assign(Rc,this,u)}function vk(u){Eb.assign(vk,this,u)}function Jm(u){Eb.assign(Jm,this,u)}function oh(u){Eb.assign(oh,
this,u)}function li(u){Eb.assign(li,this,u)}function vi(u){Eb.assign(vi,this,u)}function kn(u){Eb.assign(kn,this,u)}function lk(u){Eb.assign(lk,this,u)}function ln(u){Eb.assign(ln,this,u)}function wk(u){Eb.assign(wk,this,u)}function xk(u){Eb.assign(xk,this,u)}function df(u){Eb.assign(df,this,u)}function ih(u){Eb.assign(ih,this,u)}function Km(u){Eb.assign(Km,this,u)}function Te(u){Eb.assign(Te,this,u)}function Lm(u){Eb.assign(Lm,this,u)}function Bj(u){Eb.assign(Bj,this,u)}function Vj(u){Eb.assign(Vj,
this,u)}function wg(u){Eb.assign(wg,this,u)}function mn(u){Eb.assign(mn,this,u)}function cj(u){Eb.assign(cj,this,u)}function xh(u){Eb.assign(xh,this,u)}function Ue(u){Eb.assign(Ue,this,u)}function yh(u){Eb.assign(yh,this,u)}function Ve(u){Eb.assign(Ve,this,u)}function $e(u){Eb.assign($e,this,u)}function Mf(u){Eb.assign(Mf,this,u)}function zh(u){Eb.assign(zh,this,u)}function Bf(u){Eb.assign(Bf,this,u)}function bh(u){Eb.assign(bh,this,u)}function xg(u){Eb.assign(xg,this,u)}function $k(u){Eb.assign($k,
this,u)}function Kh(u){Eb.assign(Kh,this,u)}function yg(u){Eb.assign(yg,this,u)}function Mk(u){Eb.assign(Mk,this,u)}function pg(u,N){var V,ka;var wa=If.call(this,{source:ec[u.source],reason:mi[u.reason],reasonDependency:u.reasonDependency,subReason:u.subReason,sessionHealthEventName:u.sessionHealthEventName,impact:rn[u.impact],success:u.success,durationMs:null!==(V=u.durationMs)&&void 0!==V?V:0,count:"number"===typeof u.count?u.count:1,message:u.message,affectedWorkflows:(null!==(ka=u.affectedWorkflows)&&
void 0!==ka?ka:[]).join(","),resourceId:u.resourceId,dimension0:u.dimension0,dimension1:u.dimension1,dimension2:u.dimension2,dimension3:u.dimension3,cv:u.cv,resultSignature:u.resultSignature,resultDescription:u.resultDescription,joinContextId:u.joinContextId})||this;wa.eventName="SessionHealth";N&&wa.setClientMetadata(N);wa.metricCount=u.metricCount;wa.metricDuration=u.metricDuration;return wa}function Lh(u){this.childCount=0;if(!u){for(u=0;22>u;u++)wd[u]=Oh[Math.floor(Math.random()*Oh.length)];u=
wd.join("")}this.id=u}function he(){this.hadEgressError=this.hasBeenOpened=!1;this.lastPongTime=this.lastEgressTime=0;this.remainingPingFailures=3;this.egressByteCount=this.egressMessageCount=0;this.isClosing=!1;this.pendingEgress=[]}function ra(u,N){N=void 0===N?0:N;return Number.isFinite(u)?u:N}function qb(u){var N=new Set;u=D.makeIterator(u);for(var V=u.next();!V.done;V=u.next())if(V=V.value,"string"===typeof V)-1===mv.indexOf(V)&&N.add(V);else{V=D.makeIterator([V.getTypeName()].concat(D.Nh(V.getBaseTypes())));
for(var ka=V.next();!ka.done;ka=V.next())ka=ka.value,-1===mv.indexOf(ka)&&N.add(ka)}return Array.from(N)}function Sb(u){this.maxNumberOfLogs=40;this.numberOfLogs=0;this.id=u}function mc(){}function Ad(u){Eb.assign(Ad,this,u)}function re(u){Eb.assign(re,this,u)}function mf(u){Eb.assign(mf,this,u)}function Mg(u){Eb.assign(Mg,this,u)}function sl(u){Eb.assign(sl,this,u)}function tl(u){Eb.assign(tl,this,u)}function Wj(u){Eb.assign(Wj,this,u)}function mk(u){Eb.assign(mk,this,u)}function qm(u){Eb.assign(qm,
this,u)}function Mi(u){Eb.assign(Mi,this,u)}function qp(u){Eb.assign(qp,this,u)}function Mh(u){Eb.assign(Mh,this,u)}function rp(u){Eb.assign(rp,this,u)}function qg(u){Eb.assign(qg,this,u)}function Po(u){Eb.assign(Po,this,u)}function $h(u){Eb.assign($h,this,u)}function wf(u){Eb.assign(wf,this,u)}function al(u){Eb.assign(al,this,u)}function Ug(u){Eb.assign(Ug,this,u)}function rm(u){Eb.assign(rm,this,u)}function Bh(u){Eb.assign(Bh,this,u)}function Nk(u){this.level=Xj.a.info;this.hostCallbacks=u}function Qo(u,
N,V,ka){return new $q(u,function(wa){return wa.success&&0<=V.indexOf(wa[N])},[N,"resourceId","success","resultSignature","clientDocSessionId","dimension0","dimension1","dimension2","dimension3"],["durationMs"],ka)}function $q(u,N,V,ka,wa){var Ga=this;this.buckets=new Map;this.init=function(la){Ga.log=la};this.add=function(la,ab){ab=void 0===ab?!0:ab;if(!Ga.condition||!Ga.condition(la))return!0===ab&&Ga.log(la,!1),!1;ab=[];for(var nb=D.makeIterator(Ga.dimensions),sb=nb.next();!sb.done;sb=nb.next())if(sb=
sb.value,void 0===la[sb]||null===la[sb])ab.push(null);else{var Db="";"boolean"==typeof la[sb]?Db="b~":"number"==typeof la[sb]&&(Db="n~");ab.push(""+Db+la[sb].toString().replace(ro,"_"))}sb=ab.join("|");ab=Ga.buckets.get(sb);if(!ab){ab=new Ch;ab.traceLevel=la.traceLevel;Db=D.makeIterator(Ga.avgMeasures);for(nb=Db.next();!nb.done;nb=Db.next())ab.hnb.set(nb.value,0);Ga.buckets.set(sb,ab)}ab.count++;sb=D.makeIterator(Ga.avgMeasures);for(nb=sb.next();!nb.done;nb=sb.next())nb=nb.value,la[nb]&&ab.hnb.set(nb,
ab.hnb.get(nb)+la[nb]);return!0};this.flush=function(la){la=void 0===la?!1:la;Ga.buckets.forEach(function(ab,nb){var sb={traceLevel:ab.traceLevel,eventName:Ga.eventName,count:ab.count};nb=nb.split("|");for(var Db=0;Db<Ga.dimensions.length;Db++){var bc=Ga.dimensions[Db],Xb=nb[Db];0===Xb.indexOf("b~")?sb[bc]="b~true"===Xb:0===Xb.indexOf("n~")?sb[bc]=parseInt(Xb.slice(2),10):sb[bc]=Xb}nb=D.makeIterator(Ga.avgMeasures);for(Db=nb.next();!Db.done;Db=nb.next())Db=Db.value,sb[Db]=Math.round(ab.hnb.get(Db)/
ab.count);Ga.log(sb,!0)});Ga.buckets.clear();la&&(Ga.condition=null,clearInterval(Ga.interval))};this.eventName=u;this.condition=N;this.dimensions=V;this.avgMeasures=ka;0<wa&&(this.interval=setInterval(this.flush,1E3*wa))}function Ch(){this.count=0;this.hnb=new Map}function Pc(u,N){var V=rh.call(this,u)||this;V.eventName="Operation";V.options=N;V.durationMs=null===u||void 0===u?void 0:u.durationMs;u&&void 0!=u.count||(V.count=1);return V}function sm(u,N,V,ka,wa){this.documentContext=void 0===N?"":
N;this.intent=void 0===ka?"Creation":ka;this.diagramType=void 0===wa?"Flowchart":wa;this.H_={T_:sm.getTypeName(),B_:sm.getBaseTypes()}}function Ml(u){this.status=u.has("status")?u.status:"";this.intent=u.has("intent")?u.intent:"";u.has("answer");this.error=u.has("error")?u.error:"";this.H_={T_:Ml.getTypeName(),B_:Ml.getBaseTypes()}}function Eb(u){Eb.assign(Eb,this,u)}function zg(){this.rD=De.a.instance;this.Aa=yq.a.instance()}function pd(){}function bl(){}function Nl(){}function Ni(){}function Nh(u){this.IV=
u}function Oi(){this.A0=new nf.a}function uq(){this.A0=null}function po(){this.PostUploadCallback=this.Blobs=null}function Xd(){this._errorCode=0;this._message=this._title=null;this._type=0}function Mm(u){this._text=null;if(void 0===u||null===u)throw Error.argumentNull("text");this.gZa(u)}function ie(){this._controlValues=this._handler=this._title=null}function Dd(){}function Hi(){}function Rp(){}function Rr(){}function dj(){}function ul(){this.newPinPoints=this.shapes=this.parentPage=this.extendedGuidId=
null}function qo(u){for(var N,V=D.makeIterator(["AugLoop_Excel_Session_Protocol_","AugLoop_Powerpoint_Session_Protocol_","AugLoop_Session_Protocol_"]),ka=V.next();!ka.done;ka=V.next())if(ka=ka.value,0===u.indexOf(ka)){N=ka;break}if(!N)return"MalformedMessageName";V=u.indexOf("Message",u.length-7)===u.length-7;return u.slice(N.length,V?-7:void 0)}function tm(u,N,V){u=new im.Request(u,N);return Tn.add(u,V)}function Ro(u,N,V){return new Promise(function(ka,wa){var Ga=setTimeout(function(){wa(Error("Request timed out"))},
N);Object(im.fetch)(u,V?V:{}).then(function(la){clearTimeout(Ga);ka(la)}).catch(function(la){clearTimeout(Ga);wa(la)})})}function fm(u,N){switch(u){case 12288:case 8197:case 32:case 11:case 9:case 160:return!0;case 13:case 10:case 65532:return!(void 0===N?0:N)}return!1}function nn(u,N){return 56320<=u.charCodeAt(N)&&57343>=u.charCodeAt(N)}function ej(u,N){var V=[];(u=Ee(u,N))&&V.push(u);return V}function pt(u,N){var V=[],ka=Ee(u,N);ka&&V.push(ka);var wa;a:{var Ga,la,ab,nb,sb;if((null===u||void 0===
u?void 0:u.ipPosition)!==(null===N||void 0===N?void 0:N.ipPosition)||(null===u||void 0===u?void 0:u.isColdIp)!==(null===N||void 0===N?void 0:N.isColdIp)){if((null===u||void 0===u?void 0:u.isColdIp)===(null===N||void 0===N?void 0:N.isColdIp)&&ka)if(ka.deltaType===Qg.Add){if((null===N||void 0===N?void 0:N.ipPosition)===(null!==(wa=ka.position)&&void 0!==wa?wa:0)+(null!==(Ga=ka.length)&&void 0!==Ga?Ga:0)){wa=void 0;break a}}else if(ka.deltaType===Qg.Update){if((null===N||void 0===N?void 0:N.ipPosition)===
(null!==(la=ka.position)&&void 0!==la?la:0)+(null!==(nb=null===(ab=ka.content)||void 0===ab?void 0:ab.length)&&void 0!==nb?nb:0)){wa=void 0;break a}}else if(ka.deltaType===Qg.Delete&&(null===N||void 0===N?void 0:N.ipPosition)===(null!==(sb=ka.position)&&void 0!==sb?sb:0)){wa=void 0;break a}wa=new Vf({deltaType:Qg.CursorUpdate,cursorData:{ipPosition:null===N||void 0===N?void 0:N.ipPosition,isColdIp:null===N||void 0===N?void 0:N.isColdIp}})}else wa=void 0}wa&&V.push(wa);(ka=Ln(u,N,ka))&&V.push(ka);
var Db;ka={};wa=!1;for(Db in N)-1!==["ipPosition","isColdIp","content","formattedRanges"].indexOf(Db)||bg()(N[Db],u[Db])||(wa=!0,ka[Db]=N[Db]);u=wa?new Vf({deltaType:Qg.OtherNonContentUpdate,otherNonContentData:ka}):void 0;u&&V.push(u);return V}function Ee(u,N){u=u.content;N=N.content;var V=void 0;V=void 0===V?!1:V;var ka={firstDiffLeft:0,firstDiffRight:N.length};if(u.length<N.length){var wa=u;var Ga=N}else wa=N,Ga=u;if(0===Ga.indexOf(wa))ka.firstDiffLeft=wa.length,ka.firstDiffRight=0;else if(Ga.endsWith(wa))ka.firstDiffLeft=
0,ka.firstDiffRight=wa.length;else{ka=V;ka=void 0===ka?!1:ka;V={firstDiffLeft:0,firstDiffRight:N.length};for(Ga=0;Ga<u.length&&Ga<N.length;Ga+=1){var la=u.charCodeAt(Ga),ab=N.charCodeAt(Ga);if(!(la===ab||fm(la,ka)&&fm(ab,ka)))break}V.firstDiffLeft=Ga;for(Ga=0;Ga<u.length&&Ga<N.length&&(la=u.charCodeAt(u.length-Ga-1),ab=N.charCodeAt(N.length-Ga-1),la===ab||fm(la,ka)&&fm(ab,ka));Ga+=1);V.firstDiffRight=Ga;ka=V;ka.firstDiffLeft+ka.firstDiffRight>wa.length&&(ka.firstDiffRight=wa.length-ka.firstDiffLeft)}wa=
ka;0<wa.firstDiffLeft&&(V=wa.firstDiffLeft<u.length&&nn(u,wa.firstDiffLeft),Ga=wa.firstDiffLeft<N.length&&nn(N,wa.firstDiffLeft),(V||Ga)&&--wa.firstDiffLeft);1<wa.firstDiffRight&&(V=wa.firstDiffRight<u.length&&nn(u,u.length-wa.firstDiffRight),Ga=wa.firstDiffRight<N.length&&nn(N,N.length-wa.firstDiffRight),(V||Ga)&&--wa.firstDiffRight);V=ka;wa=V.firstDiffLeft;ka=u.length-V.firstDiffRight;la=N.length-V.firstDiffRight;V=Qg.Update;ab=void 0;if(u.length!==N.length)ka===wa?(V=Qg.Add,ab=u[u.length-1]):la===
wa&&(V=Qg.Delete,ab=N[N.length-1]);else if(u===N)return;Ga=0;switch(V){case Qg.Update:Ga=ka-wa;var nb=N.substring(wa,la);break;case Qg.Add:nb=N.substring(wa,la);break;case Qg.Delete:Ga=ka-wa,nb=u.substring(wa,ka)}u=Cj(nb,ab);if(void 0!==u)return new Vf({content:V!==Qg.Delete?nb:void 0,deltaType:V,unit:u,position:wa,length:V!==Qg.Add?Ga:0})}function Ln(u,N,V){var ka,wa,Ga,la,ab,nb,sb;if((null===(ka=N.formattedRanges)||void 0===ka?void 0:ka.length)<=(null===(wa=u.formattedRanges)||void 0===wa?void 0:
wa.length))if(V){ka=u.formattedRanges?[].concat(D.Nh(u.formattedRanges)):[];wa=(u=vl(u.formattedRanges,V,V.position))?ka.indexOf(u):-1;-1!==wa&&(u.length=V.position+(V.length||0)>u.start+u.length?V.position+(null!==(Ga=V.content)&&void 0!==Ga?Ga:"").length-u.start:u.length+((null!==(la=V.content)&&void 0!==la?la:"").length-(V.length||0)),ka[wa]=u);if(0<ka.length){Ga=D.makeIterator(ka.slice(wa+1));for(la=Ga.next();!la.done;la=Ga.next())la=la.value,la.start<V.position||(V.position+(V.length||0)>la.start?
(la.length=la.start+la.length-(V.position+(V.length||0)),la.start=V.position+(null!==(ab=V.content)&&void 0!==ab?ab:"").length):la.start+=(null!==(nb=V.content)&&void 0!==nb?nb:"").length-(V.length||0));ka=ka.filter(function(Db){return 0<Db.length})}V=null!==(sb=null===N||void 0===N?void 0:N.formattedRanges)&&void 0!==sb?sb:[];if(bg()(ka,V)||0===ka.length&&0===V.length)return}else if(bg()(null===u||void 0===u?void 0:u.formattedRanges,null===N||void 0===N?void 0:N.formattedRanges))return;return new Vf({deltaType:Qg.FormattingUpdate,
formattedRanges:null===N||void 0===N?void 0:N.formattedRanges})}function vl(u,N,V){if(u){if(N.deltaType===Qg.Add){if(N=u.find(function(ka){return ka.start===V&&0===ka.length}))return N;V=Math.max(V-1,0)}return u.find(function(ka){return 0===ka.length?ka.start===V:ka.start<=V&&V<ka.start+ka.length})}}function Cj(u,N){var V=Array.from(u.matchAll(Yj));Yj.lastIndex=0;if(0===V.length)return rg.Chars;if(1===V.length){if(0===V[0].index)return N&&ok.test(N)?rg.Sentence:N&&!Yj.test(N)?rg.Word:rg.Chars;if(V[0].index+
1===u.length)return ok.test(u[V[0].index-1])?rg.Sentence:Yj.test(u[V[0].index-1])?rg.Chars:rg.Word;if(u[V[0].index-1]){u=u[V[0].index-1];if(ok.test(u))return rg.Sentence;if(Yj.test(u))return rg.Chars}return rg.Word}N=Array.from(u.matchAll(ok));ok.lastIndex=0;if(0===N.length)return rg.PartialSentence;if(1<N.length)return rg.Paragraph;if(N[0].index+1<=u.length)return Yj.test(u[N[0].index+1])?rg.Sentence:rg.Paragraph}function Sp(){return"xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(u){var N=
16*Math.random()|0;return("x"===u?N:N&3|8).toString(16)})}function Ol(u,N){var V=(new Pc({operationName:"ApplyTextTileDeltaForLocalWorkflows",dimension0:"0",success:!0})).start();try{if(N)if(Eb.getTypeNameFor(N)!==Jh.getTypeName())V.success=!1,V.resultDescription="Unable to apply text tile delta, parent tile is not proper type: expected "+Zh.getTypeName()+", received "+Eb.getTypeNameFor(N),wb.a.info(538798174,wb.b.CoreDefault,V.stop());else{var ka=N.content;N="";if(void 0===u.position||0>u.position)V.success=
!1,V.resultDescription="Unable to apply text tile delta, invalid text tile position",wb.a.info(538798175,wb.b.CoreDefault,V.stop());else{switch(u.deltaType){case Qg.Add:N=u.position<ka.length?""+ka.slice(0,u.position)+u.content+ka.slice(u.position,ka.length):ka+u.content;break;case Qg.Update:u.content||u.unit!==rg.Sentence||(V.dimension0="1");N=""+ka.slice(0,u.position)+u.content+ka.slice(u.position+(u.length||0),ka.length);break;case Qg.Delete:N=""+ka.slice(0,u.position)+ka.slice(u.position+(u.length||
0),ka.length)}wb.a.info(538837071,wb.b.CoreDefault,V.stop());return new Jh({content:N})}}else V.success=!1,V.resultDescription="Unable to apply text tile delta, parent tile is undefined",wb.a.info(538798173,wb.b.CoreDefault,V.stop())}catch(wa){V.success=!1,V.resultDescription="Error applying text tile delta: "+wa,wb.a.info(538798176,wb.b.CoreDefault,V.stop())}}function cl(u,N,V){var ka,wa,Ga,la,ab,nb,sb,Db=(new Pc({operationName:"ApplyFormattedTextTileDeltaForLocalWorkflows",dimension0:"0",success:!0})).start();
Db.clientFlights=V;try{if(N)if(Eb.getTypeNameFor(N)!==Ih.getTypeName())Db.success=!1,Db.resultDescription="Unable to apply formatted text tile delta, parent tile is not proper type: expected "+Ih.getTypeName()+", received "+Eb.getTypeNameFor(N),wb.a.info(538798178,wb.b.CoreDefault,Db.stop());else{var bc=N.content;V="";if((void 0===u.position||0>u.position)&&!Ok(u.deltaType))Db.success=!1,Db.resultDescription="Unable to apply formatted text tile delta, invalid text tile position",wb.a.info(538798179,
wb.b.CoreDefault,Db.stop());else if(void 0!==u.content||Ok(u.deltaType))if(u.deltaType===Qg.Add&&0!==u.length?wb.a.info(538798209,wb.b.CoreDefault,new Pc({operationName:"ApplyDeltaChecks",resultDescription:"Received formatted text tile delta add operation with delta length, expected length 0",success:!0})):Ok(u.deltaType)&&void 0!==u.content&&wb.a.info(538798210,wb.b.CoreDefault,new Pc({operationName:"ApplyDeltaChecks",resultDescription:"Received formatted text tile delta delete or non-content related operation with content defined, expected undefined",
success:!0})),-1!==ne.indexOf(u.deltaType)){if(u.deltaType===Qg.CursorUpdate)return new Ih(Object.assign(Object.assign({},N),{ipPosition:null===(nb=u.cursorData)||void 0===nb?void 0:nb.ipPosition,isColdIp:null===(sb=u.cursorData)||void 0===sb?void 0:sb.isColdIp}));if(u.deltaType===Qg.FormattingUpdate)return new Ih(Object.assign(Object.assign({},N),{formattedRanges:u.formattedRanges}));if(u.deltaType===Qg.OtherNonContentUpdate){var Xb;var Gc={};for(Xb in u.otherNonContentData)Gc[Xb]=u.otherNonContentData[Xb];
return new Ih(Object.assign(Object.assign({},N),Gc))}}else{var oe=Mn(N.formattedRanges,u.deltaType,u.position),pe=N.formattedRanges?[].concat(D.Nh(N.formattedRanges)):[],md=oe?pe.indexOf(oe):-1;-1!==md&&(oe.length=u.position+(u.length||0)>oe.start+oe.length?u.position+(null!==(Gc=u.content)&&void 0!==Gc?Gc:"").length-oe.start:oe.length+((null!==(ka=u.content)&&void 0!==ka?ka:"").length-(u.length||0)),pe[md]=oe);var yf=N.ipPosition;switch(u.deltaType){case Qg.Add:V=u.position<bc.length?""+bc.slice(0,
u.position)+u.content+bc.slice(u.position,bc.length):bc+u.content;yf=u.position+u.length;break;case Qg.Update:u.content||u.unit!==rg.Sentence||(Db.dimension0="1");V=""+bc.slice(0,u.position)+u.content+bc.slice(u.position+(null!==(wa=u.length)&&void 0!==wa?wa:0),bc.length);yf=u.position+u.content.length;break;case Qg.Delete:V=""+bc.slice(0,u.position)+bc.slice(u.position+(null!==(Ga=u.length)&&void 0!==Ga?Ga:0),bc.length),yf=u.position}for(var Zd=D.makeIterator(pe.slice(md+1)),rd=Zd.next();!rd.done;rd=
Zd.next()){var Ui=rd.value;Ui.start<u.position||(u.position+(u.length||0)>Ui.start?(Ui.length=Ui.start+Ui.length-(u.position+(u.length||0)),Ui.start=u.position+(null!==(la=u.content)&&void 0!==la?la:"").length):Ui.start+=(null!==(ab=u.content)&&void 0!==ab?ab:"").length-(u.length||0))}pe=pe.filter(function(Ld){return 0<Ld.length});var dh=new Ih(Object.assign(Object.assign({},N),{ipPosition:yf,content:V,formattedRanges:pe,queryRange:u.queryRange}));wb.a.info(538837073,wb.b.CoreDefault,Db.stop());return dh}else Db.success=
!1,Db.resultDescription="Unable to apply formatted text tile delta, non-delete, non-formatting, non-other-non-content-update and non-cursor-update operation without content defined",wb.a.info(538798208,wb.b.CoreDefault,Db.stop())}else Db.success=!1,Db.resultDescription="Unable to apply formatted text tile delta, parent tile is undefined",wb.a.info(538798177,wb.b.CoreDefault,Db.stop())}catch(Ld){Db.success=!1,Db.resultDescription="Error applying formatted text tile delta: "+Ld,wb.a.info(538798211,
wb.b.CoreDefault,Db.stop())}}function Mn(u,N,V){var ka=new Pc({operationName:"FindRangeForDelta",success:!0});ka.start();if(u){if(N===Qg.Add){if(N=u.find(function(wa){return wa.start===V&&0===wa.length}))return ka.resultDescription="Found a zero-length formatted range for add operation with start "+N.start+".",wb.a.info(538798213,wb.b.CoreDefault,ka.stop()),N;V=Math.max(V-1,0)}(u=u.find(function(wa){return 0===wa.length?wa.start===V:wa.start<=V&&V<wa.start+wa.length}))?(ka.resultDescription="Updating formatted range for operation with start: "+
u.start+" and length: "+u.length,wb.a.info(538798214,wb.b.CoreDefault,ka.stop())):(ka.resultDescription="Unable to find formatted range for operation at position "+V+", skipping.",wb.a.info(538798215,wb.b.CoreDefault,ka.stop()));return u}ka.resultDescription="No formatted ranges found within the tile, skipping.";wb.a.info(538798212,wb.b.CoreDefault,ka.stop())}function Ok(u){return-1!==ne.indexOf(u)||Qg.Delete===u}function Nm(u){if(!u)return new ib([],new Set,new Map,new Map);u=u.split(";");for(var N=
new Set,V=new Map,ka=new Map,wa=D.makeIterator(u),Ga=wa.next();!Ga.done;Ga=wa.next())if(Ga=Ga.value.trim(),""!==Ga){N.add(ib.normalizeName(Ga));var la=D.makeIterator(Ga.split(":"));Ga=la.next().value;la=la.next().value;if(Ga=ib.normalizeName(Ga))V.set(Ga,la),(la=ib.parseName(Ga))&&la!==Ga&&ka.set(la,Ga)}return new ib(u,N,V,ka)}function U(u){var N=new Promise(function(V,ka){function wa(){ka(u.error);la()}function Ga(){V(Ja(u.result));la()}function la(){u.removeEventListener("success",Ga);u.removeEventListener("error",
wa)}u.addEventListener("success",Ga);u.addEventListener("error",wa)});N.then(function(V){V instanceof IDBCursor&&ir.set(V,u)}).catch(function(){});$r.set(N,u);return N}function aa(u){if(!Vn.has(u)){var N=new Promise(function(V,ka){function wa(){ka(u.error||new DOMException("AbortError","AbortError"));la()}function Ga(){V();la()}function la(){u.removeEventListener("complete",Ga);u.removeEventListener("error",wa);u.removeEventListener("abort",wa)}u.addEventListener("complete",Ga);u.addEventListener("error",
wa);u.addEventListener("abort",wa)});Vn.set(u,N)}}function ta(u){return u!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Fj||(Fj=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(u)?function(N){for(var V=[],ka=0;ka<arguments.length;++ka)V[ka-0]=arguments[ka];u.apply($r.get(this),V);return Ja(ir.get(this))}:function(N){for(var V=[],ka=0;ka<arguments.length;++ka)V[ka-0]=arguments[ka];return Ja(u.apply($r.get(this),
V))}:function(N,V){for(var ka=[],wa=1;wa<arguments.length;++wa)ka[wa-1]=arguments[wa];ka=u.call.apply(u,[$r.get(this),N].concat(D.Nh(ka)));xl.set(ka,N.sort?N.sort():[N]);return Ja(ka)}}function Ja(u){if(u instanceof IDBRequest)return U(u);if(vt.has(u))return vt.get(u);if("function"===typeof u)var N=ta(u);else u instanceof IDBTransaction&&aa(u),N=za(u,hr||(hr=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(u,Ql):u;N!==u&&(vt.set(u,N),$r.set(N,u));return N}function Wa(u,N,
V){V=void 0===V?{}:V;var ka=V.blocked,wa=V.upgrade,Ga=V.Afg,la=V.aqg,ab=indexedDB.open(u,N);u=Ja(ab);wa&&ab.addEventListener("upgradeneeded",function(nb){wa(Ja(ab.result),nb.oldVersion,nb.newVersion,Ja(ab.transaction))});ka&&ab.addEventListener("blocked",function(){return ka()});u.then(function(nb){la&&nb.addEventListener("close",function(){return la()});Ga&&nb.addEventListener("versionchange",function(){return Ga()})}).catch(function(){});return u}function xb(u,N){if(u instanceof IDBDatabase&&!(N in
u)&&"string"===typeof N){if(un.get(N))return un.get(N);var V=N.replace(/FromIndex$/,""),ka=N!==V,wa=tn.includes(V);if(V in(ka?IDBIndex:IDBObjectStore).prototype&&(wa||Cs.includes(V)))return u=function(Ga,la){for(var ab=[],nb=1;nb<arguments.length;++nb)ab[nb-1]=arguments[nb];var sb=this,Db,bc;return D.Td(function(Xb){return 1==Xb.pc?(Db=sb.transaction(Ga,wa?"readwrite":"readonly"),bc=Db.store,ka&&(bc=bc.index(ab.shift())),Xb.Rb(Promise.all([bc[V].apply(bc,D.Nh(ab)),wa&&Db.done]),2)):Xb.return(Xb.Jc[0])})},
un.set(N,u),u}}function Tb(u){var N="";if("undefined"!=typeof navigator&&navigator.userAgent){var V=navigator.userAgent;!V.indexOf||0<V.indexOf("MSIE ")||0<V.indexOf("Trident/")?N="Error: IE lacks necessary support":"undefined"==typeof Promise?N="Error: Promise is not supported":"undefined"==typeof WebAssembly&&(N="Error: WASM is not supported")}else N="Error: No window userAgent";if(""==N)return!1;u.resultDescription=N;wb.a.info(540406806,wb.b.CoreDefault,u.stop());return!0}function nc(u,N,V){var ka=
new Pc({operationName:"CreateOnnxInferenceService",success:!0,resultDescription:""});ka.start();return Tb(ka)?(ka.success=!1,ka.resultDescription="Browser lacks necessary support for inference service",wb.a.info(540406803,wb.b.CoreDefault,ka.stop()),Promise.reject(Error("Browser lacks necessary support for inference service"))):(new Promise(function(wa,Ga){if("undefined"!==typeof document){var la=document.createElement("script");la.src=u;la.onload=function(){Ic(N)?(V&&(globalThis.top[N].env.xcg.ycg=
V),wa()):(la.remove(),Ga(Error("ort.Tensor and/or ort.InferenceSession are undefined")))};la.onerror=Ga;document.body.appendChild(la)}else globalThis.importScripts?(globalThis.importScripts(u),globalThis[N]=self[N],globalThis.top||(globalThis.top={}),Ic(N)?(V&&(globalThis.top[N].env.xcg.ycg=V),wa()):Ga(Error("ort.Tensor and/or ort.InferenceSession are undefined"))):Ga(Error("Unexpected lack of document and importScripts"))})).then(function(){wb.a.info(540406804,wb.b.CoreDefault,ka.stop())}).catch(function(wa){ka.success=
!1;ka.resultDescription=wa.message;wb.a.info(509871835,wb.b.CoreDefault,ka.stop());throw wa;})}function Ic(u){var N=globalThis[u];return N&&N.foc&&N.Tensor?((null===globalThis||void 0===globalThis?0:globalThis.top)&&!globalThis.top[u]&&(globalThis.top[u]=N),!0):!1}function uc(){if(!Rk&&(Rk="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Rk))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");
return Rk(xt)}function Nc(u){return new Promise(function(N){setTimeout(function(){N()},u)})}function ae(u,N,V){return Object(br.b)(this,void 0,void 0,function(){var ka,wa,Ga;return Object(br.c)(this,function(la){switch(la.label){case 0:wa=0,la.label=1;case 1:if(!(wa<N))return[3,8];la.label=2;case 2:return la.trys.push([2,6,,7]),0<wa?[4,Nc(V)]:[3,4];case 3:la.sent(),la.label=4;case 4:return[4,u(wa)];case 5:return[2,la.sent()];case 6:return ka=Ga=la.sent(),[3,7];case 7:return wa++,[3,1];case 8:throw ka;
}})})}function Jd(u,N){var V=de.getAugLoopRuntimeManager();V.setRequestAuthTokenCallback({requestAuthTokenCallback:function(){return Promise.resolve(u.authToken)}});0==wn&&(wn=!0);N={serviceUrl:u.serviceUrl,appName:u.appName.toUpperCase(),appVersion:u.appVersion,releaseAudienceGroup:u.releaseAudienceGroup,releaseChannel:u.releaseChannel,releaseFork:u.releaseFork,sessionId:N,initSession:!0,sessionCreationOptions:{docSessionId:Yk,onSessionConnect:function(ka,wa){Wm.emit(oj.woc);Zp=wa.substring(wa.lastIndexOf("/")+
1);r("In AL Session onSessionConnect, isSeedingRequired: ".concat(ka,", docSessionId: ").concat(Yk,", sessionKey: ").concat(null!==Zp&&void 0!==Zp?Zp:""));ka&&Ng(V)},onSessionDisconnect:function(){r("In AL Session onSessionDisconnect");Wm.emit(oj.xoc)},onSessionReconnect:function(){r("In AL Session onSessionReconnect");Wm.emit(oj.zoc)},onSessionClose:function(){r("In AL Session onSessionClose");Wm.emit(oj.voc);try{r("In AL Session onSessionClose: starting new session"),V.startNewSession()}catch(ka){throw r("In AL Session onSessionClose: error in starting new session"),
Wm.emit(oj.yoc),Error("Failure in starting new AL Session onSessionClose: ".concat(ka instanceof Error&&null!=ka.message?ka.message:"Unknown error"));}}}};r("docSessionId: ".concat(Yk));V.initialize(N)}function Cf(u){pk==cg.tca&&(pk=cg.Connecting,su=u,Wm.on(oj.woc,function(){Vm=0;pk=cg.oxb}),Wm.on(oj.xoc,function(){pk=cg.tca}),Wm.on(oj.voc,function(){pk=cg.tca}),Wm.on(oj.zoc,function(){Vm=0;pk=cg.oxb}),Wm.on(oj.yoc,function(){pk=cg.tca}),Jd(u,Yp,Vm++))}function xe(){return Object(br.b)(this,void 0,
void 0,function(){var u;return Object(br.c)(this,function(N){switch(N.label){case 0:return[4,de.getAugLoopRuntimeManager().getSession()];case 1:return u=N.sent(),r("Augloop session: isClosed: ".concat(u.isClosed,", hasConnected: ").concat(u.hasConnected,", isConnected: ").concat(u.isConnected," ")),u.hasConnected&&!u.isConnected&&(u.isClosed?r("Augloop connection is closed"):(r("Sending KeepAlive..."),u.submitCustomMessage(new lk).then(function(){for(var V=0;V<arguments.length;V++);r("KeepAlive succeeded")}).catch(function(V){V=
V instanceof Error&&null!=V.message?V.message:"Unknown error";r("KeepAlive failed: ".concat(V));throw Error("Failure in KeepAlive: ".concat(V));}))),[2,ae(function(){return pk==cg.oxb?Promise.resolve():Promise.reject("Augloop connection not established. hasConnected: ".concat(u.hasConnected,", isConnected: ").concat(u.isConnected,", isClosed: ").concat(u.isClosed))},10,3E3).catch(function(V){pk=cg.tca;throw V;})]}})})}function Zg(){return Object(br.b)(this,void 0,void 0,function(){var u,N,V;return Object(br.c)(this,
function(ka){switch(ka.label){case 0:if(pk!=cg.tca||null==su.serviceUrl)return[3,4];pk=cg.Connecting;Jd(su,Yp,Vm++);ka.label=1;case 1:return ka.trys.push([1,3,,4]),[4,xe()];case 2:return ka.sent(),[3,4];case 3:throw u=ka.sent(),N=u instanceof Error&&null!=u.message?u.message:"Unknown error",r("".concat(N)),u;case 4:V=de.getAugLoopRuntimeManager();if(null==V)throw Error("Augloop runtime manager is not initialized");return[2,V]}})})}function Ng(u){return Object(br.b)(this,void 0,void 0,function(){var N,
V;return Object(br.c)(this,function(ka){switch(ka.label){case 0:return[4,u.getSession()];case 1:return N=ka.sent(),V=new Mh({parentPath:["session"],items:[{id:"doc",body:new Vb({isReadonly:!1})}]}),N.submitSeedOperations([V]),[2]}})})}e.r(H);e.d(H,"Application",function(){return b});var Yd=e(0),qh=e(190),fj=e(31),Nn=e(542),qf=e(1),sp=e(25),Md=e(168),ch=e(2),dl=e(58),on=e(1115),gm=e(1093),qt=e(1133),Mw=e(1091),vq=e(1085),zc=e(328),Dj=e(158),Ag=e(73),Om=e(6),Pm=e(10),On=e(108),We=e(645),tp=e(849),jv=
e(848),Pn=e(393);Object(Yd.a)(ul,"BulkMoveShapeCommandData",null,[]);Object(Yd.a)(dj,"ChangePictureCommandData",null,[]);var Sr=e(847);Object(Yd.a)(Rr,"ClientLayoutCommandData",null,[]);var rt=e(850),$f=e(851),Zk=e(644),je=e(642),ou=e(418),Qn=e(128),kv=e(647),Qm=e(174),So=e(117),Rm=e(646),Dh=e(649),el=e(298),nk=e(844),zs=e(859);Object(Yd.a)(Rp,"SetPageUserCellCommandData",null,[]);var pu=e(861),wq=e(399);Object(Yd.a)(Hi,"SetUserCellCommandData",null,[]);var Ej=e(364),Tp=e(784),Pl=e(417);Object(Yd.a)(Dd,
"GetQuickShapePositionActionData",null,[]);var Ge=e(391),pn=e(1089);ie.prototype.getTypeName=function(){return"Microsoft.Visio.CustomSolutionDialogArgs"};ie.prototype.invokePropertyGet=function(u){switch(u){case 3:return this.controlValues;case 2:return this.handler;case 1:return this.title}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};ie.prototype.invokePropertyGetAsync=function(u){u=this.invokePropertyGet(u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)};
ie.prototype.invokePropertySet=function(u,N){switch(u){case 3:this.controlValues=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"any");return;case 2:this.handler=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"any");return;case 1:this.title=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};ie.prototype.invokePropertySetAsync=function(u,N){this.invokePropertySet(u,N);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};ie.prototype.invokeMethod=function(u){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};ie.prototype.invokeMethodAsync=function(u,N){u=this.invokeMethod(u,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)};D.global.Object.defineProperties(ie.prototype,{controlValues:{configurable:!0,enumerable:!0,get:function(){return this._controlValues},set:function(u){this._controlValues=u}},handler:{configurable:!0,
enumerable:!0,get:function(){return this._handler},set:function(u){this._handler=u}},title:{configurable:!0,enumerable:!0,get:function(){return this._title},set:function(u){this._title=u}}});Object(Yd.a)(ie,"CustomSolutionDialogArgs",null,[]);Mm.prototype.get_text=function(){return this._text};Mm.prototype.gZa=function(u){this._text=u};Mm.prototype.get_type=function(){return 0};Object(Yd.a)(Mm,"PlainTextToken",null,[280,279]);Xd.prototype.getTypeName=function(){return"Microsoft.Visio.SolutionDialogArgs"};
Xd.prototype.invokePropertyGet=function(u){switch(u){case 1:return this.errorCode;case 3:return this.message;case 2:return this.title;case 4:return this.type}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};Xd.prototype.invokePropertyGetAsync=function(u){u=this.invokePropertyGet(u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)};Xd.prototype.invokePropertySet=function(u,N){switch(u){case 1:this.errorCode=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,
0,"int");return;case 3:this.message=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"string");return;case 2:this.title=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"string");return;case 4:this.type=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};Xd.prototype.invokePropertySetAsync=function(u,N){this.invokePropertySet(u,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
Xd.prototype.invokeMethod=function(u){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};Xd.prototype.invokeMethodAsync=function(u,N){u=this.invokeMethod(u,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)};D.global.Object.defineProperties(Xd.prototype,{errorCode:{configurable:!0,enumerable:!0,get:function(){return this._errorCode},set:function(u){this._errorCode=u}},message:{configurable:!0,enumerable:!0,get:function(){return this._message},set:function(u){this._message=
u}},title:{configurable:!0,enumerable:!0,get:function(){return this._title},set:function(u){this._title=u}},type:{configurable:!0,enumerable:!0,get:function(){return this._type},set:function(u){this._type=u}}});Object(Yd.a)(Xd,"SolutionDialogArgs",null,[]);Object(Yd.a)(po,"UploadMultiplePictureActionData",null,[]);D.global.Object.defineProperties(uq.prototype,{whatIfBeginEventArgs:{configurable:!0,enumerable:!0,set:function(u){this.A0=u}},isCommandHandledBySolution:{configurable:!0,enumerable:!0,
get:function(){return this.A0.isCommandHandledBySolution},set:function(u){this.A0.isCommandHandledBySolution=u}}});Object(Yd.a)(uq,"BeginEventOutputBuilder",null,[]);var nf=e(150);Oi.prototype.appendMoveCommand=function(u,N,V,ka,wa,Ga){u=u.createMoveObjectCommandData(N,V,ka,wa,Ga);this.A0.addCommand(u,ch.a.moveShape)};D.global.Object.defineProperties(Oi.prototype,{whatIfBeginEventAttr:{configurable:!0,enumerable:!0,get:function(){return this.A0},set:function(u){this.A0=u}},isCommandHandledBySolution:{configurable:!0,
enumerable:!0,get:function(){return this.A0.isCommandHandledBySolution},set:function(u){this.A0.isCommandHandledBySolution=u}}});Object(Yd.a)(Oi,"WhatIfEventOutputBuilder",null,[]);var Rn=e(1128);Object(Yd.a)(Nh,"VACommand",null,[]);Ni.prototype.routeDrawConnectorActionDataHelper=function(u,N,V,ka,wa){V=void 0===V?!0:V;ka=void 0===ka?null:ka;wa=void 0===wa?null:wa;var Ga=new So.a;var la=new So.a;var ab=new Ge.a;ab.page=u.ta;Ga.shape=ab.fromShape=u;la.shape=ab.toShape=N;ka?(Ga.gluePoint=new Qm.a(ka),
Ga.glueType=8,ab.fromCP=ka):Ga.glueType=64;wa?(la.gluePoint=new Qm.a(wa),la.glueType=8,ab.toCP=wa):la.glueType=64;ab.isLiveAngularConnectorEnabled=V;qf.AFrameworkApplication.ea.na(ch.a.qX,2,ab);void 0===ab.connectorPointList||null===ab.connectorPointList||2>=ab.connectorPointList.length||!ab.isLiveAngularConnectorEnabled?(u=this.ff(ka.x,ka.y,u),Ga.xPosition=u.rc,Ga.yPosition=u.sc,N=this.ff(wa.x,wa.y,N),la.xPosition=N.rc,la.yPosition=N.sc,ab.connectorPointList=new On.a,ab.connectorPointList.lc(new Pm.a(Ga.xPosition,
Ga.yPosition)),ab.connectorPointList.lc(new Pm.a(la.xPosition,la.yPosition))):(Ga.xPosition=ab.connectorPointList.Bb(0).x,Ga.yPosition=ab.connectorPointList.Bb(0).y,la.xPosition=ab.connectorPointList.Bb(ab.connectorPointList.length-1).x,la.yPosition=ab.connectorPointList.Bb(ab.connectorPointList.length-1).y);return{begin:Ga,end:la,ewa:ab.connectorPointList}};Ni.prototype.fetchPageConnectorTypeActionDataHelper=function(){var u=new Pl.a;qf.AFrameworkApplication.ea.na(ch.a.D1,2,u);return u.pageConnectorType};
Ni.prototype.dispose=function(){};Ni.prototype.ff=function(u,N,V){for(;void 0!==V&&null!==V;)N=this.tK(u,N,V),u=N.rc,N=N.sc,V=V.$a;return{rc:u,sc:N}};Ni.prototype.tK=function(u,N,V){if(void 0===V||null===V)return{rc:u,sc:N};V=V.xForm;var ka=V.angle,wa=0,Ga=1;ka&&(wa=Math.sin(ka),Ga=Math.cos(ka));ka=u-V.Qh;N-=V.Zi;V.flipX&&(ka=-ka);V.flipY&&(N=-N);u=ka*Ga-N*wa+V.pinX;N=N*Ga+ka*wa+V.pinY;return{rc:u,sc:N}};D.global.Object.defineProperties(Ni,{instance:{configurable:!0,enumerable:!0,get:function(){Ni._instance||
(Ni._instance=new Ni);return Ni._instance}}});Ni._instance=null;Object(Yd.a)(Ni,"VisioActionDataManager",null,[427,8]);var fl=e(7),ag=e(858),lv=e(857),up=e(845),Qi=e(846),Tr=e(87),Ow=e(643);Object(Yd.a)(Nl,"ConvertToStaticConnectorsCommandData",null,[]);var qu=e(1082),Pw=e(648);bl.prototype.createResolverObjectForShape=function(u,N){return Md.a.Vd.GGd.createShape(3,zc.a.create().toString(),u,N,null)};D.global.Object.defineProperties(bl,{instance:{configurable:!0,enumerable:!0,get:function(){bl._instance||
(bl._instance=new bl);return bl._instance}}});bl._instance=null;Object(Yd.a)(bl,"ResolverObjectFactory",null,[]);var xq=e(787),Gf=e(862);pd.prototype.registerSolutionBeginEvent=function(u){function N(V,ka){var wa=new (e(1137).BeginEventBuilder);wa.initBeginEvent(V);V=new uq;V.whatIfBeginEventArgs=ka;u(wa,V)}e(1078).Application.Uw().Zde(N);return N};pd.prototype.registerSolutionWhatIfEvent=function(u){function N(V,ka){var wa=new (e(1137).BeginEventBuilder);wa.initBeginEvent(V);V=new Oi;V.whatIfBeginEventAttr=
ka;u(wa,V)}e(1078).Application.Uw().$de(N);return N};pd.prototype.unregisterSolutionWhatIfEvent=function(u){e(1078).Application.Uw().LKf(u)};pd.prototype.unregisterSolutionBeginEvent=function(u){e(1078).Application.Uw().KKf(u)};pd.prototype.createVirtualShape=function(u){var N=e(1083).Shape,V=u.oe;u=u.ParentPage.P2;V=Md.a.Vd.GGd.createShape(3,zc.a.create().toString(),u,V,null);return new N(V)};pd.prototype.createResolverObjectForShape=function(u){var N=e(1083).Shape;u=bl.instance.createResolverObjectForShape(u.ParentPage.P2,
u.oe);return new N(u)};pd.prototype.createAddShapeHavingMasterCommand=function(u,N,V){var ka=Md.a.Vd.Cb;u=this.nXc(u,N,V);ka=ka.createAddShapeHavingMasterCommand(u,Md.a.Vd.kf);return new Nh(ka)};pd.prototype.createAddConnectorCommand=function(u,N,V,ka){var wa=N.oe;V=V.oe;var Ga=wa.connectionPoints.items[u?1:0],la=V.connectionPoints.items[u?0:1];var ab=this.xRa(wa,V,!0,Ga,la,ka.master);u=ab.begin;var nb=ab.end;ab=ab.ewa;var sb=new Tp.a;sb.sourceShape=wa;sb.sourceShapeConnectionPoint=Ga;sb.destinationShape=
V;sb.destinationShapeConnectionPoint=la;sb.begin=u;sb.end=nb;N=this.nXc(N.ParentPage,ka,null,sb,ab);N=Md.a.Vd.Cb.createAddShapeHavingMasterCommand(N,Md.a.Vd.kf);return new Nh(N)};pd.prototype.createAddLineConnectorCommand=function(u,N,V,ka,wa,Ga,la,ab){var nb,sb,Db=Md.a.Vd.Cb;var bc=null===(nb=V.oe.connectionPoints)||void 0===nb?void 0:nb.items[u];u=null===(sb=ka.oe.connectionPoints)||void 0===sb?void 0:sb.items[N];N=this.Ise(V,ka,bc,u,void 0===wa?null:wa,void 0===Ga?!0:Ga,void 0===la?-1:la,void 0===
ab?null:ab);Db=Db.createAddLineConnectorCommand(N,Md.a.Vd.kf);return new Nh(Db)};pd.prototype.createAddHyperlinkCommand=function(u,N,V,ka,wa,Ga,la){var ab=Md.a.Vd.Cb;u=this.awe(u,N,V,ka,wa,void 0===Ga?"":Ga,void 0===la?0:la);if(null==u)return null;ab=ab.sYc(u);return new Nh(ab)};pd.prototype.createChangeConnectorTypeOnPageCommand=function(u,N,V){var ka=Md.a.Vd.Cb;u=this.Ete(u,N,void 0===V?null:V);ka=ka.wXc(u);return new Nh(ka)};pd.prototype.createAddQuickShapeCommand=function(u,N,V,ka,wa,Ga,la,ab,
nb,sb,Db,bc,Xb,Gc){Ga=void 0===Ga?-1:Ga;la=void 0===la?null:la;ab=void 0===ab?!0:ab;sb=void 0===sb?1:sb;Db=void 0===Db?0:Db;bc=void 0===bc?!0:bc;Xb=void 0===Xb?null:Xb;Gc=void 0===Gc?!1:Gc;var oe=Md.a.Vd.Cb;if(void 0===nb||nb)wa=this.RYe(N,V,sb),ka=wa.x,wa=wa.y;bc&&(Ga=new Pl.a,qf.AFrameworkApplication.ea.na(ch.a.D1,2,Ga),Ga=Ga.pageConnectorType);u=qf.AFrameworkApplication.H.J("VisioWebUniversalCommandDataEnabled")?this.Nse(u,N,V,ka,wa,Ga,la,ab,sb,Db,Xb,Gc):this.Pse(u,N,V,ka,wa,Ga,la,ab,sb,Db,Xb,
Gc);oe=oe.createAddQuickShapeCommand(u,Md.a.Vd.kf);return new Nh(oe)};pd.prototype.createResize1DShapeCommandData=function(u,N,V,ka){var wa=N.GetBeginEndShapeId();var Ga=wa.BeginShapeId;wa=wa.EndShapeId;if(!Ga||!wa)return null;Ga=u.getActivePage().shapes.getItem(Ga);u=u.getActivePage().shapes.getItem(wa);V=this.xRa(Ga.oe,u.oe,!0,Ga.oe.connectionPoints.getItemAt(V),u.oe.connectionPoints.getItemAt(ka));return new wq.a(V.begin,V.end,N.oe,null,0)};pd.prototype.createGrowAndShrinkFontSizeCommand=function(u,
N,V,ka){ka=void 0===ka?!1:ka;var wa=new xq.a;wa.guid=zc.a.create();wa.pageID=u;wa.shapeIDs=N;wa.growStepCount=V;wa.isSyncCommand=ka;u=Md.a.Vd.Cb.createGrowAndShrinkFontSizeCommand(wa,Md.a.Vd.kf);return new Nh(u)};pd.prototype.createSetTextFontSizeCommand=function(u,N,V,ka){var wa=new Gf.a;wa.guid=zc.a.create();wa.fontSize=V;wa.isSyncCommand=ka;V=[];N=D.makeIterator(N);for(ka=N.next();!ka.done;ka=N.next())ka=ka.value,ka=u.getActivePage().shapes.getItem(ka),isNullOrUndefined(ka)||V.push(ka.oe);wa.shapes=
V;u=Md.a.Vd.Cb.createSetTextFontSizeCommand(wa);return new Nh(u)};pd.prototype.createAddQuickShapeCommandWithBetterLocalLie=function(u,N,V,ka,wa,Ga,la,ab,nb,sb,Db,bc,Xb){Xb=void 0===Xb?null:Xb;var Gc=Md.a.Vd.Cb;u=qf.AFrameworkApplication.H.J("VisioWebUniversalCommandDataEnabled")?this.Ose(u,N,V,ka,wa,Ga,la,ab,nb,sb,Db,bc,Xb):this.Qse(u,N,V,wa,Ga,la,ab,nb,sb,Db,bc,Xb);Gc=Gc.createAddQuickShapeCommand(u,Md.a.Vd.kf);return new Nh(Gc)};pd.prototype.createMoveShapesCommand=function(u,N,V,ka,wa){var Ga=
Md.a.Vd.Cb;u=this.createMoveObjectCommandData(u,N,V,ka,wa);Ga=Ga.BYc(u,Md.a.Vd.NDa.pK);return new Nh(Ga)};pd.prototype.createBulkMoveShapeCommand=function(u,N,V){var ka=Md.a.Vd.Cb;u=this.Bte(u,N,V);ka=ka.createBulkMoveShapeCommand(u);return new Nh(ka)};pd.prototype.createSetShapeFillFormatCommand=function(u,N,V,ka){var wa=Md.a.Vd.Cb;u=qf.AFrameworkApplication.H.J("VisioWebUniversalCommandDataEnabled")?this.createSetShapeFillFormatCommandData(u,N,V,ka):this.createSetShapeFillFormatCommandData_Deprecated(u,
N,V,ka);wa=wa.YYc(u,Md.a.Vd.kf);return new Nh(wa)};pd.prototype.createSetUserCellCommand=function(u,N,V){var ka=Md.a.Vd.Cb;u=this.dze(u,N,V);ka=ka.createSetUserCellCommand(u);return new Nh(ka)};pd.prototype.createSetPageUserCellCommand=function(u,N,V,ka){var wa=Md.a.Vd.Cb;u=this.aze(u,N,V,void 0===ka?!0:ka);wa=wa.createSetPageUserCellCommand(u);return new Nh(wa)};pd.prototype.createSetTextCommand=function(u,N,V){var ka=Md.a.Vd.Cb;u=this.createSetTextCommandData_Deprecated(N,u,void 0===V?!1:V);ka=
ka.createSetTextCommand(u,Md.a.Vd.kf);return new Nh(ka)};pd.prototype.createSetTextCommandDetailed=function(u,N,V,ka,wa,Ga,la,ab,nb){nb=void 0===nb?!1:nb;var sb=Md.a.Vd.Cb;u=qf.AFrameworkApplication.H.J("VisioWebSerializableTextCommandDataEnabled")?this.createSetTextCommandDataDetailed(u,N,Ga,la,ab,V,wa,nb):this.createSetTextCommandDataDetailed_Deprecated(u,ka,wa,V,nb);sb=sb.createSetTextCommand(u,Md.a.Vd.kf);return new Nh(sb)};pd.prototype.createSetTextCommandDataDetailed=function(u,N,V,ka,wa,Ga,
la,ab){ab=void 0===ab?!1:ab;var nb=new Pw.a;nb.guid=zc.a.create();nb.pageID=N;nb.shapeID=u.id.toString();nb.textStream=V;nb.charFormats=ka;nb.paraFormats=wa;nb.textFieldIndexes=la;nb.textVerticalAlign=Ga;nb.isSyncCommand=ab;return nb};pd.prototype.createSetTextCommandDataDetailed_Deprecated=function(u,N,V,ka,wa){wa=void 0===wa?!1:wa;var Ga=new pu.a;Ga.shape=u.oe;Ga.textFieldIndexes=V;Ga.textTokens=N;Ga.textVerticalAlign=ka;Ga.isSyncCommand=wa;return Ga};pd.prototype.updateShapeDataCommand=function(u,
N,V,ka){var wa=Md.a.Vd.Cb;u=this.mAe(u,N,V,ka);wa=wa.tZc(u,Md.a.Vd.kf);return new Nh(wa)};pd.prototype.createChangePictureCommand=function(u,N,V,ka,wa){var Ga=Md.a.Vd.Cb;u=this.Hte(u,N,V,ka,wa);Ga=Ga.createChangePictureCommand(u);return new Nh(Ga)};pd.prototype.createPasteShapeCommand=function(u,N,V,ka,wa,Ga,la){var ab=Md.a.Vd.Cb,nb=new zs.a;nb.guid=zc.a.create();nb.parentPage=u.P2;nb.xPosition=N;nb.yPosition=V;nb.isCrossSessionPaste=ka;nb.CCPID=wa;nb.wacDatacenter=Ga;nb.ccpLogID=la;u=ab.createPasteShapeCommand(nb,
Md.a.Vd.NDa.clipboard);return new Nh(u)};pd.prototype.showLocalPictureInputDialog=function(u){qf.AFrameworkApplication.ea.na(ch.a.zJd,2,u)};pd.prototype.showDialog=function(u,N,V,ka){ka=void 0===ka?0:ka;var wa=new Xd;wa.message=V;wa.title=N;wa.errorCode=ka;wa.type=u;qf.AFrameworkApplication.ea.na(ch.a.BJd,2,wa)};pd.prototype.hideDialog=function(u,N){N=void 0===N?0:N;var V=new Xd;V.errorCode=N;V.type=u;qf.AFrameworkApplication.ea.na(ch.a.yJd,2,V)};pd.prototype.showCustomDialog=function(u,N,V){var ka=
new ie;ka.handler=V;ka.title=u;ka.controlValues=N;qf.AFrameworkApplication.ea.na(ch.a.AJd,2,ka)};pd.prototype.uploadMultiplePictures=function(u,N){var V=new po;V.Blobs=u;V.PostUploadCallback=N;qf.AFrameworkApplication.ea.na(ch.a.CJd,2,V)};pd.prototype.createDeleteShapesCommand=function(u,N){N=void 0===N?!0:N;if(Dj.a.ka(u))throw Error.argumentNull("shapes");var V=Md.a.Vd.Cb;if(qf.AFrameworkApplication.H.J("VisioWebUniversalCommandDataEnabled")){var ka=new je.a;ka.shapesID=[];u.forEach(function(Ga){Array.add(ka.shapesID,
Ga.oe.id)});ka.parentPageID=u[0].oe.ta.id;ka.originalSelectionCount=ka.shapesID.length;ka.shouldPerformLocalLie=N;u=ka}else{var wa=new ou.a;wa.shapes=[];u.forEach(function(Ga){Array.add(wa.shapes,Ga.oe)});wa.originalSelectionCount=wa.shapes.length;wa.shouldPerformLocalLie=N;u=wa}V=V.cVb(u,Md.a.Vd.kf);return new Nh(V)};pd.prototype.createChangeShapeCommand=function(u,N,V){var ka=Md.a.Vd.Cb;u=this.createChangeShapeCommandData(u,N,V);ka=ka.createChangeShapeCommand(u,Md.a.Vd.kf);return new Nh(ka)};pd.prototype.createResize1DShapeCommand=
function(u,N,V,ka){var wa=Md.a.Vd.Cb;u=this.createResize1DShapeCommandData(u,N,V,ka);wa=wa.createResize1DShapeCommand(u,Md.a.Vd.kf,Md.a.Vd.NDa.pK);return new Nh(wa)};pd.prototype.createCutCopyShapesCommand=function(u,N,V){var ka=Md.a.Vd.Cb,wa=new Zk.a;wa.guid=zc.a.create();wa.shapes=[];u.forEach(function(Ga){Array.add(wa.shapes,Ga.oe)});wa.isCut=N;wa.isKeyboardEvent=V;u=ka.KXc(wa,Md.a.Vd.NDa.clipboard);return new Nh(u)};pd.prototype.createDuplicateShapesCommand=function(u,N,V,ka,wa){var Ga=Md.a.Vd.Cb;
u=this.Tue(u,N,V,ka,wa);Ga=Ga.PXc(u);return new Nh(Ga)};pd.prototype.executeAddShapeCommands=function(u){var N=e(1083).Shape;if(Dj.a.ka(u))throw Error.argumentNull("commands");var V=Md.a.Vd,ka=[];u=D.makeIterator(u);for(var wa=u.next();!wa.done;wa=u.next())Array.add(ka,wa.value.IV);u=zc.a.create();ka=V.bba.Sia(u,ka,V.kf);V=V.Ydb.zPa(ka).execute();return new N(V.addedShapes[0][0])};pd.prototype.createAddPersistentEventCommand=function(u){if(void 0===u||null===u)throw Error.argumentNull("addonInfo");
u=Md.a.Vd.Cb.createAddPersistentEventCommand(u.id);return new Nh(u)};pd.prototype.createVirtualNode=function(u,N,V,ka,wa,Ga,la){ka=void 0===ka?!1:ka;wa=void 0===wa?"":wa;Ga=void 0===Ga?"":Ga;la=void 0===la?"":la;var ab=null;switch(u){case pn.a.mindmapAddonCategory:ab=Rn.a.instance.createMindmapVirtualNodeDetails(ka,wa,N,V,Ga,la);break;case pn.a.orgChartAddonCategory:ab=Rn.a.instance.createOrgChartVirtualNodeDetails(N,V,wa,Ga,la)}return ab};pd.prototype.createClientLayoutCommand=function(u,N,V,ka,
wa,Ga){ka=void 0===ka?1:ka;wa=void 0===wa?0:wa;Ga=void 0===Ga?!1:Ga;var la=Md.a.Vd.Cb,ab=u.getActivePage();u=Md.a.Vd.NDa;N=this.xXc(N,V,ab.P2,ka,wa,Ga);la=la.createClientLayoutCommand(N,u.pK);return new Nh(la)};pd.prototype.createClientLayoutCommandWithVirtualNode=function(u,N,V,ka,wa,Ga,la,ab){wa=void 0===wa?1:wa;Ga=void 0===Ga?0:Ga;la=void 0===la?null:la;ab=void 0===ab?!1:ab;var nb=Md.a.Vd.Cb,sb=u.getActivePage();u=Md.a.Vd.NDa;N=this.xXc(N,V,sb.P2,wa,Ga,ab,ka,la);nb=nb.createClientLayoutCommand(N,
u.pK);if(!Dj.a.ka(ka))for(V=0;V<ka.length;V++)ka[V].pinX=N.virtualNodeDetails[V].pinX,ka[V].pinY=N.virtualNodeDetails[V].pinY;return new Nh(nb)};pd.prototype.executeQuickShapeCommand=function(u,N){var V=this;N=void 0===N?null:N;if(Dj.a.ka(u))throw Error.argumentNull("commands");var ka=Md.a.Vd,wa=[],Ga=!1,la=!1;u=D.makeIterator(u);for(var ab=u.next();!ab.done;ab=u.next())ab=ab.value,Ga||(Ga=ab.IV.isSyncCommand),la||(la=ab.IV.qc),ab.IV.qc&&Array.add(wa,ab.IV);u=zc.a.create();la&&(wa=Ga?ka.bba.Sia(u,
wa,ka.kf,Object(Ag.a)(this,this.vd,"serverSyncBeginCallback"),function(nb,sb){nb===Om.a.noError&&void 0!==N&&null!==N&&N(qu.a.noError,sb);V.jd(nb,sb)}):ka.bba.Sia(u,wa,ka.kf),ka=ka.Ydb.zPa(wa).execute(),qf.AFrameworkApplication.H.J("VisioWebOrgChartContainerDualAdditionFixEnabled")?null!=ka.addedShapes&&0<ka.addedShapes.length&&null!=ka.addedShapes[0]&&qf.AFrameworkApplication.ea.na(ch.a.hy,2,ka.addedShapes[0][0]):null!=ka.addedShapes&&0<ka.addedShapes.length&&qf.AFrameworkApplication.ea.na(ch.a.hy,
2,ka.addedShapes[0][0]));return u.toString()};pd.prototype.setFocus=function(u){var N=e(1078).Application.cR().activePage;qf.AFrameworkApplication.ea.na(ch.a.hy,2,N.Ec(u))};pd.prototype.setSelection=function(u){var N=[],V=e(1078).Application,ka=V.cR().activePage;u=D.makeIterator(u);for(var wa=u.next();!wa.done;wa=u.next())(wa=ka.Ec(wa.value))&&Array.add(N,wa);V.bW().mx(N)};pd.prototype.executeCommands=function(u,N){var V=this;N=void 0===N?null:N;if(Dj.a.ka(u))throw Error.argumentNull("commands");
var ka=Md.a.Vd,wa=[],Ga=!1,la=!1;u=D.makeIterator(u);for(var ab=u.next();!ab.done;ab=u.next())ab=ab.value,ab.IV.isSyncCommand&&(Ga=!0),la=ab.IV.qc||la,ab.IV.qc&&Array.add(wa,ab.IV);u=zc.a.create();la&&(wa=Ga?ka.bba.Sia(u,wa,ka.kf,Object(Ag.a)(this,this.vd,"serverSyncBeginCallback"),function(nb,sb){nb===Om.a.noError&&void 0!==N&&null!==N&&N(qu.a.noError,sb);V.jd(nb,sb)}):ka.bba.Sia(u,wa,ka.kf),ka.Ydb.zPa(wa).execute());return u.toString()};pd.prototype.vd=function(u){var N=null;void 0!==u&&null!==
u&&(N=new Qn.a,N.clientRevisionId=u);qf.AFrameworkApplication.ea.na(ch.a.Ij,2,N)};pd.prototype.jd=function(u){qf.AFrameworkApplication.ea.na(ch.a.Ch,2,u===Om.a.noError)};pd.prototype.fitToPage=function(){qf.AFrameworkApplication.ea.na(ch.a.fitToPage,2,!0)};pd.prototype.createConvertToStaticConnectorsCommand=function(u,N){var V=new Nl;V.guid=zc.a.create();var ka=[];u.forEach(function(wa){ka.push(wa.oe)});V.shapes=ka;V.page=N.P2;u=Md.a.Vd.Cb.createConvertToStaticConnectorsCommand(V);return new Nh(u)};
pd.prototype.executeDisableDynamicGridCommand=function(){qf.AFrameworkApplication.ea.na(ch.a.vfb,2,null)};pd.prototype.executeChangeShapeCommands=function(u,N){var V=this;N=void 0===N?null:N;if(Dj.a.ka(u))throw Error.argumentNull("commands");var ka=Md.a.Vd,wa=[];u=D.makeIterator(u);for(var Ga=u.next();!Ga.done;Ga=u.next())Array.add(wa,Ga.value.IV);u=zc.a.create();wa=ka.bba.Sia(u,wa,ka.kf,Object(Ag.a)(this,this.vd,"serverSyncBeginCallback"),function(la,ab){la===Om.a.noError&&void 0!==N&&null!==N&&
N(qu.a.noError,ab);V.NQf(la,ab)});ka.Ydb.zPa(wa).execute();return u.toString()};pd.prototype.NQf=function(u,N){var V=e(1078).Application;(u=u===Om.a.noError)&&V.bW().mx(this.Y_e(N));qf.AFrameworkApplication.ea.na(ch.a.Ch,2,u)};pd.prototype.Y_e=function(u){var N=[],V=e(1078).Application.cR().activePage,ka=V.id;if(void 0!==u&&null!==u&&void 0!==ka&&null!==ka){var wa=[];ka in u&&(wa=u[ka]);u=D.makeIterator(wa);for(ka=u.next();!ka.done;ka=u.next())(ka=V.Ec(ka.value))&&Array.add(N,ka)}return N};pd.prototype.Bte=
function(u,N,V){var ka=new ul;ka.extendedGuidId=zc.a.create();if(Dj.a.ka(u)||Dj.a.ka(N)||Dj.a.ka(V))throw Error.argumentNull("CreateBulkMoveShapeCommandData - Input passed is not valid");if(u.length!==N.length||u.length!==V.length)throw Error.argument("CreateBulkMoveShapeCommandData - Shapes Length and Points Length doesn't match");ka.parentPage=u[0].oe.ta;ka.shapes=Array(u.length);ka.newPinPoints=new On.a;for(var wa=0;wa<u.length;wa++)ka.shapes[wa]=u[wa].oe,ka.newPinPoints.lc(new Pm.a(N[wa],V[wa]));
return ka};pd.prototype.createMoveObjectCommandData=function(u,N,V,ka,wa){var Ga=new el.a;Ga.guid=zc.a.create();Ga.translateX=N;Ga.translateY=V;Ga.isSolidConnectorLocalLie=wa;for(N=0;N<ka.length;N++)V=ka[N],Array.contains(u,V)&&(Array.remove(ka,V),N--);Ga.shapesData=[];for(N=0;N<u.length;N++)V=new Ej.a,V.shape=u[N].oe,Array.add(Ga.shapesData,V);Ga.shapesToRoute=[];u=D.makeIterator(ka);for(ka=u.next();!ka.done;ka=u.next())Array.add(Ga.shapesToRoute,ka.value.oe);return Ga};pd.prototype.Hte=function(u,
N,V,ka,wa){var Ga=new dj;Ga.guid=zc.a.create();Ga.parentPage=u.oe.ta;Ga.imageId=N;Ga.imageUrl=V;Ga.imageBits=ka;Ga.localRenderingEnabled=wa;Ga.shape=u.oe;return Ga};pd.prototype.xXc=function(u,N,V,ka,wa,Ga,la,ab){ka=void 0===ka?1:ka;wa=void 0===wa?0:wa;Ga=void 0===Ga?!1:Ga;la=void 0===la?null:la;ab=void 0===ab?null:ab;var nb=new Rr;nb.guid=zc.a.create();nb.layoutAlgorithmType=u;nb.page=V;nb.beginConnectionPointIndex=ka;nb.endConnectionPointIndex=wa;nb.ignorePageShapes=Ga;nb.actionDataManager=Ni.instance;
var sb=[];N&&N.forEach(function(Db){sb.push(Db.oe)});nb.shapes=sb;void 0!==la&&null!==la&&(nb.virtualNodeDetails=la);void 0!==ab&&null!==ab&&(nb.creationNodeParent=ab);return nb};pd.prototype.dze=function(u,N,V){var ka=new Hi;ka.guid=zc.a.create();ka.parentPage=u[0].oe.ta;ka.userCellName=N;ka.userCellValue=V;ka.shapes=u;N=[];for(V=0;V<u.length;V++)Array.add(N,u[V].oe);ka.shapes=N;return ka};pd.prototype.aze=function(u,N,V,ka){var wa=new Rp;wa.guid=zc.a.create();wa.pageId=u.id;wa.userCellName=N;wa.userCellValue=
V;wa.isSyncCommand=ka;return wa};pd.prototype.createSetTextCommandData_Deprecated=function(u,N,V){var ka=new pu.a;ka.shape=N.oe;for(var wa=[],Ga=!1,la=0;la<N.oe.textStream.textTokens.length;la++)0===N.oe.textStream.textTokens[la].get_type()?Ga||(wa.push(new Mm(u)),Ga=!0):wa.push(N.oe.textStream.textTokens[la]);ka.textTokens=wa;ka.textVerticalAlign=5;ka.textFieldIndexes=[];ka.isSyncCommand=V;return ka};pd.prototype.mAe=function(u,N,V,ka){var wa=new ag.a;wa.guid=zc.a.create();wa.shapeID=u.oe.id;wa.pageID=
N;var Ga=u.shapeDataItems;u=new lv.a;N=0;for(N;N<Ga.getCount();N++)if(Ga.getItem(N).label===V){u.Format=Ga.getItem(N).format;u.Label=V;u.Value=ka;break}V={};wa.editShapeDataInfo=(V[N]=u,V);return wa};pd.prototype.createSetShapeFillFormatCommandData=function(u,N,V,ka){var wa=new up.a;wa.guid=zc.a.create();wa.parentPageID=u.oe.ta.id;var Ga=[];Array.add(Ga,u.id);wa.shapesID=Ga;wa.color=new Tr.a(N,V,ka);return wa};pd.prototype.createSetShapeFillFormatCommandData_Deprecated=function(u,N,V,ka){var wa=new Qi.a;
wa.guid=zc.a.create();var Ga=[];Array.add(Ga,u.oe);wa.shapes=Ga;wa.color=new Tr.a(N,V,ka);return wa};pd.prototype.Tue=function(u,N,V,ka,wa){var Ga=new kv.a;Ga.guid=zc.a.create();Ga.shapes=[];u.forEach(function(la){Array.add(Ga.shapes,la.oe)});Ga.translateX=N;Ga.translateY=V;Ga.isDrag=ka;Ga.shouldGlue=wa;Ga.duplicateShapeAdded=!1;return Ga};pd.prototype.nXc=function(u,N,V,ka,wa){ka=void 0===ka?null:ka;wa=void 0===wa?null:wa;var Ga=new Pn.a;Ga.pin=new So.a;V&&(Ga.pin.xPosition=V.x,Ga.pin.yPosition=
V.y);Ga.stencilMaster=N.master;Ga.parentPage=u.P2;Ga.stencil=N.stencil;Ga.containerRelationships=null;Ga.snapAndGlueData=ka;Ga.shouldGlue=!!ka;Ga.connectionPoints=wa;return Ga};pd.prototype.awe=function(u,N,V,ka,wa,Ga,la){Ga=void 0===Ga?"":Ga;la=void 0===la?0:la;var ab=new Dh.a;ab.pageId=wa;wa=[];Array.add(wa,u.oe);ab.shapes=wa;ab.extendedGuidId=zc.a.create();ab.description=Ga;0==ka&&(ab.tW=0);1==ka&&(ab.tW=1);2==ka&&(ab.tW=2);if(0==ka||1==ka){if(fl.a.ka(N))return null;0==V?ab.address=N:1==V?(V=e(1078).Application,
ab.subAddress=V.Hl.kf.pages.Ga(N).internalName):2==V&&(ab.address="mailto:"+N)}if(2==ka||1==ka)u=u.hyperlinks.getItem(la),ab.Iy=u.getRowName();return ab};pd.prototype.Ete=function(u,N,V){V=void 0===V?null:V;var ka=new Ow.a;ka.pageID=N;ka.guid=zc.a.create();ka.type=u;u=[];if(null!=V)for(N=0;N<V.length;++N){var wa=V[N].oe;wa.Zd&&Array.add(u,wa)}ka.shapes=u;return ka};pd.prototype.Ise=function(u,N,V,ka,wa,Ga,la,ab){wa=void 0===wa?null:wa;Ga=void 0===Ga?!0:Ga;la=void 0===la?-1:la;ab=void 0===ab?null:
ab;var nb=u.oe.ta;qf.AFrameworkApplication.H.J("VisioWebOrgChartAutoLayoutSnappingFixEnabled")&&null!==ab?(qf.AFrameworkApplication.H.J("VisioWebUniversalCommandDataEnabled")?(ab=this.Q6c(u.oe,new Pm.a(ab.pinX,ab.pinY),1,0,N.MasterInfo.masterId,N.MasterInfo.stencilId),u=ab.begin,V=ab.end,ab=ab.connectionPoints):(ab=this.R6c(u.oe,new Pm.a(ab.pinX,ab.pinY),1,0,N.MasterInfo.master),u=ab.begin,V=ab.end,ab=ab.connectionPoints),V.shape=N.oe,V.gluePoint=new Qm.a(ka)):(N=this.xRa(u.oe,N.oe,!0,V,ka),u=N.begin,
V=N.end,ab=N.ewa);N=new We.a(u,V,nb,[],ab);-1===la&&(nb=(la=nb.rk)?la.ju:0,la=2===(la?la.KW:0)?2:16===nb?1:0);N.connectorType=la;if(void 0!==wa&&null!==wa){la=[];wa=D.makeIterator(wa);for(nb=wa.next();!nb.done;nb=wa.next())Array.add(la,nb.value.oe);N.addedShapes=la}N.shouldPerformLocalLie=Ga;return N};pd.prototype.Nse=function(u,N,V,ka,wa,Ga,la,ab,nb,sb,Db,bc){la=void 0===la?null:la;ab=void 0===ab?!0:ab;nb=void 0===nb?1:nb;sb=void 0===sb?0:sb;Db=void 0===Db?null:Db;bc=void 0===bc?!1:bc;var Xb=new tp.a;
Xb.guid=zc.a.create();Xb.pin=new Rm.a;var Gc=1!==Ga;var oe=this.Q6c(N.oe,new Pm.a(ka,wa),nb,sb,V.masterId,V.stencilId,Gc);Gc=oe.begin;var pe=oe.end;Xb.connectorPoints=oe.connectionPoints;Xb.begin=new Rm.a(Gc);Xb.end=new Rm.a(pe);Xb.stencilID=V.stencilId;Xb.stencilMasterID=V.masterId;Xb.direction=u;Xb.parentPageID=N.oe.ta.id;Xb.shouldPerformLocalLie=ab;Xb.quickShapeConnectionPointIndex=sb;Xb.shouldPerformSolidLineConnectorLocalLie=bc;Db&&(Xb.connectorStencilMasterID=Db.masterId,Xb.connectorStencilId=
Db.stencilId);qf.AFrameworkApplication.H.J("VisioWebQuickShapeGlueToCPFixEnabled")?(Xb.quickShapeStartConnectionPointIndex=nb,Xb.shouldPerformAutoConnect=!1,Xb.pin.xPosition=ka,Xb.pin.yPosition=wa):(Xb.pin.xPosition=N.oe.xForm.pinX+2,Xb.pin.yPosition=N.oe.xForm.pinY+2,5!==u&&(Xb.pin.xPosition-=4),-1===Ga&&(Xb.pin.xPosition=ka,Xb.pin.yPosition=wa));Xb.connectorType=Ga;if(void 0!==la&&null!==la){u=[];la=D.makeIterator(la);for(N=la.next();!N.done;N=la.next())Array.add(u,N.value.id.toString());Xb.addedShapesID=
u}return Xb};pd.prototype.Ose=function(u,N,V,ka,wa,Ga,la,ab,nb,sb,Db,bc,Xb){Xb=void 0===Xb?null:Xb;var Gc=new tp.a;Gc.guid=zc.a.create();Gc.pin=new Rm.a;Gc.pin.xPosition=u;Gc.pin.yPosition=N;u=new Rm.a;N=new Rm.a;u.xPosition=Ga.xPosition;u.yPosition=Ga.yPosition;u.glueType=Ga.glueType;u.shapeID=Ga.shapeID;u.isCustomConnector=Ga.isCustomConnector;u.gluePointConnectionPointIndex=Ga.gluePointConnectionPointIndex;N.xPosition=la.xPosition;N.yPosition=la.yPosition;N.glueType=la.glueType;N.shapeID=la.shapeID;
N.isCustomConnector=la.isCustomConnector;N.gluePointConnectionPointIndex=la.gluePointConnectionPointIndex;qf.AFrameworkApplication.H.J("VisioWebQuickShapeGlueToCPFixEnabled")&&(Gc.quickShapeStartConnectionPointIndex=Ga.gluePointConnectionPointIndex,Gc.shouldPerformAutoConnect=!1);Gc.begin=u;Gc.end=N;Gc.stencilID=ka;Gc.stencilMasterID=V.masterId;Gc.direction=nb;Gc.parentPageID=wa;Gc.shouldPerformLocalLie=sb;Gc.quickShapeConnectionPointIndex=ab;Gc.connectorType=Db;V=new On.a;for(ka=0;ka<bc.length;ka++)V.lc(bc[ka]);
Gc.connectorPoints=V;if(void 0!==Xb&&null!==Xb){bc=[];Xb=D.makeIterator(Xb);for(V=Xb.next();!V.done;V=Xb.next())Array.add(bc,V.value.id.toString());Gc.addedShapesID=bc}return Gc};pd.prototype.Qse=function(u,N,V,ka,wa,Ga,la,ab,nb,sb,Db,bc){bc=void 0===bc?null:bc;var Xb=e(1078).Application,Gc=new jv.a;Gc.guid=zc.a.create();Gc.pin=new So.a;Gc.pin.xPosition=u;Gc.pin.yPosition=N;Gc.parentPage=Xb.Hl.kf.pages.Ga(ka);u=new Rm.a;N=new So.a;u.xPosition=wa.xPosition;u.yPosition=wa.yPosition;u.glueType=wa.glueType;
u.shapeID=wa.shapeID;u.isCustomConnector=wa.isCustomConnector;u.gluePointConnectionPointIndex=wa.gluePointConnectionPointIndex;Gc.begin=new So.a(Gc.parentPage.shapes.Ga(wa.shapeID),u);N.xPosition=Ga.xPosition;N.yPosition=Ga.yPosition;N.glueType=Ga.glueType;N.isCustomConnector=Ga.isCustomConnector;qf.AFrameworkApplication.H.J("VisioWebQuickShapeGlueToCPFixEnabled")&&(Gc.quickShapeStartConnectionPointIndex=wa.gluePointConnectionPointIndex,Gc.shouldPerformAutoConnect=!1);Gc.end=N;Gc.direction=ab;Gc.shouldPerformLocalLie=
nb;Gc.stencilMaster=V.master;Gc.stencil=V.stencil;Gc.shouldPerformLocalLie=nb;Gc.quickShapeConnectionPointIndex=la;Gc.connectorType=sb;V=new On.a;for(wa=0;wa<Db.length;wa++)V.lc(Db[wa]);Gc.connectorPoints=V;if(void 0!==bc&&null!==bc){Db=[];bc=D.makeIterator(bc);for(V=bc.next();!V.done;V=bc.next())Array.add(Db,V.value.oe);Gc.addedShapes=Db}return Gc};pd.prototype.createChangeShapeCommandData=function(u,N,V){for(var ka=new Sr.a,wa=[],Ga=0;Ga<u.length;Ga++)Array.add(wa,u[Ga].oe);ka.guid=zc.a.create();
ka.shapes=wa;ka.StencilID=V;ka.MasterID=N;return ka};pd.prototype.Pse=function(u,N,V,ka,wa,Ga,la,ab,nb,sb,Db,bc){la=void 0===la?null:la;ab=void 0===ab?!0:ab;nb=void 0===nb?1:nb;sb=void 0===sb?0:sb;Db=void 0===Db?null:Db;bc=void 0===bc?!1:bc;var Xb=new jv.a;Xb.guid=zc.a.create();Xb.pin=new So.a;var Gc=1!==Ga;Gc=this.R6c(N.oe,new Pm.a(ka,wa),nb,sb,V.master,Gc);Xb.begin=Gc.begin;Xb.end=Gc.end;Xb.connectorPoints=Gc.connectionPoints;Xb.stencilMaster=V.master;Xb.stencil=V.stencil;Xb.direction=u;Xb.parentPage=
N.oe.ta;Xb.shouldPerformLocalLie=ab;Xb.quickShapeConnectionPointIndex=sb;Xb.shouldPerformSolidLineConnectorLocalLie=bc;Db&&(Xb.connectorStencil=Db.stencil,Xb.connectorStencilMaster=Db.master);qf.AFrameworkApplication.H.J("VisioWebQuickShapeGlueToCPFixEnabled")?(Xb.quickShapeStartConnectionPointIndex=nb,Xb.shouldPerformAutoConnect=!1,Xb.pin.xPosition=ka,Xb.pin.yPosition=wa):(Xb.pin.xPosition=N.oe.xForm.pinX+2,Xb.pin.yPosition=N.oe.xForm.pinY+2,5!==u&&(Xb.pin.xPosition-=4),-1===Ga&&(Xb.pin.xPosition=
ka,Xb.pin.yPosition=wa));Xb.connectorType=Ga;if(void 0!==la&&null!==la){u=[];la=D.makeIterator(la);for(N=la.next();!N.done;N=la.next())Array.add(u,N.value.oe);Xb.addedShapes=u}return Xb};pd.prototype.createPageLayoutCommandData=function(u,N,V){for(var ka=new nk.a,wa=[],Ga=0;Ga<u.length;Ga++)Array.add(wa,u[Ga].oe);ka.guid=zc.a.create();ka.shapes=wa;ka.activePageID=N;ka.layoutType=V;return ka};pd.prototype.createPageLayoutCommand=function(u,N,V){var ka=Md.a.Vd.Cb;u=this.createPageLayoutCommandData(u,
N,V);ka=ka.createPageLayoutCommand(u);return new Nh(ka)};pd.prototype.Q6c=function(u,N,V,ka,wa,Ga,la){la=void 0===la?!0:la;var ab=new rt.a;ab.guid=zc.a.create();ab.parentPageID=u.ta.id;ab.pin=N;ab.stencilMasterID=wa;ab.stencilID=Ga;qf.AFrameworkApplication.ea.na(ch.a.createShape,2,ab);wa=qf.AFrameworkApplication.H.J("VisioWebQuickShapeGlueToCPFixEnabled");Ga=u.connectionPoints;N=Ga.items[0];if(wa)if(qf.AFrameworkApplication.H.J("VisioWebUseQuickShapeCommandForMindmap"))V<Ga.count&&(N=Ga.items[V]);
else for(var nb=0;nb<Ga.count;nb++)V===this.getConnectionPointIndex(Ga.items[nb].dir)&&(N=Ga.items[nb]);V=ab.shape.connectionPoints;Ga=V.items[0];if(wa)if(qf.AFrameworkApplication.H.J("VisioWebUseQuickShapeCommandForMindmap"))ka<V.count&&(Ga=V.items[ka]);else for(wa=0;wa<V.count;wa++)ka===this.getConnectionPointIndex(V.items[wa].dir)&&(Ga=V.items[wa]);u=this.xRa(u,ab.shape,la,N,Ga);return{begin:u.begin,end:u.end,connectionPoints:u.ewa}};pd.prototype.R6c=function(u,N,V,ka,wa,Ga){Ga=void 0===Ga?!0:
Ga;var la=new $f.a;la.parentPage=u.ta;la.pin=N;la.stencilMaster=wa;qf.AFrameworkApplication.ea.na(ch.a.createShape,2,la);N=qf.AFrameworkApplication.H.J("VisioWebQuickShapeGlueToCPFixEnabled");wa=u.connectionPoints;if(wa){var ab=wa.items[0];if(N)if(qf.AFrameworkApplication.H.J("VisioWebUseQuickShapeCommandForMindmap"))V<wa.count&&(ab=wa.items[V]);else for(var nb=0;nb<wa.count;nb++)if(V===this.getConnectionPointIndex(wa.items[nb].dir)){ab=wa.items[nb];break}}if(V=la.shape.connectionPoints){var sb=V.items[0];
if(N)if(qf.AFrameworkApplication.H.J("VisioWebUseQuickShapeCommandForMindmap"))ka<V.count&&(sb=V.items[ka]);else for(N=0;N<V.count;N++)if(ka===this.getConnectionPointIndex(V.items[N].dir)){sb=V.items[N];break}}u=this.xRa(u,la.shape,Ga,ab,sb);return{begin:u.begin,end:u.end,connectionPoints:u.ewa}};pd.prototype.xRa=function(u,N,V,ka,wa,Ga){V=void 0===V?!0:V;ka=void 0===ka?null:ka;wa=void 0===wa?null:wa;Ga=void 0===Ga?null:Ga;var la=new So.a;var ab=new So.a;var nb=new Ge.a;nb.page=u.ta;Ga&&Ga.shapes&&
(nb.connectorShape=Ga.shapes.getItemAt(0));la.shape=nb.fromShape=u;ab.shape=nb.toShape=N;ka?(la.gluePoint=new Qm.a(ka),la.glueType=8,nb.fromCP=ka):la.glueType=64;wa?(ab.gluePoint=new Qm.a(wa),ab.glueType=8,nb.toCP=wa):ab.glueType=64;nb.isLiveAngularConnectorEnabled=V;qf.AFrameworkApplication.ea.na(ch.a.qX,2,nb);void 0===nb.connectorPointList||null===nb.connectorPointList||2>=nb.connectorPointList.length||!nb.isLiveAngularConnectorEnabled?(nb.connectorPointList=new On.a,ka&&(u=this.ff(ka.x,ka.y,u),
la.xPosition=u.rc,la.yPosition=u.sc,nb.connectorPointList.lc(new Pm.a(la.xPosition,la.yPosition))),wa&&(N=this.ff(wa.x,wa.y,N),ab.xPosition=N.rc,ab.yPosition=N.sc,nb.connectorPointList.lc(new Pm.a(ab.xPosition,ab.yPosition)))):(la.xPosition=nb.connectorPointList.Bb(0).x,la.yPosition=nb.connectorPointList.Bb(0).y,ab.xPosition=nb.connectorPointList.Bb(nb.connectorPointList.length-1).x,ab.yPosition=nb.connectorPointList.Bb(nb.connectorPointList.length-1).y);return{begin:la,end:ab,ewa:nb.connectorPointList}};
pd.prototype.ff=function(u,N,V){for(;void 0!==V&&null!==V;)N=this.tK(u,N,V),u=N.rc,N=N.sc,V=V.$a;return{rc:u,sc:N}};pd.prototype.tK=function(u,N,V){if(void 0===V||null===V)return{rc:u,sc:N};V=V.xForm;var ka=V.angle,wa=0,Ga=1;ka&&(wa=Math.sin(ka),Ga=Math.cos(ka));ka=u-V.Qh;N-=V.Zi;V.flipX&&(ka=-ka);V.flipY&&(N=-N);u=ka*Ga-N*wa+V.pinX;N=N*Ga+ka*wa+V.pinY;return{rc:u,sc:N}};pd.prototype.RYe=function(u,N,V){var ka=new Dd;ka.fromShape=u.oe;ka.master=N.master;ka.direction=this.y2e(V);qf.AFrameworkApplication.ea.na(ch.a.uib,
2,ka);return ka.pin};pd.prototype.y2e=function(u){var N=-1;switch(u){case 0:N=0;break;case 1:N=2;break;case 2:N=3;break;case 3:N=1}return N};pd.prototype.getConnectionPointIndex=function(u){var N=-1;switch(u){case 0:N=3;break;case 1:N=0;break;case 2:N=2;break;case 3:N=1}return N};Object(Yd.a)(pd,"VisioAddonCommandingManager",null,[]);var Sn=e(726),yq=e(110),De=e(161);zg.prototype.showTaskPane=function(u){this.qq(u)};zg.prototype.hideTaskPane=function(u){this.VB(u)};zg.prototype.updateTaskPane=function(u){this.AS(u)};
zg.prototype.getTaskPaneVisibility=function(u){return this.bZe(u)};zg.prototype.qq=function(u){qf.AFrameworkApplication.H.J("VisioWebEnableSolutionTaskPaneAccessibility")&&-1===this.Aa.GQa.indexOf(u.taskPaneId)&&this.Aa.O8f([u.taskPaneId]);this.rD.qq(u.taskPaneId,Object.assign(new Sn.a,{title:u.title,width:u.width,location:u.location,onManualClose:u.onManualClose,contentProps:u.props}))};zg.prototype.VB=function(u){this.rD.VB(u.taskPaneId,u.location)};zg.prototype.AS=function(u){this.rD.AS(u.taskPaneId,
Object.assign(new Sn.a,{title:u.title,width:u.width,location:u.location,contentProps:u.props}))};zg.prototype.bZe=function(u){return this.rD.T1(u)};Object(Yd.a)(zg,"VisioAddonTaskPaneManager",null,[]);var Og=e(43),Sm={ORG_CHART_SOLUTION_DIALOG_TITLE:VisioWebIntl.VisioWebStrings.L_ORG_CHART_SOLUTION_DIALOG_TITLE,FORMAT_ORGCHART_TASKPANE_TITLE:VisioWebIntl.VisioWebStrings.L_FORMAT_ORGCHART_TASKPANE_TITLE,ORG_CHART_TITLE:VisioWebIntl.VisioWebStrings.L_ORG_CHART_TITLE,NAME_TEXT:VisioWebIntl.VisioWebStrings.L_NAME_TEXT,
EMAIL_TEXT:VisioWebIntl.VisioWebStrings.L_EMAIL_TEXT,PHONENUMBER_TEXT:VisioWebIntl.VisioWebStrings.L_PHONENUMBER_TEXT,HELP_TEXT:VisioWebIntl.VisioWebStrings.L_HELP_TEXT,SHAPE_STYLE:VisioWebIntl.VisioWebStrings.L_SHAPE_STYLE,EMPLOYEE_FIELDS:VisioWebIntl.VisioWebStrings.L_EMPLOYEE_FIELDS,BASIC_LAYOUT:VisioWebIntl.VisioWebStrings.L_BASIC_LAYOUT,ADVANCED_LAYOUT:VisioWebIntl.VisioWebStrings.L_ADVANCED_LAYOUT,NAME_EMPLOYEE_FIELD:VisioWebIntl.VisioWebStrings.L_NAME_EMPLOYEE_FIELD,TITLE_EMPLOYEE_FIELD:VisioWebIntl.VisioWebStrings.L_TITLE_EMPLOYEE_FIELD,
DEPARTMENT_EMPLOYEE_FIELD:VisioWebIntl.VisioWebStrings.L_DEPARTMENT_EMPLOYEE_FIELD,TELEPHONE_EMPLOYEE_FIELD:VisioWebIntl.VisioWebStrings.L_TELEPHONE_EMPLOYEE_FIELD,EMAIL_EMPLOYEE_FIELD:VisioWebIntl.VisioWebStrings.L_EMAIL_EMPLOYEE_FIELD,ADDRESS_EMPLOYEE_FIELD:VisioWebIntl.VisioWebStrings.L_ADDRESS_EMPLOYEE_FIELD,LOCATION_EMPLOYEE_FIELD:VisioWebIntl.VisioWebStrings.L_LOCATION_EMPLOYEE_FIELD,UPLOAD_PHOTOS:VisioWebIntl.VisioWebStrings.L_UPLOAD_PHOTOS,REPLACE_PHOTOS:VisioWebIntl.VisioWebStrings.L_REPLACE_PHOTOS,
UPLOAD_PHOTO:VisioWebIntl.VisioWebStrings.L_UPLOAD_PHOTO,REPLACE_PHOTO:VisioWebIntl.VisioWebStrings.L_REPLACE_PHOTO,FILE_COUNT_MISMATCH_ERROR_MESSAGE:VisioWebIntl.VisioWebStrings.L_FILE_COUNT_MISMATCH_ERROR_MESSAGE,BASIC_LEGACY:VisioWebIntl.VisioWebStrings.L_BASIC_LEGACY,BASIC_NO_INITIALS:VisioWebIntl.VisioWebStrings.L_BASIC_NO_INITIALS,BASIC_WITHOUT_INITIALS1:VisioWebIntl.VisioWebStrings.L_BASIC_WITHOUT_INITIALS1,BASIC_WITHOUT_INITIALS2:VisioWebIntl.VisioWebStrings.L_BASIC_WITHOUT_INITIALS2,BASIC_SQUARE_INITIALS:VisioWebIntl.VisioWebStrings.L_BASIC_SQUARE_INITIALS,
BASIC_CIRCULAR_INITIALS:VisioWebIntl.VisioWebStrings.L_BASIC_CIRCULAR_INITIALS,MEDAL_SQUARE:VisioWebIntl.VisioWebStrings.L_MEDAL_SQUARE,MEDAL_CIRCULAR:VisioWebIntl.VisioWebStrings.L_MEDAL_CIRCULAR,PINBOARD_SQUARE:VisioWebIntl.VisioWebStrings.L_PINBOARD_SQUARE,PINBOARD_CIRCULAR:VisioWebIntl.VisioWebStrings.L_PINBOARD_CIRCULAR,BADGE_SQUARE:VisioWebIntl.VisioWebStrings.L_BADGE_SQUARE,BADGE_CIRCULAR:VisioWebIntl.VisioWebStrings.L_BADGE_CIRCULAR,ROLLOUT_SQUARE:VisioWebIntl.VisioWebStrings.L_ROLLOUT_SQUARE,
ROLLOUT_CIRCULAR:VisioWebIntl.VisioWebStrings.L_ROLLOUT_CIRCULAR,UPDATING_NODE_STYLE:VisioWebIntl.VisioWebStrings.L_UPDATING_NODE_STYLE,SHAPE_OVERLAP_WARNING:VisioWebIntl.VisioWebStrings.L_SHAPE_OVERLAP_WARNING,DV_CONTAINER_WARNING:VisioWebIntl.VisioWebStrings.L_DV_CONTAINER_WARNING,APPLY_LAYOUT_BUTTON_TEXT:VisioWebIntl.VisioWebStrings.L_APPLY_LAYOUT_BUTTON_TEXT,FILENAME_PLACEHOLDER:VisioWebIntl.VisioWebStrings.L_FILENAME_PLACEHOLDER,MAX_FILESIZE_PLACEHOLDER:VisioWebIntl.VisioWebStrings.L_MAX_FILESIZE_PLACEHOLDER,
INSERTPICTURE_DIALOG_TITLE:VisioWebIntl.VisioWebStrings.L_INSERTPICTURE_DIALOG_TITLE,INSERTPICTURES_DIALOG_TITLE:VisioWebIntl.VisioWebStrings.L_INSERTPICTURES_DIALOG_TITLE,INSERTPICTURE_DIALOG_DESCRIPTION:VisioWebIntl.VisioWebStrings.L_INSERTPICTURE_DIALOG_DESCRIPTION,INSERTPICTURE_DIALOG_HEURISTICTYPE_LABEL:VisioWebIntl.VisioWebStrings.L_INSERTPICTURE_DIALOG_HEURISTICTYPE_LABEL,INSERTPICTURE_DIALOG_SELECTSOURCE_LABEL:VisioWebIntl.VisioWebStrings.L_INSERTPICTURE_DIALOG_SELECTSOURCE_LABEL,INSERTPICTURE_DIALOG_NOTE_TEXT:VisioWebIntl.VisioWebStrings.L_INSERTPICTURE_DIALOG_NOTE_TEXT,
INSERTPICTURE_DIALOG_EXAMPLE_TEXT:VisioWebIntl.VisioWebStrings.L_INSERTPICTURE_DIALOG_EXAMPLE_TEXT,INSERTPICTURE_DIALOG_FILERESTRICTION_TEXT:VisioWebIntl.VisioWebStrings.L_INSERTPICTURE_DIALOG_FILERESTRICTION_TEXT,INSERTPICTURE_DIALOG_SOURCEONE_LABEL:VisioWebIntl.VisioWebStrings.L_INSERTPICTURE_DIALOG_SOURCEONE_LABEL,INSERTPICTURE_DIALOG_SOURCETWO_LABEL:VisioWebIntl.VisioWebStrings.L_INSERTPICTURE_DIALOG_SOURCETWO_LABEL,INSERTPICTURE_GENERIC_ERROR_RETRY:VisioWebIntl.VisioWebStrings.L_INSERTPICTURE_GENERIC_ERROR_RETRY,
INSERTPICTURE_FILE_SIZE_TOO_LARGE_ERROR_MESSAGE:VisioWebIntl.VisioWebStrings.L_INSERTPICTURE_FILE_SIZE_TOO_LARGE_ERROR_MESSAGE,INSERTPICTURE_FILE_FORMAT_NOT_SUPPORTED_ERROR_MESSAGE:VisioWebIntl.VisioWebStrings.L_INSERTPICTURE_FILE_FORMAT_NOT_SUPPORTED_ERROR_MESSAGE,INSERTPICTURE_ERROR_DIALOG_TITLE:VisioWebIntl.VisioWebStrings.L_INSERTPICTURE_ERROR_DIALOG_TITLE,INSERTPICTURE_ERROR_DIALOG_GENERIC_MESSAGE:VisioWebIntl.VisioWebStrings.L_INSERTPICTURE_ERROR_DIALOG_GENERIC_MESSAGE,INSERTPICTURE_ERROR_DIALOG_NO_ORGCHART_SHAPE_MESSAGE:VisioWebIntl.VisioWebStrings.L_INSERTPICTURE_ERROR_DIALOG_NO_ORGCHART_SHAPE_MESSAGE,
INSERTPICTURE_ERROR_DIALOG_NODE_COUNT_EXCEEDED_MESSAGE:VisioWebIntl.VisioWebStrings.L_INSERTPICTURE_ERROR_DIALOG_NODE_COUNT_EXCEEDED_MESSAGE,INSERTPICTURE_ERROR_DIALOG_FORMAT_MISMATCH_MESSAGE:VisioWebIntl.VisioWebStrings.L_INSERTPICTURE_ERROR_DIALOG_FORMAT_MISMATCH_MESSAGE,INSERTPICTURE_ERROR_DIALOG_FILE_SIZE_TOO_LARGE_MESSAGE:VisioWebIntl.VisioWebStrings.L_INSERTPICTURE_ERROR_DIALOG_FILE_SIZE_TOO_LARGE_MESSAGE,INSERTPICTURE_ERROR_DIALOG_FILENAME_COLUMN_LABEL:VisioWebIntl.VisioWebStrings.L_INSERTPICTURE_ERROR_DIALOG_FILENAME_COLUMN_LABEL,
INSERTPICTURE_ERROR_DIALOG_FILESIZE_COLUMN_LABEL:VisioWebIntl.VisioWebStrings.L_INSERTPICTURE_ERROR_DIALOG_FILESIZE_COLUMN_LABEL,INSERTPICTURE_ERROR_DIALOG_FILESTATUS_COLUMN_LABEL:VisioWebIntl.VisioWebStrings.L_INSERTPICTURE_ERROR_DIALOG_FILESTATUS_COLUMN_LABEL,INSERTPICTURE_ERROR_DIALOG_STATUS_INSERT_BUTTON_LABEL:VisioWebIntl.VisioWebStrings.L_INSERTPICTURE_ERROR_DIALOG_STATUS_INSERT_BUTTON_LABEL,INSERTPICTURE_ERROR_DIALOG_STATUS_CANCEL_BUTTON_LABEL:VisioWebIntl.VisioWebStrings.L_INSERTPICTURE_ERROR_DIALOG_STATUS_CANCEL_BUTTON_LABEL,
INSERTPICTURE_ERROR_DIALOG_FILENAME_MISMATCH_TEXT:VisioWebIntl.VisioWebStrings.L_INSERTPICTURE_ERROR_DIALOG_FILENAME_MISMATCH_TEXT,INSERTPICTURE_ERROR_DIALOG_FILEFORMAT_MISMATCH_TEXT:VisioWebIntl.VisioWebStrings.L_INSERTPICTURE_ERROR_DIALOG_FILEFORMAT_MISMATCH_TEXT,INSERTPICTURE_ERROR_DIALOG_FILESIZE_TOO_LARGE_TEXT:VisioWebIntl.VisioWebStrings.L_INSERTPICTURE_ERROR_DIALOG_FILESIZE_TOO_LARGE_TEXT,INSERTPICTURE_ERROR_DIALOG_FILENAME_MATCH_SUCCESS_TEXT:VisioWebIntl.VisioWebStrings.L_INSERTPICTURE_ERROR_DIALOG_FILENAME_MATCH_SUCCESS_TEXT,
INSERTPICTURE_ERROR_DIALOG_FILENAME_MISMATCH_MESSAGE_TEXT:VisioWebIntl.VisioWebStrings.L_INSERTPICTURE_ERROR_DIALOG_FILENAME_MISMATCH_MESSAGE_TEXT,INSERTPICTURE_ERROR_DIALOG_FILESIZE_TOO_LARGE_MESSAGE_TEXT:VisioWebIntl.VisioWebStrings.L_INSERTPICTURE_ERROR_DIALOG_FILESIZE_TOO_LARGE_MESSAGE_TEXT,INSERTPICTURE_ERROR_DIALOG_FILEFORMAT_MISMATCH_MESSAGE_TEXT:VisioWebIntl.VisioWebStrings.L_INSERTPICTURE_ERROR_DIALOG_FILEFORMAT_MISMATCH_MESSAGE_TEXT,LAYOUT_TOP_TO_BOTTOM:VisioWebIntl.VisioWebStrings.L_LAYOUT_TOP_TO_BOTTOM,
LAYOUT_BOTTOM_TO_TOP:VisioWebIntl.VisioWebStrings.L_LAYOUT_BOTTOM_TO_TOP,LAYOUT_LEFT_TO_RIGHT:VisioWebIntl.VisioWebStrings.L_LAYOUT_LEFT_TO_RIGHT,LAYOUT_RIGHT_TO_LEFT:VisioWebIntl.VisioWebStrings.L_LAYOUT_RIGHT_TO_LEFT,LAYOUT_HYBRID_VERTICAL_RIGHT:VisioWebIntl.VisioWebStrings.L_LAYOUT_HYBRID_VERTICAL_RIGHT,LAYOUT_SIDE_BY_SIDE:VisioWebIntl.VisioWebStrings.L_LAYOUT_SIDE_BY_SIDE,LAYOUT_HYBRID_VERTICAL_RIGHT_SIDE_BY_SIDE:VisioWebIntl.VisioWebStrings.L_LAYOUT_HYBRID_VERTICAL_RIGHT_SIDE_BY_SIDE,LAYOUT_HYBRID_SIDE_BY_SIDE:VisioWebIntl.VisioWebStrings.L_LAYOUT_HYBRID_SIDE_BY_SIDE,
MULTIPLE_INWARD_CONNECTIONS_NOT_ALLOWED_USER_MESSAGE:VisioWebIntl.VisioWebStrings.L_MULTIPLE_INWARD_CONNECTIONS_NOT_ALLOWED_USER_MESSAGE},lg=e(805);Eb.getTypeName=function(){return"AugLoop_Core_SchemaObject"};Eb.getBaseTypes=function(){return[]};Eb.getTypeNameFor=function(u){return u&&u.H_?u.H_.T_:void 0};Eb.getBaseTypesFor=function(u){return u&&u.H_&&u.H_.B_?u.H_.B_:[]};Eb.getAllTypesFor=function(u){var N=Eb.getTypeNameFor(u);return N?[N].concat(D.Nh(Eb.getBaseTypesFor(u))):[]};Eb.matchesTypesFor=
function(u,N){if(!Array.isArray(N)||0===N.length)return!0;var V=Eb.getTypeNameFor(u);u=Eb.getBaseTypesFor(u);N=D.makeIterator(N);for(var ka=N.next();!ka.done;ka=N.next())if(ka=ka.value,ka===V||0<=u.indexOf(ka))return!0;return!1};Eb.assign=function(u,N,V){if(V)for(var ka=D.makeIterator(Object.keys(V)),wa=ka.next();!wa.done;wa=ka.next())wa=wa.value,N[wa]=V[wa];N.H_=u.H_;return N};Eb.H_={T_:Eb.getTypeName(),B_:Eb.getBaseTypes()};Ml.getTypeName=function(){return"AugLoop_VisioStart_VisioStartAnnotation"};
Ml.getBaseTypes=function(){return["AugLoop_Core_Annotation"]};Ml.typeGuard=function(u){return Eb.matchesTypesFor(u,[Ml.getTypeName()])};D.global.Object.defineProperties(Ml.prototype,{metadata:{configurable:!0,enumerable:!0,get:function(){return this.M_},set:function(u){this.M_=u}}});Object(Yd.a)(Ml,"VisioStartAnnotation",null,[]);sm.getTypeName=function(){return"AugLoop_VisioStart_VisioStartSignal"};sm.getBaseTypes=function(){return["AugLoop_Signals_Signal"]};sm.typeGuard=function(u){return Eb.matchesTypesFor(u,
[sm.getTypeName()])};Object(Yd.a)(sm,"VisioStartSignal",null,[]);var br=e(349),Xj=e(1171),Up={default:{}};Up["default"]||(Up["default"]={});var rh=function(){function u(N){if(N)for(var V in N)null!=N[V]&&(this[V]=N[V])}u.prototype.count=0;u.prototype.cv="";u.prototype.serviceName="";u.prototype.sessionKey="";u.prototype.durationMs=0;u.prototype.success=!1;u.prototype.resultDescription="";u.prototype.resultJSON="";u.prototype.resultSignature="";u.prototype.operationName="";u.prototype.resourceId="";
u.prototype.dimension0="";u.prototype.dimension1="";u.prototype.dimension2="";u.prototype.dimension3="";u.prototype.clientAppName="";u.prototype.clientAppPlatform="";u.prototype.clientRuntimeVersion="";u.prototype.clientAppVersion="";u.prototype.clientReleaseAudienceGroup="";u.prototype.clientReleaseChannel="";u.prototype.clientReleaseFork="";u.prototype.clientSessionId="";u.prototype.clientFlights="";u.prototype.clientIPRange="";u.prototype.clientDocSessionId="";u.prototype.clientDeviceId="";u.prototype.clientUserAgent=
"";u.prototype.userType="";u.prototype.userId="";u.prototype.userTenantId="";u.prototype.joinContextId="";u.prototype.ariaTenant="";u.prototype.ariaNamespace="";u.prototype.dataFields="";u.getTypeUrl=function(N){void 0===N&&(N="type.googleapis.com");return N+"/OperationEvent"};return u}(),qn=e(1130);D.ha(Pc,rh);Pc.prototype.setClientMetadata=function(u){u&&(this.clientAppName=u.appName,this.clientAppPlatform=u.appPlatform,this.clientAppVersion=u.appVersion,this.clientFlights=u.flights,this.clientReleaseAudienceGroup=
u.releaseAudienceGroup,this.clientReleaseChannel=u.releaseChannel,this.clientReleaseFork=u.releaseFork,this.clientRuntimeVersion=u.runtimeVersion,this.clientSessionId=u.sessionId,this.clientDocSessionId=u.docSessionId,this.clientDeviceId=u.deviceId,this.clientUserAgent=u.userAgent);return this};Pc.prototype.setUserContext=function(u){u&&(this.userId=u.puid||u.oid,this.userType=u.userType&&u.userType.toString(),this.userTenantId=u.tid);return this};Pc.prototype.setMetricCustomDimensions=function(u,
N){if(!this.options)throw Error("Attempting to set custom dimensions "+u+" to operation "+this.operationName+" without activating MetricCount or MetricDuration");this.options.metricCustomDimensions=this.options.metricCustomDimensions||{};this.options.metricCustomDimensions[u]=N};Pc.prototype.setDataField=function(u,N){var V=this.dataFields?JSON.parse(this.dataFields):{};V[u]=N;this.dataFields=JSON.stringify(V)};Pc.prototype.setDataFields=function(u){this.dataFields=this.dataFields?JSON.stringify(Object.assign(Object.assign({},
JSON.parse(this.dataFields)),u)):JSON.stringify(u)};Pc.prototype.start=function(){this.startTime=Object(qn.a)();return this};Pc.prototype.stop=function(){var u=Object(qn.a)();this.durationMs=Math.round(u-this.startTime);return this};Pc.prototype.getMetrics=function(u){var N,V,ka={};if(this.operationName)switch(this.operationName){case "SessionHealthOrphanedEventsWithoutProperSessionKey":case "SessionHealthOrphanedSessions":case "WorkflowActivationState":ka[this.operationName+".CountV2"]={dimensionNames:Pc.getOrphanedSessionHealthDimensionNames.bind(Pc),
dimensionValues:this.getOrphanedSessionHealthDimensionValues(),value:this.count};break;case "MarkUnhealthySession":case "MarkHealthWarningSession":ka[this.operationName+".Reason"]={dimensionNames:Pc.getSessionHealthDimensionNames.bind(Pc),dimensionValues:this.getSessionHealthDimensionValues(),value:1};break;default:"matchmaker_timer"===this.operationName&&(ka["Workflow.DurationMs"]={dimensionNames:Pc.getWorkflowDimensionNames.bind(Pc),dimensionValues:this.getWorkflowDimensionValues(),value:this.durationMs||
0},ka["Workflow.Count"]={dimensionNames:Pc.getWorkflowDimensionNames.bind(Pc),dimensionValues:this.getWorkflowDimensionValues(),value:1});if(void 0!==this.durationMs){var wa=this.operationName+".DurationMsV2";if((null===(N=this.options)||void 0===N?0:N.metricDuration)||0<=u.indexOf(wa))ka[wa]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.durationMs}}N=this.operationName+".CountV2";if((null===(V=this.options)||void 0===V?0:V.metricCount)||0<=
u.indexOf(N))ka[N]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.count}}return ka};Pc.prototype.getDimensionNames=function(){var u,N,V=Pc.dimensionNames;if(null===(u=this.options)||void 0===u?0:u.metricCustomDimensions){V=V.slice();for(var ka in null===(N=this.options)||void 0===N?void 0:N.metricCustomDimensions)V.push(ka)}return V};Pc.prototype.getDimensionValues=function(){var u,N,V=[this.success,this.clientAppName,this.clientAppPlatform,
this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3];if(null===(u=this.options)||void 0===u?0:u.metricCustomDimensions)for(var ka in null===(N=this.options)||void 0===N?void 0:N.metricCustomDimensions)V.push(this.options.metricCustomDimensions[ka]);return V};Pc.getOrphanedSessionHealthDimensionNames=function(){return this.orphanedSessionHealthDimensionNames};Pc.prototype.getOrphanedSessionHealthDimensionValues=function(){return[this.success,this.clientAppName,this.clientAppPlatform,
this.clientReleaseAudienceGroup,this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]};Pc.getSessionHealthDimensionNames=function(){return this.sessionHealthDimensionNames};Pc.prototype.getSessionHealthDimensionValues=function(){return[this.resultSignature,this.clientAppName,this.clientAppPlatform,this.clientAppVersion,this.dimension0,this.dimension1,this.dimension2,this.dimension3]};Pc.getWorkflowDimensionNames=function(){return this.workflowDimensionNames};Pc.prototype.getWorkflowDimensionValues=
function(){return[this.resultSignature,this.resourceId,this.resourceId,this.success]};Pc.dimensionNames="Success ClientAppName ClientAppPlatform ResourceId Dimension0 Dimension1 Dimension2 Dimension3".split(" ");Pc.orphanedSessionHealthDimensionNames="Success ClientAppName ClientAppPlatform ClientReleaseAudienceGroup ResourceId Dimension0 Dimension1 Dimension2 Dimension3".split(" ");Pc.sessionHealthDimensionNames="Reason ClientAppName ClientAppPlatform ClientAppVersion Dimension0 Dimension1 Dimension2 Dimension3".split(" ");
Pc.workflowDimensionNames=["ResultSignature","WorkflowId","ResourceId","Success"];var wb=e(1170),Ur;(function(u){u[u.Unknown=0]="Unknown";u[u.LiveId=1]="LiveId";u[u.OrgId=2]="OrgId";u[u.ActiveDirectory=3]="ActiveDirectory";u[u.ADAL=4]="ADAL";u[u.SSPI=5]="SSPI";u[u.OAuth2=6]="OAuth2";u[u.Badger=7]="Badger"})(Ur||(Ur={}));var Sc;(function(u){u[u.Augloop=0]="Augloop";u[u.Substrate=1]="Substrate"})(Sc||(Sc={}));var Vp;(function(u){u[u.ProductServiceUsage=2]="ProductServiceUsage";u[u.ProductServicePerformance=
4]="ProductServicePerformance"})(Vp||(Vp={}));var cr;(function(u){u[u.BasicEvent=10]="BasicEvent";u[u.FullEvent=100]="FullEvent";u[u.RequiredServiceDataEvent=110]="RequiredServiceDataEvent"})(cr||(cr={}));var ro=/\|~/g;Nk.prototype.log=function(u){var N=this;if(null!=this.hostCallbacks&&null!=this.hostCallbacks.sendTelemetryEvent){var V=function(ka,wa,Ga,la,ab){wa=wa.charAt(0).toUpperCase()+wa.slice(1);var nb={DocSessionId:ka.clientDocSessionId,ResourceId:ka.resourceId,ceg:ka.resultDescription,deg:ka.resultSignature,
Adg:ka.dimension0,Bdg:ka.dimension1,Cdg:ka.dimension2,Ddg:ka.dimension3,Sdg:ka.joinContextId};Ga&&(nb=Object.assign(Object.assign({},nb),JSON.parse(Ga)));Ga=la?la:Nk.augLoopAriaTenantToken;ab=ab||Ga!=Nk.augLoopAriaTenantToken?ab:Nk.augLoopAriaNamespace;wa=wa?wa:Nk.operationNamePlaceholder;N.hostCallbacks.sendTelemetryEvent(Ga,ab?ab+"_"+wa:wa,nb,"Office.System.Activity",{CV:ka.cv,Duration:1E3*(ka.durationMs||0),Count:ka.count,tdg:2,Success:ka.success},!1,Vp.ProductServiceUsage|Vp.ProductServicePerformance,
cr.RequiredServiceDataEvent)};"Workflow.MetricsOnly"!=u.category&&("Operation"===u.eventName?V(u,u.operationName,u.dataFields):"SessionHealth"===u.eventName?V(u,u.sessionHealthEventName):"WorkflowOperation"===u.eventName?V(u,u.operationName,u.dataFields,u.ariaTenant,u.ariaNamespace):"Log"===u.eventName&&N.hostCallbacks.sendDiagnosticTrace&&N.hostCallbacks.sendDiagnosticTrace(u.tagId,u.traceLevel,u.message))}};Nk.augLoopAriaTenantToken="3de4087d4de34817b1c376e3d1e6e293-983c4292-5ba9-485a-ab10-9797863c788b-6770";
Nk.augLoopAriaNamespace="Office_AugLoop_Client";Nk.operationNamePlaceholder="OperationNameNotProvided";var hm=e(1148),gl=e.n(hm),wi;(function(u){u[u.Undefined=0]="Undefined";u[u.Schema=1]="Schema";u[u.Boolean=2]="Boolean";u[u.Number=3]="Number";u[u.String=4]="String";u[u.Buffer=5]="Buffer";u[u.Function=6]="Function"})(wi||(wi={}));Bh.getTypeName=function(){return"AugLoop_Core_Annotation"};Bh.getBaseTypes=function(){return[]};Bh.typeGuard=function(u){return Eb.matchesTypesFor(u,[Bh.getTypeName()])};
D.global.Object.defineProperties(Bh.prototype,{metadata:{configurable:!0,enumerable:!0,get:function(){return this.M_},set:function(u){this.M_=u}}});Bh.H_={T_:Bh.getTypeName(),B_:Bh.getBaseTypes()};rm.getTypeName=function(){return"AugLoop_Core_BinaryClassificationAnnotation"};rm.getBaseTypes=function(){return["AugLoop_Core_Annotation"]};rm.typeGuard=function(u){return Eb.matchesTypesFor(u,[rm.getTypeName()])};D.global.Object.defineProperties(rm.prototype,{metadata:{configurable:!0,enumerable:!0,get:function(){return this.M_},
set:function(u){this.M_=u}}});rm.H_={T_:rm.getTypeName(),B_:rm.getBaseTypes()};Ug.getTypeName=function(){return"AugLoop_Signals_Signal"};Ug.getBaseTypes=function(){return[]};Ug.typeGuard=function(u){return Eb.matchesTypesFor(u,[Ug.getTypeName()])};Ug.H_={T_:Ug.getTypeName(),B_:Ug.getBaseTypes()};al.getTypeName=function(){return"AugLoop_Core_DirtyAreaSignal"};al.getBaseTypes=function(){return["AugLoop_Signals_Signal"]};al.typeGuard=function(u){return Eb.matchesTypesFor(u,[al.getTypeName()])};al.H_=
{T_:al.getTypeName(),B_:al.getBaseTypes()};wf.getTypeName=function(){return"AugLoop_Core_SignalWithPath"};wf.getBaseTypes=function(){return["AugLoop_Signals_Signal"]};wf.typeGuard=function(u){return Eb.matchesTypesFor(u,[wf.getTypeName()])};wf.H_={T_:wf.getTypeName(),B_:wf.getBaseTypes()};$h.getTypeName=function(){return"AugLoop_Core_ItemDelta"};$h.getBaseTypes=function(){return[]};$h.typeGuard=function(u){return Eb.matchesTypesFor(u,[$h.getTypeName()])};$h.H_={T_:$h.getTypeName(),B_:$h.getBaseTypes()};
Po.getTypeName=function(){return"AugLoop_Core_ItemChangesDelta"};Po.getBaseTypes=function(){return["AugLoop_Core_ItemDelta"]};Po.typeGuard=function(u){return Eb.matchesTypesFor(u,[Po.getTypeName()])};Po.H_={T_:Po.getTypeName(),B_:Po.getBaseTypes()};qg.getTypeName=function(){return"AugLoop_Core_Operation"};qg.getBaseTypes=function(){return[]};qg.typeGuard=function(u){return Eb.matchesTypesFor(u,[qg.getTypeName()])};qg.H_={T_:qg.getTypeName(),B_:qg.getBaseTypes()};rp.getTypeName=function(){return"AugLoop_Core_OperationWithSiblingContext"};
rp.getBaseTypes=function(){return["AugLoop_Core_Operation"]};rp.typeGuard=function(u){return Eb.matchesTypesFor(u,[rp.getTypeName()])};rp.H_={T_:rp.getTypeName(),B_:rp.getBaseTypes()};Mh.getTypeName=function(){return"AugLoop_Core_AddOperation"};Mh.getBaseTypes=function(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]};Mh.typeGuard=function(u){return Eb.matchesTypesFor(u,[Mh.getTypeName()])};Mh.H_={T_:Mh.getTypeName(),B_:Mh.getBaseTypes()};qp.getTypeName=function(){return"AugLoop_Core_MoveOperation"};
qp.getBaseTypes=function(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]};qp.typeGuard=function(u){return Eb.matchesTypesFor(u,[qp.getTypeName()])};qp.H_={T_:qp.getTypeName(),B_:qp.getBaseTypes()};Mi.getTypeName=function(){return"AugLoop_Core_UpdateAnnotationMetaDataOperation"};Mi.getBaseTypes=function(){return["AugLoop_Core_Operation"]};Mi.typeGuard=function(u){return Eb.matchesTypesFor(u,[Mi.getTypeName()])};Mi.H_={T_:Mi.getTypeName(),B_:Mi.getBaseTypes()};qm.getTypeName=
function(){return"AugLoop_Core_UpdateOperation"};qm.getBaseTypes=function(){return["AugLoop_Core_Operation"]};qm.typeGuard=function(u){return Eb.matchesTypesFor(u,[qm.getTypeName()])};qm.H_={T_:qm.getTypeName(),B_:qm.getBaseTypes()};mk.getTypeName=function(){return"AugLoop_Core_DeleteOperation"};mk.getBaseTypes=function(){return["AugLoop_Core_Operation"]};mk.typeGuard=function(u){return Eb.matchesTypesFor(u,[mk.getTypeName()])};mk.H_={T_:mk.getTypeName(),B_:mk.getBaseTypes()};Wj.getTypeName=function(){return"AugLoop_Core_PurgeOperation"};
Wj.getBaseTypes=function(){return["AugLoop_Core_Operation"]};Wj.typeGuard=function(u){return Eb.matchesTypesFor(u,[Wj.getTypeName()])};Wj.H_={T_:Wj.getTypeName(),B_:Wj.getBaseTypes()};tl.getTypeName=function(){return"AugLoop_Core_PurgeSubtreeOperation"};tl.getBaseTypes=function(){return["AugLoop_Core_Operation"]};tl.typeGuard=function(u){return Eb.matchesTypesFor(u,[tl.getTypeName()])};tl.H_={T_:tl.getTypeName(),B_:tl.getBaseTypes()};sl.getTypeName=function(){return"AugLoop_Core_FocusOperation"};
sl.getBaseTypes=function(){return["AugLoop_Core_Operation"]};sl.typeGuard=function(u){return Eb.matchesTypesFor(u,[sl.getTypeName()])};sl.H_={T_:sl.getTypeName(),B_:sl.getBaseTypes()};Mg.getTypeName=function(){return"AugLoop_Core_VisibilityOperation"};Mg.getBaseTypes=function(){return["AugLoop_Core_Operation"]};Mg.typeGuard=function(u){return Eb.matchesTypesFor(u,[Mg.getTypeName()])};Mg.H_={T_:Mg.getTypeName(),B_:Mg.getBaseTypes()};mf.getTypeName=function(){return"AugLoop_Core_DeltaUpdateOperation"};
mf.getBaseTypes=function(){return["AugLoop_Core_Operation"]};mf.typeGuard=function(u){return Eb.matchesTypesFor(u,[mf.getTypeName()])};mf.H_={T_:mf.getTypeName(),B_:mf.getBaseTypes()};re.getTypeName=function(){return"AugLoop_Core_MicroSyncOperation"};re.getBaseTypes=function(){return["AugLoop_Core_Operation"]};re.typeGuard=function(u){return Eb.matchesTypesFor(u,[re.getTypeName()])};re.H_={T_:re.getTypeName(),B_:re.getBaseTypes()};Ad.getTypeName=function(){return"AugLoop_Signals_SignalOperation"};
Ad.getBaseTypes=function(){return["AugLoop_Core_Operation"]};Ad.typeGuard=function(u){return Eb.matchesTypesFor(u,[Ad.getTypeName()])};Ad.H_={T_:Ad.getTypeName(),B_:Ad.getBaseTypes()};var st=e(1132),bg=e.n(st);mc.createHealthCheckRequest=function(u){return{payload:{},payloadSchema:{category:wi.Schema,schema:{name:"HealthCheckRequest"}},requestedSchema:{category:wi.Schema,schema:{name:"HealthCheckResponse"}},clientMetadata:u}};mc.isFeatureEnabled=function(u,N,V,ka){V=void 0===V?!1:V;return u&&u.isFeatureEnabled?
u.isFeatureEnabled("Microsoft.Office.AugLoop."+N,void 0===ka?"None":ka).catch(function(){return Promise.resolve(V)}):Promise.resolve(V)};mc.convertWebSocketUrlToHttp=function(u){return this.convertUrl(u,!1)};mc.convertServiceUrlToWebSocket=function(u){return this.convertUrl(u,!0)};mc.convertUrl=function(u,N){if(!u)return u;var V=u.split(":"),ka=V[0].toLowerCase();return 0==ka.indexOf(N?"http":"ws")?(ka=N?ka.replace("http","ws"):ka.replace("ws","http"),V[0]=ka,V.join(":")):u};mc.deepEquals=function(u,
N){return bg()(u,N)};mc.collectTelemetry=function(u,N,V,ka,wa,Ga){var la,ab,nb,sb;u.start();u.resultSignature=null!==ka&&void 0!==ka?ka:"";u.resultDescription=null!==wa&&void 0!==wa?wa:"";u.success=V;Ga?(u.dimension0=null!==(la=Ga[0])&&void 0!==la?la:"",u.dimension1=null!==(ab=Ga[1])&&void 0!==ab?ab:"",u.dimension2=null!==(nb=Ga[2])&&void 0!==nb?nb:"",u.dimension3=null!==(sb=Ga[3])&&void 0!==sb?sb:""):(u.dimension0="",u.dimension1="",u.dimension2="",u.dimension3="");N.log(function(){return wb.a.info(508367457,
wb.b.CoreDefault,u.stop())})};mc.getCurrentTimeMs=function(){return Date.now?Date.now():(new Date).getTime()};Sb.prototype.log=function(u){this.numberOfLogs<this.maxNumberOfLogs&&(this.numberOfLogs++,u(),this.numberOfLogs===this.maxNumberOfLogs&&(u=new Pc({operationName:"OnLastLog",success:!0,resourceId:this.id,resultDescription:"Limit for number of logs for id: "+this.id+" reached - all next logs will be dropped"}),wb.a.warn(572838107,wb.b.CoreDefault,u)))};var mv=[Eb.getTypeName(),Bh.getTypeName(),
Ug.getTypeName()];he.prototype.init=function(u,N,V,ka,wa){function Ga(ab){la.logPingLatencyOp&&(la.logPingLatencyOp.success=ab,wb.a.info(508843802,wb.b.CoreDefault,la.logPingLatencyOp.stop()),la.logPingLatencyOp=void 0)}var la=this;this.ws=new gl.a(u);this.logOp=(new Pc({operationName:he.className,success:!0})).start();this.egressTimer=Date.now();this.egressMessageCountOp=new Pc({operationName:"WSEgressMessageCount",success:!0});this.egressByteCountOp=new Pc({operationName:"WSEgressByteOrderOfMagnitude",
success:!0});this.ingressByteCountOp=new Pc({operationName:"WSIngressByteOrderOfMagnitude",success:!0});this.improvedWebSocketEnabled=wa;this.ws.addEventListener("open",function(){V();he.logCountLimiter.log(function(){la.logOp.resourceId="OnOpen";la.logOp.resultDescription="";la.logOp.success=!0;la.logOp.dimension0=la.pendingEgress.length.toString();wb.a.info(508843801,wb.b.CoreDefault,la.logOp.stop())});la.improvedWebSocketEnabled||(la.hasBeenOpened=!0,la.pendingEgress.forEach(function(ab){la.egress({obj:ab})}),
la.pendingEgress=[],la.pingInterval=setInterval(function(){la.logPingLatencyOp&&(--la.remainingPingFailures,Ga(!1));0<la.remainingPingFailures&&la.hasBeenOpened&&la.lastPongTime<la.lastEgressTime&&(la.logPingLatencyOp=(new Pc({operationName:"Ping",success:!0,dimension0:0<=la.ws.bufferedAmount?la.ws.bufferedAmount.toString().length.toString():void 0})).start(),la.ws.send(he.pingPongMessage,function(ab){ab&&(--la.remainingPingFailures,Ga(!1))}))},3E4))});this.ws.addEventListener("message",function(ab){!la.improvedWebSocketEnabled&&
la.logPingLatencyOp&&"string"===typeof ab.data&&1===ab.data.length&&ab.data[0]===he.pingPongMessage?(Ga(!0),la.lastPongTime=Date.now()):(la.logIngressCount(ab.data),N(ab.data))});this.ws.addEventListener("error",function(ab){la.errorMessage=ab.message;he.logCountLimiter.log(function(){la.logOp.resourceId="OnError";la.logOp.resultDescription=la.errorMessage;la.logOp.success=!1;wb.a.info(508843800,wb.b.CoreDefault,la.logOp.stop())});la.ws.close()});this.ws.addEventListener("close",function(ab){he.logCountLimiter.log(function(){la.logOp.resourceId=
"OnClose";la.logOp.resultDescription=ab?"code: "+ab.code+". reason: "+ab.reason:"";la.logOp.success=!0;wb.a.info(508843799,wb.b.CoreDefault,la.logOp.stop())});!la.improvedWebSocketEnabled&&la.pingInterval&&(clearInterval(la.pingInterval),la.pingInterval=void 0);ka(la.errorMessage);la.isClosing=!1})};he.prototype.egress=function(u){var N=this;u=u.obj;this.improvedWebSocketEnabled?this.ws.send(u,function(V){V&&!N.hadEgressError&&(N.hadEgressError=!0,he.logCountLimiter.log(function(){N.logOp.resourceId=
"OnEgressError";N.logOp.resultDescription=V.message;N.logOp.success=!1;wb.a.info(508843797,wb.b.CoreDefault,N.logOp.stop())}))}):(this.logEgressCount(u instanceof ArrayBuffer||u instanceof Uint8Array?u.byteLength:u.length),this.lastEgressTime=Date.now(),this.hasBeenOpened?this.ws.send(u,function(V){V&&!N.hadEgressError&&(N.hadEgressError=!0,he.logCountLimiter.log(function(){N.logOp.resourceId="OnFirstEgressError";N.logOp.resultDescription=V.message;N.logOp.success=!1;wb.a.info(508843798,wb.b.CoreDefault,
N.logOp.stop())}))}):this.pendingEgress.push(u))};he.prototype.close=function(){this.isClosing||(this.isClosing=!0,!this.improvedWebSocketEnabled&&this.pingInterval&&(clearInterval(this.pingInterval),this.pingInterval=void 0),this.ws.close())};he.prototype.logEgressCount=function(u){var N=Date.now(),V=N-this.egressTimer;1E3<V&&(50<this.egressMessageCount&&(this.egressMessageCountOp.start(),this.egressMessageCountOp.resultDescription="Egress message count: "+this.egressMessageCount.toString()+", Buffered amount: "+
(0<=this.ws.bufferedAmount?this.ws.bufferedAmount.toString():"-")+", Time elapsed: "+V.toString(),wb.a.info(508843796,wb.b.CoreDefault,this.egressMessageCountOp.stop())),1E5<this.egressByteCount&&(this.egressByteCountOp.start(),this.egressByteCountOp.dimension2=this.egressByteCount.toString().length.toString(),this.egressMessageCountOp.resultDescription="Buffered amount: "+(0<=this.ws.bufferedAmount?this.ws.bufferedAmount.toString():"-")+", Time elapsed: "+V.toString(),wb.a.info(508843795,wb.b.CoreDefault,
this.egressByteCountOp.stop())),this.egressTimer=N,this.egressByteCount=this.egressMessageCount=0);this.egressMessageCount++;this.egressByteCount+=null!==u&&void 0!==u?u:0};he.prototype.logIngressCount=function(u){u=u.length;1E5<u&&(this.ingressByteCountOp.start(),this.ingressByteCountOp.dimension2=u.toString().length.toString(),wb.a.info(508843794,wb.b.CoreDefault,this.ingressByteCountOp.stop()))};he.className="WebSocketWorker";he.logCountLimiter=new Sb(he.className);he.pingPongMessage="~";Lh.fromString=
function(u,N){if(!u)throw Error("Received invalid correlation vector string");u=u.endsWith(".0")?new Lh(u.substring(0,u.length-2)):new Lh(u);N&&(u.childCount=N);return u};Lh.prototype.newChild=function(){++this.childCount;return new Lh(this.id+"."+this.childCount.toString())};Lh.prototype.toString=function(){return 127<this.id.length?this.id.substring(0,127)+"!":this.id};var Oh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),wd=Array(22),yk={default:{}};yk["default"]||
(yk["default"]={});var If=function(){function u(N){if(N)for(var V in N)null!=N[V]&&(this[V]=N[V])}u.prototype.cv="";u.prototype.serviceName="";u.prototype.sessionKey="";u.prototype.clientAppName="";u.prototype.clientAppPlatform="";u.prototype.clientRuntimeVersion="";u.prototype.clientAppVersion="";u.prototype.clientReleaseAudienceGroup="";u.prototype.clientReleaseChannel="";u.prototype.clientReleaseFork="";u.prototype.clientSessionId="";u.prototype.clientFlights="";u.prototype.clientIPRange="";u.prototype.clientDocSessionId=
"";u.prototype.clientDeviceId="";u.prototype.clientUserAgent="";u.prototype.userType="";u.prototype.userId="";u.prototype.sessionHealthEventName="";u.prototype.source="";u.prototype.reason="";u.prototype.reasonDependency="";u.prototype.subReason="";u.prototype.impact="";u.prototype.success=!1;u.prototype.durationMs=0;u.prototype.count=0;u.prototype.message="";u.prototype.affectedWorkflows="";u.prototype.resourceId="";u.prototype.dimension0="";u.prototype.dimension1="";u.prototype.dimension2="";u.prototype.dimension3=
"";u.prototype.resultDescription="";u.prototype.resultSignature="";u.prototype.joinContextId="";u.getTypeUrl=function(N){void 0===N&&(N="type.googleapis.com");return N+"/SessionHealthEvent"};return u}(),ec;(function(u){u[u.Unknown=0]="Unknown";u[u.Core=1]="Core";u[u.Workflow=2]="Workflow";u[u.SessionExtension=3]="SessionExtension";u[u.Client=4]="Client";u[u.ClientRuntime=5]="ClientRuntime"})(ec||(ec={}));var mi;(function(u){u[u.Unknown=0]="Unknown";u[u.Core=1]="Core";u[u.Workflow=2]="Workflow";u[u.SessionExtension=
3]="SessionExtension";u[u.Client=4]="Client";u[u.Network=5]="Network";u[u.AugLoopDependency=6]="AugLoopDependency";u[u.WorkflowDependency=7]="WorkflowDependency";u[u.ClientRuntime=8]="ClientRuntime"})(mi||(mi={}));var rn;(function(u){u[u.Unknown=0]="Unknown";u[u.None=1]="None";u[u.MissingInput=2]="MissingInput";u[u.MissingOutput=3]="MissingOutput"})(rn||(rn={}));D.ha(pg,If);pg.prototype.getMetrics=function(){var u={};if(void 0===this.metricCount||this.metricCount)u[this.sessionHealthEventName+".CountV2"]=
{dimensionNames:function(){return pg.dimensionNames},dimensionValues:this.getDimensionValues(),value:this.count};if(void 0===this.metricDuration||this.metricDuration)u[this.sessionHealthEventName+".DurationMsV2"]={dimensionNames:function(){return pg.dimensionNames},dimensionValues:this.getDimensionValues(),value:this.durationMs};return u};pg.prototype.setClientMetadata=function(u){u&&(this.clientAppName=u.appName,this.clientAppPlatform=u.appPlatform,this.clientAppVersion=u.appVersion,this.clientFlights=
u.flights,this.clientReleaseAudienceGroup=u.releaseAudienceGroup,this.clientReleaseChannel=u.releaseChannel,this.clientReleaseFork=u.releaseFork,this.clientRuntimeVersion=u.runtimeVersion,this.clientSessionId=u.sessionId,this.clientDocSessionId=u.docSessionId,this.clientUserAgent=u.userAgent,this.clientDeviceId=u.deviceId);return this};pg.prototype.setReason=function(u){this.reason=mi[u];return this};pg.prototype.setSource=function(u){this.source=ec[u];return this};pg.prototype.setImpact=function(u){this.impact=
rn[u];return this};pg.prototype.setAffectedWorkflows=function(u){this.affectedWorkflows=(null!==u&&void 0!==u?u:[]).join(",");return this};pg.prototype.getAffectedWorkflows=function(){return this.affectedWorkflows.split(",")};pg.prototype.start=function(){this.startTime=Object(qn.a)();return this};pg.prototype.stop=function(){var u=Object(qn.a)();this.durationMs=Math.round(u-this.startTime);return this};pg.prototype.getDimensionValues=function(){var u;return[this.clientAppName,this.clientAppPlatform,
this.clientAppVersion,this.success?"1":"0",this.reason+"_"+this.reasonDependency,this.impact,null!==(u=this.getAffectedWorkflows()[0])&&void 0!==u?u:"",this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]};pg.dimensionNames="ClientAppName ClientAppPlatform ClientAppVersion Success Reason Impact FirstAffectedWorkflow ResourceId Dimension0 Dimension1 Dimension2 Dimension3".split(" ");Mk.getTypeName=function(){return"AugLoop_Session_Protocol_Message"};Mk.getBaseTypes=function(){return[]};
Mk.typeGuard=function(u){return Eb.matchesTypesFor(u,[Mk.getTypeName()])};Mk.H_={T_:Mk.getTypeName(),B_:Mk.getBaseTypes()};yg.getTypeName=function(){return"AugLoop_Session_Protocol_Response"};yg.getBaseTypes=function(){return[]};yg.typeGuard=function(u){return Eb.matchesTypesFor(u,[yg.getTypeName()])};yg.H_={T_:yg.getTypeName(),B_:yg.getBaseTypes()};Kh.getTypeName=function(){return"AugLoop_Session_Protocol_ErrorResponse"};Kh.getBaseTypes=function(){return["AugLoop_Session_Protocol_Response"]};Kh.typeGuard=
function(u){return Eb.matchesTypesFor(u,[Kh.getTypeName()])};Kh.H_={T_:Kh.getTypeName(),B_:Kh.getBaseTypes()};$k.getTypeName=function(){return"AugLoop_Session_Protocol_TimeoutErrorResponse"};$k.getBaseTypes=function(){return["AugLoop_Session_Protocol_ErrorResponse","AugLoop_Session_Protocol_Response"]};$k.typeGuard=function(u){return Eb.matchesTypesFor(u,[$k.getTypeName()])};$k.H_={T_:$k.getTypeName(),B_:$k.getBaseTypes()};xg.getTypeName=function(){return"AugLoop_Session_Protocol_SessionInitMessage"};
xg.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]};xg.typeGuard=function(u){return Eb.matchesTypesFor(u,[xg.getTypeName()])};xg.H_={T_:xg.getTypeName(),B_:xg.getBaseTypes()};bh.getTypeName=function(){return"AugLoop_Session_Protocol_SessionInitResponse"};bh.getBaseTypes=function(){return["AugLoop_Session_Protocol_Response"]};bh.typeGuard=function(u){return Eb.matchesTypesFor(u,[bh.getTypeName()])};bh.H_={T_:bh.getTypeName(),B_:bh.getBaseTypes()};Bf.getTypeName=function(){return"AugLoop_Session_Protocol_SessionLongPollMessage"};
Bf.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]};Bf.typeGuard=function(u){return Eb.matchesTypesFor(u,[Bf.getTypeName()])};Bf.H_={T_:Bf.getTypeName(),B_:Bf.getBaseTypes()};zh.getTypeName=function(){return"AugLoop_Session_Protocol_SessionLongPollResponse"};zh.getBaseTypes=function(){return["AugLoop_Session_Protocol_Response"]};zh.typeGuard=function(u){return Eb.matchesTypesFor(u,[zh.getTypeName()])};zh.H_={T_:zh.getTypeName(),B_:zh.getBaseTypes()};Mf.getTypeName=function(){return"AugLoop_Session_Protocol_SessionCloseReason"};
Mf.getBaseTypes=function(){return[]};Mf.typeGuard=function(u){return Eb.matchesTypesFor(u,[Mf.getTypeName()])};Mf.H_={T_:Mf.getTypeName(),B_:Mf.getBaseTypes()};$e.getTypeName=function(){return"AugLoop_Session_Protocol_SessionSwapOnClose"};$e.getBaseTypes=function(){return["AugLoop_Session_Protocol_SessionCloseReason"]};$e.typeGuard=function(u){return Eb.matchesTypesFor(u,[$e.getTypeName()])};$e.H_={T_:$e.getTypeName(),B_:$e.getBaseTypes()};Ve.getTypeName=function(){return"AugLoop_Session_Protocol_SessionCloseMessage"};
Ve.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]};Ve.typeGuard=function(u){return Eb.matchesTypesFor(u,[Ve.getTypeName()])};Ve.H_={T_:Ve.getTypeName(),B_:Ve.getBaseTypes()};yh.getTypeName=function(){return"AugLoop_Session_Protocol_CacheDumpRequestMessage"};yh.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]};yh.typeGuard=function(u){return Eb.matchesTypesFor(u,[yh.getTypeName()])};yh.H_={T_:yh.getTypeName(),B_:yh.getBaseTypes()};Ue.getTypeName=function(){return"AugLoop_Session_Protocol_CacheDumpRequestResponse"};
Ue.getBaseTypes=function(){return["AugLoop_Session_Protocol_Response"]};Ue.typeGuard=function(u){return Eb.matchesTypesFor(u,[Ue.getTypeName()])};Ue.H_={T_:Ue.getTypeName(),B_:Ue.getBaseTypes()};xh.getTypeName=function(){return"AugLoop_Session_Protocol_AnnotationActivationMessage"};xh.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]};xh.typeGuard=function(u){return Eb.matchesTypesFor(u,[xh.getTypeName()])};xh.H_={T_:xh.getTypeName(),B_:xh.getBaseTypes()};cj.getTypeName=function(){return"AugLoop_Session_Protocol_AnnotationActivationResponse"};
cj.getBaseTypes=function(){return["AugLoop_Session_Protocol_Response"]};cj.typeGuard=function(u){return Eb.matchesTypesFor(u,[cj.getTypeName()])};cj.H_={T_:cj.getTypeName(),B_:cj.getBaseTypes()};mn.getTypeName=function(){return"AugLoop_Session_Protocol_AnnotationResultStateMessage"};mn.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]};mn.typeGuard=function(u){return Eb.matchesTypesFor(u,[mn.getTypeName()])};mn.H_={T_:mn.getTypeName(),B_:mn.getBaseTypes()};wg.getTypeName=function(){return"AugLoop_Session_Protocol_AnnotationReleaseMessage"};
wg.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]};wg.typeGuard=function(u){return Eb.matchesTypesFor(u,[wg.getTypeName()])};wg.H_={T_:wg.getTypeName(),B_:wg.getBaseTypes()};Vj.getTypeName=function(){return"AugLoop_Session_Protocol_AnnotationReleaseResponse"};Vj.getBaseTypes=function(){return["AugLoop_Session_Protocol_Response"]};Vj.typeGuard=function(u){return Eb.matchesTypesFor(u,[Vj.getTypeName()])};Vj.H_={T_:Vj.getTypeName(),B_:Vj.getBaseTypes()};Bj.getTypeName=function(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateMessage"};
Bj.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]};Bj.typeGuard=function(u){return Eb.matchesTypesFor(u,[Bj.getTypeName()])};Bj.H_={T_:Bj.getTypeName(),B_:Bj.getBaseTypes()};Lm.getTypeName=function(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateResponse"};Lm.getBaseTypes=function(){return["AugLoop_Session_Protocol_Response"]};Lm.typeGuard=function(u){return Eb.matchesTypesFor(u,[Lm.getTypeName()])};Lm.H_={T_:Lm.getTypeName(),B_:Lm.getBaseTypes()};Te.getTypeName=function(){return"AugLoop_Session_Protocol_SyncMessage"};
Te.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]};Te.typeGuard=function(u){return Eb.matchesTypesFor(u,[Te.getTypeName()])};Te.H_={T_:Te.getTypeName(),B_:Te.getBaseTypes()};Km.getTypeName=function(){return"AugLoop_Session_Protocol_MicroSyncMessage"};Km.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]};Km.typeGuard=function(u){return Eb.matchesTypesFor(u,[Km.getTypeName()])};Km.H_={T_:Km.getTypeName(),B_:Km.getBaseTypes()};ih.getTypeName=function(){return"AugLoop_Session_Protocol_SyncResponse"};
ih.getBaseTypes=function(){return["AugLoop_Session_Protocol_Response"]};ih.typeGuard=function(u){return Eb.matchesTypesFor(u,[ih.getTypeName()])};ih.H_={T_:ih.getTypeName(),B_:ih.getBaseTypes()};df.getTypeName=function(){return"AugLoop_Session_Protocol_SessionDeleteMessage"};df.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]};df.typeGuard=function(u){return Eb.matchesTypesFor(u,[df.getTypeName()])};df.H_={T_:df.getTypeName(),B_:df.getBaseTypes()};xk.getTypeName=function(){return"AugLoop_Session_Protocol_AnnotationResultsMessage"};
xk.getBaseTypes=function(){return["AugLoop_Session_Protocol_SyncMessage","AugLoop_Session_Protocol_Message"]};xk.typeGuard=function(u){return Eb.matchesTypesFor(u,[xk.getTypeName()])};xk.H_={T_:xk.getTypeName(),B_:xk.getBaseTypes()};wk.getTypeName=function(){return"AugLoop_Session_Protocol_TokenProvisionMessage"};wk.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]};wk.typeGuard=function(u){return Eb.matchesTypesFor(u,[wk.getTypeName()])};wk.H_={T_:wk.getTypeName(),B_:wk.getBaseTypes()};
ln.getTypeName=function(){return"AugLoop_Session_Protocol_TokenProvisionResponse"};ln.getBaseTypes=function(){return["AugLoop_Session_Protocol_Response"]};ln.typeGuard=function(u){return Eb.matchesTypesFor(u,[ln.getTypeName()])};ln.H_={T_:ln.getTypeName(),B_:ln.getBaseTypes()};lk.getTypeName=function(){return"AugLoop_Session_Protocol_KeepAlive"};lk.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]};lk.typeGuard=function(u){return Eb.matchesTypesFor(u,[lk.getTypeName()])};lk.H_={T_:lk.getTypeName(),
B_:lk.getBaseTypes()};kn.getTypeName=function(){return"AugLoop_Session_Protocol_WorkflowGraphInitMessage"};kn.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]};kn.typeGuard=function(u){return Eb.matchesTypesFor(u,[kn.getTypeName()])};kn.H_={T_:kn.getTypeName(),B_:kn.getBaseTypes()};vi.getTypeName=function(){return"AugLoop_Session_Protocol_WorkflowGraphInitResponse"};vi.getBaseTypes=function(){return["AugLoop_Session_Protocol_Response"]};vi.typeGuard=function(u){return Eb.matchesTypesFor(u,
[vi.getTypeName()])};vi.H_={T_:vi.getTypeName(),B_:vi.getBaseTypes()};li.getTypeName=function(){return"AugLoop_Session_Protocol_WorkflowExecutionCompleteMessage"};li.getBaseTypes=function(){return["AugLoop_Session_Protocol_SyncMessage","AugLoop_Session_Protocol_Message"]};li.typeGuard=function(u){return Eb.matchesTypesFor(u,[li.getTypeName()])};li.H_={T_:li.getTypeName(),B_:li.getBaseTypes()};oh.getTypeName=function(){return"AugLoop_Session_Protocol_OAuth2InitV2Message"};oh.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]};
oh.typeGuard=function(u){return Eb.matchesTypesFor(u,[oh.getTypeName()])};oh.H_={T_:oh.getTypeName(),B_:oh.getBaseTypes()};Jm.getTypeName=function(){return"AugLoop_Session_Protocol_OAuth2InitV2Response"};Jm.getBaseTypes=function(){return["AugLoop_Session_Protocol_Response"]};Jm.typeGuard=function(u){return Eb.matchesTypesFor(u,[Jm.getTypeName()])};Jm.H_={T_:Jm.getTypeName(),B_:Jm.getBaseTypes()};vk.getTypeName=function(){return"AugLoop_Session_Protocol_OAuth2InitMessage"};vk.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]};
vk.typeGuard=function(u){return Eb.matchesTypesFor(u,[vk.getTypeName()])};vk.H_={T_:vk.getTypeName(),B_:vk.getBaseTypes()};Rc.getTypeName=function(){return"AugLoop_Session_Protocol_OAuth2InitResponse"};Rc.getBaseTypes=function(){return["AugLoop_Session_Protocol_Response"]};Rc.typeGuard=function(u){return Eb.matchesTypesFor(u,[Rc.getTypeName()])};Rc.H_={T_:Rc.getTypeName(),B_:Rc.getBaseTypes()};Ll.getTypeName=function(){return"AugLoop_Session_Protocol_OAuth2CallbackMessage"};Ll.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]};
Ll.typeGuard=function(u){return Eb.matchesTypesFor(u,[Ll.getTypeName()])};Ll.H_={T_:Ll.getTypeName(),B_:Ll.getBaseTypes()};uk.getTypeName=function(){return"AugLoop_Session_Protocol_BridgeMessage"};uk.getBaseTypes=function(){return[]};uk.typeGuard=function(u){return Eb.matchesTypesFor(u,[uk.getTypeName()])};uk.H_={T_:uk.getTypeName(),B_:uk.getBaseTypes()};Uj.getTypeName=function(){return"AugLoop_Session_Protocol_SessionConnectMessage"};Uj.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]};
Uj.typeGuard=function(u){return Eb.matchesTypesFor(u,[Uj.getTypeName()])};Uj.H_={T_:Uj.getTypeName(),B_:Uj.getBaseTypes()};Pe.getTypeName=function(){return"AugLoop_Session_Protocol_SessionDisconnectMessage"};Pe.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]};Pe.typeGuard=function(u){return Eb.matchesTypesFor(u,[Pe.getTypeName()])};Pe.H_={T_:Pe.getTypeName(),B_:Pe.getBaseTypes()};Aj.getTypeName=function(){return"AugLoop_Session_Protocol_SessionReconnectMessage"};Aj.getBaseTypes=
function(){return["AugLoop_Session_Protocol_Message"]};Aj.typeGuard=function(u){return Eb.matchesTypesFor(u,[Aj.getTypeName()])};Aj.H_={T_:Aj.getTypeName(),B_:Aj.getBaseTypes()};ki.getTypeName=function(){return"AugLoop_Session_Protocol_SubmittedCustomMessage"};ki.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]};ki.typeGuard=function(u){return Eb.matchesTypesFor(u,[ki.getTypeName()])};ki.H_={T_:ki.getTypeName(),B_:ki.getBaseTypes()};em.getTypeName=function(){return"AugLoop_Session_Protocol_ServerAuthenticationStateChangeMessage"};
em.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]};em.typeGuard=function(u){return Eb.matchesTypesFor(u,[em.getTypeName()])};em.H_={T_:em.getTypeName(),B_:em.getBaseTypes()};zj.prototype.put=function(u,N,V,ka,wa,Ga,la){if(void 0===V||null===V||0>=V)throw Error("Cache timeout must be a positive number");if(void 0===wa||null===wa||0>=wa)wa=this.options.idleDurationMs;V={value:N,djd:wa?Date.now():void 0,I3c:V+Date.now(),idleDurationMs:wa,J3c:ka,xIe:Ga+Date.now(),TXb:la};this.cache.set(u,
V);this.timeout||(this.timeout=setInterval(this.onInterval.bind(this),this.interval),this.timeout.B7f&&this.timeout.B7f());return N};zj.prototype.del=function(u){if(this.options.delCallback){var N=this.cache.get(u);N&&this.options.delCallback(u,N.value)}u=this.cache.delete(u);0===this.size()&&this.clear();return u};zj.prototype.clear=function(){this.timeout&&(clearInterval(this.timeout),this.timeout=void 0);this.cache.clear()};zj.prototype.get=function(u){if(u=this.cache.get(u))return this.options.idleDurationMs&&
(u.djd=Date.now()),u.value};zj.prototype.keys=function(){return this.cache.keys()};zj.prototype.forEach=function(u){this.cache.forEach(function(N,V){u(N.value,V)})};zj.prototype.size=function(){return this.cache.size};zj.prototype.updateExpireTime=function(u,N){return this.cache.has(u)&&0<=N?(this.cache.get(u).I3c=N+Date.now(),!0):!1};zj.prototype.onInterval=function(){var u=this,N=Date.now();this.cache.forEach(function(V,ka){V.idleDurationMs&&V.djd<N-V.idleDurationMs?(u.del(ka),u.options.idleCallback&&
u.options.idleCallback(ka,V.value)):(V.I3c<N&&(u.del(ka),V.J3c&&V.J3c(ka,V.value)),V.xIe<N&&V.TXb&&(V.TXb(ka,V.value),V.TXb=void 0))})};var Df;(function(u){u.ClientDisconnected="Client disconnected.";u.UnsupportedSyncMessage="SyncMessages with seq = -1 are not supported anymore.";u.UnexpectedSeedMessage="Unexpected seed message";u.SyncMessageUnsupportedBatch="SyncMessage with unsupported batching.";u.AnnotationTokenNotFound="Token not found"})(Df||(Df={}));var Gg;(function(u){u.ProvisionTokenValidationError=
"Token provision message didn't pass token validation.";u.ProvisionTokenDecryptAndTransformError="Token provision message didn't pass token decrypt and transform."})(Gg||(Gg={}));Td.prototype.setClientMetadata=function(u){this.clientMetadata=u};Td.prototype.setEgress=function(u){this.egress=u};Td.prototype.ingress=function(u,N){var V=Eb.getBaseTypesFor(u),ka=Eb.getTypeNameFor(u);ka===yg.getTypeName()||V&&0<=V.indexOf(yg.getTypeName())?(this.processResponse(u),N()):this.processMessage(u,N);ka!==Ve.getTypeName()||
u.reconnectAllowed||this.clearAllPendingResponses()};Td.prototype.sendMessage=function(u,N,V,ka){function wa(){la.setClientMetadata(Ga.clientMetadata);la.success?wb.a.info(572836E3,wb.b.CoreDefault,la.stop()):(la.message=JSON.stringify({Jgg:"ErrorWithoutPendingResponse"===la.resultSignature||"ResponseCallbackException"===la.resultSignature||"We called into done callback"!==la.message}),wb.a.error(572836001,wb.b.CoreDefault,la.stop()))}var Ga=this;ka=void 0===ka?0:ka;var la=(new pg({sessionHealthEventName:"SendMessage",
source:this.source,reason:mi.Client,impact:this.source===ec.ClientRuntime?rn.MissingInput:rn.MissingOutput,success:!0,message:"",affectedWorkflows:["All"],cv:u.cv,resourceId:qo(Eb.getTypeNameFor(u)),dimension0:ka.toString()})).start();u.messageId=""+this.messageIdPrefix+this.nextMessageId++;var ab=Eb.getTypeNameFor(u)===Ve.getTypeName();if(!V&&!ab){var nb=function(sb,Db){var bc;sb?(la.success=!1,la.resultSignature=sb.error,la.resultDescription="Error for "+Eb.getTypeNameFor(u)+" message "+u.messageId+
": "+sb.error):la.resultSignature="Success";if(N)try{la.message="We called into done callback",N(sb,Db)}catch(Xb){la.success=!1,la.resultSignature="ResponseCallbackException",la.resultDescription="Web"===(null===(bc=Ga.clientMetadata)||void 0===bc?void 0:bc.appPlatform)?JSON.stringify({message:Xb.message,stack:Xb.stack}):JSON.stringify({message:Xb.message})}Ga.pendingMessageCallbacks.del(u.messageId);wa();Ga.updateSendMessageStats(la.success,la.durationMs,sb?Error(sb.error):void 0)};V=3E4;Bf.typeGuard(u)&&
(V=15E3<=u.longPollTimeoutHint&&3E5>=u.longPollTimeoutHint?u.longPollTimeoutHint+5E3:12E4);this.pendingResponseCallbacks.put(u.messageId,nb,V,function(){nb(new $k({error:"Timeout waiting for response"}),void 0)})}this.egress(u,function(sb){var Db,bc;if(sb){var Xb=Ga.pendingResponseCallbacks.get(u.messageId);Xb?(Ga.pendingResponseCallbacks.del(u.messageId),Xb(new Kh({messageId:u.messageId,error:sb.message}))):(ab?(la.success=null!==(bc=null===(Db=sb.message)||void 0===Db?void 0:Db.endsWith("Client disconnected."))&&
void 0!==bc?bc:!1,la.resultSignature="ErrorSendingSessionCloseMessage"):(la.success=!1,la.resultSignature="ErrorWithoutPendingResponse"),la.resultDescription="Error for "+Eb.getTypeNameFor(u)+" message "+u.messageId+": "+sb.message,wa())}})};Td.prototype.queryEgressCacheSize=function(){return this.pendingResponseCallbacks.size()};Td.prototype.onMessage=function(u,N){this.messageCallbacks.set(u,N)};Td.prototype.getStats=function(){return this.stats};Td.prototype.hasMessageCallback=function(u){return this.messageCallbacks.has(u)};
Td.prototype.cancelPendingResponseCallbacks=function(){var u=this;this.pendingResponseCallbacks.forEach(function(N,V){N&&(u.pendingResponseCallbacks.del(V),N(new Kh({messageId:V,error:"Cancelled"})))})};Td.prototype.clearAllPendingResponses=function(){if(0!=this.pendingResponseCallbacks.size()){var u=new Pc({operationName:"PurgePendingResponses",resultDescription:this.pendingResponseCallbacks.size().toString(),success:!0});wb.a.info(572836002,wb.b.CoreDefault,u);this.pendingResponseCallbacks.clear()}};
Td.prototype.processMessage=function(u,N){function V(Db,bc){wa.pendingMessageCallbacks.del(u.messageId);sb?(la.success=!1,la.resultSignature="OnResponseInvokedMoreThanOnce",la.resultDescription="Invoked onResponse for "+Eb.getTypeNameFor(u)+" message "+u.messageId+" more than once"):Db?(la.success=!1,la.resultSignature=Db.error,la.resultDescription="Error for "+Eb.getTypeNameFor(u)+" message "+u.messageId+": "+Db.error):la.resultSignature="Success";sb=!0;ka();Db&&!Eb.matchesTypesFor(Db,[Kh.getTypeName()])&&
(Db=new Kh({error:"Internal Server Error"}));wa.updateProcessMessageStats(la.success,la.durationMs,Db?Error(Db.error):void 0);Db?(Db.messageId=u.messageId,N(Db)):bc?(bc.messageId=u.messageId,N(void 0,bc)):N()}function ka(){la.setClientMetadata(wa.clientMetadata);la.success?wb.a.info(572836003,wb.b.CoreDefault,la.stop()):(la.message=JSON.stringify({Igg:"UnsupportedMessage"===la.resourceId||"Timeout"===la.resultSignature||"OnResponseInvokedMoreThanOnce"===la.resultSignature||"MessageCallbackException"===
la.resultSignature||"We called into messageCallback"!==la.message}),wb.a.error(572836032,wb.b.CoreDefault,la.stop()))}var wa=this,Ga,la=(new pg({sessionHealthEventName:"ProcessMessage",source:this.source,reason:mi.Client,impact:this.source===ec.ClientRuntime?rn.MissingOutput:rn.MissingInput,success:!0,message:"",affectedWorkflows:["All"],cv:u.cv})).start(),ab=this.messageCallbacks.get(Eb.getTypeNameFor(u));ab?la.resourceId=qo(Eb.getTypeNameFor(u)):ab=function(Db,bc){la.resourceId=qo(Eb.getTypeNameFor(Db));
"MalformedMessageName"!==la.resourceId&&(la.resourceId="UnsupportedMessage");bc(new Kh({messageId:Db.messageId,error:"Message type "+Eb.getTypeNameFor(Db)+" is not supported"}))};var nb=1E4;Bf.typeGuard(u)&&(nb=15E3<=u.longPollTimeoutHint&&3E5>=u.longPollTimeoutHint?u.longPollTimeoutHint+5E3:12E4);this.pendingMessageCallbacks.put(u.messageId,void 0,nb,function(){la.success=!1;la.resultSignature="Timeout";la.resultDescription="Timeout processing message callback";ka();wb.a.error(572836033,wb.b.CoreDefault,
"Timeout processing "+la.resourceId);wa.updateProcessMessageStats(!1,la.durationMs,Error("timeout"))});var sb=!1;try{la.message="We called into messageCallback",ab(u,V)}catch(Db){this.pendingMessageCallbacks.del(u.messageId),la.success=!1,la.resultSignature="MessageCallbackException",la.resultDescription="Web"===(null===(Ga=this.clientMetadata)||void 0===Ga?void 0:Ga.appPlatform)?JSON.stringify({message:Db.message,stack:Db.stack}):JSON.stringify({message:Db.message}),ka(),this.updateProcessMessageStats(!1,
la.durationMs,Db),N()}};Td.prototype.processResponse=function(u){var N,V=new Pc({operationName:"ProcessResponse"});V.success=!0;V.setClientMetadata(this.clientMetadata);V.start();if(u.messageId){var ka=this.pendingResponseCallbacks.get(u.messageId);ka?(this.pendingResponseCallbacks.del(u.messageId),Eb.matchesTypesFor(u,[Kh.getTypeName()])?ka(u):ka(void 0,u)):(V.resultSignature="NoPendingMessage",V.resultDescription=""+u.messageId,V.success=!1)}else V.resultSignature="NoMessageIdSetInResponse",Kh.typeGuard(u)?
V.resultDescription=u.error:V.resultDescription="MessageId is not available",V.success=!1;"Production"!==(null===(N=this.clientMetadata)||void 0===N?void 0:N.releaseAudienceGroup)&&(V.resourceId=qo(Eb.getTypeNameFor(u)),wb.a.info(572836034,wb.b.CoreDefault,V.stop()))};Td.prototype.updateSendMessageStats=function(u,N,V){this.stats.sendMessageCount++;this.stats.sendMessageDurationMsMax=Math.max(N,this.stats.sendMessageDurationMsMax);u||V?u&&V&&wb.a.warn(572836036,wb.b.CoreDefault,"Succeeded send message provided error object."):
wb.a.warn(572836035,wb.b.CoreDefault,"Failed send message did not provide error object.");u||(V&&V.message===Df.ClientDisconnected?this.stats.sendMessageClientDisconnectedErrors++:this.stats.sendMessageErrors++)};Td.prototype.updateProcessMessageStats=function(u,N,V){this.stats.processMessageCount++;this.stats.processMessageDurationMsMax=Math.max(N,this.stats.processMessageDurationMsMax);u||V?u&&V&&wb.a.warn(572836038,wb.b.CoreDefault,"Succeeded process message provided error object."):wb.a.warn(572836037,
wb.b.CoreDefault,"Failed process message did not provide error object.");u||(V&&V.message===Gg.ProvisionTokenValidationError?this.stats.processMessageProvisionTokenErrors++:this.stats.processMessageErrors++)};var Ri=e(1107),dr=e(1151),zq=e.n(dr),sn;(function(u){u.ArrivedBeforeReseeding="Message is dropped from queue since it arrived before reseeding is started";u.DroppedAsOldestInQueue="Message is dropped as oldest in full queue";u.DroppedBecauseClientDisconnected="Message is dropped because client is disconnected from server"})(sn||
(sn={}));ji.prototype.clear=function(){this.queue.clear()};ji.prototype.size=function(){return this.queue.length};ji.prototype.push=function(u,N,V){var ka=this,wa=this.queue;if(1E3===wa.length){this.messageQueueLogCountLimiter.log(function(){ka.logOp.resourceId="QueueFull";ka.logOp.durationMs=0;wb.a.warn(508843746,wb.b.CoreDefault,ka.logOp)});var Ga=wa.shift();if(Ga.onResponse)Ga.onResponse(new Kh({error:sn.DroppedAsOldestInQueue}))}wa.push({message:u,onResponse:N,t4f:mc.getCurrentTimeMs(),Die:V})};
ji.prototype.sendOnSessionInitialized=function(u){var N=this,V=this.queue.length,ka=0;if(0<V){for(var wa=mc.getCurrentTimeMs()-this.queue.get(0).t4f;0<this.queue.length&&this.callbacks.canSendMessage();){var Ga=this.queue.shift();if(u&&Ga.message instanceof Te&&Eb.matchesTypesFor(Ga.message,[Te.getTypeName()])&&(!this.callbacks.dropOnlySequencedSyncsOnReseed||0<=Ga.message.seq)){if(ka++,Ga.onResponse)Ga.onResponse(new Kh({error:sn.ArrivedBeforeReseeding}))}else Ga.message instanceof Uint8Array?this.callbacks.sendBytes(Ga.message):
this.callbacks.sendMessage(Ga.message,Ga.onResponse,Ga.Die)}this.messageQueueLogCountLimiter.log(function(){N.logOp.resourceId="SendOnSessionInitialized";N.logOp.resultDescription="Queue size before: "+V+", after: "+N.queue.length+". droppedSyncMessages: "+ka;N.logOp.durationMs=wa;wb.a.warn(508843745,wb.b.CoreDefault,N.logOp)})}};var Ed;(function(u){u[u.Initing=0]="Initing";u[u.Running=1]="Running";u[u.Disconnected=2]="Disconnected";u[u.Closed=3]="Closed"})(Ed||(Ed={}));kg.prototype.onEnter=function(){};
kg.prototype.sendMessage=function(){};kg.prototype.sendBytes=function(){};kg.prototype.canSendMessage=function(){return!1};kg.prototype.onConnectionClose=function(){};D.ha(qd,kg);qd.prototype.sendMessage=function(u,N,V){Eb.matchesTypesFor(u,[xg.getTypeName()])?gf(this.context,u,N,V):tk(this.context,u,N)};qd.prototype.sendBytes=function(u){Lg(this.context,u)};qd.prototype.onConnectionClose=function(){this.context.setState(Ed.Disconnected)};D.ha(Pf,kg);Pf.prototype.onEnter=function(u){u&&u.isSessionReseedingStarted&&
this.context.resetNextSyncSequenceId();this.context.messageQueue.sendOnSessionInitialized(u&&u.isSessionReseedingStarted)};Pf.prototype.sendMessage=function(u,N,V){gf(this.context,u,N,V)};Pf.prototype.sendBytes=function(u){u&&void this.context.networkWorkerManager.egressBytes(u)};Pf.prototype.canSendMessage=function(){return!0};Pf.prototype.onConnectionClose=function(){this.context.setState(Ed.Disconnected)};D.ha(ii,kg);ii.prototype.onEnter=function(){this.context.messageEndpoint.cancelPendingResponseCallbacks()};
ii.prototype.sendMessage=function(u,N,V,ka){Eb.matchesTypesFor(u,[xg.getTypeName()])?(this.context.setState(Ed.Initing),gf(this.context,u,N,V)):Eb.matchesTypesFor(u,[Ve.getTypeName()])?this.context.setState(Ed.Closed):ka?N&&N(new Kh({messageId:u.messageId,error:sn.DroppedBecauseClientDisconnected})):tk(this.context,u,N,V)};ii.prototype.sendBytes=function(u){Lg(this.context,u)};D.ha(ik,kg);ik.prototype.onEnter=function(){this.context.messageEndpoint.cancelPendingResponseCallbacks()};var tt=e(1172);
hk.prototype.tryProcessNextRequest=function(){this.requestInProgress=!1;if(0<this.queuedRequests.length){var u=D.makeIterator(this.queuedRequests.shift()),N=u.next().value,V=u.next().value;u=u.next().value;clearTimeout(u);this.add(N,V)}};hk.prototype.add=function(u,N){var V=this;if(this.requestInProgress){var ka=setTimeout(function(){N(Error("Timed out waiting in queue"),null);V.queuedRequests.shift()},this.queueTimeout);this.queuedRequests.push([u,N,ka])}else this.requestInProgress=!0,(new Promise(function(wa,
Ga){var la=!1,ab=setTimeout(function(){la=!0;Ga(Error("Fetch timed out"))},V.fetchTimeout);V.fetch(u).then(function(nb){la||(clearTimeout(ab),wa(nb))}).catch(function(nb){la||(clearTimeout(ab),Ga(nb))})})).then(function(wa){N(null,wa);V.tryProcessNextRequest()}).catch(function(wa){N(wa,null);V.tryProcessNextRequest()})};var im=e(1095),Tn=new hk(im.fetch,2E4,12E4);Uf.prototype.start=function(){mc.collectTelemetry(this.pingPongLogOp,this.logCountLimiter,!0,"ping","initial ping");this.isPingPongSuccessful=
!0;this.ping();this.startInterval()};Uf.prototype.onResponse=function(){this.lastPongTime=Date.now()};Uf.prototype.isReliabilityResponse=function(u){return"string"===typeof u&&1===u.length&&u===Uf.pingPongMessage};Uf.prototype.close=function(){this.lastPongTime=this.lastPingTime=0;this.isPingPongSuccessful=!1;this.clearPingInterval();this.worker=void 0};Uf.prototype.checkConnection=function(){return this.isPingPongSuccessful};Uf.prototype.postEgress=function(){this.lastEgressTime=Date.now()};Uf.prototype.needsParsedResponses=
function(){return!1};Uf.prototype.ping=function(){this.lastPingTime=Date.now();this.worker&&this.worker.egress({obj:Uf.pingPongMessage})};Uf.prototype.startInterval=function(){var u=this;this.pingInterval=setInterval(function(){u.isPingPongSuccessful=u.lastPongTime>=u.lastPingTime&&3E4>=u.lastPongTime-u.lastPingTime;if(!(u.lastPongTime>u.lastEgressTime)){var N=u.lastPongTime-u.lastPingTime;u.isPingPongSuccessful?(u.remainingPingFailures=3,mc.collectTelemetry(u.pingPongLogOp,u.logCountLimiter,!0,"ping",
"WebSocket channel active",[""+N,""+u.remainingPingFailures]),u.ping()):0<u.remainingPingFailures?(--u.remainingPingFailures,mc.collectTelemetry(u.pingPongLogOp,u.logCountLimiter,!0,"ping","Pong not received within 30000 ms",[""+N,""+u.remainingPingFailures]),u.ping()):(mc.collectTelemetry(u.pingPongLogOp,u.logCountLimiter,!1,"ping","Pong still not received after all retry attempts",[""+N,""+u.remainingPingFailures]),u.closeWorkerOnReliabilityFailure&&u.worker?u.worker.close():u.rateControllerClose())}},
3E4)};Uf.prototype.clearPingInterval=function(){this.pingInterval&&(clearInterval(this.pingInterval),this.pingInterval=void 0)};Uf.pingPongMessage="~";Uf.className="WebSocketReliabilityManager";var wl=JSON.stringify(new Bf({longPollTimeoutHint:15E3}));Ie.prototype.start=function(){var u=(new Pc({operationName:"StartHttpReliabilityManager",success:!0})).start();wb.a.info(508163399,wb.b.CoreDefault,u.stop());this.trySendLongPoll(!0);this.isLongPollSuccessful=!0};Ie.prototype.onResponse=function(u){!u||
this.isResponseReceived?(u=(new Pc({operationName:"HttpReliabilityManagerFailure",success:!1})).start(),wb.a.info(508162497,wb.b.CoreDefault,u.stop())):(this.isResponseReceived=!0,this.isActiveLongPoll=!1,u.error?(this.isLongPollSuccessful=!1,--this.remainingRetryAttempts,0<this.remainingRetryAttempts?(this.longPollLogOp.success=!1,this.longPollLogOp.resultDescription="Retry attempts left : "+this.remainingRetryAttempts,this.longPollLogOp.resultSignature=u.error,wb.a.info(508163398,wb.b.CoreDefault,
this.longPollLogOp.stop()),"Request timed out"===u.error||3===this.remainingRetryAttempts?this.trySendLongPoll(!0):this.enqueueSendLongPoll()):(this.longPollLogOp.success=!1,this.longPollLogOp.resultDescription="Long poll still not received after all retry attempts",wb.a.info(508163397,wb.b.CoreDefault,this.longPollLogOp.stop()),this.worker&&this.worker.close())):(this.longPollLogOp.success=!0,this.longPollLogOp.resultDescription="Long poll received",wb.a.info(508163401,wb.b.CoreDefault,this.longPollLogOp.stop()),
this.remainingRetryAttempts=4,this.isLongPollSuccessful=!0,this.trySendLongPoll()))};Ie.prototype.close=function(){var u=(new Pc({operationName:"CloseHttpReliabilityManager",success:!0})).start();wb.a.info(508162467,wb.b.CoreDefault,u.stop());this.sendLongPollTimer&&(clearTimeout(this.sendLongPollTimer),this.sendLongPollTimer=void 0);this.isLongPollSuccessful=this.isActiveLongPoll=!1;this.worker=void 0};Ie.prototype.checkConnection=function(){if(this.isAsleep){var u=(new Pc({operationName:"AwakenHttpReliabilityManager",
success:!0})).start();wb.a.info(508162496,wb.b.CoreDefault,u.stop());this.trySendLongPoll(!0);this.isAsleep=!1}return this.isLongPollSuccessful};Ie.prototype.isReliabilityResponse=function(u){return"string"!==typeof u&&zh.typeGuard(u)};Ie.prototype.postEgress=function(){this.lastEgressTime=Date.now();this.trySendLongPoll()};Ie.prototype.needsParsedResponses=function(){return!0};Ie.prototype.enqueueSendLongPoll=function(){var u=this;this.sendLongPollTimer=setTimeout(function(){u.trySendLongPoll(!0)},
2E4)};Ie.prototype.trySendLongPoll=function(u){!0===this.isActiveLongPoll?(u=(new Pc({operationName:"LongPollNoOp",success:!0})).start(),u.resultDescription="Already active long poll",wb.a.info(508163396,wb.b.CoreDefault,u.stop())):6E4<Date.now()-this.lastEgressTime&&!u?(u=(new Pc({operationName:"LongPollNoOp",success:!0})).start(),u.resultDescription="Sleeping due to inactivity",wb.a.info(508162466,wb.b.CoreDefault,u.stop()),this.isAsleep=!0):this.worker&&(this.longPollLogOp.start(),this.isActiveLongPoll=
!0,this.isResponseReceived=!1,this.worker.egress({obj:wl,isHttpSessionLongPollMessage:!0,isHttpSessionInitMessage:!1}))};var Wr=JSON.stringify(new zh({error:"Failed to parse response from server"})),Ph=JSON.stringify(new zh({error:"Failed to receive succesful response from server"})),um=JSON.stringify(new zh({error:"Catched error received"})),Xr=JSON.stringify(new zh({error:"Request timed out"}));He.prototype.init=function(u,N,V,ka,wa,Ga){this.url=mc.convertWebSocketUrlToHttp(u);this.ingress=N;this.onOpen=
V;this.onClose=ka;this.jsond2ContentTypeEnabled=null!==Ga&&void 0!==Ga?Ga:!1};He.prototype.egress=function(u){var N=this,V=(new Pc({operationName:"HttpEgress",success:!0})).start();if(this.isConnectedToSession()||u.isHttpSessionInitMessage){var ka=this.getRequestInfo(u);ka.url?u.isHttpSessionLongPollMessage?this.egressLongPoll(ka,V):tm(ka.url,ka.request,function(wa,Ga){wa?(V.success=!1,V.resultDescription="OnEgressError:"+(null===wa||void 0===wa?void 0:wa.message),wb.a.info(508163392,wb.b.CoreDefault,
V.stop())):Ga&&Ga.ok?Ga.text().then(function(la){V.success=!0;V.resultDescription="ResponseReceived";wb.a.info(508163362,wb.b.CoreDefault,V.stop());N.ingressInternal(la)}).catch(function(la){V.success=!1;V.resultDescription="OnEgressParseError: "+(null===la||void 0===la?void 0:la.message);wb.a.info(508163361,wb.b.CoreDefault,V.stop())}):(V.success=!1,V.resultDescription="OnEgressResponseError: "+(null===wa||void 0===wa?void 0:wa.message),V.resultDescription="Status "+(null===Ga||void 0===Ga?void 0:
Ga.status)+": "+(null===Ga||void 0===Ga?void 0:Ga.statusText),wb.a.info(508163363,wb.b.CoreDefault,V.stop()))}):(V.success=!1,V.resultDescription="Could not generate HTTP request",wb.a.info(508163393,wb.b.CoreDefault,V.stop()))}else this.pendingEgress.push(u),V.success=!1,V.resultDescription="NotConnected, pendingQueueSize:  "+this.pendingEgress.length.toString(),wb.a.info(508163394,wb.b.CoreDefault,V.stop())};He.prototype.close=function(){var u=(new Pc({operationName:"HttpWorkerClose",success:!0})).start();
this.isClosing?(u.resultDescription="AlreadyClosing",wb.a.info(508163360,wb.b.CoreDefault,u.stop())):(wb.a.info(508163359,wb.b.CoreDefault,u.stop()),this.isClosing=!0,this.sessionSettings=void 0,this.onClose&&(this.onClose(void 0),this.onClose=void 0),this.isClosing=!1)};He.prototype.ingressInternal=function(u,N){function V(Ga){if(bh.typeGuard(Ga))ka.onSessionInitResponse(Ga)}var ka=this,wa=u;N||(wa=this.formatServerInput(u));wa&&(this.logIngressCount(wa),this.ingress(wa,V))};He.prototype.onSessionInitResponse=
function(u){var N=this,V=(new Pc({operationName:"HttpWorkerOpen",success:!0})).start();u.sessionKey&&u.origin&&u.anonymousToken&&u.sessionUrlBase?(wb.a.info(508163357,wb.b.CoreDefault,V.stop()),this.setSessionSettings(u.sessionKey,u.origin,u.anonymousToken,u.sessionUrlBase),this.onOpen(),this.pendingEgress.forEach(function(ka){N.egress(ka)}),this.pendingEgress=[]):(V.success=!1,V.resultDescription="SessionInitResponse missing information",wb.a.info(508163358,wb.b.CoreDefault,V.stop()))};He.prototype.egressLongPoll=
function(u,N){var V=this;Ro(u.url,2E4,u.request).then(function(ka){ka&&ka.ok?ka.text().then(function(wa){N.success=!0;N.resultDescription="LongPollResponseReceived";wb.a.info(508163355,wb.b.CoreDefault,N.stop());V.ingressInternal(wa)}).catch(function(wa){N.success=!1;N.resultDescription="LongPollFetchParseError:"+(null===wa||void 0===wa?void 0:wa.message);wb.a.info(508163354,wb.b.CoreDefault,N.stop());V.ingressInternal(Wr,!0)}):(N.success=!1,N.resultDescription="LongPollFetchStatusFailure: "+(null===
ka||void 0===ka?void 0:ka.statusText),wb.a.info(508163356,wb.b.CoreDefault,N.stop()),V.ingressInternal(Ph,!0))}).catch(function(ka){"Request timed out"===ka.message?(N.success=!1,N.resultDescription="LongPollFetchResponseTimeout:"+(null===ka||void 0===ka?void 0:ka.message),wb.a.info(508163353,wb.b.CoreDefault,N.stop()),V.ingressInternal(Xr,!0)):(N.success=!1,N.resultDescription="LongPollFetchResponseError: "+(null===ka||void 0===ka?void 0:ka.message),wb.a.info(508163352,wb.b.CoreDefault,N.stop()),
V.ingressInternal(um,!0))})};He.prototype.getRequestInfo=function(u){return{url:this.getUrl(null===u||void 0===u?void 0:u.isHttpSessionInitMessage),request:{method:"POST",headers:this.getHeader(u),body:u.obj}}};He.prototype.getUrl=function(u){var N=this.sessionSettings&&this.sessionSettings.sliceUrl?this.sessionSettings.sliceUrl:this.url;return u?N+"/sessioninit":this.isConnectedToSession()?N+"/session/"+this.sessionSettings.sessionKey:""};He.prototype.getHeader=function(u){return(null===u||void 0===
u?0:u.isHttpSessionInitMessage)?new im.Headers({"Content-Type":"application/json"}):this.isConnectedToSession()?(u=this.jsond2ContentTypeEnabled&&(u.obj instanceof Uint8Array||u.obj instanceof ArrayBuffer)?new im.Headers({"Content-Type":"application/jsond2"}):new im.Headers({"Content-Type":"application/json"}),u.append("Authorization","Bearer "+this.sessionSettings.anonymousToken),u.set("x-origin",this.sessionSettings.origin),u):new im.Headers};He.prototype.setSessionSettings=function(u,N,V,ka){ka=
ka.replace("/session","");this.sessionSettings={sessionKey:u,origin:N,anonymousToken:V,sliceUrl:ka}};He.prototype.isConnectedToSession=function(){return this.sessionSettings&&0<this.sessionSettings.sessionKey.length&&0<this.sessionSettings.anonymousToken.length&&0<this.sessionSettings.origin.length&&0<this.sessionSettings.sliceUrl.length};He.prototype.formatServerInput=function(u){return 1<u.length?u.substring(1,u.length-1):""};He.prototype.logIngressCount=function(u){u=u.length;if(1E5<u){var N=(new Pc({operationName:"HttpIngressByteOrderOfMagnitude",
success:!0})).start();N.dimension2=u.toString().length.toString();wb.a.info(508409622,wb.b.CoreDefault,N.stop())}};Rd.prototype.init=function(u,N,V,ka,wa){var Ga=this;this.worker=u;this.ingress=N;this.queryEgressCacheSize=V;this.clientMetadata=wa;this.egressRateControlTimer=setInterval(function(){return Ga.flush()},1E3);this.networkMode=ka;this.reliabilityManager=gh(this.worker,this.close.bind(this),this.closeWorkerOnReliabilityFailureEnabled);this.resolveInitPromise()};Rd.prototype.open=function(){var u=
this;this.initPromise.then(function(){u.reliabilityManager?(u.collectTelemetry(!0,"OnOpen"),u.egressRateControlIntervalStart=Date.now(),u.reliabilityManager.start(),u.flush()):u.collectTelemetry(!1,"OnOpenFailure","Reliability Manager is undefined")}).catch(function(N){u.collectTelemetry(!1,"OnOpenFailure",N)})};Rd.prototype.ingressFromWorker=function(u,N){var V=this;if(this.reliabilityManager)if(!this.reliabilityManager.needsParsedResponses()&&this.reliabilityManager.isReliabilityResponse(u))this.reliabilityManager.onResponse();
else this.ingress(u,function(ka){null===N||void 0===N?void 0:N(ka);if(V.reliabilityManager.needsParsedResponses()&&V.reliabilityManager.isReliabilityResponse(ka))V.reliabilityManager.onResponse(ka)});else this.collectTelemetry(!1,"ingressFromWorkerFailure","Reliability Manager is undefined")};Rd.prototype.close=function(){var u;this.collectTelemetry(!0,"OnClose");null===(u=this.reliabilityManager)||void 0===u?void 0:u.close();this.worker=void 0;this.prevSeq=-1;this.clearEgressControlTimeout();this.reliabilityManager=
void 0};Rd.prototype.clearMessageQueues=function(){this.pendingQueue=[];this.egressedCache.clear()};Rd.prototype.egress=function(u){var N;if(this.reliabilityManager){var V=this.getMessageSize(u);if(V>=this.messageMaxSize)this.collectTelemetry(!0,"Message size exceeded "+this.messageMaxSize,""+V);else if((u.obj instanceof ArrayBuffer||u.isHttpSessionInitMessage)&&this.worker)this.worker.egress(u);else{this.validateSyncMessage(u.messageId,u.seqId);var ka=this.egressMessageCount>=this.rpsThreshold||
this.egressByteCount>=this.bpsThreshold;V=this.queryEgressCacheSize();var wa=this.pendingQueue.length>this.pendingMaxSize||V>this.egressedMaxSize,Ga=this.reliabilityManager.checkConnection(),la=0==this.pendingQueue.length;!Ga||ka||!la||wa?(ka=this.pendingQueue.length>=this.pendingMaxSize?"Pending queue max exceeded. ":la?"":"Pending queue not empty",ka+=V>=this.egressedMaxSize?"Egressed cache max exceeded. ":"",ka+=this.egressMessageCount>=this.rpsThreshold?"RPS exceeded. ":"",ka+=this.egressByteCount>=
this.bpsThreshold?"BPS exceeded. ":"",this.collectTelemetry(!0,ka+(Ga?"":"Not connected"),"pendingQueueSize: "+this.pendingQueue.length+" | egressCacheSize: "+V+" | rpsThreshold: "+this.rpsThreshold+" | bpsThreshold: "+this.bpsThreshold),V=null!==(N=u.messageId)&&void 0!==N?N:"id"+this.emptyMessageId++,this.pendingQueue.push({obj:u.obj,seqId:null===u||void 0===u?void 0:u.seqId,messageId:V,isHttpSessionInitMessage:null===u||void 0===u?void 0:u.isHttpSessionInitMessage})):this.sendToNetworkWorker(u)}}else this.collectTelemetry(!1,
"EgressFailure","Reliability Manager is undefined")};Rd.prototype.getMessageSize=function(u){return u.obj instanceof ArrayBuffer?u.obj.byteLength:u.obj.length};Rd.prototype.sendToNetworkWorker=function(u){try{if(this.worker)if(this.reliabilityManager){this.worker.egress(u);this.reliabilityManager.postEgress();var N=this.getMessageSize(u);this.logEgressCount(N)}else this.collectTelemetry(!1,"SendToNetworkWorkerFailure","Reliability Manager is undefined");else this.collectTelemetry(!1,"SendToNetworkWorkerFailure",
"NetworkWorker is undefined")}catch(V){this.collectTelemetry(!1,"sendToWorker",V?V.message:"")}};Rd.prototype.flush=function(){if(this.reliabilityManager)for(var u=0,N=0;0<this.pendingQueue.length&&this.queryEgressCacheSize()<this.egressedMaxSize&&u<this.rpsThreshold&&N<this.bpsThreshold&&this.reliabilityManager.checkConnection();){var V=this.pendingQueue.shift();this.sendToNetworkWorker(V);u++;N+=this.getMessageSize(V)}else this.collectTelemetry(!1,"FlushFailure","Reliability Manager is undefined")};
Rd.prototype.clearEgressControlTimeout=function(){this.egressRateControlTimer&&(clearInterval(this.egressRateControlTimer),this.egressRateControlTimer=void 0)};Rd.prototype.validateSyncMessage=function(u,N){void 0===N||void 0===u||N<=this.prevSeq||(N&&N!==this.prevSeq+1&&this.collectTelemetry(!0,"abandonedSyncMessage","Gap in sync message",[""+this.prevSeq,""+N,""+(N-this.prevSeq)]),this.prevSeq=N)};Rd.prototype.logEgressCount=function(u){var N,V=Date.now();if(1E3<V-this.egressRateControlIntervalStart){if(50<
this.egressMessageCount||1E5<this.egressByteCount)this.egressRateLogOp.start(),this.egressRateLogOp.resultDescription=50<this.egressMessageCount?"rps limit exceeded":"",this.egressRateLogOp.resultDescription=1E5<this.egressByteCount?"bps limit exceeded":"",this.egressRateLogOp.dimension0=(V-this.egressRateControlIntervalStart).toString(),this.egressRateLogOp.dimension1=""+this.egressMessageCount,this.egressRateLogOp.dimension2=""+this.egressByteCount,this.egressRateLogOp.dimension3="networkMode: "+
this.networkMode,wb.a.info(508843792,wb.b.CoreDefault,this.egressRateLogOp.stop());"Production"!==(null===(N=this.clientMetadata)||void 0===N?void 0:N.releaseAudienceGroup)&&(N=this.queryEgressCacheSize(),this.collectTelemetry(!0,"networkMode: "+this.networkMode,"egress",[""+(0===this.pendingQueue.length?"0":this.pendingQueue.length.toString().length),""+(0===N?"0":N.toString().length),this.rpsThreshold+" | "+this.bpsThreshold]));this.egressRateControlIntervalStart=V;this.egressByteCount=this.egressMessageCount=
0}this.egressMessageCount++;this.egressByteCount+=null!==u&&void 0!==u?u:0};Rd.prototype.collectTelemetry=function(u,N,V,ka){var wa=Array(4).fill("");if(ka)for(var Ga=0;Ga<ka.length;Ga++)wa[Ga]=ka[Ga];wa[3]=wa[3]?wa[3]:"networkMode: "+this.networkMode;mc.collectTelemetry(this.egressLogOp,this.logCountLimiter,u,V,N,wa)};Rd.className="NetworkRateController";var Si;(function(u){u[u.JSWebSockets=0]="JSWebSockets";u[u.LocalWorkflowsOnly=1]="LocalWorkflowsOnly";u[u.HostWebSockets=2]="HostWebSockets";u[u.HttpFallback=
3]="HttpFallback"})(Si||(Si={}));Vc.prototype.init=function(u,N,V){function ka(){if(V||!wa.alreadyLoggedReconnectAttempt){var Ga=V?Vc.initialAttemptTimeout:Vc.reconnectAttemptTimeout;wa.connTimeout=setTimeout(function(){var la=new Pc({operationName:"ConnectionFailingOrSlow",dimension0:V?"Initial":"Reconnect",dimension1:Ga.toString(),dimension2:wa.currentReconnectAttempt.toString()});wb.a.info(508843787,wb.b.CoreDefault,la);wa.alreadyLoggedReconnectAttempt=!V;wa.connTimeout=void 0},Ga)}}var wa=this;
V=void 0===V?!1:V;if(this.permanentlyClosed)return Promise.reject(Error("permanentlyClosed"));if(this.isWorkerReady||this.pendingInitPromise)return this.pendingInitPromise?this.pendingInitPromise:Promise.resolve();this.extensionConfigs=u||this.extensionConfigs;N?this.pendingInitPromise=N().catch(function(Ga){Ga=new Pc({operationName:"WorkerManagerCustomInit",success:!1,resultDescription:""+Ga});wb.a.error(508843786,wb.b.CoreDefault,Ga)}).then(function(){ka();wa.initInternal()}):(this.pendingInitPromise=
Promise.resolve(),ka(),this.initInternal());return this.pendingInitPromise};Vc.prototype.egress=function(u){var N=this;if(!this.isWorkerReady&&this.pendingInitPromise)return this.pendingInitPromise.then(function(){N.egressInternal(u)});this.egressInternal(u);return Promise.resolve()};Vc.prototype.egressBytes=function(u){var N=this;if(!this.isWorkerReady&&this.pendingInitPromise)return this.pendingInitPromise.then(function(){N.egressBytesInternal(u)});this.egressBytesInternal(u);return Promise.resolve()};
Vc.prototype.getNetworkMode=function(){return this.networkMode};Vc.prototype.close=function(u){this.isWorkerReady=!1;this.worker&&(this.worker.close(),this.worker=null);this.improvedWebSocketEnabled&&(this.networkRateController&&this.getNetworkRateController().close(),this.networkRateController=null);if(this.permanentlyClosed=u||this.permanentlyClosed)this.leaveOfflineMode(),clearTimeout(this.connTimeout)};Vc.prototype.initInternal=function(){var u=this;this.isWorkerReady=!1;if(this.permanentlyClosed||
this.isOffline()){var N=new Pc({operationName:"WorkerManagerInitOffline",success:!0,resultSignature:this.permanentlyClosed?"PermanentlyClosed":"Offline"});wb.a.info(508843785,wb.b.CoreDefault,N)}else 0<this.currentReconnectAttempt?setTimeout(function(){u.tryToConnectAndInitializeSession()},lf(this.currentReconnectAttempt,this.lastInitializationAttemptTimeMs,this.httpFallbackEnabled?this.httpTestsSuccessCount:void 0)):this.tryToConnectAndInitializeSession()};Vc.prototype.egressInternal=function(u){if(this.isWorkerReady||
Eb.matchesTypesFor(u,[xg.getTypeName()])){if(Eb.matchesTypesFor(u,[Km.getTypeName()])){this.castBinaryData(u);var N=tt.a.serialize(u)}else N=JSON.stringify(u);if(this.improvedWebSocketEnabled){if(Te.typeGuard(u))var V=u.seq;if(this.bypassRateController(u))this.worker.egress({obj:N});else{var ka=xg.typeGuard(u)&&this.getNetworkMode()===Si.HttpFallback;this.getNetworkRateController().egress({obj:N,isHttpSessionInitMessage:ka,messageId:u.messageId,seqId:V})}}else this.worker.egress({obj:N})}else Eb.matchesTypesFor(u,
[yg.getTypeName()])||wb.a.error(508843784,wb.b.CoreDefault,new Pc({operationName:"UnexpectedEgressCall",resultDescription:"isWorkerReady: "+this.isWorkerReady}))};Vc.prototype.bypassRateController=function(u){return Ve.typeGuard(u)};Vc.prototype.egressBytesInternal=function(u){this.isWorkerReady?this.improvedWebSocketEnabled?this.getNetworkRateController().egress({obj:u}):this.worker.egress({obj:u}):wb.a.error(508843783,wb.b.CoreDefault,new Pc({operationName:"UnexpectedEgressBytesCall",resultDescription:"isWorkerReady: "+
this.isWorkerReady}))};Vc.prototype.tryToConnectAndInitializeSession=function(){function u(ka){N.permanentlyClosed||N.isOffline()||(N.connect(N.sliceUrl?N.sliceUrl:N.globalUrl),N.sessionInitializer.initSession({isTokenRefresh:!1,isReconnectOnSameSlice:!!N.sliceUrl,extensionConfigs:N.extensionConfigs,onResponse:function(wa,Ga){ka.success=!wa;ka.resourceId=Ga?Ga.sliceUrl:"";ka.dimension2=N.getNetworkModeLogString();N.getNetworkMode()===Si.HttpFallback?(ka.resultDescription=wa?"HTTP Error: "+wa.error:
"",ka.dimension0=ka.success?"HTTPOK":"HTTPFail"):(ka.resultDescription=wa?"WS Error: "+wa.error:"",ka.dimension0=ka.success?"WSOK":"WSFail");if(wa||!N.worker)N.sliceUrl=void 0,N.close(),0<N.httpTestsLeft?(N.httpTestsLeft--,N.testHttpConnection(ka.stop())):(N.httpFallbackEnabled&&N.improvedWebSocketEnabled?N.getNetworkMode()===Si.JSWebSockets?0===N.workerOpenCount&&5<=N.httpTestsSuccessCount?(ka.dimension1="WSBlocked",ka.dimension3="HTTP Fallback",N.networkMode=Si.HttpFallback,N.currentReconnectAttempt=
0,N.resetHttpTestsCounter()):N.sessionOfflineModeEnabled&&0===N.httpTestsSuccessCount&&(N.startOfflineMode(),ka.dimension1="WSOffline"):N.sessionOfflineModeEnabled&&0===N.httpTestsSuccessCount&&(N.startOfflineMode(),ka.dimension1="HTTPOffline"):N.closeWSBlockedSession&&0===N.workerOpenCount&&5<=N.httpTestsSuccessCount?(N.permanentlyClosed=!0,ka.dimension1="WSBlocked",ka.dimension3="CloseWSBlockedSession",N.onDetectedWSBlock()):N.sessionOfflineModeEnabled&&0===N.httpTestsSuccessCount&&(N.startOfflineMode(),
ka.dimension1="WSOffline"),N.logCountLimiter.log(function(){wb.a.info(508843782,wb.b.CoreDefault,ka.stop())})),N.initInternal();else{N.logCountLimiter.log(function(){wb.a.info(508843781,wb.b.CoreDefault,ka.stop())});if(Ga.forceReconnect){N.close();var la=(new Pc({operationName:"ForcedReconnect"})).start();la.resultSignature="globalUrl: "+N.globalUrl+". sliceUrl: "+N.sliceUrl;N.sliceUrl=void 0;setTimeout(function(){u(la)},1E3)}else clearTimeout(N.connTimeout),N.sliceUrl=Ga.sliceUrl,N.ready();N.resetHttpTestsCounter()}}}))}
var N=this;this.currentReconnectAttempt++;this.lastInitializationAttemptTimeMs=mc.getCurrentTimeMs();var V=(new Pc({operationName:"TryToConnectAndInitializeSession",resultSignature:"Reconnection attempt #"+this.currentReconnectAttempt})).start();u(V)};Vc.prototype.getNetworkRateController=function(){this.networkRateController||(this.networkRateController=new Rd(this.networkRateSettings,this.closeWorkerOnReliabilityFailureEnabled));return this.networkRateController};Vc.prototype.connect=function(u){var N=
this,V=this.getNetworkMode();this.networkWorkerLogOp.start();this.networkWorkerLogOp.resultDescription=this.getNetworkModeLogString();this.networkWorkerLogOp.dimension0=V.toString();this.logCountLimiter.log(function(){return wb.a.info(508372418,wb.b.CoreDefault,N.networkWorkerLogOp.stop())});this.worker=this.workerFactory(V);this.worker.init(u,this.improvedWebSocketEnabled?this.getNetworkRateController().ingressFromWorker.bind(this.networkRateController):this.ingress,function(){N.workerOpenCount++;
N.improvedWebSocketEnabled&&N.getNetworkRateController().open();N.leaveOfflineMode()},function(ka){N.close();N.onConnectionClose(ka)},this.improvedWebSocketEnabled,this.jsond2ContentTypeEnabled);this.improvedWebSocketEnabled&&this.getNetworkRateController().init(this.worker,this.ingress,this.queryEgressCacheSize,V,this.clientMetadata)};Vc.prototype.ready=function(){this.isWorkerReady=!0;this.pendingInitPromise=void 0;this.currentReconnectAttempt=0};Vc.prototype.castBinaryData=function(u){if(u){if(Array.isArray(u.HUd))for(var N=
D.makeIterator(u.HUd),V=N.next();!V.done;V=N.next())V=V.value,ArrayBuffer.isView(u[V])||(u[V]=new Uint8Array(u[V]));N=D.makeIterator(Object.keys(u));for(V=N.next();!V.done;V=N.next())V=V.value,"object"===typeof u[V]&&null!==u[V]&&this.castBinaryData(u[V])}};Vc.prototype.isOffline=function(){return!!this.offlineInterval};Vc.prototype.startOfflineMode=function(){var u=this;this.offlineInterval=setInterval(function(){u.testHttpConnection()},6E4)};Vc.prototype.leaveOfflineMode=function(){this.isOffline()&&
(clearInterval(this.offlineInterval),this.offlineInterval=void 0,this.resetHttpTestsCounter(),this.tryToConnectAndInitializeSession())};Vc.prototype.resetHttpTestsCounter=function(){this.httpTestsLeft=5;this.httpTestsSuccessCount=0};Vc.prototype.getNetworkModeLogString=function(){return"NetworkMode: "+(this.getNetworkMode()===Si.JSWebSockets?"WebSocket":"HTTP")};Vc.initialAttemptTimeout=1E5;Vc.reconnectAttemptTimeout=2E4;Vc.className="NetworkWorkerManager";var Yr=Ri.EventEmitter;D.ha(kd,Yr);kd.prototype.setState=
function(u,N,V){var ka=this;if(!this.state||u!==this.state.stateName){var wa=this.state?Ed[this.state.stateName]:"undefined",Ga=this.state?0<=this.state.possibleNextStates.indexOf(u):u===Ed.Initing;this.sessionStateChangeLogCountLimiter.log(function(){ka.logOp.stop();ka.logOp.resourceId="New state: "+(Ga?Ed[u]:wa);ka.logOp.resultDescription="Previous state: "+wa;ka.logOp.dimension0="Attempted state: "+(Ed[u]||"undefined");ka.logOp.resultSignature=N+(ka.state&&!Ga?"Unexpected state change":"");ka.logOp.success=
Ga;wb.a.info(508843791,wb.b.CoreDefault,ka.logOp)});Ga&&(this.state=this.allStates[u],this.logOp.start(),this.state.onEnter(V))}};kd.prototype.init=function(u,N){this.extensionConfigs=u;this.customInitPromise=N;return this.networkWorkerManager.init(this.extensionConfigs,this.customInitPromise,!0)};kd.prototype.sendMessage=function(u,N,V){this.retrySendMessage(u,N,kd.maxRetries,V)};kd.prototype.sendBytes=function(u){this.state.sendBytes(u)};kd.prototype.onMessage=function(u,N){this.messageEndpoint.onMessage(u,
N)};kd.prototype.getCorrelationVector=function(){return this.cvParent};kd.prototype.forceReconnect=function(u){var N=this;this.extensionConfigs=u||this.extensionConfigs;this.networkWorkerManager.close(!1);return new Promise(function(V){return setTimeout(function(){V(N.networkWorkerManager.init(N.extensionConfigs))},100)})};kd.prototype.closeSession=function(u){this.sendMessage(new Ve);this.networkWorkerManager.close(!0);if(this.sendCloseCallbackOnClientRequestedClose)u=u?u:new Mf({reasonDescription:"ClientRequested"}),
this.onSessionClose(new Ve({reconnectAllowed:!1,reason:u}),"ClientRequested");else this.onSessionClose(void 0,"ClientRequested")};kd.prototype.ingress=function(u,N){var V=this;try{var ka=JSON.parse(u)}catch(wa){wb.a.error(508843790,wb.b.CoreDefault,new pg({sessionHealthEventName:"ProcessMessage",resourceId:"Unknown",success:!1,resultSignature:"ParseError",resultDescription:wa.message,durationMs:0,source:ec.ClientRuntime,reason:mi.Client,impact:rn.MissingOutput,affectedWorkflows:["All"],message:""}))}if(ka)if(this.improvedWebSocketEnabled&&
N&&yg.typeGuard(ka)&&N(ka),this.networkWorkerManager.getNetworkMode()===Si.HttpFallback&&zh.typeGuard(ka)){if(u=ka,u.batch)for(u=D.makeIterator(u.batch),N=u.next();!N.done;N=u.next())this.messageEndpoint.ingress(N.value,function(wa,Ga){return V.egress(wa||Ga,function(){})})}else this.messageEndpoint.ingress(ka,function(wa,Ga){return V.egress(wa||Ga,function(){})})};kd.prototype.egress=function(u,N){u&&this.networkWorkerManager.egress(u).then(function(){return N()}).catch(function(V){return N(V)})};
kd.prototype.onSessionCloseMessage=function(u,N){if(u.reconnectAllowed)this.networkWorkerManager.close();else this.onSessionClose(u,"CloseMessageReceived");N()};kd.prototype.onSessionClose=function(u,N){this.setState(Ed.Closed,N);this.tokenRefreshManager.clearAllTimeouts();this.onConnectionClose(void 0);u&&this.emit("sessionClose",u)};kd.prototype.onConnectionClose=function(u){this.state.onConnectionClose();this.stats.lastConnectionClose=mc.getCurrentTimeMs();this.emit("disconnect",u)};kd.prototype.retrySendMessage=
function(u,N,V,ka){var wa=this;this.state.sendMessage(u,function(Ga,la){Ga&&0<V&&wa.canBeRetried(u)&&wa.isTransientError(Ga)?wa.retrySendMessage(u,N,V-1,ka):N&&N(Ga,la)},kd.maxRetries-V,ka)};kd.prototype.canBeRetried=function(u){return!Eb.matchesTypesFor(u,[xg.getTypeName(),Km.getTypeName()])};kd.prototype.isTransientError=function(u){u=u.error;return u!==Df.SyncMessageUnsupportedBatch&&u!==Df.UnexpectedSeedMessage&&u!==Df.UnsupportedSyncMessage&&u!==Df.AnnotationTokenNotFound&&u!==sn.ArrivedBeforeReseeding&&
u!==sn.DroppedAsOldestInQueue&&u!==sn.DroppedBecauseClientDisconnected};kd.maxRetries=2;var Bg;(function(u){u[u.NotAuthenticated=0]="NotAuthenticated";u[u.Pending=1]="Pending";u[u.Authenticated=2]="Authenticated";u[u.WacUserInfoAuthenticated=3]="WacUserInfoAuthenticated"})(Bg||(Bg={}));var so;(function(u){u[u.IdentityChange=0]="IdentityChange"})(so||(so={}));var Nf;(function(u){u[u.Idle=0]="Idle";u[u.Pending=1]="Pending"})(Nf||(Nf={}));Ub.getTypeName=function(){return"AugLoop_Session_Protocol_Internal_WorkflowRegistrationMessage"};
Ub.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]};Ub.typeGuard=function(u){return Eb.matchesTypesFor(u,[Ub.getTypeName()])};Ub.H_={T_:Ub.getTypeName(),B_:Ub.getBaseTypes()};cb.getTypeName=function(){return"AugLoop_Session_Protocol_WorkflowExecutionRequest"};cb.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]};cb.typeGuard=function(u){return Eb.matchesTypesFor(u,[cb.getTypeName()])};cb.H_={T_:cb.getTypeName(),B_:cb.getBaseTypes()};Ya.getTypeName=function(){return"AugLoop_Session_Protocol_WorkflowExecutionResponse"};
Ya.getBaseTypes=function(){return["AugLoop_Session_Protocol_Response"]};Ya.typeGuard=function(u){return Eb.matchesTypesFor(u,[Ya.getTypeName()])};Ya.H_={T_:Ya.getTypeName(),B_:Ya.getBaseTypes()};Aa.getTypeName=function(){return"AugLoop_Session_Protocol_Internal_RuntimeInitMessage"};Aa.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]};Aa.typeGuard=function(u){return Eb.matchesTypesFor(u,[Aa.getTypeName()])};Aa.H_={T_:Aa.getTypeName(),B_:Aa.getBaseTypes()};rc.getTypeName=function(){return"AugLoop_Session_Protocol_Internal_DiagnosticTraceMessage"};
rc.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]};rc.typeGuard=function(u){return Eb.matchesTypesFor(u,[rc.getTypeName()])};rc.H_={T_:rc.getTypeName(),B_:rc.getBaseTypes()};ld.getTypeName=function(){return"AugLoop_Session_Protocol_Internal_TelemetryMessage"};ld.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]};ld.typeGuard=function(u){return Eb.matchesTypesFor(u,[ld.getTypeName()])};ld.H_={T_:ld.getTypeName(),B_:ld.getBaseTypes()};lh.getTypeName=function(){return"AugLoop_Session_Protocol_Internal_TelemetryFlushMessage"};
lh.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]};lh.typeGuard=function(u){return Eb.matchesTypesFor(u,[lh.getTypeName()])};lh.H_={T_:lh.getTypeName(),B_:lh.getBaseTypes()};hg.getTypeName=function(){return"AugLoop_Session_Protocol_Internal_SessionCloseResponse"};hg.getBaseTypes=function(){return["AugLoop_Session_Protocol_Response"]};hg.typeGuard=function(u){return Eb.matchesTypesFor(u,[hg.getTypeName()])};hg.H_={T_:hg.getTypeName(),B_:hg.getBaseTypes()};ge.getTypeName=function(){return"AugLoop_Session_Protocol_Internal_WorkflowDefinitionOverrideMessage"};
ge.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]};ge.typeGuard=function(u){return Eb.matchesTypesFor(u,[ge.getTypeName()])};ge.H_={T_:ge.getTypeName(),B_:ge.getBaseTypes()};zd.getTypeName=function(){return"AugLoop_Session_Protocol_Internal_GetAnnotationsRequestMessage"};zd.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]};zd.typeGuard=function(u){return Eb.matchesTypesFor(u,[zd.getTypeName()])};zd.H_={T_:zd.getTypeName(),B_:zd.getBaseTypes()};fd.getTypeName=
function(){return"AugLoop_Session_Protocol_Internal_GetAnnotationsResponseMessage"};fd.getBaseTypes=function(){return["AugLoop_Session_Protocol_Response"]};fd.typeGuard=function(u){return Eb.matchesTypesFor(u,[fd.getTypeName()])};fd.H_={T_:fd.getTypeName(),B_:fd.getBaseTypes()};var er;(function(u){u[u.None=0]="None";u[u.HttpsGetDownloadUrl=1]="HttpsGetDownloadUrl";u[u.AlCodedLocation=2]="AlCodedLocation";u[u.Token=3]="Token"})(er||(er={}));var ut;(function(u){u[u.NewDocument=0]="NewDocument";u[u.EditDocument=
1]="EditDocument";u[u.ViewOnlyDocument=2]="ViewOnlyDocument"})(ut||(ut={}));lc.prototype.activate=function(u,N){var V=this;return new Promise(function(ka,wa){V.sendMessage(new xh({annotationType:V.annotationType,token:V.token,config:V.options?V.options.config:void 0,ignoreExistingAnnotations:u,sendStateUpdates:V.options?!!V.options.stateUpdateCallback:void 0,forceReturnCachedAnnotations:V.options?V.options.forceReturnCachedAnnotations:void 0}),function(Ga){Ga?wa(Error(Ga.error)):ka({token:V.token})},
N)})};lc.prototype.release=function(){var u=this;return new Promise(function(N,V){u.sendMessage(new wg({token:u.token}),function(ka,wa){ka?V(Error(ka.error)):N(wa.lastRelease)})})};lc.nextActivationResultBatchId=1;var to;(function(u){u[u.Input=0]="Input";u[u.Exception=1]="Exception";u[u.WaitOn=2]="WaitOn";u[u.StopAndFilterWorkflow=3]="StopAndFilterWorkflow"})(to||(to={}));var ke;(function(u){u[u.Unknown=0]="Unknown";u[u.NoOutput=1]="NoOutput";u[u.Authentication=2]="Authentication";u[u.JoinTimedOut=
3]="JoinTimedOut";u[u.LambdaThrow=4]="LambdaThrow";u[u.LambdaErrorCallback=5]="LambdaErrorCallback"})(ke||(ke={}));var Ef;(function(u){u[u.dSd=0]="ExceedingMaxSize";u[u.nSd=1]="GroupComplete";u[u.mRd=2]="BatchIntervalElapsed"})(Ef||(Ef={}));ac.prototype.addBatchItem=function(u,N,V,ka,wa,Ga){var la=this,ab=N.delayMs,nb=N.delayMsMax,sb=N.maxInputSize,Db=N.estimateSize,bc=N.groupingKeyExtractor;Db=Db(u);var Xb=bc(u);if(N.split&&Db>sb){try{var Gc=N.split(u)}catch(yf){V=Error("Split error: "+yf.message);
Ga?Ga(V):wb.a.error(573366352,wb.b.CoreDefault,V);return}if(Gc&&Array.isArray(Gc.inputs)&&1<Gc.inputs.length){var oe,pe=[];u=Ga?function(yf,Zd){oe=oe||yf;pe.push(Zd);if(pe.length===Gc.inputs.length){try{var rd=Gc.join(pe)}catch(Ui){Ga(Error("Join error: "+Ui.message));return}Ga(oe,rd)}}:void 0;for(ab=0;ab<Gc.inputs.length;ab++)this.addBatchItem(Gc.inputs[ab],N,V,ka,wa&&ab===Gc.inputs.length-1,u);return}}var md=this.batchesByGroupingKey.get(Xb);md&&md.size+Db>sb&&(this.executeBatch(Xb,md,N,Ef.dSd),
md=void 0);md||(md={items:[],size:0,hasItemsWithCallbacks:!1,context:V,creationTime:Date.now()},this.batchesByGroupingKey.set(Xb,md));md.items.push({input:u,size:Db,callback:Ga});md.size+=Db;md.hasItemsWithCallbacks=md.hasItemsWithCallbacks||!!Ga;md.cv=ka;md.groupComplete=wa;md.groupComplete?this.executeBatch(Xb,md,N,Ef.nSd):(Date.now()-md.creationTime+ab<nb&&(clearTimeout(md.timeout),md.timeout=void 0),md.timeout||(md.timeout=setTimeout(function(){la.executeBatch(Xb,md,N,Ef.mRd)},ab)))};ac.prototype.removeAllBatchedItems=
function(){this.batchesByGroupingKey.forEach(function(u){u.timeout&&clearTimeout(u.timeout)});this.batchesByGroupingKey.clear()};ac.prototype.reduceBatchOperations=function(u,N){u=(new Pc({operationName:"ReduceBatchOperations",cv:u.cv})).start();for(var V=0,ka=0,wa=0,Ga=new Set,la=[],ab=D.makeIterator(N.input.reverse()),nb=ab.next();!nb.done;nb=ab.next())if(nb=nb.value,qm.typeGuard(nb)){for(var sb=[],Db=D.makeIterator(nb.items),bc=Db.next();!bc.done;bc=Db.next()){bc=bc.value;wa++;var Xb=nb.parentPath.toString()+
"/"+nb.parentRevId+"/"+bc.id;Ga.has(Xb)?ka++:(sb.push(bc),Ga.add(Xb),V++)}0!=sb.length&&(nb.items=sb,la.push(nb))}else{if(Mh.typeGuard(nb))for(sb=D.makeIterator(nb.items),bc=sb.next();!bc.done;bc=sb.next())Ga.delete(nb.parentPath.toString()+"/"+nb.parentRevId+"/"+bc.value.id);la.push(nb)}N.input=la.reverse();0!=wa&&(u.dimension0=""+this.getOrderOfMagnitudeDimension(ka),u.dimension1="noOp: "+(0===ka));u.success=wa-ka==V?!0:!1;wb.a.info(508039169,wb.b.CoreDefault,u.stop())};ac.prototype.executeBatch=
function(u,N,V,ka){function wa(sb,Db,bc){if(Db&&Db.exceptionType===ke.NoOutput)ab.success=!0,wb.a.info(573366353,wb.b.CoreDefault,ab.stop());else{var Xb=sb+" error: "+(Db?Db.message||Db:"Unknown error");var Gc=Db||Error(Xb);ab.success=!1;ab.resultDescription="Batch of "+la.length+" items of size "+N.size+" with "+Xb;ab.resultSignature=sb+" Error";wb.a.error(573366354,wb.b.CoreDefault,ab.stop())}if(N.hasItemsWithCallbacks)for(sb=D.makeIterator(la),Db=sb.next();!Db.done;Db=sb.next())Db=Db.value,Db.callback&&
Db.callback(Gc,bc)}var Ga=this;clearTimeout(N.timeout);N.timeout=void 0;this.batchesByGroupingKey.delete(u);var la=N.items,ab=(new Pc({operationName:"ExecuteBatch",cv:N.cv,resourceId:N.context.name,resultDescription:"batching duration: "+(Date.now()-N.creationTime)+"ms",dimension0:"Count "+this.getOrderOfMagnitudeDimension(la.length),dimension1:"Size "+this.getOrderOfMagnitudeDimension(N.size),dimension2:ka.toString()})).start();try{var nb=V.multiplex(la.map(function(sb){return sb.input}))}catch(sb){wa("Multiplex",
sb);return}this.reduceBatchOperationsEnabled&&"operations"==u&&this.reduceBatchOperations(N,nb);this.submit(nb.input,N,function(sb,Db){if(sb||Db&&("exceptionType"in Db||Db instanceof Error))wa("Submit",sb||Db,Db);else if(N.hasItemsWithCallbacks||V.summaryExtractor){if(N.hasItemsWithCallbacks)try{var bc=nb.demultiplex(Db);if(bc.length!==la.length)throw Error("Mismatched output length");}catch(pe){wa("Demultiplex",pe);return}if(V.summaryExtractor)try{var Xb=D.makeIterator(V.summaryExtractor(Db));var Gc=
Xb.next().value;var oe=Xb.next().value}catch(pe){wa("SummaryExtractor",pe);return}ab.success=!0;wb.a.info(573366342,wb.b.CoreDefault,ab.stop());if(N.hasItemsWithCallbacks)for(sb=0;sb<la.length;sb++)la[sb].callback&&la[sb].callback(void 0,bc[sb]);if(oe)Ga.onSummary(Gc,oe,N.context)}else ab.success=!0,wb.a.info(573366343,wb.b.CoreDefault,ab.stop())})};var uo;(function(u){u[u.EditorLowPrivilege=0]="EditorLowPrivilege";u[u.AugLoopLowPrivilege=1]="AugLoopLowPrivilege";u[u.Anonymous=2]="Anonymous";u[u.ClientAssertion=
3]="ClientAssertion";u[u.ClientAssertionV2=4]="ClientAssertionV2";u[u.AutoClpLowPrivilege=5]="AutoClpLowPrivilege";u[u.AutoClpAppOnlyLowPrivilege=6]="AutoClpAppOnlyLowPrivilege";u[u.Substrate=7]="Substrate";u[u.WacUserInfo=8]="WacUserInfo";u[u.OwaExchange=9]="OwaExchange";u[u.SmartCompose=10]="SmartCompose";u[u.WritingAnalyticsLowPrivilege=11]="WritingAnalyticsLowPrivilege";u[u.DWEngineLowPrivilege=12]="DWEngineLowPrivilege";u[u.SubstrateApp=13]="SubstrateApp";u[u.CortanaAppPop=14]="CortanaAppPop";
u[u.OfficeAppsAppOnly=15]="OfficeAppsAppOnly";u[u.PPTFrontdoorAppPop=16]="PPTFrontdoorAppPop";u[u.EditorAppOnlyLowPrivilege=17]="EditorAppOnlyLowPrivilege";u[u.AugLoopApp=18]="AugLoopApp";u[u.MeetingIntelligenceApp=19]="MeetingIntelligenceApp";u[u.GraphApp=20]="GraphApp";u[u.IceServicesApp=21]="IceServicesApp";u[u.AzureMapsApp=22]="AzureMapsApp";u[u.SpoApp=23]="SpoApp";u[u.OneDrive=24]="OneDrive";u[u.GoogleDrive=25]="GoogleDrive";u[u.GettyApp=26]="GettyApp";u[u.Dropbox=27]="Dropbox";u[u.GooglePhotos=
28]="GooglePhotos";u[u.EditorApp=29]="EditorApp";u[u.AmazonKindle=30]="AmazonKindle";u[u.ShredderApp=31]="ShredderApp";u[u.FormsLowPrivilege=32]="FormsLowPrivilege";u[u.VivaSalesLowPrivilege=33]="VivaSalesLowPrivilege";u[u.IntentSvcApp=34]="IntentSvcApp";u[u.DcgLowPrivilege=35]="DcgLowPrivilege";u[u.CSALowPrivilege=36]="CSALowPrivilege";u[u.ConsumerSydneyLowPrivilege=37]="ConsumerSydneyLowPrivilege";u[u.CompliantSydneyApp=38]="CompliantSydneyApp";u[u.M365AdminApp=39]="M365AdminApp";u[u.MeetingArtifactsServiceLowPrivilege=
40]="MeetingArtifactsServiceLowPrivilege";u[u.AlchemyApp=41]="AlchemyApp";u[u.M365Admin=42]="M365Admin";u[u.ConsumerShellApp=43]="ConsumerShellApp";u[u.PowerQueryLowPrivilege=44]="PowerQueryLowPrivilege";u[u.CIIApp=45]="CIIApp";u[u.ConsumerShell=46]="ConsumerShell";u[u.AssistCopilotLowPrivilege=47]="AssistCopilotLowPrivilege";u[u.Pva=48]="Pva";u[u.TeamsCopilotServiceLowPrivilege=49]="TeamsCopilotServiceLowPrivilege";u[u.CallAnalytics=50]="CallAnalytics";u[u.IncomingPFT=51]="IncomingPFT";u[u.GraphExchange=
52]="GraphExchange";u[u.EXOAdmin=53]="EXOAdmin";u[u.InsightsServicesLowPrivilege=54]="InsightsServicesLowPrivilege";u[u.VivaServicesLowPrivilege=55]="VivaServicesLowPrivilege";u[u.EcsAppOnly=56]="EcsAppOnly";u[u.ShredderLowPrivilege=57]="ShredderLowPrivilege"})(uo||(uo={}));var Pg;(function(u){u[u.Unknown=0]="Unknown";u[u.Consumer=1]="Consumer";u[u.Enterprise=2]="Enterprise"})(Pg||(Pg={}));var Ii;(function(u){u.AuthorizationCode="authorization_code";u.ClientCredentials="client_credentials";u.RefreshToken=
"refresh_token"})(Ii||(Ii={}));var vm;(function(u){u[u.LoggedIn=0]="LoggedIn";u[u.LoggedOut=1]="LoggedOut"})(vm||(vm={}));var Hg;(function(u){u[u.SingleItem=0]="SingleItem";u[u.Reduce=1]="Reduce";u[u.Grid=2]="Grid";u[u.DynamicText=3]="DynamicText";u[u.Join=4]="Join";u[u.Generic=5]="Generic"})(Hg||(Hg={}));var Jb;(function(u){u[u.Default=0]="Default";u[u.Copilot=1]="Copilot"})(Jb||(Jb={}));var xi;(function(u){u[u.Default=0]="Default";u[u.LocalOnly=1]="LocalOnly";u[u.Exclusive=2]="Exclusive"})(xi||
(xi={}));var hj;(function(u){u[u.PreActivate=0]="PreActivate";u[u.Default=1]="Default";u[u.DelayActivate=1]="DelayActivate";u[u.NeverActivate=2]="NeverActivate"})(hj||(hj={}));var zk;(function(u){u[u.Required=-3]="Required";u[u.Optional=-1]="Optional"})(zk||(zk={}));var hl;(function(u){u[u.Never=0]="Never";u[u.Always=1]="Always"})(hl||(hl={}));var ij;(function(u){u[u.PreSeed=1]="PreSeed";u[u.OnSeed=2]="OnSeed";u[u.PostSeed=4]="PostSeed";u[u.All=5]="All"})(ij||(ij={}));var jj;(function(u){u[u.UpstreamWorkflowsReady=
0]="UpstreamWorkflowsReady";u[u.AnnotationMetadataUpdated=1]="AnnotationMetadataUpdated";u[u.DeltaUpdate=2]="DeltaUpdate";u[u.NonExclusiveTriggerSignals=3]="NonExclusiveTriggerSignals"})(jj||(jj={}));var Tm;(function(u){u[u.Character=1]="Character";u[u.Paragraph=2]="Paragraph"})(Tm||(Tm={}));var Zr;(function(u){u.Input="Input";u.Delta="Delta";u.UILanguage="UILanguage";u.MaxInputCount="MaxInputCount"})(Zr||(Zr={}));var pc;(function(u){u.SetPredefinedAnnotation="SetPredefinedAnnotation";u.ClearAnnotations=
"ClearAnnotations"})(pc||(pc={}));var Um;(function(u){u[u.Local=0]="Local";u[u.External=1]="External"})(Um||(Um={}));Je.prototype.getWorkflow=function(u,N){var V;N=this.getLocation(N);return null===(V=this.graphNodeByLocationAndWorkflowId.get(N))||void 0===V?void 0:V.get(u)};Je.prototype.addWorkflow=function(u,N){N=void 0===N?!1:N;if(this.getWorkflow(u.id,N))u=(new Pc({operationName:"AddWorkflowToGraphFailure",success:!1,resourceId:u.id,resultDescription:"Adding a new with workflow with a duplicated workflowId: "+
N})).start(),wb.a.error(524300630,wb.b.CoreDefault,u.stop());else{N=this.getLocation(N);var V=new Kn(u,N);this.addWorkflowAsDependency(V);var ka=this.graphNodeByLocationAndWorkflowId.get(N);ka||(ka=new Map,this.graphNodeByLocationAndWorkflowId.set(N,ka));ka.set(u.id,V)}};Je.prototype.getUpstreamRuntimeVisibleWorkflows=function(){for(var u=[],N=D.makeIterator(this.graphNodeByLocationAndWorkflowId.values()||[]),V=N.next();!V.done;V=N.next()){V=D.makeIterator(V.value.values()||[]);for(var ka=V.next();!ka.done;ka=
V.next()){ka=ka.value;var wa=this.createWorkflowDefinition(ka.workflow);ka.workflow.visibility===xi.LocalOnly?this.compressDownstreamWorkflows(wa,ka):wa.outputTypes.push.apply(wa.outputTypes,D.Nh(ka.workflow.outputTypes));0!==wa.inputTypes.length&&u.push(wa)}}return u};Je.prototype.removeWorkflows=function(u){u=this.getLocation(u);u=this.graphNodeByLocationAndWorkflowId.get(u);var N=Array.from((null===u||void 0===u?void 0:u.values())||[]);N=D.makeIterator(N);for(var V=N.next();!V.done;V=N.next()){V=
V.value;for(var ka=D.makeIterator(V.upstreamWorkflows.values()),wa=ka.next();!wa.done;wa=ka.next())wa.value.downstreamWorkflows.delete(V);ka=D.makeIterator(V.downstreamWorkflows.values());for(wa=ka.next();!wa.done;wa=ka.next())wa.value.upstreamWorkflows.delete(V);u.delete(V.workflow.id)}};Je.prototype.getWorkflowsDefinitions=function(){for(var u=[],N=D.makeIterator(this.graphNodeByLocationAndWorkflowId.values()||[]),V=N.next();!V.done;V=N.next()){V=D.makeIterator(V.value.values()||[]);for(var ka=
V.next();!ka.done;ka=V.next())u.push(ka.value.workflow)}return u};Je.prototype.getWorkflowNodes=function(){for(var u=[],N=D.makeIterator(this.graphNodeByLocationAndWorkflowId.values()),V=N.next();!V.done;V=N.next()){V=D.makeIterator(V.value.values());for(var ka=V.next();!ka.done;ka=V.next())u.push(ka.value)}return u};Je.prototype.getLocation=function(u){return u?Um.External:Um.Local};Je.prototype.createWorkflowDefinition=function(u){return Object.assign(Object.assign({},u),{outputTypes:[]})};Je.prototype.compressDownstreamWorkflows=
function(u,N){N=D.makeIterator(N.downstreamWorkflows);for(var V=N.next();!V.done;V=N.next())if(V=V.value,V.workflow.visibility===xi.LocalOnly)this.compressDownstreamWorkflows(u,V);else if(V.workflow.kind!==Hg.Join||-1!==u.inputTypes.indexOf(V.workflow.collectionScopeType)){V=D.makeIterator(V.workflow.outputTypes);for(var ka=V.next();!ka.done;ka=V.next())ka=ka.value,-1===u.outputTypes.indexOf(ka)&&u.outputTypes.push(ka)}};Je.prototype.addWorkflowAsDependency=function(u){for(var N=D.makeIterator(this.graphNodeByLocationAndWorkflowId.values()),
V=N.next();!V.done;V=N.next()){V=D.makeIterator(V.value.values());for(var ka=V.next();!ka.done;ka=V.next()){ka=ka.value;for(var wa=D.makeIterator(ka.workflow.inputTypes),Ga=wa.next();!Ga.done;Ga=wa.next())-1!==u.workflow.outputTypes.indexOf(Ga.value)&&this.addWorkflowChain(u,ka);wa=D.makeIterator(ka.workflow.outputTypes);for(Ga=wa.next();!Ga.done;Ga=wa.next())-1!==u.workflow.inputTypes.indexOf(Ga.value)&&this.addWorkflowChain(ka,u)}}};Je.prototype.addWorkflowChain=function(u,N){u.downstreamWorkflows.add(N);
N.upstreamWorkflows.add(u)};Sf.mergeDefinitions=function(u,N,V){return Object.assign(Object.assign(Object.assign({},u),N),V)};Sf.prototype.mergeWorkflowDefinition=function(u,N,V){if(V){var ka=yj(this.workflowDefByWorkflowAndContextId,u.id,function(){return new Map});ka.set(V,Sf.mergeDefinitions(u,ka.get(V),N))}else this.workflowDefByWorkflow.set(u.id,Sf.mergeDefinitions(u,this.workflowDefByWorkflow.get(u.id),N))};Sf.prototype.getWorkflowDefinition=function(u,N){var V,ka;N&&(ka=null===(V=this.workflowDefByWorkflowAndContextId.get(u.id))||
void 0===V?void 0:V.get(N));ka||(ka=this.workflowDefByWorkflow.get(u.id));ka||(ka=u);return ka};Sf.prototype.deleteWorkflowDefinition=function(u,N){var V=this.workflowDefByWorkflowAndContextId.get(u.id);V&&(V.delete(N),0===V.size&&this.workflowDefByWorkflowAndContextId.delete(u.id))};var fr=new Set([Mh.getTypeName(),qm.getTypeName(),Ad.getTypeName(),mf.getTypeName()]);ui.isParentContextId=function(u,N){return ic(u,N)};ui.prototype.applyContextIdOnOperations=function(u){u=D.makeIterator(u);for(var N=
u.next();!N.done;N=u.next()){N=N.value;var V=Eb.getTypeNameFor(N);if(this.isSupportedOperation(V))for(N=D.makeIterator(N.items),V=N.next();!V.done;V=N.next())V=V.value,V.contextId?V.source&&this.workflowGraph.getWorkflow(V.source,!1)?V.contextId=this.addNewContextId(V.contextId):this.tryLogMessage((new Pc({operationName:"ApplyContextIdOnOperations",success:!0})).start(),"Item with a contextId but without a workflow source atribute"):V.contextId=this.addNewContextId()}};ui.prototype.addNewContextId=
function(u){var N=""+this.runtimeKind+this.nextId++;return u?u+"."+N:N};ui.prototype.isSupportedOperation=function(u){return fr.has(u)};ui.prototype.tryLogMessage=function(u,N,V){u&&(u.success=void 0===V?!0:V,u.resultDescription=N,wb.a.verbose(527308633,wb.b.CoreDefault,u.stop()))};var Qf;(function(u){u[u.Idle=1]="Idle";u[u.Pending=2]="Pending";u[u.Running=3]="Running";u[u.Executed=4]="Executed"})(Qf||(Qf={}));og.prototype.setScopeItem=function(u,N){var V,ka=u.contextId;if(ka)if(this.itemsByWorkflowAndContextId.has(N.id)||
this.itemsByWorkflowAndContextId.set(N.id,new Map),this.itemsByWorkflowAndContextId.get(N.id).set(ka,[]),!this.scopeItemsByContextId.has(ka))this.scopeItemsByContextId.set(ka,u);else if(null===(V=this.itemsByWorkflowAndContextId.get(N.id))||void 0===V?0:V.has(ka))u=(new Pc({resultDescription:"Trying to set new scope item: "+u.id+" with already existing contextId "+ka+" for workflow "+N.id,operationName:"WIS.setScopeItem",resourceId:N.id,success:!0})).start(),wb.a.verbose(527291288,wb.b.CoreDefault,
u.stop())};og.prototype.getScopeItem=function(u,N){var V;N=D.makeIterator((null===(V=this.itemsByWorkflowAndContextId.get(N.id))||void 0===V?void 0:V.keys())||[]);for(V=N.next();!V.done;V=N.next())if(V=V.value,ic(V,u))return this.scopeItemsByContextId.get(V)};og.prototype.addItemToWorkflowList=function(u,N){var V=u.contextId;if(V){var ka=this.itemsByWorkflowAndContextId.get(N.id);if(ka){ka=D.makeIterator(ka);for(var wa=ka.next();!wa.done;wa=ka.next()){var Ga=D.makeIterator(wa.value);wa=Ga.next().value;
Ga=Ga.next().value;ic(wa,V)&&(Ga.push(u),wa=(new Pc({resultDescription:"Items for contextId "+wa+": ["+Ga.map(function(la){return la.id}).join(",")+"]",operationName:"WIS.addItemOnContextIdList",resourceId:N.id,success:!0})).start(),wb.a.info(526403808,wb.b.CoreDefault,wa.stop()))}}}};og.prototype.isWorkflowReady=function(u,N){var V=this.workflowDefinitionManager.getWorkflowDefinition(N,u).maxAnnotations;return this.getGeneratedItems(u,N).length>=V};og.prototype.getItemsToExecute=function(u,N){var V=
this.getGeneratedItems(u,N);this.itemsByWorkflowAndContextId.get(N.id).delete(u);return V};og.prototype.onWorkflowExecuted=function(u,N){u=u.contextId;var V=this.itemsByWorkflowAndContextId.get(N.id);V&&(V.delete(u),0===V.size&&this.itemsByWorkflowAndContextId.delete(N.id));this.hasWorkflowsAwaitingExecution(u)||this.scopeItemsByContextId.delete(u)};og.prototype.getGeneratedItems=function(u,N){var V;if(null===(V=this.itemsByWorkflowAndContextId.get(N.id))||void 0===V||!V.get(u))return[];V=this.workflowDefinitionManager.getWorkflowDefinition(N,
u).maxAnnotations;return this.itemsByWorkflowAndContextId.get(N.id).get(u).slice(0,V)};og.prototype.hasWorkflowsAwaitingExecution=function(u){for(var N=D.makeIterator(this.itemsByWorkflowAndContextId.values()),V=N.next();!V.done;V=N.next()){V=D.makeIterator(V.value.keys());for(var ka=V.next();!ka.done;ka=V.next())if(ka.value===u)return!0}return!1};var To;(function(u){u.JsClient="C";u.Server="S"})(To||(To={}));Jh.getTypeName=function(){return"AugLoop_Text_TextTile"};Jh.getBaseTypes=function(){return[]};
Jh.typeGuard=function(u){return Eb.matchesTypesFor(u,[Jh.getTypeName()])};Jh.H_={T_:Jh.getTypeName(),B_:Jh.getBaseTypes()};Ih.getTypeName=function(){return"AugLoop_Text_FormattedTextTile"};Ih.getBaseTypes=function(){return["AugLoop_Text_TextTile"]};Ih.typeGuard=function(u){return Eb.matchesTypesFor(u,[Ih.getTypeName()])};Ih.H_={T_:Ih.getTypeName(),B_:Ih.getBaseTypes()};Rj.getTypeName=function(){return"AugLoop_Text_DynamicTextContext"};Rj.getBaseTypes=function(){return["AugLoop_Core_DynamicContext"]};
Rj.typeGuard=function(u){return Eb.matchesTypesFor(u,[Rj.getTypeName()])};Rj.H_={T_:Rj.getTypeName(),B_:Rj.getBaseTypes()};Lk.getTypeName=function(){return"AugLoop_Text_TaskTile"};Lk.getBaseTypes=function(){return["AugLoop_Text_FormattedTextTile","AugLoop_Text_TextTile"]};Lk.typeGuard=function(u){return Eb.matchesTypesFor(u,[Lk.getTypeName()])};Lk.H_={T_:Lk.getTypeName(),B_:Lk.getBaseTypes()};wh.getTypeName=function(){return"AugLoop_Text_PersonTile"};wh.getBaseTypes=function(){return["AugLoop_Text_TextTile"]};
wh.typeGuard=function(u){return Eb.matchesTypesFor(u,[wh.getTypeName()])};wh.H_={T_:wh.getTypeName(),B_:wh.getBaseTypes()};hh.getTypeName=function(){return"AugLoop_Text_DateTile"};hh.getBaseTypes=function(){return["AugLoop_Text_TextTile"]};hh.typeGuard=function(u){return Eb.matchesTypesFor(u,[hh.getTypeName()])};hh.H_={T_:hh.getTypeName(),B_:hh.getBaseTypes()};Jg.getTypeName=function(){return"AugLoop_Text_LinkTile"};Jg.getBaseTypes=function(){return["AugLoop_Text_TextTile"]};Jg.typeGuard=function(u){return Eb.matchesTypesFor(u,
[Jg.getTypeName()])};Jg.H_={T_:Jg.getTypeName(),B_:Jg.getBaseTypes()};var Qg;(function(u){u[u.Add=0]="Add";u[u.Delete=1]="Delete";u[u.Update=2]="Update";u[u.CursorUpdate=3]="CursorUpdate";u[u.FormattingUpdate=4]="FormattingUpdate";u[u.OtherNonContentUpdate=5]="OtherNonContentUpdate"})(Qg||(Qg={}));var rg;(function(u){u[u.Chars=0]="Chars";u[u.Word=1]="Word";u[u.PartialSentence=2]="PartialSentence";u[u.Sentence=3]="Sentence";u[u.Paragraph=4]="Paragraph"})(rg||(rg={}));var Pk;(function(u){u[u.SessionUser=
0]="SessionUser";u[u.Programmatic=1]="Programmatic";u[u.Collaborator=2]="Collaborator"})(Pk||(Pk={}));Zh.getTypeName=function(){return"AugLoop_Text_TextTileDelta"};Zh.getBaseTypes=function(){return["AugLoop_Core_ItemDelta"]};Zh.typeGuard=function(u){return Eb.matchesTypesFor(u,[Zh.getTypeName()])};Zh.H_={T_:Zh.getTypeName(),B_:Zh.getBaseTypes()};Vf.getTypeName=function(){return"AugLoop_Text_FormattedTextTileDelta"};Vf.getBaseTypes=function(){return["AugLoop_Text_TextTileDelta","AugLoop_Core_ItemDelta"]};
Vf.typeGuard=function(u){return Eb.matchesTypesFor(u,[Vf.getTypeName()])};Vf.H_={T_:Vf.getTypeName(),B_:Vf.getBaseTypes()};var Yj=/[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]/g,ok=/[.!?]/g;Fc.prototype.registerDeltaBuilderHandler=function(u,N){this.deltaBuilderHandlers.set(u,N)};Fc.prototype.executeDeltaBuilderHandler=function(u,N,V){return(u=this.deltaBuilderHandlers.get(u))?u(N,V):[]};Xg.prototype.addItemToLocalMap=function(u,N){N=Kk(u.id,N);u=u.body;Jh.typeGuard(u)&&!this.lastSeenTileByTileId.has(N)&&
this.lastSeenTileByTileId.set(N,u)};Xg.prototype.deleteItemFromLocalMap=function(u,N){u=Kk(u.id,N);this.lastSeenTileByTileId.has(u)&&this.lastSeenTileByTileId.delete(u)};Xg.prototype.createDeltas=function(u,N){return this.deltaBuilder.executeDeltaBuilderHandler(Eb.getTypeNameFor(N),u,N)};var Rg;(function(u){u[u.LocalWorkflow=0]="LocalWorkflow";u[u.ServerWorkflow=1]="ServerWorkflow";u[u.Submitted=2]="Submitted"})(Rg||(Rg={}));var kj;(function(u){u[u.Internal=0]="Internal";u[u.External=1]="External"})(kj||
(kj={}));Xc.prototype.tryGetDocSessionId=function(){if(this.clientMetadata&&this.clientMetadata.docSessionId)return this.clientMetadata.docSessionId};Xc.prototype.getSessionStateCallbackToken=function(u){var N;return u+"-callback-"+(null!==(N=this.tryGetDocSessionId())&&void 0!==N?N:"unknown")+"-"+this.sessionStateCallbackToken++};Xc.prototype.updateGraphOnAuthStateChange=function(){this.tryActivateWorkflows()};Xc.prototype.tryActivateWorkflows=function(){var u=this;if(this.enableRemoteExecutionNotification){var N=
(new Pc({operationName:"GraphServerWorkflowActivation",success:!0})).setClientMetadata(this.clientMetadata).start(),V=[];this.workflowGraph.getWorkflowNodes().filter(function(ka){return ka.location===Um.External}).forEach(function(ka){u.localWorkflowManager.canActivateWorkflow(ka,u)?ka.isActivated=!0:(u.localWorkflowManager.deactivateServerWorkflow(ka,u),V.push(ka.workflow.id))});N.resultDescription="deactivated workflows: ["+V.join()+"]";wb.a.info(508879493,wb.b.CoreDefault,N.stop())}};Xc.prototype.initialize=
function(){var u=this;this.localWorkflowManager&&this.localWorkflowManager.addSession(this);this.registerLocalWorkflowsWithoutGraphInit(this.localRegisteredWorkflows);return this.sessionManager.init(this.extensionConfigs,this.hostCallbacks.onInitSession?this.hostCallbacks.onInitSession:void 0,this.egress).then(function(){u.localWorkflowManager&&u.localWorkflowManager.setTokenCallback(u.getAuthToken.bind(u));return u})};Xc.prototype.isLocalWorkflowRegistered=function(u){return this.getLocalRegisteredWorkflows().some(function(N){return u===
N.id})};Xc.prototype.getServerAuthenticationState=function(){return this.serverAuthenticationState};Xc.prototype.getContextIdManager=function(){return this.contextIdManager};Xc.prototype.getWorkflowItemStorage=function(){return this.workflowItemStorage};Xc.prototype.getWorkflowDefinition=function(u,N){return this.workflowDefinitionManager.getWorkflowDefinition(u,N)};Xc.prototype.registerLocalWorkflows=function(u){this.registerLocalWorkflowsWithoutGraphInit(u);this.trySendWorkflowGraphInitMessage()};
Xc.prototype.registerLocalWorkflowsWithoutGraphInit=function(u){if(u.length){if(this.workflowRuntime)for(var N=D.makeIterator(u),V=N.next();!V.done;V=N.next())V=V.value,this.workflowRuntime.registerWorkflow(V),this.sendMessageToSession(new Ub({workflowDefinition:V}));if(this.localWorkflowManager)for(u=D.makeIterator(u),V=u.next();!V.done;V=u.next())this.localWorkflowManager.registerLocalWorkflow(V.value,this)}};Xc.prototype.registerLocalWorkflow=function(u){this.registerLocalWorkflows([u]);u=(new Pc({operationName:"SessionRegisterLocalWorkflow",
resourceId:u.id,success:!0})).setClientMetadata(this.clientMetadata).start();nh(u)};Xc.prototype.activateAnnotation=function(u,N){var V,ka=new lc(this.sendMessageToSession.bind(this),u,N);if(N&&N.callback){var wa=this.annotationCallbacks.get(u);wa||(wa=new Map,this.annotationCallbacks.set(u,wa));wa.set(ka.token,N.callback)}N=null!==(V=this.tokensByAnnotationType.get(u))&&void 0!==V?V:[];-1===N.indexOf(ka.token)&&N.push(ka.token);this.tokensByAnnotationType.set(u,N);this.annotationActivationTrackers.set(ka.token,
ka);return this.activateAnnotationForTracker(ka,{ignoreExistingAnnotations:!1,Qrb:!1})};Xc.prototype.activateAnnotationForTracker=function(u,N){var V=(new Pc({operationName:"ActivateAnnotation",resourceId:u.annotationType,success:!0})).setClientMetadata(this.clientMetadata).start();return u.activate(N.ignoreExistingAnnotations,N.Qrb).then(function(ka){V.resultSignature="Ok";V.resultDescription="Activated annotation "+u.annotationType+" with token "+u.token+"; sendOnlyIfConnected: "+N.Qrb;nh(V);return ka}).catch(function(ka){nh(V,
"error on activate annotation type "+u.annotationType+": "+ka+"; sendOnlyIfConnected: "+N.Qrb);throw ka;})};Xc.prototype.updateAnnotationConfig=function(u,N){var V=new Bj({token:u,config:N});this.sendMessageToSession(V);(u=this.annotationActivationTrackers.get(u))&&u.options&&(u.options.config=N)};Xc.prototype.releaseAnnotation=function(u){var N=this.annotationActivationTrackers.get(u);if(N){this.annotationActivationTrackers.delete(u);var V=this.annotationCallbacks.get(N.annotationType);V&&(V.delete(u),
0==V.size&&this.annotationCallbacks.delete(N.annotationType));return N.release()}return Promise.resolve(!1)};Xc.prototype.setAnnotationState=function(u,N,V){this.submitOperation(new Mi({parentPath:u,items:[{id:N}],M_:{state:V}}))};Xc.prototype.setAnnotationMetadata=function(u,N,V){this.submitOperation(new Mi({parentPath:u,items:[{id:N}],M_:V}))};Xc.prototype.submitOperation=function(u,N){this.submitOperations([u],N)};Xc.prototype.submitOperations=function(u,N){this.contextIdManager.applyContextIdOnOperations(u);
this.updateWorkflowExecutionStates(u);if(!this.onAnnotationsSubmittedEnabled){var V=D.makeIterator(this.partitionAnnotationOperations(u)),ka=V.next().value;V.next();this.executeCallbacksOnAnnotationSubmitted(ka)}V=u.filter(this.filterOperationsForSession.bind(this)).filter(ti);if(this.workflowRuntime)this.onAnnotationsSubmittedEnabled?(V=D.makeIterator(this.partitionAnnotationOperations(V)),u=V.next().value,V=V.next().value,this.onAnnotationsSubmitted(u,N),this.submitOperationsToSession(V,N)):this.submitOperationsToSession(V,
N);else{ka=[];if(this.deltaGenerator){for(var wa=(new Pc({operationName:"ExecuteDeltaGenerator",success:!0})).setClientMetadata(this.clientMetadata).start(),Ga=D.makeIterator(V),la=Ga.next();!la.done;la=Ga.next())if(la=la.value,qm.typeGuard(la))ka.push.apply(ka,D.Nh(this.createDeltasFromUpdateOperation(la)));else{for(var ab=la,nb=D.makeIterator(ab.items),sb=nb.next();!sb.done;sb=nb.next())sb=sb.value,Mh.typeGuard(la)?this.deltaGenerator.addItemToLocalMap(sb,ab.parentPath):mk.typeGuard(la)&&this.deltaGenerator.deleteItemFromLocalMap(sb,
ab.parentPath);ka.push(la)}nh(wa)}this.onAnnotationsSubmittedEnabled?(ka=D.makeIterator(this.partitionAnnotationOperations(ka.length?ka:V)),V=ka.next().value,ka=ka.next().value,this.onAnnotationsSubmitted(V,N),this.submitOperationsToSession(ka,N)):this.submitOperationsToSession(ka.length?ka:V,N);this.localWorkflowManager&&this.localWorkflowManager.runLocalWorkflows(u,this,!0)}};Xc.prototype.submitSeedOperations=function(u,N){if(!this.allowSeed)throw Error("Cannot submit seed operations more than once per session");
if(this.networkMode===Si.LocalWorkflowsOnly&&this.localWorkflowManager)this.localWorkflowManager.runLocalWorkflows(u,this);else{this.allowGroupSeed=this.allowSeed=!1;var V=D.makeIterator(this.partitionAnnotationOperations(u)),ka=V.next().value;V=V.next().value;if(this.onAnnotationsSubmittedEnabled)this.onAnnotationsSubmitted(ka,N);else this.executeCallbacksOnAnnotationSubmitted(ka);this.operationBatchConfig?this.sendSeedMessagesViaBatchManager(this.onAnnotationsSubmittedEnabled?V:u,!0,N):this.sendMessageToSession(new Te({cv:N,
seq:0,ops:this.onAnnotationsSubmittedEnabled?V:u}))}};Xc.prototype.submitSeedGroupOperations=function(u,N,V){if(!this.allowGroupSeed)throw Error("Seed operations are not allowed for this session");if(this.networkMode===Si.LocalWorkflowsOnly&&this.localWorkflowManager)this.localWorkflowManager.runLocalWorkflows(u,this);else{N&&(this.allowGroupSeed=!1);this.allowSeed=!1;var ka=D.makeIterator(this.partitionAnnotationOperations(u)),wa=ka.next().value;ka=ka.next().value;this.executeCallbacksOnAnnotationSubmitted(wa);
if(this.onAnnotationsSubmittedEnabled)this.onAnnotationsSubmitted(wa,V);else this.executeCallbacksOnAnnotationSubmitted(wa);this.operationBatchConfig?this.sendSeedMessagesViaBatchManager(this.onAnnotationsSubmittedEnabled?ka:u,!!N,V):(this.seedGroupSize++,this.sendMessageToSession(new Te({cv:V,seq:0,ops:this.onAnnotationsSubmittedEnabled?ka:u,groupId:"Seed",groupSize:N?this.seedGroupSize:void 0,groupComplete:N?N:void 0})))}};Xc.prototype.submitCustomMessage=function(u){var N=this;return new Promise(function(V,
ka){N.sendMessageToSession(u,function(wa,Ga){wa?ka(Error(wa.error)):V(Ga)})})};Xc.prototype.submitLargeBinaryDataMessage=function(u){var N=this;return new Promise(function(V,ka){N.sendMessageToSessionPostEndpoint(u,function(wa,Ga){wa?ka(Error(wa.error)):V(Ga)})})};Xc.prototype.requestBinaryDataForBlob=function(u){var N=this;return u.data?Promise.resolve(u.data):u.dataPointer&&u.dataPointer.refType!==er.None?new Promise(function(V,ka){N.requestBinaryDataFromSessionBlobEndpoint(u.dataPointer,function(wa,
Ga){wa?ka(wa):V(Ga)})}):Promise.reject(Error("Blob does not have a data pointer"))};Xc.prototype.requestCacheDump=function(u){if(u)throw Error("NYI");return this.submitCustomMessage(new yh)};Xc.prototype.forceReconnect=function(u){this.extensionConfigs=u;return this.sessionManager.forceReconnect(u)};Xc.prototype.close=function(u){this.isSessionClosed=!0;this.sessionManager.closeSession(u);this.workflowRuntime&&this.workflowRuntime.close();this.localWorkflowManager&&this.localWorkflowManager.closeSession(this);
this.graphInitMessageTimer&&(clearTimeout(this.graphInitMessageTimer),this.graphInitMessageTimer=void 0)};Xc.prototype.getClientMetadata=function(){return this.clientMetadata};Xc.prototype.getUserContext=function(){return this.userContext};Xc.prototype.setSessionCloseCallback=function(u){var N=this.getSessionStateCallbackToken("close");u&&this.sessionCloseCallbacks.set(N,u);return N};Xc.prototype.setConnectCallback=function(u){var N=this.getSessionStateCallbackToken("connect");u&&this.connectCallbacks.set(N,
u);return N};Xc.prototype.setDisconnectCallback=function(u){var N=this.getSessionStateCallbackToken("disconnect");u&&this.disconnectCallbacks.set(N,u);return N};Xc.prototype.setReconnectCallback=function(u){var N=this.getSessionStateCallbackToken("reconnect");u&&this.reconnectCallbacks.set(N,u);return N};Xc.prototype.removeSessionStateCallback=function(u){function N(V){return V.has(u)?(V.delete(u),!0):!1}return N(this.sessionCloseCallbacks)||N(this.reconnectCallbacks)||N(this.disconnectCallbacks)||
N(this.connectCallbacks)};Xc.prototype.setServerAuthenticationStateChangeCallback=function(u){this.serverAuthenticationStateChangeCallback.push(u);u(this.serverAuthenticationState)};Xc.prototype.onAnnotationResults=function(u,N,V){var ka=this;wb.a.info(508916486,wb.b.CoreDefault,new Pc({operationName:"OnAnnotationResultsEgress",dimension0:null===u||void 0===u?void 0:u.annotationType,success:!0}));V(void 0,new yg);N===Rg.LocalWorkflow&&this.contextIdManager.applyContextIdOnOperations(u.ops);this.updateWorkflowExecutionStates(u.ops);
this.egress&&this.egress(u,function(){});this.annotationResultsProcessor.process(u,function(wa,Ga){ka.applyOperationForContext(wa,Ga,N)},function(wa){ka.triggerRegisteredAnnotationCallbacks(wa,u.annotationType)},function(wa){if(N!==Rg.ServerWorkflow){var Ga=wa.ops.filter(ka.filterOperationsForSession.bind(ka)).filter(ti);ka.submitOperationsToSession(Ga,wa.cv)}ka.localWorkflowManager&&ka.localWorkflowManager.runLocalWorkflows(wa.ops,ka)})};Xc.prototype.onAnnotationResultStateMessage=function(u,N){var V;
N(void 0,new yg);u=D.makeIterator(u.updates);for(N=u.next();!N.done;N=u.next()){N=N.value;var ka=N.annotationType;N=N.state;if(this.tokensByAnnotationType.has(ka)){var wa=this.annotationResultStates.has(ka)?this.annotationResultStates.get(ka):N===Nf.Idle?Nf.Pending:Nf.Idle;ka=D.makeIterator(this.tokensByAnnotationType.get(ka));for(var Ga=ka.next();!Ga.done;Ga=ka.next())Ga=this.annotationActivationTrackers.get(Ga.value),(null===(V=Ga.options)||void 0===V?0:V.stateUpdateCallback)&&Ga.options.stateUpdateCallback(wa,
N)}}};Xc.prototype.submitOperationsToSession=function(u,N){var V=this,ka=u.filter(function(wa){return Ad.typeGuard(wa)});u=u.filter(function(wa){return!Ad.typeGuard(wa)});0<ka.length&&this.sendMessageToSession(new Te({cv:N,ops:ka}));0<u.length&&(this.operationBatchConfig?(this.batchedOperationsManager||(this.batchedOperationsManager=new ac(function(wa,Ga,la){V.sendMessageToSession(new Te({cv:Ga.cv,seq:V.nextSyncSequenceId++,ops:wa}),function(ab){la(ab?Error(ab.error):void 0)})},this.reduceBatchOperationsEnabled)),
this.batchedOperationsManager.addBatchItem(u,this.operationBatchConfig,{name:"SubmitOperations"},N)):this.sendMessageToSession(new Te({cv:N,seq:this.nextSyncSequenceId++,ops:u})))};Xc.prototype.sendMessageToSession=function(u,N){this.sessionManager.sendMessage(u,N);Ve.typeGuard(u)&&this.close()};Xc.prototype.sendMessageToSessionPostEndpoint=function(u,N){var V=this;if(this.connectParams)this.sendLargeBinaryDataMessage(this.connectParams,u,N);else{var ka=function(wa){return V.sendLargeBinaryDataMessage(wa,
u,N)}.bind(this);this.pendingConnectCallbacks.push(ka)}};Xc.prototype.requestBinaryDataFromSessionBlobEndpoint=function(u,N){var V=this;if(this.connectParams)this.requestBinaryData(this.connectParams,u,N);else{var ka=function(wa){return V.requestBinaryData(wa,u,N)}.bind(this);this.pendingConnectCallbacks.push(ka)}};Xc.prototype.registerContextTypes=function(u){u=D.makeIterator(u);for(var N=u.next();!N.done;N=u.next())N=N.value,void this.activateAnnotation(N),this.registeredContextTypes.add(N)};Xc.prototype.applyOperationForContext=
function(u,N,V){var ka=this,wa=Eb.getTypeNameFor(u);if(wa==Mh.getTypeName()||wa==qg.getTypeName()||wa==qm.getTypeName()||wa==mk.getTypeName()){wa==qg.getTypeName()&&(wa=Mh.getTypeName());var Ga=mb(this.resolvePlaceholdersInOperationParentPath(u.parentPath),N),la=Ka(Ga.parentPath);if(wa==Mh.getTypeName()||wa==qm.getTypeName()){if(Ga.body&&(N=Eb.getTypeNameFor(Ga.body),this.registeredContextTypes.has(N))){u=this.availableContexts.get(N);u||(u=new Map,this.availableContexts.set(N,u));N=u.get(V);N||(N=
[],u.set(V,N));if(!Ga.id){if(this.workflowRuntime)throw Error("Expected item to have id already");this.localWorkflowManager&&(Ga.id=this.localWorkflowManager.getNextClientAnnotationId())}if(wa==Mh.getTypeName())0==N.filter(function(ab){return Ka(ab.parentPath)==la&&ab.id==Ga.id}).length?N.push(Ga):wb.a.info(540848911,wb.b.CoreDefault,"AddOperation for ("+V+", "+Ga.id+", "+Ga.source+") can't be applied as the context item with matching path and ID already exists. Use UpdateOperation instead.");else for(wa=
0;wa<N.length;wa++)if(N[wa].id==Ga.id&&Ka(N[wa].parentPath)==la)if(N[wa].source==Ga.source){N[wa]=Ga;break}else wb.a.warn(540848912,wb.b.CoreDefault,"UpdateOperation for ("+V+", "+Ga.id+", "+Ga.source+") can't be applied as the context item with provided path and ID has different source: "+N[wa].source);else wb.a.warn(540848913,wb.b.CoreDefault,"UpdateOperation for ("+V+", "+Ga.id+", "+Ga.source+") can't be applied as the context item with matching path and ID was not found. AddOperation should be used instead")}}else wa==
mk.getTypeName()&&Ga.id&&this.availableContexts.forEach(function(ab,nb){var sb=ab.get(V);sb&&(sb=sb.filter(function(Db){return!(Ka(Db.parentPath)==la&&Db.id==Ga.id)}),0==sb.length?ab.delete(V):ab.set(V,sb),0==ab.size?ka.availableContexts.delete(nb):ka.availableContexts.set(nb,ab))})}};Xc.prototype.updateWorkflowExecutionStates=function(u){if(this.localWorkflowManager){var N=this.enableRemoteExecutionNotification?this.workflowGraph.getWorkflowNodes().map(function(la){return la.workflow}):this.localWorkflowManager.getAllRegisteredWorkflowsFromSession(this);
u=D.makeIterator(u);for(var V=u.next();!V.done;V=u.next())if(V=V.value,fr.has(Eb.getTypeNameFor(V))){V=D.makeIterator(V.items);for(var ka=V.next();!ka.done;ka=V.next()){ka=ka.value;for(var wa=D.makeIterator(N||[]),Ga=wa.next();!Ga.done;Ga=wa.next())this.localWorkflowManager.preProcessItemToWorkflow(Ga.value,ka,this)}}}};Xc.prototype.resolveRequestedContexts=function(u){var N=[];u=D.makeIterator(yb(u.requestedContextTypesRules));for(var V=u.next();!V.done;V=u.next()){var ka=D.makeIterator(V.value);
V=ka.next().value;var wa=ka.next().value;ka.next();if(this.availableContexts.has(V)){ka=Array.from(this.availableContexts.get(V).values()).reduce(function(Ga,la){return Ga.concat(la)},[]);if(0==ka.length)throw Error("Assert: availableContexts have the entry for "+V+" which does not contain any context annotation.");N.push.apply(N,D.Nh(ka))}else if(wa==zk.Required)return[!1,[]]}return[!0,this.removeDuplicatedContextItems(N)]};Xc.prototype.removeDuplicatedContextItems=function(u){return u.filter(function(N,
V,ka){return ka.findIndex(function(wa){return mc.deepEquals(wa,N)})===V})};Xc.prototype.getContextAnnotations=function(u,N,V,ka){var wa,Ga,la=V?Ka(V):void 0;return null===(Ga=null===(wa=this.availableContexts.get(u))||void 0===wa?void 0:wa.get(N))||void 0===Ga?void 0:Ga.filter(function(ab){return(!la||Ka(ab.parentPath)==la)&&(!ka||ab.source==ka)})};Xc.prototype.onWorkflowDefinitionOverrideMessage=function(u){function N(Ga){nh(V,Ga);throw Error("WorkflowDefinitionOverride: "+Ga);}var V=(new Pc({operationName:"WorkflowDefinitionOverride",
success:!0})).setClientMetadata(this.clientMetadata).start();if(this.localWorkflowManager){var ka=this.localWorkflowManager.getWorkflowDefinitionsByName(this),wa=ka.get(u.sourceWorkflowId);if(wa){if(V.resourceId=wa.id,ka=ka.get(u.targetWorkflowId))ka.allowDefinitionOverride?wa.definitionOverrideTargetWorkflows&&-1!==wa.definitionOverrideTargetWorkflows.indexOf(ka.id)?(this.workflowDefinitionManager.mergeWorkflowDefinition(ka,u.definition,u.contextId),V.resultDescription="Updated config for workflow: "+
u.targetWorkflowId+", context id: "+u.contextId,nh(V)):N("Workflow '"+wa.id+"' does not allow workflow definition for workflow '"+ka.id+"'."):N("Workflow '"+ka.id+"' does not allow workflow definition override.")}else N("Workflow registration for source workflow '"+u.targetWorkflowId+"' was not found.")}else N("Not supported by this local SessionProxy instance.")};Xc.prototype.applyContextIdOnOperations=function(u){this.contextIdManager.applyContextIdOnOperations(u)};Xc.prototype.attachToWorkflowGraph=
function(u){this.addToWorkflowGraph(u);this.attachExecutionTrackerToEachWorkflow()};Xc.prototype.triggerRegisteredAnnotationCallbacks=function(u,N){this.callAnnotationCallbacks(u,N);if(this.hostCallbacks.onAnnotationResult)try{this.hostCallbacks.onAnnotationResult(u)}catch(V){wb.a.error(540301151,wb.b.CoreDefault,new Pc({operationName:"HostCallbackOnAnnotationResultError",dimension0:N,resultDescription:"onAnnotationResult error: "+V}))}};Xc.prototype.attachExecutionTrackerToEachWorkflow=function(){this.localWorkflowManager&&
this.localWorkflowManager.attachExecutionTrackerToEachWorkflow(this.workflowGraph,this,this.onWorkflowExecutionComplete.bind(this))};Xc.prototype.onWorkflowExecutionCompleteMessage=function(u,N){N(void 0,new yg);if(this.localWorkflowManager)this.localWorkflowManager.onExternalWorkflowExecuted(u.contextId,u.workflowId,this)};Xc.prototype.onWorkflowExecutionComplete=function(){};Xc.prototype.enableDeltaGenerator=function(){var u,N;this.deltaGenerator=null!==(u=this.deltaGenerator)&&void 0!==u?u:new Xg;
this.syncDeltaTimers=null!==(N=this.syncDeltaTimers)&&void 0!==N?N:new Map};Xc.prototype.createDeltasFromUpdateOperation=function(u){var N,V,ka=[];wb.a.info(523776396,wb.b.CoreDefault,"Calling delta create for UpdateOperation under parent path ["+u.parentPath+"] ("+(null===(N=u.items)||void 0===N?void 0:N.length)+" item(s), first item id: "+(0<(null===(V=u.items)||void 0===V?void 0:V.length)?u.items[0].id:"(no items)")+")");N=[].concat(D.Nh(u.parentPath));V=D.makeIterator(u.items);for(var wa=V.next();!wa.done;wa=
V.next()){wa=wa.value;var Ga=[],la=this.deltaGenerator.createTextTileDeltasFromItem(wa,u.parentPath);if(null!==la&&void 0!==la&&la.length){la=D.makeIterator(la);for(var ab=la.next();!ab.done;ab=la.next()){ab=ab.value;var nb=Sp();N=[].concat(D.Nh(u.parentPath),[wa.id]);Ga.push({id:nb,revId:wa.revId,body:ab,contextId:wa.contextId,source:wa.source})}0<Ga.length&&(ka.push(new mf({parentPath:N,items:Ga})),this.enableSyncDeltaSending&&this.setupSyncDeltaAfterDelay(wa,N,Ga))}else wb.a.info(523329632,wb.b.CoreDefault,
"Failed to create delta on item "+wa.id)}return ka};Xc.prototype.setupSyncDeltaAfterDelay=function(u,N,V){var ka=this,wa,Ga,la,ab=this.syncDeltaTimers.get(u.id);ab&&(clearTimeout(ab),this.syncDeltaTimers.delete(u.id));if(V=V.find(function(nb){var sb;return(null===(sb=nb.body)||void 0===sb?void 0:sb.unit)===rg.Chars}))V=V.body,ab={content:"",deltaType:Qg.Update,length:0,position:(null!==(wa=null===V||void 0===V?void 0:V.position)&&void 0!==wa?wa:0)+(null!==(la=null===(Ga=null===V||void 0===V?void 0:
V.content)||void 0===Ga?void 0:Ga.length)&&void 0!==la?la:0),unit:rg.Sentence},wa=Ih.typeGuard(u.body)?new Vf(ab):new Zh(ab),wa={id:Sp(),revId:u.revId,body:wa,contextId:u.contextId,source:u.source},N=new mf({parentPath:N,items:[wa]}),N=setTimeout(function(nb,sb){ka.submitOperation(nb);ka.syncDeltaTimers.delete(sb)},this.syncDeltaTimeout,N,u.id),this.syncDeltaTimers.set(u.id,N)};Xc.prototype.addToWorkflowGraph=function(u){this.workflowGraph.addWorkflow(Eg(u))};Xc.prototype.getAuthToken=function(u,
N){var V={Tickets:[]};this.clientMetadata.docSessionId&&(V.DocSessionId=this.clientMetadata.docSessionId);var ka=u===uo.Substrate?Sc.Substrate:void 0;ka&&(V.TokenType=ka);this.hostCallbacks.requestAuthToken(V).then(function(wa){var Ga;wa?N(void 0,wa.Token,{returnedTokenType:u,timeToLiveSec:null===(Ga=wa.TokenProperties)||void 0===Ga?void 0:Ga.timeToLiveSec}):N(Error("Missing AuthTokenResponse from requestAuthToken"))}).catch(function(wa){return N(wa)})};Xc.prototype.resetNextSyncSequenceId=function(){this.nextSyncSequenceId=
1};Xc.prototype.onReconnect=function(){var u=this;this.annotationActivationTrackers.forEach(function(N){u.activateAnnotationForTracker(N,{ignoreExistingAnnotations:!0,Qrb:!0}).catch(function(){})});this.reconnectCallbacks.forEach(function(N){N()});if(!this.connectParams)throw Error("Expected onConnect before onReconnect");};Xc.prototype.onSessionClose=function(u){this.isSessionClosed=!0;this.connectParams=void 0;this.sessionCloseCallbacks.forEach(function(N){N(u)})};Xc.prototype.onConnect=function(u,
N,V,ka,wa,Ga){this.hasSessionConnected?u&&(this.allowGroupSeed=this.allowSeed=!0,this.seedGroupSize=0,this.seedBatchedOperationsManager&&(this.seedBatchedOperationsManager.removeAllBatchedItems(),this.seedBatchedOperationsManager=void 0),this.batchedOperationsManager&&(this.batchedOperationsManager.removeAllBatchedItems(),this.batchedOperationsManager=void 0)):this.enableRemoteExecutionNotification&&this.addDownstreamWorkflowsIntoClientGraph(Ga);this.connectParams={isSeedingRequired:u,sessionUrl:N,
origin:V,authToken:ka};this.hasSessionConnected=!0;this.tryActivateWorkflows();Ga=D.makeIterator(this.pendingConnectCallbacks);for(var la=Ga.next();!la.done;la=Ga.next())la=la.value,la(this.connectParams);this.connectCallbacks.forEach(function(ab){ab(u,N,V,ka)});this.serverInputTypes=wa};Xc.prototype.onDisconnect=function(u){this.connectParams=void 0;this.disconnectCallbacks.forEach(function(N){N(u)})};Xc.prototype.onServerAuthenticationStateChange=function(u){if(u!=this.serverAuthenticationState&&
(this.serverAuthenticationState!=Bg.Authenticated||u!=Bg.Pending)){this.serverAuthenticationState=u;u=D.makeIterator(this.serverAuthenticationStateChangeCallback);for(var N=u.next();!N.done;N=u.next())N=N.value,N(this.serverAuthenticationState)}};Xc.prototype.callAnnotationCallbacks=function(u,N){0!==this.annotationCallbacks.size&&(N=this.annotationCallbacks.get(N))&&N.forEach(function(V){V(u)})};Xc.prototype.getOperationBatchConfig=function(u){return{delayMs:u.delayMs,delayMsMax:u.delayMsMax,maxInputSize:u.maxInputSize,
estimateSize:od,groupingKeyExtractor:function(){return"operations"},multiplex:function(N){return{input:N.filter(function(V){return V.length}).reduce(function(V,ka){return V.concat(ka)},[]),demultiplex:function(){return[[]]}}},split:function(N){if(!(1>=N.length))return{inputs:N.reduce(function(V,ka){V.push([ka]);return V},[]),join:function(){return[]}}}}};Xc.prototype.sendSeedMessagesViaBatchManager=function(u,N,V){var ka=this;this.seedBatchedOperationsManager||(this.seedBatchedOperationsManager=new ac(function(wa,
Ga,la){ka.seedGroupSize++;ka.sendMessageToSession(new Te({cv:Ga.cv,seq:0,ops:wa,groupId:"Seed",groupSize:Ga.groupComplete?ka.seedGroupSize:void 0,groupComplete:Ga.groupComplete?Ga.groupComplete:void 0}),function(ab){la(ab?Error(ab.error):void 0)})},this.reduceBatchOperationsEnabled));this.seedBatchedOperationsManager.addBatchItem(u,this.operationBatchConfig,{name:"SubmitSeedOperations"},V,N)};Xc.prototype.onAnnotationResultsFromServer=function(u,N){this.onAnnotationResults(u,Rg.ServerWorkflow,N)};
Xc.prototype.onAnnotationResultsFromLocal=function(u,N){this.onAnnotationResults(u,Rg.LocalWorkflow,N)};Xc.prototype.getLocalRegisteredWorkflows=function(){return this.workflowRuntime?this.workflowRuntime.getRegisteredWorkflows():this.localWorkflowManager?this.localWorkflowManager.getAllRegisteredWorkflowsFromSession(this).map(function(u){return Eg(u)}):[]};Xc.prototype.sendWorkflowGraphInitMessage=function(){var u=this,N=this.getLocalRegisteredWorkflows(),V=(new Pc({operationName:"WorkflowGraphInit",
success:!0})).setClientMetadata(this.clientMetadata).start(),ka=new kn({upstreamRuntimeWorkflows:N});this.sendMessageToSession(ka,function(wa,Ga){wa?nh(V,wa.error):(V.resultDescription="local workflows: "+N.map(function(la){return la.id})+", remote workflows: "+Ga.downstreamRuntimeWorkflows.map(function(la){return la.id}),nh(V),u.onWorkflowGraphInitResponse(Ga))})};Xc.prototype.trySendWorkflowGraphInitMessage=function(){var u=this;!this.graphInitMessageTimer&&this.enableRemoteExecutionNotification&&
(this.graphInitMessageTimer=setTimeout(function(){u.graphInitMessageTimer=void 0;u.sendWorkflowGraphInitMessage()},10))};Xc.prototype.onWorkflowGraphInitResponse=function(u){this.addDownstreamWorkflowsIntoClientGraph(u.downstreamRuntimeWorkflows);this.tryActivateWorkflows()};Xc.prototype.addDownstreamWorkflowsIntoClientGraph=function(u){this.workflowGraph.removeWorkflows(!0);u=D.makeIterator(u||[]);for(var N=u.next();!N.done;N=u.next())this.workflowGraph.addWorkflow(N.value,!0);this.workflowRuntime||
this.attachExecutionTrackerToEachWorkflow()};Xc.prototype.resolvePlaceholdersInOperationParentPath=function(u){var N=u;3==N.length&&"session"==N[0]&&"user"==N[1]&&N[2].startsWith("user_")&&(wb.a.info(540848914,wb.b.CoreDefault,"Replacing user context placeholder for: "+Ka(u)+"."),N=["session","#userContext#"]);3==N.length&&"session"==N[0]&&"user"==N[1]&&N[2].startsWith("tenant_")&&(wb.a.info(540848915,wb.b.CoreDefault,"Replacing tenant context placeholder for: "+Ka(u)+"."),N=["session","#tenantContext#"]);
return N};Xc.prototype.filterOperationsForSession=function(u){if(this.workflowRuntime)var N=!0;else a:if(N=this.serverInputTypes,!Array.isArray(N)||0===N.length||mf.typeGuard(u)||Mi.typeGuard(u))N=!0;else{u=D.makeIterator(u.items);for(var V=u.next();!V.done;V=u.next())if(V=V.value,!V.body||Eb.matchesTypesFor(V.body,N)){N=!0;break a}N=!1}return N};Xc.prototype.makeRequestForConnectParams=function(u,N){var V=u.sessionUrl,ka=N.body;return Object(im.fetch)(N.ZLf||V,{method:N.method,headers:Object.assign({Authorization:"Bearer "+
u.authToken,"x-origin":u.origin,"x-correlationid":N.cv},N.headers),body:ka}).then(function(wa){if(200!==wa.status)throw Error("Unexpected status code: "+wa.status);return wa})};Xc.prototype.sendLargeBinaryDataMessage=function(u,N,V){var ka=(new Pc({operationName:"SendLargeBinaryDataMessage",success:!0,cv:N.cv})).setClientMetadata(this.clientMetadata).start(),wa;void this.makeRequestForConnectParams(u,{headers:{"Content-Type":"application/jsond"},body:tt.a.serialize(N),cv:ka.cv,method:"POST"}).then(function(Ga){return Ga.json()}).catch(function(Ga){wa=
new Kh({messageId:N.messageId,error:Ga.message})}).then(function(Ga){nh(ka,wa?wa.error:void 0);V(wa,Ga)})};Xc.prototype.requestBinaryData=function(u,N,V){var ka=(new Pc({operationName:"RequestBinaryData",success:!0,cv:(new Lh).toString()})).setClientMetadata(this.clientMetadata).start(),wa=u.sessionUrl,Ga;void this.makeRequestForConnectParams(u,{cv:ka.cv,method:"GET",ZLf:N.refType===er.AlCodedLocation?wa+"/blob/"+N.value:N.value}).then(function(la){return la.arrayBuffer()}).then(function(la){return new Uint8Array(la)}).catch(function(la){Ga=
la}).then(function(la){nh(ka,Ga?Ga.message:void 0);V(Ga,la)})};Xc.prototype.executeCallbacksOnAnnotationSubmitted=function(u){var N=this;this.getAnnotationOperationsByType(u).forEach(function(V,ka){Array.from(V).forEach(function(wa){return N.triggerRegisteredAnnotationCallbacks(wa,ka)})})};Xc.prototype.partitionAnnotationOperations=function(u){return u.reduce(function(N,V){var ka=D.makeIterator(N);N=ka.next().value;ka=ka.next().value;return V.items.some(function(wa){return wa.body&&Bh.typeGuard(wa.body)})?
[[].concat(D.Nh(N),[V]),ka]:[N,[].concat(D.Nh(ka),[V])]},[[],[]])};Xc.prototype.onAnnotationsSubmitted=function(u,N){var V=this;this.getAnnotationOperationsByType(u).forEach(function(ka,wa){ka=Array.from(ka);V.onAnnotationResults(new xk({annotationType:wa,ops:ka,cv:N}),Rg.Submitted,function(){})})};Xc.prototype.getAnnotationOperationsByType=function(u){var N=new Map;u=D.makeIterator(u);for(var V=u.next();!V.done;V=u.next()){V=V.value;for(var ka=D.makeIterator(V.items),wa=ka.next();!wa.done;wa=ka.next())if(wa=
wa.value,wa.body&&Bh.typeGuard(wa.body)){wa=Eb.getTypeNameFor(wa.body);var Ga=N.get(wa)||new Set;Ga.add(V);N.set(wa,Ga)}}return N};D.global.Object.defineProperties(Xc.prototype,{isConnected:{configurable:!0,enumerable:!0,get:function(){return!!this.connectParams}},hasConnected:{configurable:!0,enumerable:!0,get:function(){return this.hasSessionConnected}},isClosed:{configurable:!0,enumerable:!0,get:function(){return this.isSessionClosed}}});var vo;(function(u){u[u.Anonymous=0]="Anonymous";u[u.Host=
1]="Host"})(vo||(vo={}));Hd.prototype.scheduleRefresh=function(u,N,V,ka){var wa=this.timers.get(u);wa||(wa={numberOfAttempts:0},this.timers.set(u,wa));wa.refreshTimeoutId&&(clearTimeout(wa.refreshTimeoutId),wa.refreshTimeoutId=void 0);wa.expiredTimeoutId&&(clearTimeout(wa.expiredTimeoutId),wa.expiredTimeoutId=void 0);u=1E3*N-Hd.tokenRefreshBufferMs;N=1E3*N-Hd.tokenExpirationBufferMs;0<u?wa.numberOfAttempts=0:(++wa.numberOfAttempts,u=Hd.tokenRefreshBackoffIntervalMs,N=Hd.tokenExpirationBufferMs);wa.numberOfAttempts<=
Hd.tokenRefreshMaximumAttempts&&(wa.refreshTimeoutId=setTimeout(function(){V()},u));ka&&(wa.expiredTimeoutId=setTimeout(function(){ka()},N))};Hd.prototype.clearRefreshTimeouts=function(){this.clearTimeouts(!1)};Hd.prototype.clearAllTimeouts=function(){this.clearTimeouts(!0)};Hd.prototype.clearTimeouts=function(u){var N=this;this.timers.forEach(function(V,ka){V.refreshTimeoutId&&(clearTimeout(V.refreshTimeoutId),V.refreshTimeoutId=void 0);u&&V.expiredTimeoutId&&(clearTimeout(V.expiredTimeoutId),V.expiredTimeoutId=
void 0);V.expiredTimeoutId||N.timers.delete(ka)})};Hd.tokenRefreshBufferMs=24E4;Hd.tokenExpirationBufferMs=12E4;Hd.tokenRefreshBackoffIntervalMs=3E4;Hd.tokenRefreshMaximumAttempts=3;var lj=Ri.EventEmitter;D.ha(yc,lj);yc.prototype.initSession=function(u){var N=this;u.onResponse=u.onResponse||function(){};var V=mc.getCurrentTimeMs(),ka=this.getSessionStats().lastConnectionClose&&V-this.getSessionStats().lastConnectionClose;V=this.getSessionStats().lastSyncMessage&&V-this.getSessionStats().lastSyncMessage;
var wa=(new Pc({operationName:"SessionInit"})).start(),Ga={sessionKey:this.sessionKey,sessionId:this.clientMetadata.sessionId,lqg:ka,mqg:V,isTokenRefresh:u.isTokenRefresh,enableRemoteExecutionNotification:this.options.enableRemoteExecutionNotification,error:void 0};ka=this.options.overrideSessionInitMessage(new xg({protocolVersion:2,clientMetadata:this.clientMetadata,sessionKey:this.sessionKey,origin:this.origin,authToken:this.anonymousToken,extensionConfigs:u.extensionConfigs,returnWorkflowInputTypes:!0,
enableRemoteExecutionNotification:this.options.enableRemoteExecutionNotification}));this.sendMessage(ka,function(la,ab){wa.success=!la;wa.resultSignature=N.getSessionStats().lastConnectionClose?"Reconnect":"FirstConnect";wa.resourceId=null===ab||void 0===ab?void 0:ab.sliceUrl;wa.setClientMetadata(N.clientMetadata);(null===ab||void 0===ab?0:ab.sessionKey)&&Ga.sessionKey!==ab.sessionKey&&(Ga.sessionKey=ab.sessionKey);la&&(Ga.error=la.error);wa.resultDescription=JSON.stringify(Ga);wb.a.info(508843779,
wb.b.CoreDefault,wa.stop());u.onResponse(la,ab);la?N.emit("serverAuthenticationStateChange",Bg.NotAuthenticated):u.isReconnectOnSameSlice&&ab.forceReconnect?N.emit("serverAuthenticationStateChange",Bg.NotAuthenticated):ab.anonymousToken&&ab.tokenExpirationSeconds?(N.anonymousToken=ab.anonymousToken,N.onSuccessfulSessionInitOnServerSide(ab)):(N.emit("serverAuthenticationStateChange",Bg.NotAuthenticated),wb.a.error(508843778,wb.b.CoreDefault,"AL Anonymous token was not generated for the session"))})};
yc.prototype.onSuccessfulSessionInitOnServerSide=function(u){var N=this;this.tokenRefreshManager.scheduleRefresh(vo.Anonymous,u.tokenExpirationSeconds,this.initSession.bind(this,{isTokenRefresh:!0}),function(){N.anonymousToken=void 0});this.initHostAuthToken();var V=!!this.sessionKey,ka=this.sessionKey!==u.sessionKey;this.sessionKey=u.sessionKey;this.origin=u.origin;this.emit("connect",ka,V,u.sessionUrlBase+"/"+u.sessionKey,u.origin,this.anonymousToken,u.workflowInputTypes,u.downstreamRuntimeWorkflows);
V&&this.emit("reconnect")};yc.prototype.initHostAuthToken=function(){var u=this;if(this.options.getAuthToken){var N=(new Pc({operationName:"RefreshAuthToken",success:!0})).setClientMetadata(this.clientMetadata).start();this.options.getAuthToken().then(function(V){V?(wb.a.info(508843776,wb.b.CoreDefault,N.stop()),u.sendTokenProvisionMessage(V)):(u.emit("serverAuthenticationStateChange",Bg.NotAuthenticated),N.success=!1,N.resultDescription="Host auth token provision failed",wb.a.info(508843777,wb.b.CoreDefault,
N.stop()))}).catch(function(V){u.emit("serverAuthenticationStateChange",Bg.NotAuthenticated);N.success=!1;N.resultDescription="Error happened while attempting to fetch host token: "+V;wb.a.error(508843747,wb.b.CoreDefault,N.stop())})}};yc.prototype.sendTokenProvisionMessage=function(u){u=new wk({authToken:u});this.emit("serverAuthenticationStateChange",Bg.Pending);this.sendMessage(u,this.onTokenProvisionResponse.bind(this),!0)};yc.prototype.onTokenProvisionResponse=function(u,N){!u&&N&&N.tokenExpirationSeconds?
(this.emit("serverAuthenticationStateChange",N.tokenType&&N.tokenType==uo.WacUserInfo?Bg.WacUserInfoAuthenticated:Bg.Authenticated),this.tokenRefreshManager.scheduleRefresh(vo.Host,N.tokenExpirationSeconds,this.initHostAuthToken.bind(this))):this.emit("serverAuthenticationStateChange",Bg.NotAuthenticated)};Of.getTypeName=function(){return"AugLoop_Core_Blob"};Of.getBaseTypes=function(){return[]};Of.typeGuard=function(u){return Eb.matchesTypesFor(u,[Of.getTypeName()])};Of.H_={T_:Of.getTypeName(),B_:Of.getBaseTypes()};
Id.getTypeName=function(){return"AugLoop_Core_Binary"};Id.getBaseTypes=function(){return[]};Id.typeGuard=function(u){return Eb.matchesTypesFor(u,[Id.getTypeName()])};Id.H_={T_:Id.getTypeName(),B_:Id.getBaseTypes()};Cc.getTypeName=function(){return"AugLoop_Core_TileGroup"};Cc.getBaseTypes=function(){return[]};Cc.typeGuard=function(u){return Eb.matchesTypesFor(u,[Cc.getTypeName()])};Cc.H_={T_:Cc.getTypeName(),B_:Cc.getBaseTypes()};$c.getTypeName=function(){return"AugLoop_Core_Session"};$c.getBaseTypes=
function(){return["AugLoop_Core_TileGroup"]};$c.typeGuard=function(u){return Eb.matchesTypesFor(u,[$c.getTypeName()])};$c.H_={T_:$c.getTypeName(),B_:$c.getBaseTypes()};Vb.getTypeName=function(){return"AugLoop_Core_Document"};Vb.getBaseTypes=function(){return["AugLoop_Core_TileGroup"]};Vb.typeGuard=function(u){return Eb.matchesTypesFor(u,[Vb.getTypeName()])};Vb.H_={T_:Vb.getTypeName(),B_:Vb.getBaseTypes()};Oc.getTypeName=function(){return"AugLoop_Core_SubDocument"};Oc.getBaseTypes=function(){return[]};
Oc.typeGuard=function(u){return Eb.matchesTypesFor(u,[Oc.getTypeName()])};Oc.H_={T_:Oc.getTypeName(),B_:Oc.getBaseTypes()};kc.getTypeName=function(){return"AugLoop_Core_GridCell"};kc.getBaseTypes=function(){return[]};kc.typeGuard=function(u){return Eb.matchesTypesFor(u,[kc.getTypeName()])};kc.H_={T_:kc.getTypeName(),B_:kc.getBaseTypes()};Qb.getTypeName=function(){return"AugLoop_Core_GridNeighborhoodContext"};Qb.getBaseTypes=function(){return[]};Qb.typeGuard=function(u){return Eb.matchesTypesFor(u,
[Qb.getTypeName()])};Qb.H_={T_:Qb.getTypeName(),B_:Qb.getBaseTypes()};Yb.getTypeName=function(){return"AugLoop_Core_ItemFilter"};Yb.getBaseTypes=function(){return[]};Yb.typeGuard=function(u){return Eb.matchesTypesFor(u,[Yb.getTypeName()])};Yb.H_={T_:Yb.getTypeName(),B_:Yb.getBaseTypes()};Tc.getTypeName=function(){return"AugLoop_Core_DynamicContext"};Tc.getBaseTypes=function(){return[]};Tc.typeGuard=function(u){return Eb.matchesTypesFor(u,[Tc.getTypeName()])};Tc.H_={T_:Tc.getTypeName(),B_:Tc.getBaseTypes()};
gc.getTypeName=function(){return"AugLoop_Core_ContextHolder"};gc.getBaseTypes=function(){return[]};gc.typeGuard=function(u){return Eb.matchesTypesFor(u,[gc.getTypeName()])};gc.H_={T_:gc.getTypeName(),B_:gc.getBaseTypes()};Hb.getTypeName=function(){return"AugLoop_Core_UserContextHolder"};Hb.getBaseTypes=function(){return["AugLoop_Core_ContextHolder"]};Hb.typeGuard=function(u){return Eb.matchesTypesFor(u,[Hb.getTypeName()])};Hb.H_={T_:Hb.getTypeName(),B_:Hb.getBaseTypes()};ob.getTypeName=function(){return"AugLoop_Core_TenantContextHolder"};
ob.getBaseTypes=function(){return["AugLoop_Core_ContextHolder"]};ob.typeGuard=function(u){return Eb.matchesTypesFor(u,[ob.getTypeName()])};ob.H_={T_:ob.getTypeName(),B_:ob.getBaseTypes()};Va.getTypeName=function(){return"AugLoop_Core_EventsHolder"};Va.getBaseTypes=function(){return[]};Va.typeGuard=function(u){return Eb.matchesTypesFor(u,[Va.getTypeName()])};Va.H_={T_:Va.getTypeName(),B_:Va.getBaseTypes()};Ca.getTypeName=function(){return"AugLoop_Core_UserCommandsHolder"};Ca.getBaseTypes=function(){return["AugLoop_Core_EventsHolder"]};
Ca.typeGuard=function(u){return Eb.matchesTypesFor(u,[Ca.getTypeName()])};Ca.H_={T_:Ca.getTypeName(),B_:Ca.getBaseTypes()};var mj;(function(u){u[u.Undefined=0]="Undefined";u[u.Created=10]="Created";u[u.Sent=20]="Sent";u[u.Duplicated=30]="Duplicated";u[u.Seen=40]="Seen";u[u.Tried=50]="Tried";u[u.Kept=60]="Kept";u[u.Rejected=70]="Rejected"})(mj||(mj={}));var As;(function(u){u[u.JoinContext=0]="JoinContext";u[u.Session=1]="Session"})(As||(As={}));D.ha(fb,Error);var wo={default:{}};wo["default"]||(wo["default"]=
{});var gr=function(){function u(N){if(N)for(var V in N)null!=N[V]&&(this[V]=N[V])}u.prototype.sessionKey="";u.prototype.annotationType="";u.prototype.annotationState=0;u.prototype.workflowId="";u.getTypeUrl=function(N){void 0===N&&(N="type.googleapis.com");return N+"/AnnotationMetaDataChangeEvent"};return u}();D.ha(Ma,gr);lb.prototype.getModelIterator=function(){throw Error("Method not implemented.");};lb.prototype.getBody=function(){return this.item.body};lb.prototype.getItemReference=function(){throw Error("Method not implemented.");
};lb.prototype.getParentItem=function(){throw Error("Method not implemented.");};lb.prototype.getParentItemBody=function(){throw Error("Method not implemented.");};lb.prototype.getPrevItem=function(){throw Error("Method not implemented.");};lb.prototype.getPrevItemBody=function(){throw Error("Method not implemented.");};lb.prototype.getNextItem=function(){throw Error("Method not implemented.");};lb.prototype.getNextItemBody=function(){throw Error("Method not implemented.");};lb.prototype.getChildItem=
function(){throw Error("Method not implemented.");};lb.prototype.getChildItemBody=function(){throw Error("Method not implemented.");};lb.prototype.getChildItems=function(){throw Error("Method not implemented.");};lb.prototype.getChildItemBodies=function(){throw Error("Method not implemented.");};lb.prototype.getSubtreeItem=function(){throw Error("Method not implemented.");};lb.prototype.getSubtreeItemBody=function(){throw Error("Method not implemented.");};lb.prototype.getSubtreeItems=function(){throw Error("Method not implemented.");
};lb.prototype.getSubtreeItemBodies=function(){throw Error("Method not implemented.");};lb.prototype.getContextItem=function(){throw Error("Method not implemented.");};lb.prototype.getContextItemBody=function(){throw Error("Method not implemented.");};lb.prototype.getContextItems=function(){throw Error("Method not implemented.");};lb.prototype.getContextItemBodies=function(){throw Error("Method not implemented.");};lb.prototype.addAnnotation=function(){throw Error("Method not implemented.");};lb.prototype.updateAnnotation=
function(){throw Error("Method not implemented.");};lb.prototype.deleteAnnotation=function(){throw Error("Method not implemented.");};lb.prototype.loadSubtree=function(){throw Error("Method not implemented.");};lb.prototype.getSourceTimestamp=function(){return this.item.sourceTimestamp};lb.prototype.getContextId=function(){return this.item.contextId};D.global.Object.defineProperties(lb.prototype,{itemPath:{configurable:!0,enumerable:!0,get:function(){return[].concat(D.Nh(this.item.parentPath),[this.item.id])}}});
fc.prototype.getItem=function(){throw Error("Method not implemented.");};fc.prototype.getItems=function(){throw Error("Method not implemented.");};fc.prototype.getItemBody=function(u){return this.getItemBodies(u)[0]};fc.prototype.getItemBodies=function(u){u=this.normalizeFilter(u);return this.items.filter(u).map(function(N){return N.body})};fc.prototype.getItemByReference=function(){throw Error("Method not implemented.");};fc.prototype.getItemBodyByReference=function(){throw Error("Method not implemented.");
};var ne=[Qg.CursorUpdate,Qg.FormattingUpdate,Qg.OtherNonContentUpdate];ib.normalizeName=function(u){return null===u||void 0===u?void 0:u.toLowerCase()};ib.parseName=function(u){return(u=null===u||void 0===u?void 0:u.split("."))?u[u.length-1]:void 0};ib.prototype.hasFlight=function(u){var N=ib.normalizeName(u);u=this.normalizedFlights.has(N);var V=this.keyValueFlightsMap.has(N);N=this.parsedFlightsMap.has(N);return u||V||N};ib.prototype.getBooleanValue=function(u,N){var V,ka,wa=null===(V=this.getStringValue(u))||
void 0===V?void 0:V.toLowerCase();u=null===(ka=this.getStringValue(this.parsedFlightsMap.get(u)))||void 0===ka?void 0:ka.toLowerCase();return"true"===wa||"true"===u?!0:"false"===wa||"false"===u?!1:N};ib.prototype.getIntValue=function(u,N){u=this.getStringValue(u);u=Number.parseInt(u,10);return Number.isNaN(u)?N:u};ib.prototype.getStringValue=function(u,N){var V;return null!==(V=this.keyValueFlightsMap.get(ib.normalizeName(u)))&&void 0!==V?V:N};ib.prototype.getAll=function(){return this.originalFlights};
ib.prototype.getAllParsed=function(){var u=[];this.keyValueFlightsMap.forEach(function(N,V){var ka=null===N||void 0===N?void 0:N.toLowerCase();switch(ka){case "true":u.push({name:V,value:!0});break;case "false":u.push({name:V,value:!1});break;default:ka=Number.parseInt(ka,10),Number.isNaN(ka)?u.push({name:V,value:N}):u.push({name:V,value:ka})}});return u};pb.prototype.getToken=function(u,N){return this.getToken(u,N)};D.global.Object.defineProperties(pb.prototype,{flights:{configurable:!0,enumerable:!0,
get:function(){var u;null!==(u=this._flights)&&void 0!==u?u:this._flights=Nm(this.clientMetadata.flights);return this._flights}}});La.prototype.addInputItemToProcess=function(u){this.itemsContextId.add(u)};La.prototype.removeProcessedInputItem=function(u){this.itemsContextId.delete(u)};La.prototype.countItemsToProcess=function(u){for(var N=0,V=D.makeIterator(this.itemsContextId),ka=V.next();!ka.done;ka=V.next())0===ka.value.indexOf(u)&&(N+=1);return N};La.prototype.getExecutionState=function(){return this.executionState};
La.prototype.setExecutionState=function(u,N){if(!this.graphNode.isActivated)return wb.a.info(508883415,wb.b.CoreDefault,new Pc({operationName:"WorkflowExecutionTracker",resourceId:this.graphNode.workflow.id,joinContextId:u,resultDescription:"Trying to set state "+N+" for a not activated workflow"})),!1;if(!u)return wb.a.info(520217546,wb.b.CoreDefault,new Pc({operationName:"WorkflowExecutionTracker",resourceId:this.graphNode.workflow.id,joinContextId:u,resultDescription:"Trying to set state "+N+" for a undefined contextId (setExecutionState)"})),
!1;this.executionState.set(u,N);return!0};La.prototype.beforeWorkflowExecution=function(u){this.setExecutionState(u,Qf.Pending)};La.prototype.afterWorkflowExecution=function(u){this.setExecutionState(u,Qf.Executed)&&this.tryToCompleteWorkflowExecution(u)};La.prototype.clearWorkflowExecutions=function(){var u=this;this.executionState.forEach(function(N,V){return u.afterWorkflowExecution(V)})};La.prototype.tryToCompleteWorkflowExecution=function(u){if(this.executionState.get(u)===Qf.Executed&&this.canCompleteExecution(u)){this.executionState.delete(u);
if(this.onContextIdWorkflowExecutionComplete)this.onContextIdWorkflowExecutionComplete(this.graphNode.workflow.id,u);for(var N=D.makeIterator(this.downstreamWorkflowExecutionTrackers),V=N.next();!V.done;V=N.next()){V=V.value;for(var ka=D.makeIterator(V.getExecutionState()),wa=ka.next();!wa.done;wa=ka.next()){wa=D.makeIterator(wa.value);var Ga=wa.next().value;wa.next().value===Qf.Executed&&ui.isParentContextId(u,Ga)&&V.tryToCompleteWorkflowExecution(Ga)}}}};La.prototype.canCompleteExecution=function(u){for(var N=
D.makeIterator(this.upstreamWorkflowExecutionTrackers),V=N.next();!V.done;V=N.next()){V=D.makeIterator(V.value.getExecutionState().keys());for(var ka=V.next();!ka.done;ka=V.next())if(ui.isParentContextId(ka.value,u))return!1}return!0};var mg;(function(u){u.Unknown="";u.uSd="input";u.loc="maxAnnotation";u.zSd="maxTimeout";u.koc="earlyCompletion"})(mg||(mg={}));yd.prototype.getNextClientAnnotationId=function(){return"#AC"+this.nextAnnotationId++};yd.prototype.getNextClientSignalId=function(){return"#SC"+
this.nextSignalId++};yd.prototype.registerLocalWorkflow=function(u,N){var V=this,ka=(new Pc({operationName:"WorkflowRegistration",resourceId:u.id})).start();if(0===u.inputTypes.length)throw Error("Invalid workflow params");N?(this.workflowsWithSessionAffinity.get(N).push(this.createWorkflowImplementation(u,N)),N.registerContextTypes(yb(u.requestedContextTypesRules).map(function(wa){wa=D.makeIterator(wa);var Ga=wa.next().value;wa.next();return Ga})),N.attachToWorkflowGraph(u),ka.setClientMetadata(N.getClientMetadata())):
(u.isStateful?(this.workflowDefinitionsWithSessionAffinity.push(u),this.workflowsWithSessionAffinity.forEach(function(wa,Ga){wa.push(V.createWorkflowImplementation(u,Ga))})):this.workflowsWithoutSessionAffinity.push(this.createWorkflowImplementation(u)),this.workflowsWithSessionAffinity.forEach(function(wa,Ga){Ga.registerContextTypes(yb(u.requestedContextTypesRules).map(function(la){la=D.makeIterator(la);var ab=la.next().value;la.next();return ab}));Ga.attachToWorkflowGraph(u)}));ka.success=!0;wb.a.info(572838110,
wb.b.CoreDefault,ka.stop())};yd.prototype.getAllRegisteredWorkflowsFromSession=function(u){var N=[];N.push.apply(N,D.Nh(this.workflowsWithoutSessionAffinity||[]));N.push.apply(N,D.Nh(this.workflowsWithSessionAffinity.get(u)||[]));return N.map(function(V){return V.workflow})};yd.prototype.getWorkflowDefinitionsByName=function(u){var N,V=new Map;null===(N=this.workflowsWithSessionAffinity.get(u))||void 0===N?void 0:N.forEach(function(ka){return V.set(ka.workflow.id,ka.workflow)});return V};yd.prototype.getWorkflowDefinitionsWithSessionAffinity=
function(){return this.workflowDefinitionsWithSessionAffinity};yd.prototype.attachExecutionTrackerToEachWorkflow=function(u,N,V){function ka(nb,sb){V&&V(nb,sb);if(nb=wa.enableEarlyJoin)a:{nb=D.makeIterator(wa.executionTrackersByWorkflowNameBySession.get(N).values());for(var Db=nb.next();!Db.done;Db=nb.next())if(Db=Db.value,Db.graphNode.workflow.kind===Hg.Join){Db=D.makeIterator(Db.getExecutionState().keys());for(var bc=Db.next();!bc.done;bc=Db.next())if(ui.isParentContextId(bc.value,sb)){nb=!0;break a}}nb=
!1}nb&&(wa.cancelSweepTimer(N),wa.ensureSweepTimer(N),wa.sweepScopeExecutionNotifications())}var wa=this,Ga=u.getWorkflowNodes();u=this.executionTrackersByWorkflowNameBySession.get(N);Ga=D.makeIterator(Ga);for(var la=Ga.next();!la.done;la=Ga.next()){la=la.value;var ab=u.get(la.workflow.id);ab=new La(la,ka.bind(this),ab);u.set(la.workflow.id,ab)}Ga=D.makeIterator(u.values());for(la=Ga.next();!la.done;la=Ga.next())la=la.value,this.setDownstreamWorkflowExecutionTrackers(la,u),this.setUpstreamWorkflowExecutionTrackers(la,
u)};yd.prototype.canActivateWorkflow=function(u,N){var V;return u.location===Um.Local?!0:!N.hasConnected||0<(null===(V=u.workflow.requiredTokenTypes)||void 0===V?void 0:V.length)&&N.getServerAuthenticationState()===Bg.NotAuthenticated?!1:!0};yd.prototype.setDownstreamWorkflowExecutionTrackers=function(u,N){if(void 0===u.downstreamWorkflowExecutionTrackers){u.downstreamWorkflowExecutionTrackers=new Set;for(var V=D.makeIterator(u.graphNode.downstreamWorkflows||[]),ka=V.next();!ka.done;ka=V.next())ka=
N.get(ka.value.workflow.id),this.setDownstreamWorkflowExecutionTrackers(ka,N),u.downstreamWorkflowExecutionTrackers.add(ka)}};yd.prototype.setUpstreamWorkflowExecutionTrackers=function(u,N){if(void 0===u.upstreamWorkflowExecutionTrackers){u.upstreamWorkflowExecutionTrackers=new Set;for(var V=D.makeIterator(u.graphNode.upstreamWorkflows||[]),ka=V.next();!ka.done;ka=V.next())ka=N.get(ka.value.workflow.id),this.setUpstreamWorkflowExecutionTrackers(ka,N),u.upstreamWorkflowExecutionTrackers.add(ka)}};
yd.prototype.deactivateServerWorkflow=function(u,N){var V;u.location!==Um.Local&&(null===(V=this.executionTrackersByWorkflowNameBySession.get(N))||void 0===V?void 0:V.get(u.workflow.id).clearWorkflowExecutions(),u.isActivated=!1)};yd.prototype.addSession=function(u){this.executionTrackersByWorkflowNameBySession.set(u,new Map);for(var N=[],V=D.makeIterator(this.workflowDefinitionsWithSessionAffinity),ka=V.next();!ka.done;ka=V.next())ka=ka.value,N.push(this.createWorkflowImplementation(ka)),u.attachToWorkflowGraph(ka);
this.workflowsWithSessionAffinity.set(u,N);N=D.makeIterator(this.workflowsWithoutSessionAffinity);for(V=N.next();!V.done;V=N.next())u.attachToWorkflowGraph(V.value.workflow)};yd.prototype.closeSession=function(u){this.cancelSweepTimer(u);for(var N=D.makeIterator(this.workflowsWithSessionAffinity.get(u)||[]),V=N.next();!V.done;V=N.next())V.value.uQd.dispose();this.workflowsWithSessionAffinity.delete(u)};yd.prototype.setTokenCallback=function(u){this.getAuthTokenCallback=u};yd.prototype.preProcessItemToWorkflow=
function(u,N,V){V=this.executionTrackersByWorkflowNameBySession.get(V).get(u.id);u.kind===Hg.Join&&Eb.matchesTypesFor(N.body,u.inputTypes)&&V.addInputItemToProcess(N.contextId);(u.kind===Hg.SingleItem&&Eb.matchesTypesFor(N.body,u.inputTypes)||u.kind===Hg.Join&&Eb.matchesTypesFor(N.body,[u.collectionScopeType]))&&V.beforeWorkflowExecution(N.contextId)};yd.prototype.isReadyToEarlyJoin=function(u,N,V){function ka(nb){var sb,Db=Array.from(null!==(sb=nb.Ntb)&&void 0!==sb?sb:[]).map(function(bc){return bc[0]+
": "+bc[1].map(function(Xb){return Xb.join()})}).join();sb=(new Pc({operationName:"EarlyJoinCompletion",resourceId:u.graphNode.workflow.id,joinContextId:N,success:!0})).start();sb.setClientMetadata(V);sb.resultDescription="isReadyToEarlyJoin ("+wa.enableEarlyJoin+") -> hasProcessedAllInputItems: "+nb.vcd+", allUpstreamComplete: "+nb.Icb+", states: "+Db;wb.a.info(512550800,wb.b.CoreDefault,sb.stop())}var wa=this,Ga=0===u.countItemsToProcess(N);if(!Ga)return this.enableEarlyJoin||ka({vcd:Ga}),!1;var la=
this.areAllUpstreamWorkflowComplete(u,N),ab=la.Icb;la=la.Ntb;return this.enableEarlyJoin?ab:(ka({vcd:Ga,Icb:ab,Ntb:la}),!1)};yd.prototype.areAllUpstreamWorkflowComplete=function(u,N){var V=new Map;u=D.makeIterator(u.upstreamWorkflowExecutionTrackers);for(var ka=u.next();!ka.done;ka=u.next()){ka=ka.value;for(var wa=[],Ga=D.makeIterator(ka.getExecutionState()),la=Ga.next();!la.done;la=Ga.next()){var ab=D.makeIterator(la.value);la=ab.next().value;ab=ab.next().value;wa.push([la,ab]);if(ui.isParentContextId(N,
la))return V.set(ka.graphNode.workflow.id,wa),{Icb:!1,Ntb:V}}0<wa.length&&V.set(ka.graphNode.workflow.id,wa)}return{Icb:!0,Ntb:V}};yd.prototype.runLocalWorkflows=function(u,N,V){function ka(Gc,oe,pe){var md,yf,Zd=N.getWorkflowItemStorage(),rd=Gc.workflow,Ui=null===(md=wa.executionTrackersByWorkflowNameBySession.get(N))||void 0===md?void 0:md.get(rd.id);md=rd.inputTypes.concat(rd.kind===Hg.Join?rd.collectionScopeType:[]);var dh=(new Pc({operationName:"RunLocalWorkflows",success:!0,resourceId:rd.id,
joinContextId:oe.contextId})).start();dh.setClientMetadata(N.getClientMetadata());if(Eb.matchesTypesFor(oe.body,md)){var Ld=mb(pe.parentPath,oe);if(rd.kind===Hg.Join){if(Eb.matchesTypesFor(Ld.body,[rd.collectionScopeType])){Zd.setScopeItem(Ld,rd);dh.resultDescription="Scope item: "+oe.id+" ("+Eb.getTypeNameFor(oe.body)+")";wb.a.info(524126153,wb.b.CoreDefault,dh.stop());wa.setScopeExecutionNotification(N,Gc,Ld,kj.Internal);return}Ui.removeProcessedInputItem(Ld.contextId);pe=Zd.getScopeItem(Ld.contextId,
rd);if(!pe){dh.resultDescription="Filtered out join invalidation: out of scope type ("+rd.collectionScopeType+"), item id: "+Ld.id;wb.a.info(541173894,wb.b.CoreDefault,dh.stop());return}Zd.addItemToWorkflowList(Ld,rd);dh.joinContextId=pe.contextId;dh.resultDescription="Input item: "+oe.id+" ("+Eb.getTypeNameFor(oe.body)+")"}if(0<=Eb.getBaseTypesFor(Ld.body).indexOf(gc.getTypeName())){pe=[].concat(D.Nh(Ld.parentPath),[Ld.id]);md=!0;var ak=D.makeIterator(null!==(yf=rd.outputTypes)&&void 0!==yf?yf:[]);
for(yf=ak.next();!yf.done;yf=ak.next())if(!N.getContextAnnotations(yf.value,Rg.LocalWorkflow,pe,rd.id)){md=!1;break}if(md)return}var Rf=function(){var Vd,ig=D.makeIterator(N.resolveRequestedContexts(rd)),ug=ig.next().value;ig=ig.next().value;if(!ug)dh.resultDescription="Required contexts are not ready for "+rd.id+". Retrying execution in 500 milliseconds...",wb.a.info(545837259,wb.b.CoreDefault,dh.stop()),setTimeout(Rf,500);else if(rd.kind===Hg.SingleItem)wa.queueWorkflow({h0a:Gc,scopeItem:Ld,inputItems:[Ld],
requestedContexts:ig,session:N,QVa:kj.Internal,UX:mg.uSd,Unb:wa.onWorkflowExecuted.bind(wa,Ld,rd,N)}).then(function(){wb.a.info(509154263,wb.b.WorkflowDefault,dh.stop())}).catch(function(vg){dh.resultDescription=vg;wb.a.error(572838111,wb.b.CoreDefault,dh.stop())});else if(rd.kind===Hg.Join){var Gj=oe.contextId;if(ug=Zd.getScopeItem(Gj,Gc.workflow)){var Xn=wa.isReadyToEarlyJoin(Ui,ug.contextId,N.getClientMetadata());Gj=Xn?mg.koc:mg.loc;if(Zd.isWorkflowReady(ug.contextId,rd)||Xn)null!==(Vd=wa.pendingScopeExecutionNotificationsByWorkflow.get(rd.id))&&
void 0!==Vd&&Vd.get(ug.contextId)?(Vd=Zd.getItemsToExecute(ug.contextId,rd),wa.queueWorkflow({h0a:Gc,scopeItem:ug,inputItems:Vd,requestedContexts:ig,session:N,QVa:kj.Internal,UX:Gj,Unb:wa.onWorkflowExecuted.bind(wa,ug,rd,N)}).then(function(){wb.a.info(509154262,wb.b.WorkflowDefault,dh.stop())}).catch(function(vg){dh.resultDescription=vg;wb.a.error(541173895,wb.b.CoreDefault,dh.stop())}),wa.pendingScopeExecutionNotificationsByWorkflow.get(rd.id).delete(ug.contextId),0===wa.pendingScopeExecutionNotificationsByWorkflow.get(rd.id).size&&
wa.pendingScopeExecutionNotificationsByWorkflow.delete(rd.id)):(dh.resultDescription="Workflow "+rd.id+", contextId "+ug.contextId+", already queued, skipping new scope execution",wb.a.info(528048977,wb.b.CoreDefault,dh.stop()))}else dh.resultDescription="No scope item for "+rd.id+" workflow from contextId "+Gj,wb.a.info(526758475,wb.b.CoreDefault,dh.stop())}};Rf()}}var wa=this,Ga,la,ab,nb=u;if(void 0===V?0:V)nb=[new Mh({parentPath:["session"],items:[{id:"#userContext#",body:new Hb}]}),new Mh({parentPath:["session"],
items:[{id:"#tenantContext#",body:new ob}]})],N.getContextIdManager().applyContextIdOnOperations(nb),nb=nb.concat(u);u=D.makeIterator(nb);for(V=u.next();!V.done;V=u.next()){V=V.value;nb=Eb.getTypeNameFor(V);for(var sb=D.makeIterator(V.items),Db=sb.next();!Db.done;Db=sb.next())if(Db=Db.value,N.applyOperationForContext(V,Db,Rg.Submitted),nb===mk.getTypeName())null===(Ga=this.itemsForDelta)||void 0===Ga?void 0:Ga.delete(V.parentPath.concat(Db.id).toString());else if(Db.body)if(nb===mf.getTypeName()&&
this.deltaHandlers&&this.itemsForDelta)this.handleLocalDeltaUpdate(Db,V,N);else{null===(la=this.itemsForDelta)||void 0===la?void 0:la.set(V.parentPath.concat(Db.id).toString(),Db);for(var bc=D.makeIterator(this.workflowsWithoutSessionAffinity),Xb=bc.next();!Xb.done;Xb=bc.next())ka(Xb.value,Db,V);bc=D.makeIterator(null!==(ab=this.workflowsWithSessionAffinity.get(N))&&void 0!==ab?ab:[]);for(Xb=bc.next();!Xb.done;Xb=bc.next())ka(Xb.value,Db,V)}}};yd.prototype.handleLocalDeltaUpdate=function(u,N,V){var ka=
new Pc({operationName:"LocalDeltaUpdate",dimension0:Eb.getTypeNameFor(u.body),success:!0});ka.start();try{var wa=this.deltaHandlers.get(Eb.getTypeNameFor(u.body)),Ga=this.itemsForDelta.get(N.parentPath.toString());if(wa&&Ga){var la=0<N.parentPath.length?N.parentPath.slice(0,N.parentPath.length-1):N.parentPath,ab=wa(u.body,Ga.body);if(ab){var nb={id:Ga.id,revId:u.revId,body:ab,parentPath:la,delta:u.body,contextId:u.contextId},sb=new qg({parentPath:nb.parentPath,items:[nb]});wb.a.info(539637591,wb.b.CoreDefault,
ka.stop());this.runLocalWorkflows([sb],V)}else ka.success=!1,ka.resultDescription="Failed because the handler did not produce valid updated item",wb.a.info(539637592,wb.b.CoreDefault,ka.stop())}else ka.success=!1,ka.resultDescription="Failed due to lack of handler or parent item",wb.a.info(539637593,wb.b.CoreDefault,ka.stop())}catch(Db){ka.success=!1,ka.resultDescription="Failed to apply delta, error: "+Db,wb.a.info(539637594,wb.b.CoreDefault,ka.stop())}};yd.prototype.createWorkflowImplementation=
function(u,N){var V=u.factory();return{workflow:u,uQd:V,initPromise:this.initWorkflow(u.kind,V,N)}};yd.prototype.initWorkflow=function(u,N,V){var ka;V=new pb({model:void 0,clientMetadata:V?V.getClientMetadata():void 0,userContext:V?V.getUserContext():void 0,site:this.site,getTokenCallback:null===(ka=this.getAuthTokenCallback)||void 0===ka?void 0:ka.bind(this)});return u===Hg.SingleItem?N.init(this.site,V):u===Hg.Join?N.init(this.site,V):Promise.resolve()};yd.prototype.queueWorkflow=function(u){var N=
this,V,ka,wa=u.session.getClientMetadata(),Ga=void 0;wa&&"outlook"==(null===(V=wa.appName)||void 0===V?void 0:V.toLowerCase())&&"web"==(null===(ka=wa.appPlatform)||void 0===ka?void 0:ka.toLowerCase())&&"Production"!=wa.releaseAudienceGroup&&(Ga=(new Pc({operationName:"QueueLocalWorkflows",success:!0,resourceId:u.h0a.workflow.id,joinContextId:u.scopeItem.contextId,dimension0:u.UX})).start().setClientMetadata(wa));Ga&&wb.a.info(509154261,wb.b.CoreDefault,Ga.stop());this.executionTrackersByWorkflowNameBySession.get(u.session).get(u.h0a.workflow.id).setExecutionState(u.scopeItem.contextId,
Qf.Running);return this.executeLocalWorkflow(u.h0a,u.scopeItem,u.inputItems,u.session,u.requestedContexts,u.QVa,u.UX).then(function(la){N.processAnnotationResults(la,u.session);u.Unb()}).catch(function(la){u.Unb();throw la;})};yd.prototype.processAnnotationResults=function(u,N){u=D.makeIterator(u);for(var V=u.next();!V.done;V=u.next())N.onAnnotationResults(V.value,Rg.LocalWorkflow,function(){})};yd.prototype.executeLocalWorkflow=function(u,N,V,ka,wa,Ga,la){var ab=this;return new Promise(function(nb,
sb){function Db(Rf){bc(Rf?Rf.message:void 0);Rf?sb(Rf):nb(pe)}function bc(Rf,Vd){Vd=void 0===Vd?yf:Vd;if(Rf)return Vd.success=!1,Vd.resultDescription+="string"===typeof Rf?Rf:Rf.message,Vd.resultSignature="Exception",wb.a.error(572838112,wb.b.CoreDefault,Vd.stop()),"string"===typeof Rf?Error(Rf):Rf;wb.a.info(572838113,wb.b.CoreDefault,Vd.stop())}var Xb,Gc,oe,pe=[],md=u.workflow,yf=(new Pc({operationName:"ExecuteWorkflow",resourceId:md.id,joinContextId:null!==(Xb=null===N||void 0===N?void 0:N.contextId)&&
void 0!==Xb?Xb:"",resultDescription:null!==la&&void 0!==la?la:"",success:!0})).setClientMetadata(ka.getClientMetadata());yf.start();var Zd=null!==(Gc=null===N||void 0===N?void 0:N.contextId)&&void 0!==Gc?Gc:V[0].contextId,rd=null!==(oe=null===N||void 0===N?void 0:N.revId)&&void 0!==oe?oe:V[0].revId,Ui=function(){var Rf=new Map;N&&(N.parentPath||wb.a.error(525382231,wb.b.CoreDefault,"Missing scope item parent. Workflow: "+md.id+". Type: "+Eb.getTypeNameFor(N.body)),Rf.set(N.body,N));if(Array.isArray(V))for(var Vd=
D.makeIterator(V),ig=Vd.next();!ig.done;ig=Vd.next())(ig=ig.value)&&ig.body&&(ig.parentPath||wb.a.error(525382232,wb.b.CoreDefault,"Missing parent. Workflow: "+md.id+". Type: "+Eb.getTypeNameFor(ig.body)),Rf.set(ig.body,ig));return Rf}(),dh=new pb({model:new fc(V[0],wa),clientMetadata:ka.getClientMetadata(),userContext:ka.getUserContext(),site:ab.site,getTokenCallback:ab.getAuthTokenCallback.bind(ab)}),Ld={setAnnotations:function(Rf,Vd,ig,ug){function Gj(gj){wb.a.info(555866112,wb.b.CoreDefault,new Ma({annotationType:Vd,
annotationState:gj,workflowId:u.workflow.id}))}var Xn,vg=(new Pc({operationName:"SetAnnotations",resourceId:Vd,joinContextId:null!==(Xn=null===N||void 0===N?void 0:N.contextId)&&void 0!==Xn?Xn:"",success:!0})).setClientMetadata(ka.getClientMetadata());vg.start();Xn=D.makeIterator(ig);for(var Wn=Xn.next();!Wn.done;Wn=Xn.next())Wn=Wn.value,Wn.metadata=Object.assign(Object.assign({},Wn.metadata),{state:mj.Created}),Gj(mj.Created);var Ah=Ui.get(Rf);Xn=Eb.getTypeNameFor(Ah.body);if(Wn=function(){if(md.kind===
Hg.SingleItem&&V[0].body!==Rf){var gj="Expected obj to be "+V[0].body+" but instead it was "+Rf;bc(gj,vg);sb(bc(gj))}else{if(Array.isArray(ig))if(!md.outputTypes||0>md.outputTypes.indexOf(Vd))var Vg="Workflow said it would output one of ["+md.outputTypes+"] but instead output "+Vd;else if(Ah)for(var Fs=D.makeIterator(ig),xo=Fs.next();!xo.done;xo=Fs.next()){var Yg=xo.value;Eb.matchesTypesFor(Yg,[Bh.getTypeName()])?Eb.getTypeNameFor(Yg)!==Vd&&(Vg="Workflow produced inconsistent annotation types in setAnnotations call ("+
Eb.getTypeNameFor(Yg)+" did not match expected "+Vd+")"):Vg="Workflow produced an output that is not an annotation "+Eb.getTypeNameFor(Yg)}else Vg="No item provided";else Vg="Workflow produced an invalid annotation array";if(Vg)bc(Vg,vg),sb(bc(Vg));else if(Vg=ug&&ug.isSessionAnnotation?["session"]:ug&&ug.ancestorType?Ah.parentPath:Ah.parentPath.concat(Ah.id),Ga!==kj.External){Fs=[];Yg=[];var pp={},hf=D.makeIterator(ig);for(xo=hf.next();!xo.done;pp={kEa:pp.kEa},xo=hf.next()){xo=xo.value;xo.metadata=
Object.assign(Object.assign({},xo.metadata),{state:mj.Sent});Gj(mj.Sent);pp.kEa=xo.id;var te=pp.kEa?null===(gj=ka.getContextAnnotations(Vd,Rg.LocalWorkflow,Vg,md.id))||void 0===gj?void 0:gj.filter(function(Dq){return function(Ji){var Gs;return(null===(Gs=Ji.body)||void 0===Gs?void 0:Gs.id)==Dq.kEa}}(pp)):void 0;1==(null===te||void 0===te?void 0:te.length)?1==te.length?Yg.push({id:te[0].id,source:md.id,revId:rd,body:xo,contextId:Zd}):wb.a.error(545837260,wb.b.CoreDefault,"Assert: Multiple existing context annotations with body id "+
pp.kEa+" found for "+Vd+" and local workflow "+md.id+")."):Fs.push({id:ab.getNextClientAnnotationId(),source:md.id,revId:rd,body:xo,contextId:Zd})}gj=[];0<Fs.length&&gj.push(new Mh({parentPath:Vg,items:Fs,parentRevId:rd}));0<Yg.length&&gj.push(new qm({parentPath:Vg,items:Yg,parentRevId:rd}));return new xk({annotationType:Vd,ops:gj})}}}()){if(ug&&ug.immediate)ka.onAnnotationResults(Wn,Rg.LocalWorkflow,function(){});else pe.push(Wn);(Xn==Hb.getTypeName()||Xn==ob.getTypeName()||Eb.matchesTypesFor(Ah.body,
[Vb.getTypeName(),Oc.getTypeName()]))&&ka.submitOperationsToSession(Wn.ops);wb.a.info(509644822,wb.b.CoreDefault,vg.stop())}else wb.a.info(509644823,wb.b.CoreDefault,vg.stop())},submitSignals:function(Rf){if(Ga===kj.External)sb(bc("NYI"));else{for(var Vd=(new Pc({operationName:"submitSignalsAction",resourceId:md.id,success:!0})).setClientMetadata(ka.getClientMetadata()),ig=D.makeIterator(Rf),ug=ig.next();!ug.done;ug=ig.next()){ug=ug.value;var Gj=Eb.getTypeNameFor(ug);Eb.matchesTypesFor(ug,[Ug.getTypeName()])||
(Vd.resultDescription="Workflow produced an output that is not an signal ("+Eb.getTypeNameFor(ug)+")",wb.a.info(521413954,wb.b.CoreDefault,Vd));md.outputTypes&&-1!==md.outputTypes.indexOf(Gj)||(Vd.resultDescription="Workflow said it would output one of ["+md.outputTypes+"] but instead output "+Gj,wb.a.info(521413953,wb.b.CoreDefault,Vd));ug.timestamp&&!yd.logTimestampUsageByWorkflowId.has(md.id)&&(yd.logTimestampUsageByWorkflowId.add(md.id),Vd.resultDescription='Workflow "'+md.id+'" sets signal.timeStamp',
wb.a.info(509212803,wb.b.CoreDefault,Vd))}Rf=Rf.map(function(Xn){return{id:ab.getNextClientSignalId(),source:md.id,revId:rd,body:Xn,contextId:Zd}});Rf=new Ad({parentPath:["session"],parentRevId:rd,items:Rf});ka.submitOperations([Rf])}},done:Db,overrideWorkflowDefinition:function(Rf,Vd,ig){switch(ig){case As.JoinContext:if(!N.contextId)throw wb.a.error(527472289,wb.b.CoreDefault,"ContextId is not defined for this scope item."),Error("ContextId is not defined for this scope item.");ig=N.contextId;break;
case As.Session:ig=void 0;break;default:throw Rf="Defined scope is not supported. "+ig,wb.a.error(527472290,wb.b.CoreDefault,Rf),Error(Rf);}Rf=new ge({definition:Vd,contextId:ig,sourceWorkflowId:md.id,targetWorkflowId:Rf});ka.onWorkflowDefinitionOverrideMessage(Rf)},getDynamicAnnotations:void 0,setBillingDomain:void 0},ak=u.uQd;if(md.kind===Hg.SingleItem){1!==V.length&&Db(Error("Single item workflows expect a single input"));dh.delta=V[0].delta;dh.deltas=V[0].deltas;try{u.initPromise||(u.initPromise=
ak.init(ab.site,dh)),u.initPromise.then(function(){ak.execute(V[0].body,dh,Ld)}).catch(function(Rf){bc(Rf)})}catch(Rf){bc(Rf)}}else if(md.kind===Hg.Join){0===V.length&&Db(Error("Join workflows expect an inputs array"));dh.delta=N.delta;dh.deltas=N.deltas;try{u.initPromise||(u.initPromise=ak.init(ab.site,dh)),u.initPromise.then(function(){ak.execute(N.body,V.map(function(Rf){return Rf.body}),dh,Ld)}).catch(function(Rf){bc(Rf)})}catch(Rf){bc(Rf)}}else bc("Workflow kind "+md.kind+" not supported")})};
yd.prototype.ensureSweepTimer=function(u){if(!this.sweepTimers.get(u)){var N=setInterval(this.onSweep.bind(this),this.sweepIntervalMs);this.sweepTimers.set(u,N)}};yd.prototype.cancelSweepTimer=function(u){var N=this.sweepTimers.get(u);this.sweepTimers.get(u)&&(clearInterval(N),this.sweepTimers.delete(u))};yd.prototype.onSweep=function(){this.sweepScopeExecutionNotifications()};yd.prototype.setScopeExecutionNotification=function(u,N,V,ka){var wa,Ga,la=Date.now(),ab=la+ra(N.workflow.minDelayMs,1E3),
nb=la+ra(N.workflow.maxDelayMs,5E3);ka={session:u,Cnc:N,scopeItem:V,startTime:la,minTime:ab,maxTime:nb,QVa:ka};la=N.workflow.kind===Hg.Join?V.contextId:ka.scopeItem.parentPath.concat(V.id).join("\\");this.pendingScopeExecutionNotificationsByWorkflow.get(N.workflow.id)||this.pendingScopeExecutionNotificationsByWorkflow.set(N.workflow.id,new Map);this.pendingScopeExecutionNotificationsByWorkflow.get(N.workflow.id).get(la)?(N=(new Pc({resultDescription:"Duplicated pending scope execution for "+N.workflow.id+
" at "+la,operationName:"LocalScopeExecutionNotification",resourceId:N.workflow.id,joinContextId:null!==(Ga=null===V||void 0===V?void 0:V.contextId)&&void 0!==Ga?Ga:"",success:!0})).setClientMetadata(u.getClientMetadata()).start(),wb.a.info(509727899,wb.b.CoreDefault,N.stop())):(Ga=(new Pc({resultDescription:"New pending scope execution for "+N.workflow.id+" at "+la,operationName:"LocalScopeExecutionNotification",resourceId:N.workflow.id,joinContextId:null!==(wa=null===V||void 0===V?void 0:V.contextId)&&
void 0!==wa?wa:"",success:!0})).setClientMetadata(u.getClientMetadata()).start(),wb.a.info(539883075,wb.b.CoreDefault,Ga.stop()),this.pendingScopeExecutionNotificationsByWorkflow.get(N.workflow.id).set(la,ka));this.ensureSweepTimer(u)};yd.prototype.sweepScopeExecutionNotifications=function(){for(var u=this,N,V,ka=new Set(Array.from(this.sweepTimers.keys())),wa=D.makeIterator(Array.from(this.pendingScopeExecutionNotificationsByWorkflow.entries())),Ga=wa.next();!Ga.done;Ga=wa.next()){var la=D.makeIterator(Ga.value);
Ga=la.next().value;var ab=la.next().value;la={};ab=D.makeIterator(Array.from(ab.entries()));for(var nb=ab.next();!nb.done;la={KH:la.KH,oY:la.oY,zK:la.zK,vEa:la.vEa,Ry:la.Ry,hxb:la.hxb,Zwb:la.Zwb},nb=ab.next()){var sb=D.makeIterator(nb.value);nb=sb.next().value;la.oY=sb.next().value;sb=la.oY;la.zK=sb.session;la.KH=sb.Cnc.workflow;la.Zwb=sb.QVa;la.vEa=la.zK.getWorkflowItemStorage();la.Ry=(new Pc({operationName:"LocalScopeExecutionNotification",resourceId:la.KH.id,joinContextId:null!==(V=null===(N=la.oY.scopeItem)||
void 0===N?void 0:N.contextId)&&void 0!==V?V:"",success:!0})).setClientMetadata(la.zK.getClientMetadata()).start();la.hxb=function(Db){return function(){if(Db.KH.kind===Hg.Join){var bc=Date.now(),Xb=Db.oY.Cnc.workflow,Gc=Db.oY.scopeItem.contextId,oe=Db.zK.getWorkflowDefinition(Xb,Gc).maxDelayMs;return Db.vEa.isWorkflowReady(Gc,Xb)?(Db.Ry.resultDescription="Join Workflow: "+Xb.id+" queuing by maxAnnotation, contextId: "+Gc,wb.a.info(528048978,wb.b.CoreDefault,Db.Ry.stop()),{isValid:!0,UX:mg.loc}):
Db.oY.startTime+oe<bc?(Db.Ry.resultDescription="Join Workflow: "+Xb.id+" queuing by maxTimeout, contextId: "+Gc,wb.a.info(528048979,wb.b.CoreDefault,Db.Ry.stop()),{isValid:!0,UX:mg.zSd}):u.isReadyToEarlyJoin(u.executionTrackersByWorkflowNameBySession.get(Db.zK).get(Xb.id),Gc,Db.zK.getClientMetadata())?(wb.a.info(512550856,wb.b.CoreDefault,"Workflow: "+Xb.id+" queuing by early completion, contextId: "+Gc+", timeout: "+oe),{isValid:!0,UX:mg.koc}):{isValid:!1,UX:mg.Unknown}}return{isValid:!0,UX:mg.Unknown}}}(la);
(function(Db){return function(){var bc=Db.hxb(),Xb=bc.UX;if(!bc.isValid)return!1;var Gc=D.makeIterator(Db.zK.resolveRequestedContexts(Db.KH));bc=Gc.next().value;Gc=Gc.next().value;if(!bc)return!1;try{if(Db.KH.kind===Hg.Join){var oe=Db.oY.scopeItem.contextId,pe=Db.vEa.getScopeItem(oe,Db.KH);if(pe){var md=Db.vEa.getItemsToExecute(pe.contextId,Db.KH);if(0===md.length)return Db.Ry.resultDescription="Failed to retrieve items for workflow: "+Db.KH.id+", contextId: "+oe+", skipping execution",wb.a.info(527472291,
wb.b.CoreDefault,Db.Ry.stop()),u.onWorkflowExecuted(pe,Db.KH,Db.zK),!0;u.queueWorkflow({h0a:Db.oY.Cnc,scopeItem:pe,inputItems:md,requestedContexts:Gc,session:Db.zK,QVa:Db.Zwb,UX:Xb,Unb:u.onWorkflowExecuted.bind(u,pe,Db.KH,Db.zK)}).catch(function(yf){Db.Ry.success=!1;Db.Ry.resultDescription=yf.message;wb.a.error(509092189,wb.b.CoreDefault,Db.Ry.stop())})}else Db.Ry.resultDescription="ContextId no longer exists, skipping workflow execution",wb.a.info(539883076,wb.b.CoreDefault,Db.Ry.stop())}else Db.Ry.resultDescription=
"Workflow in type "+Db.KH.kind+" is not supported",wb.a.error(539883077,wb.b.CoreDefault,Db.Ry.stop())}catch(yf){Db.Ry.resultDescription="Trying to execute "+Db.KH.id+" caused an exception: "+yf,wb.a.warn(539883078,wb.b.CoreDefault,Db.Ry.stop())}return!0}})(la)()?(this.pendingScopeExecutionNotificationsByWorkflow.get(Ga).delete(nb),0===this.pendingScopeExecutionNotificationsByWorkflow.get(Ga).size&&this.pendingScopeExecutionNotificationsByWorkflow.delete(Ga)):ka.delete(la.zK)}}if(0!==ka.size)for(N=
D.makeIterator(Array.from(ka)),V=N.next();!V.done;V=N.next())V=V.value,ka=(new Pc({resultDescription:"No pending scope notifications left, cancelling sweep timer",operationName:"LocalScopeExecutionNotification",success:!0})).start(),wb.a.debug(539883079,wb.b.CoreDefault,ka.stop()),this.cancelSweepTimer(V)};yd.prototype.onExternalWorkflowExecuted=function(u,N,V){this.onWorkflowExecuted({id:"",parentPath:[],contextId:u},{id:N},V,!1)};yd.prototype.onWorkflowExecuted=function(u,N,V,ka){ka=void 0===ka?
!0:ka;var wa;null===(wa=this.executionTrackersByWorkflowNameBySession.get(V).get(N.id))||void 0===wa?void 0:wa.afterWorkflowExecution(u.contextId);if(ka&&N.kind===Hg.Join)V.getWorkflowItemStorage().onWorkflowExecuted(u,N)};ce.prototype.sequence=function(u){var N=this;return new Promise(function(V,ka){if(u<N.prevSeq){if(N.rejectOutdatedSequenceNumbers){V=Error("BufferingSequencer: Item out of order. Expecting seqId > "+N.prevSeq+". Actual seqId "+u);V.name=ce.Rejected;ka(V);return}N.prevSeq=-1}u!=
N.prevSeq+1&&wb.a.warn(542712385,wb.b.CoreDefault,"BufferingSequencer: got out of order sequence number. Got "+u+", expected "+(N.prevSeq+1));ka={seq:u,resolve:V};N.insertItem(ka);N.runInOrder(ka,!0,!1)})};ce.prototype.insertItem=function(u){if(this.firstQueueItem){var N=this.lastQueueItem,V=null;do{if(u.seq>N.seq){u.prev=N;N.next=u;V?V.prev=u:this.lastQueueItem=u;return}V=N;N=N.prev}while(N);V&&(V.prev=u);u.next=V;this.firstQueueItem=u}else this.lastQueueItem=this.firstQueueItem=u};ce.prototype.runInOrder=
function(u,N,V){for(var ka=this,wa=this.prevSeq,Ga=!1,la=[];this.firstQueueItem;){var ab=this.firstQueueItem;if(wa+1!=ab.seq&&(!V||ab.seq>u.seq))break;wa=ab.seq;ab.timeout&&clearTimeout(ab.timeout);la.push(ab);u==ab&&(Ga=!0);if(this.firstQueueItem=this.firstQueueItem.next)this.firstQueueItem.prev=null}0<la.length&&setTimeout(function(){for(var nb=D.makeIterator(la),sb=nb.next();!sb.done;sb=nb.next())sb=sb.value,sb.resolve(sb.seq)},0);this.prevSeq=wa;!Ga&&N&&(u.timeout=setTimeout(function(){ka.runInOrder(u,
!1,!0)},this.bufferingTimeMs))};ce.Rejected="SequenceItemRejected";Wd.prototype.create=function(u){if(!u.ownerId)return null;var N=this.workflowIdToSequencersMap.get(u.ownerId);N||(N=new ce(this.bufferingTimeMs),this.workflowIdToSequencersMap.set(u.ownerId,N));return N};Ec.prototype.sequence=function(u){var N;return cc(this,void 0,void 0,function ka(){var wa,Ga=this,la;return D.ys.jVb(ka,function(ab){wa=null===(N=null===u||void 0===u?void 0:u.M_)||void 0===N?void 0:N.seq;return null===wa||void 0===
wa?ab.return():(la=Ga.sequencerFactory.create(u))?ab.Rb(la.sequence(u.M_.seq),0):ab.return()})})};vc.prototype.process=function(u,N,V,ka){for(var wa=[],Ga={},la=D.makeIterator(u.ops),ab=la.next();!ab.done;Ga={e4:Ga.e4},ab=la.next()){Ga.e4=ab.value;ab=[];if(null===Ga.e4||void 0===Ga.e4?0:Ga.e4.items)for(var nb={},sb=D.makeIterator(Ga.e4.items),Db=sb.next();!Db.done;nb={y0a:nb.y0a},Db=sb.next())nb.y0a=Db.value,Db=this.annotationSequencer.sequence(nb.y0a.body).then(function(bc,Xb){return function(){N(bc.e4,
Xb.y0a)}}(Ga,nb)),ab.push(Db);wa.push(Promise.all(ab).then(function(bc){return function(){V(bc.e4)}}(Ga)))}void Promise.all(wa).then(function(){return ka(u)})};wc.prototype.process=function(u,N,V,ka){for(var wa=D.makeIterator(u.ops),Ga=wa.next();!Ga.done;Ga=wa.next()){Ga=Ga.value;if(null===Ga||void 0===Ga?0:Ga.items)for(var la=D.makeIterator(Ga.items),ab=la.next();!ab.done;ab=la.next())N(Ga,ab.value);V(Ga)}ka(u)};Ib.prototype.process=function(u,N,V,ka){this.isOrderingEnabled()?this.orderedAnnotationResultsProcessor.process(u,
N,V,ka):this.unorderedAnnotationResultsProcessor.process(u,N,V,ka)};var Wp=Ri.EventEmitter;D.ha(Bb,Wp);Bb.prototype.init=function(){return Promise.resolve()};Bb.prototype.sendMessage=function(){};Bb.prototype.onMessage=function(){};Bb.prototype.forceReconnect=function(){return Promise.resolve()};Bb.prototype.closeSession=function(){};Bb.prototype.sendBytes=function(){};Bb.prototype.getCorrelationVector=function(){return new Lh};Bb.prototype.setState=function(){};eb.prototype.init=function(u,N,V,ka){var wa=
this,Ga,la,ab,nb,sb,Db,bc,Xb,Gc,oe,pe,md=new Pc({operationName:"InitRuntime",resourceId:u,dimension1:this.hasBeenInitialized.toString()});md.start();this.hasBeenInitialized=!0;this.hostCallbacks=V;this.shouldAddLogger(md)?(wb.a.addLogger(new Nk(this.hostCallbacks)),this.addLoggingAggregator(ka)):(wb.a.clearLoggers(),wb.a.addLogger(new Nk(this.hostCallbacks)));eb.haveCalledInit=!0;this.annotationResultsProcessor=new Ib(function(){return wa.settings.annotationsOrderingEnabled});this.inferenceServiceFactory=
ka.inferenceServiceFactory;if(this.clientMetadata=N)this.clientMetadata.runtimeVersion=e(1147).version;this.networkRateSettings=ka.networkRateSettings;md.dimension2=Object(wb.c)(Xj.a.info).toString();V=[];u&&(this.defaultServiceUrl=mc.convertServiceUrlToWebSocket(u),this.serviceProtocol=this.defaultServiceUrl.split(":")[0].toLowerCase());V.push(this.isFeatureEnabled("CheckIdbByFeatures",!1).then(function(Zd){wa.settings.checkIdbByFeatures=Zd}));V.push(this.isFeatureEnabled("DropOnlySequencedSyncsOnReseedDisabled").then(function(Zd){wa.settings.dropOnlySequencedSyncsOnReseedEnabled=
!Zd}));V.push(this.isFeatureEnabled("CloseWSBlockedSessionDisabled").then(function(Zd){wa.settings.closeWSBlockedSessionEnabled=!Zd}));V.push(this.isFeatureEnabled("SessionOfflineModeDisabled").then(function(Zd){wa.settings.sessionOfflineModeEnabled=!Zd}));V.push(this.isFeatureEnabled("AnnotationsOrderingEnabled",!0).then(function(Zd){wa.settings.annotationsOrderingEnabled=Zd}));V.push(this.isFeatureEnabled("ImprovedWebsocketDisabled").then(function(Zd){var rd;(rd=wa.settings).improvedWebSocketEnabled&&
(rd.improvedWebSocketEnabled=!Zd)}));V.push(this.isFeatureEnabled("DefaultBatchingDisabled").then(function(Zd){var rd;(rd=wa.settings).defaultBatchingEnabled&&(rd.defaultBatchingEnabled=!Zd)}));V.push(this.isFeatureEnabled("HttpFallbackEnabled").then(function(Zd){var rd;(rd=wa.settings).httpFallbackEnabled||(rd.httpFallbackEnabled=Zd)}));V.push(this.isFeatureEnabled("JSOND2ContentTypeEnabled").then(function(Zd){var rd;(rd=wa.settings).jsond2ContentTypeEnabled||(rd.jsond2ContentTypeEnabled=Zd)}));
V.push(this.isFeatureEnabled("CloseWorkerOnReliabilityFailureDisabled").then(function(Zd){var rd;(rd=wa.settings).closeWorkerOnReliabilityFailureEnabled&&(rd.closeWorkerOnReliabilityFailureEnabled=!Zd)}));V.push(this.isFeatureEnabled("BatchingWith20msIntervalDisabled").then(function(Zd){var rd;(rd=wa.settings).batchingWith20msIntervalEnabled&&(rd.batchingWith20msIntervalEnabled=!Zd)}));V.push(this.isFeatureEnabled("OnAnnotationsSubmittedDisabled").then(function(Zd){var rd;(rd=wa.settings).onAnnotationsSubmittedEnabled&&
(rd.onAnnotationsSubmittedEnabled=!Zd)}));V.push(this.isFeatureEnabled("SendCallbackOnHostRequestedSessionCloseDisabled").then(function(Zd){var rd;(rd=wa.settings).sendCloseCallbackOnClientRequestedClose&&(rd.sendCloseCallbackOnClientRequestedClose=!Zd)}));V.push(this.isFeatureEnabled("ReduceBatchOperationsEnabled").then(function(Zd){var rd;(rd=wa.settings).reduceBatchOperationsEnabled||(rd.reduceBatchOperationsEnabled=Zd)}));var yf={enableDeltas:!1,enableEarlyJoin:!1};V.push(Promise.all([this.isFeatureEnabled("DeltaOperationsEnabled").then(function(Zd){return yf.enableDeltas=
Zd}).catch(function(){return yf.enableDeltas=!1}),this.isFeatureEnabled("EarlyJoinCompletionEnabled").then(function(Zd){return yf.enableEarlyJoin=Zd}).catch(function(){return yf.enableEarlyJoin=!1})]).then(function(){wa.localWorkflowManager=new yd(ka.modelDownloader&&wa.isDownloaderCompatible()?ka.modelDownloader:void 0,wa.inferenceServiceFactory,yf)}));u=Nm(null!==(Ga=N.flights)&&void 0!==Ga?Ga:"");this.isDeltaGeneratorEnabled=u.getBooleanValue("Microsoft.Office.WordOnline.AugloopDeltas",null!==
(la=ka.isDeltaGeneratorEnabled)&&void 0!==la?la:!1);this.disableSyncDeltaSending=u.getBooleanValue("Microsoft.Office.WordOnline.DisableSyncDeltaSending",null!==(ab=ka.disableSyncDeltaSending)&&void 0!==ab?ab:!1);this.syncDeltaTimeout=u.getIntValue("Microsoft.Office.WordOnline.SyncDeltaTimeout",ka.syncDeltaTimeout);(nb=this.settings).improvedWebSocketEnabled&&(nb.improvedWebSocketEnabled=!u.getBooleanValue("ImprovedWebsocketDisabled",!1));(sb=this.settings).httpFallbackEnabled||(sb.httpFallbackEnabled=
u.getBooleanValue("Microsoft.Office.WordOnline.Augloop.HttpFallbackEnabled",!1));(Db=this.settings).jsond2ContentTypeEnabled||(Db.jsond2ContentTypeEnabled=u.getBooleanValue("Microsoft.Office.WordOnline.Augloop.JSOND2ContentTypeEnabled",!1));(bc=this.settings).closeWorkerOnReliabilityFailureEnabled&&(bc.closeWorkerOnReliabilityFailureEnabled=!u.getBooleanValue("Microsoft.Office.WordOnline.Augloop.CloseWorkerOnReliabilityFailureDisabled",!1));(Xb=this.settings).defaultBatchingEnabled&&(Xb.defaultBatchingEnabled=
!u.getBooleanValue("DefaultBatchingDisabled",!1));(Gc=this.settings).batchingWith20msIntervalEnabled&&(Gc.batchingWith20msIntervalEnabled=!u.getBooleanValue("BatchingWith20msIntervalDisabled",!1));(oe=this.settings).sendCloseCallbackOnClientRequestedClose&&(oe.sendCloseCallbackOnClientRequestedClose=!u.getBooleanValue("SendCallbackOnHostRequestedSessionCloseDisabled",!1));(pe=this.settings).reduceBatchOperationsEnabled||(pe.reduceBatchOperationsEnabled=u.getBooleanValue("ReduceBatchOperationsEnabled",
!1));ka&&ka.networkMode&&(ka.networkMode===Si.HttpFallback&&(ka.networkMode=this.settings.httpFallbackEnabled&&this.settings.improvedWebSocketEnabled?Si.HttpFallback:Si.JSWebSockets),this.networkMode=ka.networkMode,ka.networkMode===Si.LocalWorkflowsOnly&&(this.sessionManagerFactory=function(){return new Bb}));return Promise.all(V).then(function(){wa.batchOptions=ka.batchOptions;!wa.batchOptions&&wa.settings.defaultBatchingEnabled&&(wa.batchOptions={delayMs:1,maxInputSize:1E6,delayMsMax:50},wa.settings.batchingWith20msIntervalEnabled&&
(wa.batchOptions.delayMs=20));wa.batchOptions&&!wa.batchOptions.delayMsMax&&(wa.batchOptions.delayMsMax=50);md.dimension0=JSON.stringify(wa.batchOptions);wa.logOperation(md,!0)}).catch(function(Zd){wa.logOperation(md,!1,"Error",Zd?Zd.message:"(no error)")})};eb.prototype.getServiceProtocol=function(){return this.serviceProtocol};eb.prototype.registerLocalWorkflow=function(u){this.localWorkflowManager.registerLocalWorkflow(u)};eb.prototype.flushTelemetry=function(u){wb.a.flushAggregators(u)};eb.prototype.createSession=
function(u){var N,V=u&&u.docSessionId?u.docSessionId:Sp(),ka=u&&u.documentId?u.documentId:void 0,wa=this.sessionsByDocSessionId.get(V);if(wa&&!1===wa.isClosed)throw Error("docSessionId already exists");wa=u?null!==(N=u.serviceUrl)&&void 0!==N?N:this.defaultServiceUrl:this.defaultServiceUrl;wa=mc.convertServiceUrlToWebSocket(wa);wa||(u=u||{},u.networkMode=Si.LocalWorkflowsOnly);!this.networkMode||u&&u.networkMode||(u=u||{},u.networkMode=this.networkMode);u&&u.networkMode===Si.HttpFallback&&(u.networkMode=
this.settings.httpFallbackEnabled&&this.settings.improvedWebSocketEnabled?Si.HttpFallback:Si.JSWebSockets);N=Object.assign({},this.clientMetadata);N.docSessionId=V;ka&&(N.documentId=ka);u&&u.flights&&(N.flights=N.flights?N.flights+";"+u.flights:u.flights);ka=this.sessionFactory({hostCallbacks:this.hostCallbacks,sessionManager:this.sessionManagerFactory(N,wa,u,this.networkRateSettings),batchOptions:this.batchOptions,extensionConfigs:(null===u||void 0===u?void 0:u.extensionConfigs)||[],clientMetadata:N,
userContext:u?u.userContext:void 0,localWorkflowManager:u&&u.enableComplexLocalWorkflows?void 0:this.localWorkflowManager,annotationResultsProcessor:this.annotationResultsProcessor,localRegisteredWorkflows:(null===u||void 0===u?void 0:u.localRegisteredWorkflows)||[],enableRemoteExecutionNotification:(null===u||void 0===u?void 0:u.enableRemoteExecutionNotification)||!1,networkMode:null===u||void 0===u?void 0:u.networkMode,egress:u?u.egress:void 0,isDeltaGeneratorEnabled:this.isDeltaGeneratorEnabled,
onAnnotationsSubmittedEnabled:this.settings.onAnnotationsSubmittedEnabled,disableSyncDeltaSending:this.disableSyncDeltaSending,syncDeltaTimeout:this.syncDeltaTimeout,reduceBatchOperationsEnabled:this.settings.reduceBatchOperationsEnabled});this.sessionsByDocSessionId.set(V,ka);u&&u.onSessionConnect&&ka.setConnectCallback(u.onSessionConnect);u&&u.onSessionDisconnect&&ka.setDisconnectCallback(u.onSessionDisconnect);u&&u.onSessionReconnect&&ka.setReconnectCallback(u.onSessionReconnect);u&&u.onSessionClose&&
ka.setSessionCloseCallback(u.onSessionClose);u&&u.onServerAuthenticationStateChangeCallback&&ka.setServerAuthenticationStateChangeCallback(u.onServerAuthenticationStateChangeCallback);return ka.initialize?ka.initialize():Promise.resolve(ka)};eb.prototype.getSessionManagerFactory=function(){return this.sessionManagerFactory};eb.prototype.shouldAddLogger=function(u){if(eb.haveCalledInit){var N=Error("Runtime already initialized");u.dimension3=N.stack;u.dimension2=Object(wb.c)(Xj.a.info).toString();
this.logOperation(u,!1,"Error",N.message);return!1}return!0};eb.prototype.createDefaultSessionManagerFactory=function(){var u=this;return function(N,V,ka){function wa(){wb.a.error(573321615,wb.b.CoreDefault,"Unexpectedly not set sendMessage")}if(ka&&ka.enableComplexLocalWorkflows)throw Error("NYI");if(ka&&ka.networkMode==Si.LocalWorkflowsOnly)return new Bb;var Ga=new Hd,la=new jk,ab=new yc(function(){return la},N,Ga,function(nb,sb,Db){wa(nb,sb,Db)},{getAuthToken:u.getAuthToken.bind(u,N.docSessionId),
overrideSessionInitMessage:u.hostCallbacks.overrideSessionInitMessage,enableRemoteExecutionNotification:(null===ka||void 0===ka?void 0:ka.enableRemoteExecutionNotification)||!1});N=new kd(mc.convertServiceUrlToWebSocket(V),la,u.workerFactory,ab,N,Ga,u.settings,null===ka||void 0===ka?void 0:ka.networkMode,u.networkRateSettings);wa=N.sendMessage.bind(N);N.on("disconnect",function(){return Ga.clearRefreshTimeouts()});N.on("connect",function(nb,sb,Db,bc){nb&&u.hostCallbacks.setSessionData&&u.hostCallbacks.setSessionData(sb,
Db,bc)});return N}};eb.prototype.getAuthToken=function(u){var N={Tickets:[],TokenType:Sc.Augloop};u&&(N.DocSessionId=u);return this.hostCallbacks.requestAuthToken(N).then(function(V){if(V)return V.Token}).catch(function(){})};eb.prototype.isFeatureEnabled=function(u,N,V){return mc.isFeatureEnabled(this.hostCallbacks,u,void 0===N?!1:N,void 0===V?"None":V)};eb.prototype.logOperation=function(u,N,V,ka){u.stop();u.success=N;u.resultSignature=V;u.resultDescription=ka;wb.a.info(573321622,wb.b.CoreDefault,
u)};eb.prototype.addLoggingAggregator=function(u){var N,V,ka;wb.a.addAggregator(Qo("Operation","operationName","ExecuteBatch ReduceBatchOperations ProcessResponse LocalDeltaUpdate ApplyFormattedTextTileDeltaForLocalWorkflows ApplyTextTileDeltaForLocalWorkflows FindRangeForDelta RunModelForInferencing GetResource CreateTextTileDeltaFromItem NetworkEgressControl HttpEgress".split(" "),null!==(N=u.telemetryAggregationIntervalSec)&&void 0!==N?N:30));wb.a.addAggregator(Qo("Operation","operationName","ExecuteWorkflow ExecuteLambda LocalScopeExecutionNotification RunLocalWorkflows EarlyJoinCompletion OnLongPollMessage OnAnnotationResultsEgress".split(" "),
null!==(V=u.telemetryAggregationIntervalSec)&&void 0!==V?V:60));wb.a.addAggregator(Qo("SessionHealth","sessionHealthEventName",["SendMessage","ProcessMessage"],null!==(ka=u.telemetryAggregationIntervalSec)&&void 0!==ka?ka:60))};eb.prototype.uninitialize=function(){this.flushTelemetry(!0);this.hostCallbacks=null;this.hasBeenInitialized=!1;eb.haveCalledInit=!1;wb.a.clearAggregators();wb.a.clearLoggers()};var Aq=new eb,nd={category:wi.Schema,schema:{name:"Exception",path:"message-schema.proto"}},Uo;
(function(u){(function(N){N[N.Unknown=0]="Unknown";N[N.Text=1]="Text";N[N.Slide=2]="Slide"})(u.TileType||(u.TileType={}));(function(N){N[N.Generic=0]="Generic";N[N.Title=1]="Title";N[N.SmartArt=2]="SmartArt";N[N.TableCell=3]="TableCell";N[N.TextBox=4]="TextBox";N[N.Notes=5]="Notes"})(u.TextTileType||(u.TextTileType={}));(function(N){N[N.Undefined=0]="Undefined";N[N.Word=1]="Word";N[N.Phrase=2]="Phrase";N[N.Sentence=3]="Sentence";N[N.Paragraph=4]="Paragraph"})(u.TextTileElementUnit||(u.TextTileElementUnit=
{}));(function(N){N[N.Undefined=0]="Undefined";N[N.Bullet=1]="Bullet";N[N.Numbered=2]="Numbered"})(u.ListType||(u.ListType={}));(function(N){N[N.Undefined=0]="Undefined";N[N.AlphaLcParenBoth=1]="AlphaLcParenBoth";N[N.AlphaUcParenBoth=2]="AlphaUcParenBoth";N[N.AlphaLcParenR=3]="AlphaLcParenR";N[N.AlphaUcParenR=4]="AlphaUcParenR";N[N.AlphaLcPeriod=5]="AlphaLcPeriod";N[N.AlphaUcPeriod=6]="AlphaUcPeriod";N[N.ArabicParenBoth=7]="ArabicParenBoth";N[N.ArabicParenR=8]="ArabicParenR";N[N.ArabicPeriod=9]="ArabicPeriod";
N[N.ArabicPlain=10]="ArabicPlain";N[N.RomanLcParenBoth=11]="RomanLcParenBoth";N[N.RomanUcParenBoth=12]="RomanUcParenBoth";N[N.RomanLcParenR=13]="RomanLcParenR";N[N.RomanUcParenR=14]="RomanUcParenR";N[N.RomanLcPeriod=15]="RomanLcPeriod";N[N.RomanUcPeriod=16]="RomanUcPeriod";N[N.CircleNumDbPlain=17]="CircleNumDbPlain";N[N.CircleNumWdBlackPlain=18]="CircleNumWdBlackPlain";N[N.CircleNumWdWhitePlain=19]="CircleNumWdWhitePlain";N[N.ArabicDbPeriod=20]="ArabicDbPeriod";N[N.ArabicDbPlain=21]="ArabicDbPlain";
N[N.Ea1ChsPeriod=22]="Ea1ChsPeriod";N[N.Ea1ChsPlain=23]="Ea1ChsPlain";N[N.Ea1ChtPeriod=24]="Ea1ChtPeriod";N[N.Ea1ChtPlain=25]="Ea1ChtPlain";N[N.Ea1JpnChsDbPeriod=26]="Ea1JpnChsDbPeriod";N[N.Ea1JpnKorPlain=27]="Ea1JpnKorPlain";N[N.Ea1JpnKorPeriod=28]="Ea1JpnKorPeriod";N[N.Arabic1Minus=29]="Arabic1Minus";N[N.Arabic2Minus=30]="Arabic2Minus";N[N.Hebrew2Minus=31]="Hebrew2Minus";N[N.ThaiAlphaPeriod=32]="ThaiAlphaPeriod";N[N.ThaiAlphaParenR=33]="ThaiAlphaParenR";N[N.ThaiAlphaParenBoth=34]="ThaiAlphaParenBoth";
N[N.ThaiNumPeriod=35]="ThaiNumPeriod";N[N.ThaiNumParenR=36]="ThaiNumParenR";N[N.ThaiNumParenBoth=37]="ThaiNumParenBoth";N[N.HindiAlphaPeriod=38]="HindiAlphaPeriod";N[N.HindiNumPeriod=39]="HindiNumPeriod";N[N.HindiNumParenR=40]="HindiNumParenR";N[N.HindiAlpha1Period=41]="HindiAlpha1Period"})(u.ListNumeration||(u.ListNumeration={}));(function(N){N[N.Undefined=0]="Undefined";N[N.Delete=1]="Delete";N[N.Add=2]="Add";N[N.Change=3]="Change";N[N.Refresh=4]="Refresh"})(u.TextTileEventType||(u.TextTileEventType=
{}))})(Uo||(Uo={}));var Ke;(function(u){u=u.SlideTileEventType||(u.SlideTileEventType={});u[u.Undefined=0]="Undefined";u[u.Delete=1]="Delete";u[u.Add=2]="Add";u[u.Change=3]="Change";u[u.Refresh=4]="Refresh"})(Ke||(Ke={}));Wb.prototype.setReduceTimer=function(u,N,V,ka,wa,Ga){function la(){var sb=nb.get(N),Db=Date.now()-sb.start;wa()&&Db<Ga?sb.timer=setTimeout(sb.x4f,Math.min(ka,Ga-Db)):(1<nb.size?nb.delete(N):ab.cache.delete(u),V())}var ab=this;ka=void 0===ka?500:ka;wa=void 0===wa?function(){return!1}:
wa;Ga=void 0===Ga?5E3:Ga;this.cache.has(u)||this.cache.set(u,new Map);var nb=this.cache.get(u);nb.has(N)&&clearTimeout(nb.get(N).timer);nb.set(N,{start:Date.now(),x4f:la,timer:setTimeout(la,ka)})};Wb.prototype.clear=function(u,N){this.cache.forEach(function(V,ka){u&&u!==ka||V.forEach(function(wa,Ga){N&&N!==Ga||clearTimeout(wa.timer)})});this.cache.clear()};ub.prototype.updateAuthToken=function(u,N){var V=this,ka=JSON.stringify(N),wa=this.requestRecordMap.get(ka);if(void 0===wa||this.isTokenExpired(wa))wa=
{VLf:u.requestAuthToken(N).then(function(Ga){if(!Ga||!Ga.Token)throw Error("No token available for request "+ka);V.tokenCache.set(ka,Ga.Token)}),requestTime:mc.getCurrentTimeMs()},this.requestRecordMap.set(ka,wa);return wa.VLf};ub.prototype.getAuthTokenEntries=function(u,N){var V=this;return Array.from(this.tokenCache.keys()).map(function(ka){var wa=V.requestMap.get(ka);void 0===wa&&(wa=JSON.parse(ka),V.requestMap.set(ka,wa));return{requestKey:ka,request:wa}}).filter(function(ka){ka=ka.request;return N?
ka.DocId===N:!0}).map(function(ka){var wa=ka.requestKey;ka=ka.request;V.isTokenExpired(V.requestRecordMap.get(wa))&&void V.updateAuthToken(u,ka);return{ticket:ka.Tickets[0],token:V.tokenCache.get(wa)}})};ub.prototype.isTokenExpired=function(u){return mc.getCurrentTimeMs()>u.requestTime+this.tokenExpirationMs};var Vo;Fb();Ba.prototype.l1f=function(){this.startTime=mc.getCurrentTimeMs()};Ba.prototype.z9c=function(){var u=mc.getCurrentTimeMs()-this.startTime;return this.requestTimeoutInMs-u};Ba.prototype.cgb=
function(u){this.ended||(this.hkb(null,u,!0),this.ended=!0)};Ba.prototype.Q$d=function(u){this.hkb(u,null,!1)};Ba.prototype.hkb=function(u,N,V){var ka=this;(new Promise(function(){return ka.callback(u,N,V)})).catch(function(){})};$a.prototype.testConnection=function(u,N){var V=this,ka=!1,wa=(new Pc({cv:(new Lh).toString(),operationName:"WebSocketTest",resourceId:u,success:!0})).start();return new Promise(function(Ga){var la=mc.createHealthCheckRequest(N);u?V.addRequest(u,la,wa.cv,"HealthCheckRequest",
function(ab,nb,sb){nb&&(wa.success=!1,wa.resultSignature="Error",wa.resultDescription=nb.message||nb);ab&&"OK"===ab.status&&(ka=!0);sb&&(wa.success&&!ka&&(wa.success=!1,wa.resultSignature="NoResponseData"),wb.a.info(556617949,wb.b.CoreDefault,wa.stop()),Ga(wa.success))}):(wa.success=!1,wa.resultSignature="EmptyUrl",wb.a.info(557641870,wb.b.CoreDefault,wa.stop()),Ga(wa.success))})};$a.prototype.addRequest=function(u,N,V,ka,wa){var Ga=(this.requestCounter++).toString();N=new Ba(Ga,V,ka,N,wa,this.requestTimeoutInMs);
this.getWorker(u);this.pendingRequests.push(N);this.egressPendingRequests()};$a.prototype.egressPendingRequests=function(){for(;0<this.pendingRequests.length&&this.activeRequests.length<this.maxActiveRequests;){var u=this.pendingRequests.shift();this.activeRequests.push(u);if(1===this.activeRequests.length){var N=u.z9c();setTimeout(this.onTimeout.bind(this),N)}u.l1f();this.worker&&this.worker.egress({obj:this.createRequestMessage(u.data,u.requestId,u.correlationId)})}};$a.prototype.createRequestMessage=
function(u,N,V){return JSON.stringify({correlationId:V,requestId:N,body:u})};$a.prototype.onTimeout=function(){for(;0<this.activeRequests.length;){var u=this.activeRequests[0],N=u.z9c();if(0>=N)u.cgb(Error("Request timed out")),this.activeRequests.shift(),this.egressPendingRequests();else{setTimeout(this.onTimeout.bind(this),N);break}}};$a.prototype.onMessage=function(u){try{var N=JSON.parse(u);for(u=0;u<this.activeRequests.length;u++){var V=this.activeRequests[u];if(V.requestId===N.requestId){N.end?
(this.activeRequests.splice(u,1),V.cgb(N.error),this.egressPendingRequests()):N.body&&V.Q$d(N.body);break}}}catch(ka){wb.a.error(557641871,wb.b.CoreDefault,ka)}};$a.prototype.onClose=function(u){u=Error("Connection closed: "+u);for(var N=D.makeIterator(this.activeRequests),V=N.next();!V.done;V=N.next())V.value.cgb(u);this.activeRequests=[];N=D.makeIterator(this.pendingRequests);for(V=N.next();!V.done;V=N.next())V.value.cgb(u);this.pendingRequests=[];this.worker=void 0};$a.prototype.getWorker=function(u){this.worker||
(this.worker=this.workerFactory(),this.worker.init(u,this.onMessage.bind(this),function(){},this.onClose.bind(this)));return this.worker};var gg;Na();var Pi=new $a(3E4,function(){return new he},50);Fa.prototype.setBucketSize=function(u,N){this.bucketSizes.set(u,N)};Fa.prototype.setResult=function(u,N,V){if(N.primary){var ka=this.cache.get(u);ka||(ka=new Map,this.cache.set(u,ka));var wa=ka.get(N.primary);wa||(wa=N.secondary?new Map:[],ka.set(N.primary,wa));N.secondary?wa.set(N.secondary,V):(N=wa,N.length==
this.getBucketSize(u)&&N.shift(),N.push(V))}};Fa.prototype.getResults=function(u,N){if(u=this.cache.get(u))if(u=u.get(N.primary)){if(!N.secondary)return u;N=Array.from(u.values());if(0<N.length)return N}return[]};Fa.prototype.clear=function(u,N){N?this.cache.forEach(function(V,ka){u&&u!==ka||(N.secondary?(V=V.get(N.primary))&&V.delete(N.secondary):V.delete(N.primary))}):u?this.cache.delete(u):this.cache.clear()};Fa.prototype.getBucketSize=function(u){return this.bucketSizes.get(u)||10};var Bk;(function(u){u[u.Unknown=
0]="Unknown";u[u.Local=1]="Local";u[u.Custom=2]="Custom";u[u.Remote=3]="Remote";u[u.BatchedRemote=4]="BatchedRemote"})(Bk||(Bk={}));zb.prototype.execute=function(u,N,V){var ka=this;if(N.throttleSettings.shouldBeThrottled&&0<N.throttleSettings.throttlingInterval){var wa=this.getWorkflowThrottleInfo(N.name);if(void 0==wa.Zeb)wa.Zeb=u,wa.o_a=mc.getCurrentTimeMs(),V();else if(wa.Zeb===u){u=mc.getCurrentTimeMs();var Ga=this.delayTime(wa,u,N.throttleSettings.throttlingInterval);0<Ga?(wa.Q5b=V,void 0==wa.vza&&
(wa.vza=setTimeout(function(){var la=ka.getWorkflowThrottleInfo(N.name);la.vza=void 0;la.o_a=mc.getCurrentTimeMs();la.Q5b()},Ga))):(wa.o_a=u,V())}else void 0!=wa.vza&&(clearTimeout(wa.vza),wa.Q5b(),wa.vza=void 0),wa.Zeb=u,wa.o_a=mc.getCurrentTimeMs(),V()}else V()};zb.prototype.delayTime=function(u,N,V){return Math.max(V-(N-u.o_a),0)};zb.prototype.getWorkflowThrottleInfo=function(u){var N=this.throttleInfoMap.get(u);N||(N={Zeb:void 0,o_a:-1,Q5b:function(){},vza:void 0},this.throttleInfoMap.set(u,N));
return N};var Zb;(function(u){u[u.Restricted=0]="Restricted";u[u.Unrestricted=1]="Unrestricted";u[u.Suppressed=2]="Suppressed"})(Zb||(Zb={}));kb.prototype.getOutputSchema=function(){return this.lambdas[this.lambdas.length-1].outputSchema};kb.prototype.scheduleExecution=function(u,N){u=this.docSessionIdExtractor?this.docSessionIdExtractor(u):void 0;var V=this.getStateForDocSessionId(u);V===Zb.Restricted?(u=this.getExecutionQueueForDocSessionId(u),u.push(N),1===u.length&&N()):V===Zb.Unrestricted&&N()};
kb.prototype.onStart=function(u){this.incrementExecutionCountForDocSessionId(u)};kb.prototype.onFinish=function(u,N){this.decrementExecutionCountForDocSessionId(u);if(N===ke.Authentication)this.stateByDocSessionId.set(u,Zb.Suppressed),this.executionQueueByDocSessionId.delete(u);else if(this.stateByDocSessionId.get(u)===Zb.Restricted){var V=this.getExecutionQueueForDocSessionId(u);V.shift();if(void 0===N)for(this.stateByDocSessionId.set(u,Zb.Unrestricted),this.executionQueueByDocSessionId.delete(u),
u=D.makeIterator(V),N=u.next();!N.done;N=u.next())N=N.value,N();else if(0<V.length)(0,V[0])()}};kb.prototype.onRefresh=function(u){this.stateByDocSessionId=new Map;this.triggerOnRefresh&&(u?(this.executionQueueByDocSessionId.delete(u),this.executionCountByDocSessionId.delete(u)):(this.executionQueueByDocSessionId=new Map,this.executionCountByDocSessionId=new Map));this.canaryTextTileEventSubmittedByDocSessionId.delete(u)};kb.prototype.getStateForDocSessionId=function(u){var N=this.stateByDocSessionId.get(u);
void 0===N&&(N=kb.executionQueuesEnabled?Zb.Restricted:Zb.Unrestricted,this.stateByDocSessionId.set(u,N));return N};kb.prototype.getExecutionQueueForDocSessionId=function(u){var N=this.executionQueueByDocSessionId.get(u);void 0===N&&(N=[],this.executionQueueByDocSessionId.set(u,N));return N};kb.prototype.incrementExecutionCountForDocSessionId=function(u){var N=this.executionCountByDocSessionId.get(u)||0;this.executionCountByDocSessionId.set(u,N+1)};kb.prototype.decrementExecutionCountForDocSessionId=
function(u){var N=this.executionCountByDocSessionId.get(u)||0;1>=N?this.executionCountByDocSessionId.delete(u):this.executionCountByDocSessionId.set(u,N-1)};kb.executionQueuesEnabled=!0;xa.prototype.init=function(u,N,V){var ka=this,wa=new Pc({operationName:"InitRuntimeALv1",resourceId:u});wa.start();if(this.clientMetadata=N)this.clientMetadata.runtimeVersion=e(1147).version;this.hostCallbacks=V;V=[];V.push(this.isFeatureEnabled("DisableWebSocket").then(function(Ga){Ga?Ga=!1:0<="Outlook Mac;Outlook Win32;PowerPoint Mac;PowerPoint Web;PowerPoint Win32;Word Mac;Word Win32".split(";").indexOf(N.appName+
" "+N.appPlatform)?(Ga=mc.convertServiceUrlToWebSocket(u),Ga=Pi.testConnection(Ga,ka.clientMetadata)):Ga=!0;return Ga}).then(function(Ga){u&&(ka.serviceUrl=Ga?mc.convertServiceUrlToWebSocket(u):u,ka.executeRemoteLambda=Ga?Za:Xa,ka.clearRemoteLambdaTokenCache=Ga?Na:Fb,ka.serviceProtocol=ka.serviceUrl.split(":")[0].toLowerCase())}));V.push(this.isFeatureEnabled("WorkflowQueuesDisabled").then(function(Ga){kb.executionQueuesEnabled=!Ga}));V.push(this.isFeatureEnabled("TileRefreshByDocSessionIdDisabled").then(function(Ga){ka.tileRefreshByDocSessionIdEnabled=
!Ga}));return Promise.all(V).then(function(){ka.logOperation(wa,!0)}).catch(function(Ga){ka.logOperation(wa,!1,"Error",Ga?Ga.message:"(no error)")})};xa.prototype.getServiceProtocol=function(){return this.serviceProtocol};xa.prototype.registerSchemas=function(){return Promise.resolve()};xa.prototype.registerSimpleLocalWorkflow=function(u,N,V){V=void 0===V?this.defaultWorkflowOptions:V;N.source=N.source||Bk.Custom;return this.registerHardcodedWorkflow(u,[N],this.inputSchemasToWorkflows,V)};xa.prototype.registerSimpleRemoteWorkflow=
function(u,N,V,ka,wa){wa=void 0===wa?this.defaultWorkflowOptions:wa;var Ga=[];N&&(N.source=Bk.Custom,Ga.push(N));V.source=V.func?Bk.Custom:Bk.Remote;Ga.push(V);ka&&(ka.source=Bk.Custom,Ga.push(ka));return this.registerHardcodedWorkflow(u,Ga,this.inputSchemasToWorkflows,wa)};xa.prototype.registerMultipleLambdasWorkflow=function(u,N,V){V=void 0===V?this.defaultWorkflowOptions:V;return this.registerHardcodedWorkflow(u,N,this.inputSchemasToWorkflows,V)};xa.prototype.registerReduceWorkflow=function(u,
N,V,ka,wa){ka=void 0===ka?10:ka;wa=void 0===wa?this.defaultWorkflowOptions:wa;this.reduceWorkflowsGroupingKeyExtractors.set(N.inputSchema,V);this.resultCache.setBucketSize(N.inputSchema,ka);N.source=N.source||Bk.Custom;return this.registerHardcodedWorkflow(u,[N],this.inputSchemasToReduceWorkflows,wa)};xa.prototype.registerMultipleLambdasReduceWorkflow=function(u,N,V,ka,wa){ka=void 0===ka?10:ka;wa=void 0===wa?this.defaultWorkflowOptions:wa;this.reduceWorkflowsGroupingKeyExtractors.set(N[0].inputSchema,
V);this.resultCache.setBucketSize(N[0].inputSchema,ka);return this.registerHardcodedWorkflow(u,N,this.inputSchemasToReduceWorkflows,wa)};xa.prototype.submit=function(u,N,V){this.submitToWorkflows(u,N,V,this.inputSchemasToWorkflows)};xa.prototype.getGroupingKey=function(u,N,V){V=this.reduceWorkflowsGroupingKeyExtractors.get(V);if(void 0==V)throw Error("Reduce workflow does not have a grouping extractor");return V(N,u)};xa.prototype.submitToWorkflows=function(u,N,V,ka){ka=void 0===ka?this.inputSchemasToWorkflows:
ka;if(this.hostCallbacks){V=V?Lh.fromString(V):new Lh;this.handleTileRefresh(u,N,V);var wa=ka.get(u)||[];wa=D.makeIterator(wa);for(var Ga=wa.next();!Ga.done;Ga=wa.next())if(Ga=Ga.value,!Da(u,N)||Ga.triggerOnRefresh)Ga.useCanaryTextTile&&"Tiling.TextTileEvent"===u&&!Ga.canaryTextTileEventSubmittedByDocSessionId.has(ua(u,N))&&(this.submitToWorkflow("Tiling.TextTileEvent",{type:N.type,tile:{metadata:{docSessionId:N.tile.metadata.docSessionId,docId:N.tile.metadata.docId,VDd:N.tile.metadata.VDd,tileId:"A56B3127DBDFD0D6"},
elements:[{text:"B91153AE828B4E48"}]}},V,Ga,ka),Ga.canaryTextTileEventSubmittedByDocSessionId.add(ua(u,N))),this.submitToWorkflow(u,N,V,Ga,ka)}};xa.prototype.submitToWorkflow=function(u,N,V,ka,wa){var Ga=this,la={messageType:to.Input,correlationVector:V.newChild(),payload:N,payloadSchema:Sa(ka.lambdas[0].inputSchema),clientMetadata:this.clientMetadata},ab=new Pc({cv:la.correlationVector.toString(),operationName:"ExecuteWorkflow",resourceId:ka.name});ab.setClientMetadata(this.clientMetadata);ab.start();
ka.scheduleExecution(N,function(){try{la.payload&&la.payload.tile&&la.payload.tile.metadata&&la.payload.tile.metadata.tileId?Ga.throttling.execute(la.payload.tile.metadata.tileId,ka,function(){return Ga.executeWorkflow(ab,la,N,ka,u,wa)}):Ga.executeWorkflow(ab,la,N,ka,u,wa)}catch(nb){ab.success=!1,ab.resultSignature="ExecuteException",ab.resultDescription=nb?nb.message:"(no error)",wb.a.error(559290447,wb.b.CoreDefault,ab.stop())}})};xa.prototype.handleTileRefresh=function(u,N,V){var ka=this;if(Da(u,
N)){var wa=this.tileRefreshByDocSessionIdEnabled?ua(u,N):void 0;u=Pa(u,N);if(this.tileRefreshByDocSessionIdEnabled){if(N=this.lastTileRefreshSeqByDocSessionId.get(wa),0<=N&&u<=N)return}else if(u<=this.lastTileRefreshSeq)return;var Ga=new Pc({cv:V.toString(),operationName:"TileRefresh",resultDescription:"",success:!0});Ga.start();if(this.tileRefreshByDocSessionIdEnabled&&!wa)Ga.success=!1,Ga.resultDescription="NoDocSessionId",wb.a.info(559290448,wb.b.CoreDefault,Ga.stop());else{this.inputSchemasToReduceWorkflows.forEach(function(ab,
nb){ab.some(function(sb){return sb.triggerOnRefresh})&&(ka.tileRefreshByDocSessionIdEnabled?(ka.resultCache.clear(nb,{primary:wa}),ka.resultCache.clear(ka.getForcedDocLevelSchema(nb),{primary:wa}),ka.reduceTimerCache.clear(nb,wa)):(ka.resultCache.clear(nb),ka.resultCache.clear(ka.getForcedDocLevelSchema(nb)),ka.reduceTimerCache.clear(nb)),ab.some(function(sb){return!sb.triggerOnRefresh})&&(Ga.resultDescription+="X_"),Ga.resultDescription+=nb+" ")});this.clearRemoteLambdaTokenCache();var la=[];this.inputSchemasToWorkflows.forEach(function(ab){return la.push.apply(la,
D.Nh(ab))});this.inputSchemasToReduceWorkflows.forEach(function(ab){return la.push.apply(la,D.Nh(ab))});V=D.makeIterator(la);for(N=V.next();!N.done;N=V.next())if(N=N.value,this.tileRefreshByDocSessionIdEnabled)N.onRefresh(wa);else N.onRefresh();this.tileRefreshByDocSessionIdEnabled?this.lastTileRefreshSeqByDocSessionId.set(wa,u):this.lastTileRefreshSeq=u;wb.a.info(559290449,wb.b.CoreDefault,Ga.stop())}}};xa.prototype.executeWorkflow=function(u,N,V,ka,wa,Ga){function la(bc){var Xb=ab.tileRefreshByDocSessionIdEnabled?
ab.lastTileRefreshSeqByDocSessionId.get(sb):ab.lastTileRefreshSeq;if(ka.triggerOnRefresh&&Xb!==Db)u.success=!0,u.resultSignature="TileRefreshIgnore",wb.a.info(559290450,wb.b.CoreDefault,u.stop());else{var Gc=(Xb=bc.messageType==to.Exception&&bc.payload.exceptionType==ke.NoOutput)&&ka.canProduceNullResult,oe=Gc?ka.lambdas[ka.lambdas.length-1].outputSchema:bc.payloadSchema.schema.name,pe=Gc?null:bc.payload;if(bc.messageType===to.Input||Gc){if(ka.shouldSendResultsToHost)if(Ga===ab.inputSchemasToReduceWorkflows)ab.hostCallbacks.onResult("Reduce.Input",
V,oe,pe);else ab.hostCallbacks.onResult(wa,V,oe,pe);u.success=!0;u.resultSignature=Xb?"NoOutput":"ValidOutput"}else Xb?(u.success=!0,u.resultSignature="NoOutput"):(u.success=!1,u.resultSignature="Exception",u.resultDescription=dc(bc));Ga!==ab.inputSchemasToReduceWorkflows&&ab.updateResultCacheForReduceWorkflows(wa,V,oe,pe,bc.correlationVector.toString());bc.moreResults||(u.stop(),wb.a.info(559290451,wb.b.CoreDefault,u),ka.onFinish(sb,bc.payload&&bc.payload.exceptionType?null==bc||null==bc.payload||
null==bc.payload.exceptionType?ke.Unknown:bc.payload.exceptionType:void 0))}}var ab=this,nb=ka.docIdExtractor?ka.docIdExtractor(N.payload):void 0,sb=ka.docSessionIdExtractor(V),Db=this.tileRefreshByDocSessionIdEnabled?this.lastTileRefreshSeqByDocSessionId.get(sb):this.lastTileRefreshSeq;ka.onStart(sb);void ka.preExecutionPromise.then(function(){for(var bc={lookupTable:ab.lookupTableCache.get(ka.name),docId:nb,docSessionId:sb},Xb=la,Gc=ka.lambdas.length-1;0<=Gc;Gc--)Xb=ab.createLambdaExecutionStep(ka.name,
ka.lambdas[Gc],bc,Xb,la);Xb(N)})};xa.prototype.getForcedDocLevelSchema=function(u){return"~"+u};xa.prototype.updateResultCacheForReduceWorkflows=function(u,N,V,ka,wa){var Ga=this,la=this.inputSchemasToReduceWorkflows.get(V);if(la){if("docSessionId"===u){var ab=this.getGroupingKey(u,N,V);this.resultCache.setResult(this.getForcedDocLevelSchema(V),ab,ka);ab.secondary="*"}else ab=this.getGroupingKey(u,N,V),("Tiling.TextTileEvent"===u&&N&&N.type==Uo.TextTileEventType.Delete||"ClpSlideTile"===u&&N&&N.eventType==
Ke.SlideTileEventType.Delete)&&void 0!=ab.primary&&void 0!=ab.secondary?this.resultCache.clear(void 0,ab):this.resultCache.setResult(V,ab,ka);var nb=la.some(function(Db){return Db.deferReduceUntilIdle}),sb=[];this.inputSchemasToWorkflows.forEach(function(Db){return sb.push.apply(sb,D.Nh(Db.filter(function(bc){return bc.getOutputSchema()===V})))});u=la.map(function(Db){return Db.deferReduceUntilIdleMaxDelayMs||0}).reduce(function(Db,bc){return Math.max(Db,bc)});this.reduceTimerCache.setReduceTimer(V,
ab.primary,function(){var Db=Ga.resultCache.getResults(V,ab);Db.push.apply(Db,D.Nh(Ga.resultCache.getResults(Ga.getForcedDocLevelSchema(V),{primary:ab.primary})));Array.isArray(Db)?Ga.submitToWorkflows(V,{id:ab.primary,values:Db,cff:!0},wa,Ga.inputSchemasToReduceWorkflows):wb.a.error(559290452,wb.b.CoreDefault,'Cached results have unexpected type "'+typeof Db+'"')},500,function(){return nb&&sb.some(function(Db){return 0<Db.executionCountByDocSessionId.get(ab.primary)})},u)}};xa.prototype.isFeatureEnabled=
function(u,N,V){N=void 0===N?!1:N;return this.hostCallbacks&&this.hostCallbacks.isFeatureEnabled?this.hostCallbacks.isFeatureEnabled("Microsoft.Office.AugLoop."+u,void 0===V?"None":V).catch(function(){return Promise.resolve(N)}):Promise.resolve(N)};xa.prototype.areLicenseFeaturesEnabled=function(u){return this.hostCallbacks&&this.hostCallbacks.areLicenseFeaturesEnabled?this.hostCallbacks.areLicenseFeaturesEnabled(u).catch(function(){return Promise.resolve(!1)}):Promise.resolve(!1)};xa.prototype.isWorkflowEnabled=
function(u,N,V,ka,wa){var Ga=this;if(N.some(function(la){return la.source===Bk.Remote||la.source===Bk.BatchedRemote})){if(!this.serviceUrl)return wa.resultDescription="Disabled because no service URL available for remote workflow",Promise.resolve(!1);if(this.clientMetadata&&this.clientMetadata.privateMode&&N.some(function(la){return(la.source===Bk.Remote||la.source===Bk.BatchedRemote)&&!la.canRunInPrivateMode}))return wa.resultDescription="Disabled because we are running in private mode",Promise.resolve(!1)}if(!this.clientMetadata||
"Mac"!==this.clientMetadata.appPlatform&&"Win32"!==this.clientMetadata.appPlatform)ka=!0,wa.resultDescription="Enabled by default due to platform name";return(ka?Promise.resolve(!0):this.isFeatureEnabled("WorkflowEnabled."+u)).then(function(la){if(la)return Ga.isFeatureEnabled("WorkflowDisabled."+u).then(function(ab){return ab?(wa.resultDescription="Disabled because explicitly disabled",!1):V?Ga.areLicenseFeaturesEnabled(V).then(function(nb){nb||(wa.resultDescription="Disabled because license check failed");
return nb}):!0});wa.resultDescription="Disabled because not explicitly enabled";return!1})};xa.prototype.registerHardcodedWorkflow=function(u,N,V,ka){var wa=this;V=void 0===V?this.inputSchemasToWorkflows:V;if(!u||40<u.length)throw Error("Workflow name has invalid length");if(!1===(new RegExp(/^[A-Z][a-zA-Z0-9_]+$/)).test(u))throw Error("Workflow name has invalid format");V.forEach(function(la){if(la.some(function(ab){return ab.name===u}))throw Error("Workflow name already registered.");});var Ga=
new Pc({operationName:"WorkflowRegistration",resourceId:u,success:!0});Ga.setClientMetadata(this.clientMetadata);Ga.start();return this.isWorkflowEnabled(u,N,ka.licenseFeatures,ka.enabledByDefault,Ga).then(function(la){Ga.resultSignature=la?"Enabled":"Disabled";Ga.stop();wb.a.info(559290453,wb.b.CoreDefault,Ga);if(la){var ab=N[0].inputSchema;la=V.get(ab);la||(la=[],V.set(ab,la));var nb=Promise.resolve();ka.lookupTableLambda&&(nb=new Promise(function(Db){function bc(Gc){Gc.messageType===to.Input&&
Gc.payload&&wa.lookupTableCache.set(u,Gc.payload);Db()}var Xb=new Lh;Xb={messageType:to.Input,correlationVector:Xb,payloadSchema:Sa(ka.lookupTableLambda.inputSchema),clientMetadata:wa.clientMetadata,payload:{}};wa.createLambdaExecutionStep("",ka.lookupTableLambda,{},bc,bc)(Xb)}));var sb=new kb;sb.name=u;sb.lambdas=N;sb.canProduceNullResult=ka.canProduceNullResult;sb.shouldSendResultsToHost=ka.shouldSendResultsToHost;sb.triggerOnRefresh=ka.triggerOnRefresh;sb.throttleSettings=ka.throttleSettings||
wa.defaultWorkflowOptions.throttleSettings;sb.docIdExtractor=ka.docIdExtractor;sb.docSessionIdExtractor=function(Db){return Db.cff?Db.id:ua(ab,Db)};sb.deferReduceUntilIdle=ka.deferReduceUntilIdle;sb.deferReduceUntilIdleMaxDelayMs=ka.deferReduceUntilIdleMaxDelayMs;sb.useCanaryTextTile=ka.useCanaryTextTile;sb.preExecutionPromise=nb;la.push(sb)}})};xa.prototype.logOperation=function(u,N,V,ka){u.stop();u.success=N;u.resultSignature=V;u.resultDescription=ka;wb.a.info(559290454,wb.b.CoreDefault,u)};xa.prototype.handleLambdaError=
function(u,N,V,ka,wa){void 0!=u.exceptionType?Kc(N,u):u instanceof Error?Kc(N,{exceptionType:ka,message:u.message}):Kc(N,{exceptionType:ke.Unknown,message:u?u.toString():void 0});this.logOperation(V,!1,"Exception",dc(N));wa(N)};xa.prototype.handleLambdaOutput=function(u,N,V,ka,wa,Ga){u&&u.exceptionType!==ke.NoOutput?void 0!=u.exceptionType?this.handleLambdaError(u,N,V,u.exceptionType,Ga):u instanceof Error?this.handleLambdaError(u,N,V,ke.LambdaErrorCallback,Ga):(N.payload=u,N.payloadSchema=Sa(ka),
this.logOperation(V,!0),wa(N)):(Kc(N,{exceptionType:ke.NoOutput}),this.logOperation(V,!0,"NoOutput"),Ga(N))};xa.prototype.executeCustomLambdaStep=function(u,N,V,ka,wa,Ga){var la=this;if(null==V.func)Kc(u,{exceptionType:ke.LambdaThrow,message:"No lambda function set"}),this.logOperation(N,!1,"Error",dc(u)),Ga(u);else{var ab=function(sb){la.handleLambdaOutput(sb,u,N,V.outputSchema,wa,Ga)},nb=function(sb,Db){la.handleLambdaOutput(sb,u,N,Db,Ga,Ga)};try{V.func(u.payload,V.config,ka,ab,nb)}catch(sb){this.handleLambdaError(sb,
u,N,ke.LambdaThrow,Ga)}}};xa.prototype.executeLocalLambdaStep=function(u,N,V,ka,wa){var Ga=this;void 0==this.hostCallbacks.executeLocalLambda?(Kc(u,{exceptionType:ke.LambdaThrow,message:"No local lambda host callback set"}),this.logOperation(N,!1,"Error",dc(u)),wa(u)):this.hostCallbacks.executeLocalLambda(V.inputSchema,u.payload,V.outputSchema).then(function(la){Ga.handleLambdaOutput(la,u,N,V.outputSchema,ka,wa)}).catch(function(la){Ga.handleLambdaError(la,u,N,ke.LambdaThrow,wa)})};xa.prototype.executeRemoteLambdaStep=
function(u,N,V,ka,wa,Ga){var la=this;if(this.serviceUrl){N.resourceId+="."+this.serviceProtocol;var ab=function(Db,bc){Db?la.handleLambdaError(Db,u,N,Db.exceptionType||ke.LambdaErrorCallback,Ga):la.handleLambdaOutput(bc,u,N,V.outputSchema,wa,Ga)};ka.authTickets=V.authTickets;if(V.source===Bk.Remote)this.executeRemoteLambda(this.serviceUrl,u,Sa(V.inputSchema),Sa(V.outputSchema),u.correlationVector,this.clientMetadata,this.hostCallbacks,ka,ab);else{this.batchedRemoteLambdaManager||(this.batchedRemoteLambdaManager=
new ac(function(Db,bc,Xb){var Gc=bc.context,oe=Gc.xIf;Gc=Gc.$id;la.executeRemoteLambda(la.serviceUrl,{messageType:to.Input,correlationVector:{id:bc.cv},payload:Db,payloadSchema:Sa(oe.inputSchema),clientMetadata:la.clientMetadata},Sa(oe.remoteInputSchema),Sa(oe.remoteOutputSchema),{id:bc.cv},la.clientMetadata,la.hostCallbacks,Gc,Xb)},!1,function(Db,bc,Xb){var Gc;Xb=Xb.$id;la.updateResultCacheForReduceWorkflows("docSessionId",null!==(Gc=Xb.docSessionId)&&void 0!==Gc?Gc:Xb.docId,Db,bc)}));var nb=this.normalizeBatchOptions(V.batchOptions),
sb=nb.groupingKeyExtractor;nb.groupingKeyExtractor=function(Db){return V.name+"-"+sb(Db)};this.batchedRemoteLambdaManager.addBatchItem(u.payload,nb,{name:V.name,xIf:V,$id:ka},127<u.correlationVector.id.length?u.correlationVector.id.substring(0,127)+"!":u.correlationVector.id,void 0,ab)}}else Kc(u,{exceptionType:ke.LambdaThrow,message:"No URL for remote lambda"}),this.logOperation(N,!1,"Error",dc(u)),Ga(u)};xa.prototype.createLambdaExecutionStep=function(u,N,V,ka,wa){var Ga=this;return function(la){var ab=
new Pc({cv:la.correlationVector.toString(),operationName:"ExecuteLambda",resourceId:N.name,dimension0:u});ab.start();N.source===Bk.Custom?Ga.executeCustomLambdaStep(la,ab,N,V,ka,wa):N.source===Bk.Local?Ga.executeLocalLambdaStep(la,ab,N,ka,wa):N.source===Bk.Remote||N.source===Bk.BatchedRemote?Ga.executeRemoteLambdaStep(la,ab,N,V,ka,wa):(Kc(la,{exceptionType:ke.LambdaThrow,message:"Unknown/No lambda location set"}),Ga.logOperation(ab,!1,"Error",dc(la)),wa(la))}};xa.prototype.normalizeBatchOptions=function(u){if(!u)throw Error("Expected batchConfig");
var N=Object.assign({},u);u.estimateSize||(N.estimateSize=od);return N};var Qk=new xa,hr,Fj,ir=new WeakMap,Vn=new WeakMap,xl=new WeakMap,vt=new WeakMap,$r=new WeakMap,Ql={get:function(u,N,V){if(u instanceof IDBTransaction){if("done"===N)return Vn.get(u);if("objectStoreNames"===N)return u.objectStoreNames||xl.get(u);if("store"===N)return V.objectStoreNames[1]?void 0:V.objectStore(V.objectStoreNames[0])}return Ja(u[N])},set:function(u,N,V){u[N]=V;return!0},has:function(u,N){return u instanceof IDBTransaction&&
("done"===N||"store"===N)?!0:N in u}},Cs=["get","getKey","getAll","getAllKeys","count"],tn=["put","add","delete","clear"],un=new Map;Ql=function(u){return Object.assign({},u,{get:function(N,V,ka){return xb(N,V)||u.get(N,V,ka)},has:function(N,V){return!!xb(N,V)||u.has(N,V)}})}(Ql);var vn="undefined"!==typeof fetch?fetch:im,Zj;(function(u){u.URL="URL";u.ArrayBuffer="ArrayBuffer"})(Zj||(Zj={}));M.prototype.getResourceAsArrayBuffer=function(u,N,V){var ka=new Pc({operationName:"GetResource",success:!0,
resultDescription:"",dimension0:Zj.ArrayBuffer,dimension1:u,dimension2:N});ka.start();var wa={};return this.getResource(u,N,V,Zj.ArrayBuffer,ka,function(Ga){return Promise.all(Array.from(Ga.keys()).map(function(la){var ab=Ga.get(la);return ab.arrayBuffer?ab.arrayBuffer().then(function(nb){wa[la]=nb}):new Promise(function(nb,sb){var Db=new FileReader;Db.readAsArrayBuffer(ab);Db.onload=function(bc){bc=bc.target.result;bc instanceof ArrayBuffer?(wa[la]=bc,nb()):sb(Error("Unable to obtain ArrayBuffer"))}})}))}).then(function(){return wa})};
M.prototype.getResourceAsURL=function(u,N,V){var ka=new Pc({operationName:"GetResource",success:!0,resultDescription:"",dimension0:Zj.URL,dimension1:u,dimension2:N});ka.start();var wa={};return this.getResource(u,N,V,Zj.URL,ka,function(Ga){return Promise.all(Array.from(Ga.keys()).map(function(la){wa[la]=URL.createObjectURL(Ga.get(la))}))}).then(function(){return wa})};M.prototype.getResource=function(u,N,V,ka,wa,Ga){var la=this;return this.getFiles(u,N,V,wa).then(function(ab){return Ga(ab)}).then(function(){la.closeDBAndEndLog(wa,
"retrieving "+u)}).catch(function(ab){0<=wa.resultDescription.indexOf(ab.message)&&(wa.success=!1,wa.resultDescription+=ab.message+" ");wa.resultSignature="Issue retrieving from CDN or translating to "+ka;la.closeDBAndEndLog(wa,"retrieving "+u);throw ab;})};M.prototype.checkFirefoxCompatibility=function(u){u=globalThis.navigator.userAgent.substring(u+8,u+11);u.replace(".","");return 70>=parseInt(u,10)?new Promise(function(N,V){var ka=globalThis.indexedDB.open(this.dbName,this.dbVersion);ka.onsuccess=
function(){N(!0)};ka.onerror=function(wa){V(wa);return!0}}):Promise.resolve(!0)};M.prototype.isBrowserIdbCompatible=function(){var u,N;return"undefined"===typeof Array||"undefined"===typeof Array.from||"undefined"===typeof Proxy||"undefined"===typeof URL||"undefined"===typeof URL.createObjectURL?Promise.resolve(!1):"undefined"!==typeof globalThis&&(null===(u=globalThis.navigator)||void 0===u?0:u.userAgent)?-1<globalThis.navigator.userAgent.toLowerCase().indexOf("firefox")?globalThis.indexedDB?this.checkFirefoxCompatibility(globalThis.navigator.userAgent.toLowerCase().indexOf("firefox")):
Promise.resolve(!1):-1<globalThis.navigator.userAgent.toLowerCase().indexOf("safari")&&-1>=globalThis.navigator.userAgent.toLowerCase().indexOf("chrome")?this.checkIdbByFeatures?(null===(N=globalThis.document)||void 0===N?0:N.hasStorageAccess)?globalThis.document.hasStorageAccess().then(function(){return!0}).catch(function(){return!1}):Promise.resolve(!1):Promise.resolve(!1):Promise.resolve(!0):Promise.resolve(!1)};M.prototype.accessDB=function(){var u=this;return this.accessDBPromise?this.accessDBPromise.then(function(N){return N.transaction(u.osName).done}).then(function(){return u.accessDBPromise}).catch(function(){return u.callOpenDB()}):
this.callOpenDB()};M.prototype.callOpenDB=function(){var u=this;return this.accessDBPromise=Wa(this.dbName,this.dbVersion,{upgrade:function(N){N.objectStoreNames.contains(u.osName)&&N.deleteObjectStore(u.osName);N.createObjectStore(u.osName,{keyPath:"id",autoIncrement:!0})}})};M.prototype.endLog=function(u,N){u.success?(u.resultDescription="Success "+N,wb.a.info(573329487,wb.b.CoreDefault,u.stop())):(u.resultDescription+="error "+N,wb.a.error(573329488,wb.b.CoreDefault,u.stop()))};M.prototype.closeDBAndEndLog=
function(u,N){var V=this;this.accessDBPromise?void this.accessDBPromise.then(function(ka){ka.close()}).catch(function(ka){0<=u.resultDescription.indexOf(ka.message)&&(u.success=!1,u.resultDescription+=(ka.message?ka.message:"Error closing db")+" ",u.resultSignature="Issue closing db")}).then(function(){V.accessDBPromise=void 0;V.endLog(u,N)}):this.endLog(u,N)};M.prototype.getFiles=function(u,N,V,ka){var wa=this;return this.isBrowserIdbCompatible().catch(function(Ga){ka.success=!1;ka.resultDescription+=
Ga.message+" ";ka.resultSignature="Issue determining idb compatibility";return!1}).then(function(Ga){function la(){if(V){if(wa.isPolymerSupported)return wa.downloadFiles1CDN(u,N,V,ka,Ga);throw Error("Missing polymerBaseURL provided at host level for queries with modelFilters");}return wa.downloadFiles(u,N,ka,Ga)}return Ga?wa.getFilesFromIDB(u,N,V,ka).catch(function(ab){ab&&(0<=ka.resultDescription.indexOf(ab.message)&&(ka.success=!1,ka.resultDescription+=ab.message+" "),ka.resultSignature="Issue retrieving from DB");
return la()}):la()})};M.prototype.getFilesFromIDB=function(u,N,V,ka){var wa=this;return this.initPromise.catch(function(Ga){ka.success=!1;ka.resultDescription+=Ga.message+" ";ka.resultSignature="Issue initializing"}).then(function(){return wa.getModelOptions(u)}).then(function(Ga){Ga=D.makeIterator(Ga);for(var la=Ga.next();!la.done;la=Ga.next())if((la=la.value)&&la.model&&la.version==N&&wa.checkModelFiltersPass(V,la.filters))return void wa.putModel(u,la.model,N,la.filters,ka,la.id),Promise.resolve(la.model);
return Promise.reject()})};M.prototype.checkModelFiltersPass=function(u,N){var V;u=D.makeIterator(u);for(var ka=u.next();!ka.done;ka=u.next()){ka=ka.value;var wa=null===(V=N.get(ka[0]))||void 0===V?void 0:V.map(function(Ga){return Ga.toLocaleLowerCase()});if(!wa)throw Error("Expected filter "+ka[0]+" to exist in metadata file");if(0>wa.indexOf(ka[1].toLocaleLowerCase()))return!1}return!0};M.prototype.downloadFiles1CDN=function(u,N,V,ka,wa){var Ga=this;ka.dimension3="Polymer";var la;V||(V=new Map);
return vn(this.polymerBaseURL+"/"+u+"/"+N+"/metadata.json").then(function(ab){if(ab.ok)return ab.text();throw Error("CDN download response status: "+ab.status);}).then(function(ab){var nb,sb;ab=JSON.parse(ab);if(ab.name!==u||ab.version!==N)throw Error("Expected: "+u+" version "+N+", received: "+ab.name+" version "+ab.version);for(var Db=D.makeIterator(ab.variants),bc=Db.next();!bc.done;bc=Db.next())if(bc=bc.value,la=new Map(Object.entries(bc)),Ga.checkModelFiltersPass(V,la)){if(ab.Ffg?V.size+2:V.size+
1!==la.size)ka.success=!1,ka.resultDescription+="Expected "+(null===(nb=la.keys)||void 0===nb?void 0:nb.length)+" # of filters, received "+(null===(sb=V.keys)||void 0===sb?void 0:sb.length);return bc.$hg}throw Error("No model found with given filters");}).then(function(ab){return Promise.all(ab.map(function(nb){return vn(Ga.polymerBaseURL+"/"+u+"/"+N+"/"+nb).then(function(sb){if(sb.ok)return sb.blob();throw Error("CDN download response status: "+sb.status);}).then(function(sb){return[nb,sb]})}))}).then(function(ab){ab=
new Map(ab);return wa?Ga.putModel(u,ab,N,la,ka):ab})};M.prototype.downloadFiles=function(u,N,V,ka){var wa=this;V.dimension3="FS";return vn(this.baseURL+"/catalog_"+u+"_"+N+".json").then(function(Ga){if(Ga.ok)return Ga.text();throw Error("CDN download response status: "+Ga.status);}).then(function(Ga){Ga=JSON.parse(Ga);var la=Ga.MajorVersion+"."+Ga.MinorVersion+"/ModelResources",ab=u+"/"+N+"/";return Promise.all(Ga.beg.map(function(nb){nb.Name.length>ab.length&&nb.Name.substring(0,ab.length)===ab&&
(nb.Name=nb.Name.substring(ab.length));return vn(wa.baseURL+"/"+la+"/"+ab+nb.Name+"."+nb.Type).then(function(sb){if(sb.ok)return sb.blob();throw Error("CDN download response status: "+sb.status);}).then(function(sb){return[nb.Name+"."+nb.Type,sb]})}))}).then(function(Ga){Ga=new Map(Ga);return ka?wa.putModel(u,Ga,N,new Map,V):Ga})};M.prototype.getModelOptions=function(u){var N=this;return this.accessDB().then(function(V){var ka=[],wa=V.transaction(N.osName,"readonly");return wa.objectStore(N.osName).openCursor().then(function ab(la){if(la){var nb=
la.value;nb.modelId==u&&ka.push(nb);return la.continue().then(ab)}return wa.done}).then(function(){return ka})})};M.prototype.putModel=function(u,N,V,ka,wa,Ga){var la=this;ka||(ka=new Map);return this.accessDB().then(function(ab){return ab.put(la.osName,{modelId:u,model:N,version:V,filters:ka,Pub:0},Ga)}).catch(function(ab){0<=wa.resultDescription.indexOf(ab.message)&&(wa.success=!1,wa.resultDescription+=ab.message+" ");wa.resultSignature="Issue adding to DB"}).then(function(){return N})};var Jf;
(function(u){u[u.None=0]="None";u[u.Booleans=1]="Booleans";u[u.Float32s=2]="Float32s";u[u.Float64s=3]="Float64s";u[u.Int8s=4]="Int8s";u[u.Int16s=5]="Int16s";u[u.Int32s=6]="Int32s";u[u.Strings=7]="Strings";u[u.UnsignedInt8s=8]="UnsignedInt8s";u[u.UnsignedInt16s=9]="UnsignedInt16s";u[u.UnsignedInt32s=10]="UnsignedInt32s"})(Jf||(Jf={}));oa.create=function(u,N,V){return sa(this,void 0,void 0,function wa(){var Ga,la=this;return D.ys.jVb(wa,function(ab){Ga=new Pc({operationName:"CreateModelForInferencing",
success:!0,resourceId:N});Ga.start();return V[u]?(Ga.resultDescription="Model already existed",wb.a.info(509699716,wb.b.CoreDefault,Ga.stop()),ab.return(V[u])):ab.return(V[u]=la.getInferenceSession(V).create(u).then(function(nb){wb.a.info(540406807,wb.b.CoreDefault,Ga.stop());return new oa(nb,N,V)}).catch(function(nb){Ga.resultDescription="Error: "+nb;wb.a.info(540406808,wb.b.CoreDefault,Ga.stop());throw nb;}))})})};oa.getInferenceSession=function(u){if(null===u||void 0===u?0:u.foc)return u.foc;throw Error("InferenceSession is not defined");
};oa.prototype.run=function(u){var N;return sa(this,void 0,void 0,function ka(){var wa=this,Ga,la,ab,nb;return D.ys.jVb(ka,function(sb){Ga=wa;la=new Pc({operationName:"RunModelForInferencing",success:!0,resourceId:wa.modelName});la.start();if(null===(N=wa.onnxObject)||void 0===N?0:N.Tensor)return ab=u.getInputs(),nb={},Object.keys(ab).forEach(function(Db){var bc=ab[Db];if(Array.isArray(bc.values)&&0<bc.values.length&&"boolean"===typeof bc.values[0]){var Xb=new Uint8Array(bc.values);nb[Db]=new Ga.onnxObject.Tensor(Xb,
bc.dimensions)}else nb[Db]=new Ga.onnxObject.Tensor(bc.values,bc.dimensions)}),sb.return(wa.session.run(nb).then(function(Db){wb.a.info(540406809,wb.b.CoreDefault,la.stop());return new ba(Db)}).catch(function(Db){la.resultDescription="Problem running model. "+Db.message;wb.a.info(540406810,wb.b.CoreDefault,la.stop())}));la.resultDescription="Unable to run model. Tensor not defined";wb.a.info(540406811,wb.b.CoreDefault,la.stop());throw Error("Tensor is not defined");})})};ea.create=function(){return new ea};
ea.prototype.getInputs=function(){return this.map};ea.prototype.add=function(u,N,V){this.map[u]={dimensions:N,values:V};return this};na.prototype.name=function(){return this.DBd};na.prototype.outputType=function(){switch(this.result.type){case "string":return Jf.Strings;case "int8":return Jf.Int8s;case "int16":return Jf.Int16s;case "int32":return Jf.Int32s;case "bool":return Jf.Booleans;case "uint8":return Jf.UnsignedInt8s;case "uint16":return Jf.UnsignedInt16s;case "uint32":return Jf.UnsignedInt32s;
case "float32":return Jf.Float32s;case "float64":return Jf.Float64s;default:throw Error("The output type "+this.result.type+" is not supported.");}};na.prototype.dimensions=function(){return this.result.pgg};na.prototype.asBooleans=function(){if(this.outputType()===Jf.Booleans)return this.result.data.map(function(u){return!!u});throw Error("asBooleans() was called; however, outputType() is "+this.outputType()+", not Type.Booleans.");};na.prototype.asFloat32s=function(){if(this.outputType()===Jf.Float32s)return this.result.data;
throw Error("asFloat32s() was called; however, outputType() is "+this.outputType()+", not Type.Float32s.");};na.prototype.asFloat64s=function(){if(this.outputType()===Jf.Float64s)return this.result.data;throw Error("asFloat64s() was called; however, outputType() is "+this.outputType()+", not Type.Float64s.");};na.prototype.asInt8s=function(){if(this.outputType()===Jf.Int8s)return this.result.data;throw Error("asInt8s() was called; however, outputType() is "+this.outputType()+", not Type.Int8s.");
};na.prototype.asInt16s=function(){if(this.outputType()===Jf.Int16s)return this.result.data;throw Error("asInt16s() was called; however, outputType() is "+this.outputType()+", not Type.Int16s.");};na.prototype.asInt32s=function(){if(this.outputType()===Jf.Int32s)return this.result.data;throw Error("asInt32s() was called; however, outputType() is "+this.outputType()+", not Type.Int32s.");};na.prototype.asStrings=function(){if(this.outputType()===Jf.Strings)return this.result.data;throw Error("asStrings() was called; however, outputType() is "+
this.outputType()+", not Type.Strings.");};na.prototype.asUnsignedInt8s=function(){if(this.outputType()===Jf.UnsignedInt8s)return this.result.data;throw Error("asUnsignedInt8s() was called; however, outputType() is "+this.outputType()+", not Type.UnsignedInt8s.");};na.prototype.asUnsignedInt16s=function(){if(this.outputType()===Jf.UnsignedInt16s)return this.result.data;throw Error("asUnsignedInt16s() was called; however, outputType() is "+this.outputType()+", not Type.UnsignedInt16s.");};na.prototype.asUnsignedInt32s=
function(){if(this.outputType()===Jf.UnsignedInt32s)return this.result.data;throw Error("asUnsignedInt32s() was called; however, outputType() is "+this.outputType()+", not Type.UnsignedInt32s.");};ia.createFactory=function(u,N,V){var ka=this;return function(){var wa;return ia.onnxRetrievalPromise?ia.onnxRetrievalPromise:u&&N?((null===(wa=null===globalThis||void 0===globalThis?void 0:globalThis.top)||void 0===wa?0:wa.Byf)?Promise.resolve():nc(ka.createCdnUrl(u,N),"ort",V)).then(function(){ia.onnxRetrievalPromise=
Promise.resolve(new ia)}).catch(function(Ga){ia.onnxRetrievalPromise=Promise.reject(Ga)}).then(function(){return ia.onnxRetrievalPromise}):Promise.reject(Error("Error: appName and/or version not provided"))}};ia.createCdnUrl=function(u,N){return"https://"+u+N};ia.prototype.createModel=function(u,N){var V,ka=null===(V=null===globalThis||void 0===globalThis?void 0:globalThis.top)||void 0===V?void 0:V.Byf;return oa.create(u,N?N:"",ka)};ia.prototype.createInputs=function(){return ea.create()};var nj;
(function(u){u[u.Dpf=0]="msoulscat_ES_EWAJS";u[u.Fpf=1]="msoulscat_ES_EWAJSGrid";u[u.Epf=6]="msoulscat_ES_EWAJSChart";u[u.Gpf=202]="msoulscat_MSOSP_FileMenuCommands";u[u.Hpf=225]="msoulscat_MSOSP_OTelJS";u[u.Ipf=227]="msoulscat_MSOSP_OTelJSInWebWoker";u[u.Jpf=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype";u[u.Cng=301]="msoulscat_Wac_WordViewer";u[u.dx=306]="msoulscat_Wac_BrowserGeneral";u[u.nmg=320]="msoulscat_Wac_TaskPane";u[u.Qpf=339]="msoulscat_Wac_OneNoteGeneral";u[u.Zpf=340]="msoulscat_Wac_Ribbon";
u[u.Lmg=379]="msoulscat_Wac_WopiPendingApplication";u[u.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry";u[u.bqf=391]="msoulscat_Wac_WacCatchUpActivities";u[u.Mpf=394]="msoulscat_Wac_Dictation";u[u.Rpf=395]="msoulscat_Wac_OneNoteSync";u[u.rmg=700]="msoulscat_Wac_VisioApp";u[u.Kpf=1601]="msoulscat_OneNoteOnline_EditableCache";u[u.Spf=800]="msoulscat_Wac_PptAnimation";u[u.Tpf=833]="msoulscat_Wac_PptLive";u[u.Upf=834]="msoulscat_Wac_PptMWeb";u[u.Wpf=815]="msoulscat_Wac_PptShape";u[u.Vpf=817]="msoulscat_Wac_PptSession";
u[u.Xpf=830]="msoulscat_Wac_PptSlideshow";u[u.Ypf=822]="msoulscat_Wac_PptView";u[u.aqf=2300]="msoulscat_Wac_VersionHistory";u[u.dqf=302]="msoulscat_Wac_WordPresence";u[u.eqf=3005]="msoulscat_Wac_WordVersionHistory";u[u.Opf=3006]="msoulscat_Wac_LivePersonaCard";u[u.Lpf=3012]="msoulscat_Wac_CatchUpFlyout";u[u.cqf=3016]="msoulscat_Wac_WordDesigner";u[u.Ppf=3021]="msoulscat_Wac_ModernFontPicker";u[u.$pf=3027]="msoulscat_Wac_UnifiedUiHost";u[u.Npf=3033]="msoulscat_Wac_EquationTools"})(nj||(nj={}));var Ze;
(function(u){u[u.Error=10]="Error";u[u.Warning=15]="Warning";u[u.Info=50]="Info";u[u.Verbose=100]="Verbose";u[u.Spam=200]="Spam"})(Ze||(Ze={}));var Ds=function(){function u(){}u.prototype.sendTraceTag=function(){};u.prototype.shipAssertTag=function(){};u.prototype.debugAssertTag=function(){};return u}(),jl=new (function(){function u(){this.VV=new Ds}u.prototype.oFd=function(N){this.VV=N};u.prototype.sendTraceTag=function(N,V,ka,wa){this.VV.sendTraceTag(N,V,ka,wa)};u.prototype.debugAssertTag=function(N,
V,ka,wa){this.VV.debugAssertTag(N,V,ka,wa)};u.prototype.shipAssertTag=function(N,V,ka,wa){this.VV.shipAssertTag(N,V,ka,wa)};return u}());Z.getTypeName=function(){return"AugLoop_Excel_Session_Protocol_ExcelServerSessionInitMessage"};Z.getBaseTypes=function(){return["AugLoop_Session_Protocol_SessionInitMessage","AugLoop_Session_Protocol_Message"]};Z.typeGuard=function(u){return Eb.matchesTypesFor(u,[Z.getTypeName()])};Z.H_={T_:Z.getTypeName(),B_:Z.getBaseTypes()};T.getTypeName=function(){return"AugLoop_Excel_Session_Protocol_ExcelServerSessionExtensionConfig"};
T.getBaseTypes=function(){return[]};T.typeGuard=function(u){return Eb.matchesTypesFor(u,[T.getTypeName()])};T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()};P.getTypeName=function(){return"AugLoop_Excel_Session_Protocol_ExcelWorkbookUpdated"};P.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]};P.typeGuard=function(u){return Eb.matchesTypesFor(u,[P.getTypeName()])};P.H_={T_:P.getTypeName(),B_:P.getBaseTypes()};W.getTypeName=function(){return"AugLoop_Excel_Session_Protocol_ExcelAccessTokenRefreshed"};
W.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]};W.typeGuard=function(u){return Eb.matchesTypesFor(u,[W.getTypeName()])};W.H_={T_:W.getTypeName(),B_:W.getBaseTypes()};ca.getTypeName=function(){return"AugLoop_Excel_Session_Protocol_ExcelKeepAlive"};ca.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]};ca.typeGuard=function(u){return Eb.matchesTypesFor(u,[ca.getTypeName()])};ca.H_={T_:ca.getTypeName(),B_:ca.getBaseTypes()};X.getTypeName=function(){return"AugLoop_Excel_Session_Protocol_ExcelSessionCloseReason"};
X.getBaseTypes=function(){return[]};X.typeGuard=function(u){return Eb.matchesTypesFor(u,[X.getTypeName()])};X.H_={T_:X.getTypeName(),B_:X.getBaseTypes()};Y.getTypeName=function(){return"AugLoop_Excel_Session_Protocol_ObserverStatusAnnotation"};Y.getBaseTypes=function(){return["AugLoop_Core_Annotation"]};Y.typeGuard=function(u){return Eb.matchesTypesFor(u,[Y.getTypeName()])};D.global.Object.defineProperties(Y.prototype,{metadata:{configurable:!0,enumerable:!0,get:function(){return this.M_},set:function(u){this.M_=
u}}});Y.H_={T_:Y.getTypeName(),B_:Y.getBaseTypes()};I.getTypeName=function(){return"AugLoop_Excel_Session_Protocol_FullSeedingAnnotation"};I.getBaseTypes=function(){return["AugLoop_Core_Annotation"]};I.typeGuard=function(u){return Eb.matchesTypesFor(u,[I.getTypeName()])};D.global.Object.defineProperties(I.prototype,{metadata:{configurable:!0,enumerable:!0,get:function(){return this.M_},set:function(u){this.M_=u}}});I.H_={T_:I.getTypeName(),B_:I.getBaseTypes()};K.getTypeName=function(){return"AugLoop_Powerpoint_Session_Protocol_PowerPointSessionInitMessage"};
K.getBaseTypes=function(){return["AugLoop_Session_Protocol_SessionInitMessage","AugLoop_Session_Protocol_Message"]};K.typeGuard=function(u){return Eb.matchesTypesFor(u,[K.getTypeName()])};K.H_={T_:K.getTypeName(),B_:K.getBaseTypes()};F.getTypeName=function(){return"AugLoop_Powerpoint_Session_Protocol_PowerPointSessionExtensionConfig"};F.getBaseTypes=function(){return[]};F.typeGuard=function(u){return Eb.matchesTypesFor(u,[F.getTypeName()])};F.H_={T_:F.getTypeName(),B_:F.getBaseTypes()};S.create=function(u){return new S(u)};
S.prototype.setInputTypes=function(u){this.inputTypes=qb(u);return this};S.prototype.setOutputTypes=function(u){this.outputTypes=qb(u);return this};S.prototype.setStateful=function(){this.isStateful=!0;return this};S.prototype.setRequestedContexts=function(u){var N;this.requestedContextTypesRules=(null!==(N=this.requestedContextTypesRules)&&void 0!==N?N:this.requestedContextTypesRules=[]).concat(u);return this};S.prototype.setLambdaType=function(u){this.factory=u;return this};S.prototype.setDefinitionOverrideTargetWorkflows=
function(u){this.definitionOverrideTargetWorkflows=u;return this};S.prototype.setCorrelatedSignals=function(u){0!==u.length&&(this.correlatedSignals=u);return this};S.prototype.setLambda=function(u,N){this.factory=function(){return{init:N?N:function(){return Promise.resolve()},execute:u,dispose:function(){}}};return this};S.prototype.validateOptions=function(){return{isValid:!0}};L.getTypeName=function(){return"AugLoop_Chat_ChatsHolder"};L.getBaseTypes=function(){return["AugLoop_Core_TileGroup"]};
L.typeGuard=function(u){return Eb.matchesTypesFor(u,[L.getTypeName()])};L.H_={T_:L.getTypeName(),B_:L.getBaseTypes()};E.getTypeName=function(){return"AugLoop_Chat_Chat"};E.getBaseTypes=function(){return[]};E.typeGuard=function(u){return Eb.matchesTypesFor(u,[E.getTypeName()])};E.H_={T_:E.getTypeName(),B_:E.getBaseTypes()};B.getTypeName=function(){return"AugLoop_Chat_MessagesHolder"};B.getBaseTypes=function(){return["AugLoop_Core_TileGroup"]};B.typeGuard=function(u){return Eb.matchesTypesFor(u,[B.getTypeName()])};
B.H_={T_:B.getTypeName(),B_:B.getBaseTypes()};A.getTypeName=function(){return"AugLoop_Chat_ChatMessage"};A.getBaseTypes=function(){return[]};A.typeGuard=function(u){return Eb.matchesTypesFor(u,[A.getTypeName()])};A.H_={T_:A.getTypeName(),B_:A.getBaseTypes()};x.getTypeName=function(){return"AugLoop_Chat_TextChatMessage"};x.getBaseTypes=function(){return["AugLoop_Chat_ChatMessage"]};x.typeGuard=function(u){return Eb.matchesTypesFor(u,[x.getTypeName()])};x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()};
v.create=function(u){var N=new v(u);return N.activateAnnotation(u.responseType).then(function(){return N})};v.prototype.send=function(u,N){var V=""+this.nextMessageId++;this.responseCallbacks.set(V,N);this.config.session.submitOperations([new Mh({parentPath:this.messagesPath,items:[{id:V,body:u}]})])};v.prototype.close=function(){return this.config.session.releaseAnnotation(this.activatedAnnotationToken)};v.prototype.activateAnnotation=function(u){var N=this;return this.config.session.activateAnnotation(u,
{callback:function(V){if(Mh.typeGuard(V)&&N.isUnderSubtree(V.parentPath,N.messagesPath))for(var ka=D.makeIterator(V.items),wa=ka.next();!wa.done;wa=ka.next()){wa=wa.value;var Ga=V.parentPath[V.parentPath.length-1],la=N.responseCallbacks.get(Ga);la&&(la(wa.body),N.responseCallbacks.delete(Ga))}}}).then(function(V){N.activatedAnnotationToken=V.token})};v.prototype.isUnderSubtree=function(u,N){if(u.length<N.length)return!1;for(var V=0;V<N.length;V++)if(u[V]!==N[V])return!1;return!0};w.prototype.getAugLoopRuntimeManager=
function(){return this._augLoopRuntimeManager};w.prototype.createSingleItemWorkflow=function(u){return S.create(u)};w.prototype.createChatHelper=function(u){return this.getAugLoopRuntimeManager().getSession().then(function(N){return v.create(Object.assign({session:N},u))})};for(var de=new w,kl=e(1145),wt={Spb:"undefined"!==typeof crypto&&crypto.Spb&&crypto.Spb.bind(crypto)},Rk,xt=new Uint8Array(16),yl=[],Xp=0;256>Xp;++Xp)yl.push((Xp+256).toString(16).slice(1));var oj;(function(u){u.woc="SessionConnect";
u.xoc="SessionDisconnect";u.zoc="SessionReconnect";u.voc="SessionClose";u.yoc="SessionReConnectFailed"})(oj||(oj={}));var cg;(function(u){u[u.tca=0]="ReadyToConnect";u[u.Connecting=1]="Connecting";u[u.oxb=2]="Connected"})(cg||(cg={}));var Vm=0,pk=cg.tca,su,Yp=m(),Yk=m(),wn=!1,Zp,Wm=new kl.EventEmitter,jm;(function(u){u[u.Dpf=0]="msoulscat_ES_EWAJS";u[u.Fpf=1]="msoulscat_ES_EWAJSGrid";u[u.jig=2]="msoulscat_ES_EWAJSHeaderResize";u[u.kig=3]="msoulscat_ES_EWAJSKeyboard";u[u.nig=4]="msoulscat_ES_EWAJSTest";
u[u.iig=5]="msoulscat_ES_EWAJSFloatingObjects";u[u.Epf=6]="msoulscat_ES_EWAJSChart";u[u.pig=7]="msoulscat_ES_MobileEwa";u[u.fig=8]="msoulscat_ES_EWAJSBIExplore";u[u.lig=9]="msoulscat_ES_EWAJSNov";u[u.hig=10]="msoulscat_ES_EWAJSExcelEverywhere";u[u.oig=11]="msoulscat_ES_EWAJSTp";u[u.gig=12]="msoulscat_ES_EWAJSComment";u[u.mig=13]="msoulscat_ES_EWAJSOCSIntegration";u[u.Jng=100]="msoulscat_bULS_Uploader";u[u.Hng=101]="msoulscat_bULS_CachingHost";u[u.Ing=102]="msoulscat_bULS_Core";u[u.Gng=103]="msoulscat_bULS_Assert";
u[u.yjg=200]="msoulscat_Osi_MsoSpLogging";u[u.Fig=201]="msoulscat_MSOSP_Error";u[u.Gpf=202]="msoulscat_MSOSP_FileMenuCommands";u[u.Hig=203]="msoulscat_MSOSP_MsoSpRenameManager";u[u.Cig=204]="msoulscat_MSOSP_CrossDocumentMessenger";u[u.yig=205]="msoulscat_MSOSP_ClientRequestManager";u[u.Eig=206]="msoulscat_MSOSP_DownloadQueue";u[u.zig=207]="msoulscat_MSOSP_CommandUI";u[u.xig=208]="msoulscat_MSOSP_AppSettings";u[u.Aig=209]="msoulscat_MSOSP_CommonDebug";u[u.Dig=210]="msoulscat_MSOSP_DomUtils";u[u.Jig=
211]="msoulscat_MSOSP_OIC";u[u.wig=212]="msoulscat_MSOSP_AnonEdit";u[u.tig=213]="msoulscat_MSOSP_Activity";u[u.vig=214]="msoulscat_MSOSP_AnonCreate";u[u.Iig=215]="msoulscat_MSOSP_O365ShellService";u[u.Nig=216]="msoulscat_MSOSP_SaveToCloudStorage";u[u.Oig=217]="msoulscat_MSOSP_SessionExpirationManager";u[u.Rig=218]="msoulscat_MSOSP_TaskManager";u[u.Mig=219]="msoulscat_MSOSP_SaveAsToHost";u[u.uig=220]="msoulscat_MSOSP_AddInCommands";u[u.Big=221]="msoulscat_MSOSP_CookieCompliance";u[u.zjg=222]="msoulscat_Osi_MsoSpOfflineLogger";
u[u.Pig=223]="msoulscat_MSOSP_Signals";u[u.Qig=224]="msoulscat_MSOSP_Skills";u[u.Hpf=225]="msoulscat_MSOSP_OTelJS";u[u.Kig=226]="msoulscat_MSOSP_OTelJSBootstrap";u[u.Ipf=227]="msoulscat_MSOSP_OTelJSInWebWoker";u[u.Jpf=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype";u[u.Lig=229]="msoulscat_MSOSP_OTelJSTest";u[u.Gig=230]="msoulscat_MSOSP_LiveMeeting";u[u.Sig=231]="msoulscat_MSOSP_UploadFileFromPC";u[u.ung=300]="msoulscat_Wac_WordMerge";u[u.ikg=301]="msoulscat_WAC_WordViewer";u[u.dqf=302]="msoulscat_Wac_WordPresence";
u[u.dmg=303]="msoulscat_Wac_RevisionDiffer";u[u.Nmg=304]="msoulscat_Wac_WordCoauth";u[u.cmg=305]="msoulscat_Wac_Replication";u[u.dx=306]="msoulscat_Wac_BrowserGeneral";u[u.eig=307]="msoulscat_Box4_CopyPaste";u[u.cng=308]="msoulscat_Wac_WordEditorFootnoteEndnote";u[u.kng=309]="msoulscat_Wac_WordEditorPageNumber";u[u.Ikg=310]="msoulscat_Wac_EventManager";u[u.qng=311]="msoulscat_Wac_WordEditorTableStyle";u[u.bng=312]="msoulscat_Wac_WordEditorFindReplace";u[u.Lkg=313]="msoulscat_Wac_FindReplace";u[u.jng=
314]="msoulscat_Wac_WordEditorPageBreak";u[u.Pjg=315]="msoulscat_WAC_Box4Crash";u[u.Smg=316]="msoulscat_Wac_WordEditorBlobFormatting";u[u.eng=317]="msoulscat_Wac_WordEditorHeaderFooter";u[u.ong=318]="msoulscat_Wac_WordEditorSelection";u[u.Zkg=319]="msoulscat_Wac_NodeLogger";u[u.omg=320]="msoulscat_Wac_TaskPaneFramework";u[u.Mkg=321]="msoulscat_Wac_Focus";u[u.Skg=322]="msoulscat_Wac_ImageEditor";u[u.Gkg=323]="msoulscat_Wac_EditingView";u[u.skg=324]="msoulscat_Wac_Box4General";u[u.klg=325]="msoulscat_Wac_PeoplesWell";
u[u.ilg=326]="msoulscat_Wac_PageView";u[u.ykg=327]="msoulscat_Wac_Comments";u[u.Fkg=328]="msoulscat_Wac_DirectPrint";u[u.Okg=329]="msoulscat_Wac_GraphValidation";u[u.glg=330]="msoulscat_Wac_OneNotePrint";u[u.okg=331]="msoulscat_Wac_AppSettings";u[u.Hkg=332]="msoulscat_Wac_Embed";u[u.hmg=333]="msoulscat_Wac_SkypeChat";u[u.Ojg=334]="msoulscat_WAC_Accessibility";u[u.jkg=335]="msoulscat_Wac_Aggregator";u[u.lng=336]="msoulscat_Wac_WordEditorPagination";u[u.hkg=337]="msoulscat_WAC_WordEditorSave";u[u.Jmg=
338]="msoulscat_Wac_WoncaGeneral";u[u.Qpf=339]="msoulscat_Wac_OneNoteGeneral";u[u.Zpf=340]="msoulscat_Wac_Ribbon";u[u.Rmg=341]="msoulscat_Wac_WordEditorAppsForOffice";u[u.fmg=342]="msoulscat_Wac_SendUsYourFile";u[u.Qjg=343]="msoulscat_WAC_DocxSaveMonitor";u[u.qkg=344]="msoulscat_Wac_AppsForOffice";u[u.wkg=345]="msoulscat_Wac_BrowserPerformance";u[u.png=346]="msoulscat_Wac_WordEditorShapes";u[u.ang=347]="msoulscat_Wac_WordEditorFeatureHelper";u[u.Vkg=348]="msoulscat_Wac_InsertSymbol";u[u.Img=349]=
"msoulscat_Wac_WebAppsPortal";u[u.Fng=350]="msoulscat_Wac_Yammer";u[u.hlg=351]="msoulscat_Wac_OoXml";u[u.Ukg=352]="msoulscat_Wac_InsertMedia";u[u.Eng=353]="msoulscat_Wac_WordZoom";u[u.dng=354]="msoulscat_Wac_WordEditorFormatPainter";u[u.wng=355]="msoulscat_Wac_WordRealTimeTyping";u[u.umg=356]="msoulscat_Wac_WacFeedback";u[u.xmg=357]="msoulscat_Wac_WacFeedbackExcelOnlineViewMode";u[u.vmg=358]="msoulscat_Wac_WacFeedbackExcelOnlineEditMode";u[u.wmg=359]="msoulscat_Wac_WacFeedbackExcelOnlineSurveyMode";
u[u.Amg=360]="msoulscat_Wac_WacFeedbackPptOnlineViewMode";u[u.zmg=361]="msoulscat_Wac_WacFeedbackPptOnlineEditMode";u[u.ymg=362]="msoulscat_Wac_WacFeedbackOneNoteOnline";u[u.Emg=363]="msoulscat_Wac_WacFeedbackWordOnlineViewMode";u[u.Dmg=364]="msoulscat_Wac_WacFeedbackWordOnlineEditMode";u[u.ukg=365]="msoulscat_Wac_Box4Undo";u[u.Ymg=366]="msoulscat_Wac_WordEditorCustomXml";u[u.hng=367]="msoulscat_Wac_WordEditorNavigationPane";u[u.Xmg=368]="msoulscat_Wac_WordEditorContentControl";u[u.$mg=369]="msoulscat_Wac_WordEditorExtension";
u[u.qmg=370]="msoulscat_Wac_UpdateHints";u[u.elg=371]="msoulscat_Wac_OneNoteAppsforOffice";u[u.flg=372]="msoulscat_Wac_OneNoteExtension";u[u.Cmg=373]="msoulscat_Wac_WacFeedbackVisioOnlineViewMode";u[u.Bmg=374]="msoulscat_Wac_WacFeedbackVisioOnlineEditMode";u[u.amg=375]="msoulscat_Wac_Proofing";u[u.rng=376]="msoulscat_Wac_WordEditorTrackChange";u[u.Tmg=377]="msoulscat_Wac_WordEditorCatchUp";u[u.Hmg=378]="msoulscat_Wac_WacSafeLinks";u[u.Kmg=379]="msoulscat_Wac_WopiBootstrapper";u[u.jlg=380]="msoulscat_Wac_PeopleHandler";
u[u.Gmg=381]="msoulscat_Wac_WacOcsVectorClockTelemetry";u[u.tmg=382]="msoulscat_Wac_WacDigitalPrint";u[u.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry";u[u.llg=384]="msoulscat_Wac_PolicyHandler";u[u.fng=385]="msoulscat_Wac_WordEditorMetadataHelper";u[u.nng=386]="msoulscat_Wac_WordEditorRevisionMetadata";u[u.Fmg=387]="msoulscat_Wac_WacInProductMessaging";u[u.mng=388]="msoulscat_Wac_WordEditorResumeAssistant";u[u.rkg=389]="msoulscat_Wac_Box4AugmentationLoop";u[u.Qmg=390]="msoulscat_Wac_WordEditorAcronyms";
u[u.bqf=391]="msoulscat_Wac_WacCatchUpActivities";u[u.smg=392]="msoulscat_Wac_WacAwayStatus";u[u.tkg=393]="msoulscat_Wac_Box4List";u[u.Mpf=394]="msoulscat_Wac_Dictation";u[u.Rpf=395]="msoulscat_Wac_OneNoteSync";u[u.Rkg=396]="msoulscat_Wac_IdeasRuntime";u[u.Qkg=397]="msoulscat_Wac_IdeasPane";u[u.Tkg=398]="msoulscat_Wac_Infrared";u[u.gng=399]="msoulscat_Wac_WordEditorModernTranslator";u[u.ijg=400]="msoulscat_OneService_Site";u[u.qjg=401]="msoulscat_OneService_UnitTests";u[u.fjg=402]="msoulscat_OneService_ClipperInstall";
u[u.hjg=403]="msoulscat_OneService_ClipperUsage";u[u.ljg=404]="msoulscat_OneService_Site_EmailSettings";u[u.ojg=405]="msoulscat_OneService_Site_Notebooks";u[u.kjg=406]="msoulscat_OneService_Site_DevSite";u[u.mjg=407]="msoulscat_OneService_Site_FeaturedApps";u[u.njg=408]="msoulscat_OneService_Site_FeedbackPage";u[u.ajg=409]="msoulscat_OneService_Augmentation";u[u.ejg=410]="msoulscat_OneService_AugmentationProvider_UrlEnhancer";u[u.cjg=411]="msoulscat_OneService_AugmentationProvider_DomEnhancer";u[u.djg=
412]="msoulscat_OneService_AugmentationProvider_Entitization";u[u.gjg=413]="msoulscat_OneService_ClipperTooltip";u[u.pjg=414]="msoulscat_OneService_Site_Students";u[u.bjg=415]="msoulscat_OneService_AugmentationProvider_BizcardExtractor";u[u.jjg=416]="msoulscat_OneService_Site_ClassNotebook";u[u.Sjg=500]="msoulscat_WAC_RealtimeChannel";u[u.Tjg=501]="msoulscat_WAC_RealtimeChannelTest";u[u.Rjg=502]="msoulscat_WAC_HostNotification";u[u.Ujg=600]="msoulscat_WAC_Signalr";u[u.W7b=700]="msoulscat_WAC_VisioApp";
u[u.$jg=701]="msoulscat_WAC_VisioLoader";u[u.Yjg=702]="msoulscat_WAC_VisioDataModel";u[u.bkg=703]="msoulscat_WAC_VisioRenderer";u[u.akg=704]="msoulscat_WAC_VisioRecalc";u[u.Wjg=705]="msoulscat_WAC_VisioCommand";u[u.Xjg=706]="msoulscat_WAC_VisioController";u[u.ckg=707]="msoulscat_WAC_VisioShapePanel";u[u.Vjg=708]="msoulscat_WAC_VisioAppControls";u[u.dkg=709]="msoulscat_WAC_VisioSync";u[u.Zjg=710]="msoulscat_WAC_VisioDataRefresh";u[u.gkg=711]="msoulscat_WAC_VisioWebDVAddinService";u[u.fkg=712]="msoulscat_WAC_VisioWebDVAddinClient";
u[u.ekg=713]="msoulscat_WAC_VisioWebClipboard";u[u.Spf=800]="msoulscat_Wac_PptAnimation";u[u.mlg=801]="msoulscat_Wac_PptAppEvents";u[u.nlg=802]="msoulscat_Wac_PptAppsForOffice";u[u.olg=803]="msoulscat_Wac_PptBrowserLayer";u[u.plg=804]="msoulscat_Wac_PptCoauthoring";u[u.rlg=805]="msoulscat_Wac_PptComments";u[u.vlg=806]="msoulscat_Wac_PptEditingManager";u[u.xlg=807]="msoulscat_Wac_PptFocus";u[u.Blg=808]="msoulscat_Wac_PptGraph";u[u.Clg=809]="msoulscat_Wac_PptInit";u[u.Elg=810]="msoulscat_Wac_PptNavigation";
u[u.Flg=811]="msoulscat_Wac_PptNone";u[u.Glg=812]="msoulscat_Wac_PptNotes";u[u.Ilg=813]="msoulscat_Wac_PptPerf";u[u.Klg=814]="msoulscat_Wac_PptPresence";u[u.Wpf=815]="msoulscat_Wac_PptShape";u[u.Nlg=816]="msoulscat_Wac_PptSelection";u[u.Vpf=817]="msoulscat_Wac_PptSession";u[u.Plg=818]="msoulscat_Wac_PptTasks";u[u.Rlg=819]="msoulscat_Wac_PptThumbnailPane";u[u.Qlg=820]="msoulscat_Wac_PptText";u[u.Tlg=821]="msoulscat_Wac_PptUtil";u[u.Ypf=822]="msoulscat_Wac_PptView";u[u.Olg=823]="msoulscat_Wac_PptSynchronization";
u[u.Wlg=824]="msoulscat_Wac_PptWebService";u[u.Dlg=825]="msoulscat_Wac_PptMedia";u[u.slg=826]="msoulscat_Wac_PptCopyPaste";u[u.Ylg=827]="msoulscat_Wac_PptZoom";u[u.Mlg=828]="msoulscat_Wac_PptRealTimeCoauth";u[u.ulg=829]="msoulscat_Wac_PptDesigner";u[u.Xpf=830]="msoulscat_Wac_PptSlideshow";u[u.Jlg=831]="msoulscat_Wac_PptPictureCrop";u[u.Ulg=832]="msoulscat_Wac_PptVersionHistory";u[u.Tpf=833]="msoulscat_Wac_PptLive";u[u.Upf=834]="msoulscat_Wac_PptMWeb";u[u.ylg=835]="msoulscat_Wac_PptGc2General";u[u.zlg=
836]="msoulscat_Wac_PptGc2GraphicHost";u[u.Alg=837]="msoulscat_Wac_PptGc2Operation";u[u.Llg=838]="msoulscat_Wac_PptPresentToTeams";u[u.Xlg=839]="msoulscat_Wac_PptWebSocketFrontDoor";u[u.Xkg=840]="msoulscat_Wac_MediaSnap";u[u.Ykg=841]="msoulscat_Wac_MediaTranscoding";u[u.Kkg=842]="msoulscat_Wac_FileSnap";u[u.Hlg=843]="msoulscat_Wac_PptPartialDocs";u[u.tlg=844]="msoulscat_Wac_PptDataSync";u[u.qlg=845]="msoulscat_Wac_PptCollabTasks";u[u.Vlg=846]="msoulscat_Wac_PptVideos";u[u.xkg=847]="msoulscat_Wac_ChatPPT";
u[u.wlg=848]="msoulscat_Wac_PptFluidRuntime";u[u.Slg=849]="msoulscat_Wac_PptThumbnailPaneResize";u[u.Cjg=1300]="msoulscat_Uci_CommandsClient";u[u.Hjg=1301]="msoulscat_Uci_InsightsClient";u[u.Ajg=1302]="msoulscat_Uci_Assistance";u[u.Gjg=1303]="msoulscat_Uci_Insights";u[u.Jjg=1304]="msoulscat_Uci_Insights_Overview";u[u.Ijg=1306]="msoulscat_Uci_Insights_DrillIn";u[u.Ljg=1307]="msoulscat_Uci_JunoClient";u[u.Fjg=1308]="msoulscat_Uci_GraphImportClient";u[u.Njg=1309]="msoulscat_Uci_TellMeServiceClient";
u[u.Ejg=1310]="msoulscat_Uci_EnrichmentClient";u[u.Kjg=1311]="msoulscat_Uci_JunoBrowserExtension";u[u.Djg=1312]="msoulscat_Uci_Enrichment";u[u.Mjg=1313]="msoulscat_Uci_SmartLookupClient";u[u.Bjg=1314]="msoulscat_Uci_CanvasContext";u[u.tjg=1401]="msoulscat_Osf_Latency";u[u.ujg=1402]="msoulscat_Osf_Notification";u[u.vjg=1403]="msoulscat_Osf_Runtime";u[u.rjg=1404]="msoulscat_Osf_AppManagementMenu";u[u.sjg=1405]="msoulscat_Osf_InsertionDialogSession";u[u.xjg=1406]="msoulscat_Osf_UploadFileDevCatelog";
u[u.wjg=1411]="msoulscat_Osf_UploadFileDevCatalogUsage";u[u.Zig=1600]="msoulscat_OneNoteOnline_Navigation";u[u.Kpf=1601]="msoulscat_OneNoteOnline_EditableCache";u[u.$ig=1602]="msoulscat_OneNoteOnline_Zoom";u[u.dig=1700]="msoulscat_Alchemy_Browser";u[u.rig=1800]="msoulscat_Ice_EmailHrd";u[u.sig=1801]="msoulscat_Ice_InsertMedia";u[u.qig=1802]="msoulscat_Ice_Abt";u[u.Tig=1900]="msoulscat_Met_Broadcast";u[u.Uig=2200]="msoulscat_NlAppsClient_Acronyms";u[u.Vig=2201]="msoulscat_NlAppsClient_EditorPane";
u[u.Wig=2202]="msoulscat_NlAppsClient_KeyPoints";u[u.Xig=2203]="msoulscat_NlAppsClient_Synonyms";u[u.Yig=2204]="msoulscat_NlAppsClient_ToDo";u[u.Pkg=2250]="msoulscat_Wac_Ideas";u[u.bmg=2251]="msoulscat_Wac_ReadingTime";u[u.Nkg=2252]="msoulscat_Wac_Goals";u[u.img=2253]="msoulscat_Wac_StatsDialog";u[u.aqf=2300]="msoulscat_Wac_VersionHistory";u[u.$kg=3E3]="msoulscat_Wac_OAuth";u[u.sng=3001]="msoulscat_Wac_WordGraphicsEditor";u[u.Wkg=3002]="msoulscat_Wac_Licensing";u[u.Bng=3003]="msoulscat_Wac_WordTasks";
u[u.pkg=3004]="msoulscat_Wac_ApplicationFeatureHelper";u[u.eqf=3005]="msoulscat_Wac_WordVersionHistory";u[u.Opf=3006]="msoulscat_Wac_LivePersonaCard";u[u.vkg=3007]="msoulscat_Wac_Box4Workers";u[u.Dng=3008]="msoulscat_Wac_WordWorkers";u[u.Vmg=3009]="msoulscat_Wac_WordEditorClientPagination";u[u.vng=3010]="msoulscat_Wac_WordPrediction";u[u.pmg=3011]="msoulscat_Wac_TranscriptionPane";u[u.Lpf=3012]="msoulscat_Wac_CatchUpFlyout";u[u.zkg=3013]="msoulscat_Wac_ComponentStateLogging";u[u.yng=3014]="msoulscat_Wac_WordRuler";
u[u.tng=3015]="msoulscat_Wac_WordInlineTab";u[u.cqf=3016]="msoulscat_Wac_WordDesigner";u[u.jmg=3017]="msoulscat_Wac_Styles";u[u.zng=3018]="msoulscat_Wac_WordStyles";u[u.mmg=3019]="msoulscat_Wac_TableOfContents";u[u.Ckg=3020]="msoulscat_Wac_ConvertWordToPpt";u[u.Ppf=3021]="msoulscat_Wac_ModernFontPicker";u[u.Ang=3022]="msoulscat_Wac_WordTables";u[u.Omg=3023]="msoulscat_Wac_WordColors";u[u.$lg=3025]="msoulscat_Wac_ProactiveUxGovernance";u[u.Zlg=3026]="msoulscat_Wac_PrebootHandler";u[u.$pf=3027]="msoulscat_Wac_UnifiedUiHost";
u[u.Akg=3028]="msoulscat_Wac_ConditionalTriggering";u[u.Mmg=3029]="msoulscat_Wac_WordBookmarks";u[u.Wmg=3030]="msoulscat_Wac_WordEditorClientPaginationTyping";u[u.ing=3031]="msoulscat_Wac_WordEditorNudgeToWeb";u[u.kmg=3032]="msoulscat_Wac_Suite";u[u.Npf=3033]="msoulscat_Wac_EquationTools";u[u.Bkg=3034]="msoulscat_Wac_ContextIQ";u[u.Umg=3035]="msoulscat_Wac_WordEditorClientActivityGeneration";u[u.Zmg=3036]="msoulscat_Wac_WordEditorEmergencyView";u[u.xng=3037]="msoulscat_Wac_WordRevisionSequenceNumber";
u[u.Pmg=3038]="msoulscat_Wac_WordDataLossMonitor";u[u.blg=3039]="msoulscat_Wac_OWL";u[u.clg=3040]="msoulscat_Wac_OWLNest";u[u.lkg=3041]="msoulscat_Wac_AiMaker";u[u.dlg=3042]="msoulscat_Wac_OfficeTemplatesMetadataService";u[u.mkg=3043]="msoulscat_Wac_AiRewrite";u[u.kkg=3044]="msoulscat_Wac_AiInsert";u[u.Jkg=3045]="msoulscat_Wac_FastCards";u[u.emg=3046]="msoulscat_Wac_SendToKindle";u[u.nkg=3047]="msoulscat_Wac_AiSummarize";u[u.Ekg=3048]="msoulscat_Wac_CopilotCompose";u[u.gmg=3049]="msoulscat_Wac_Skittles";
u[u.Dkg=3050]="msoulscat_Wac_CopilotChat";u[u.lmg=3051]="msoulscat_Wac_Syntex"})(jm||(jm={}));Object(Yd.b)("ULSCat",jm);var Cq;(function(u){u[u.error=10]="error";u[u.warning=15]="warning";u[u.shg=20]="important";u[u.info=50]="info";u[u.verbose=100]="verbose";u[u.Npg=200]="spam";u[u.Fpg=1E3]="shiftFactor"})(Cq||(Cq={}));Object(Yd.b)("ULSTraceLevel",Cq);var Tw=e(36),Sk=e(536),$p=Sk.a;D.ha(k,$p);k.prototype.getToken=function(){return this.sC(k.Oua,k.fDa)};k.Oua="AugLoop";k.fDa="https://augloop-int.officeppe.com/v2";
Object(Yd.a)(k,"AugLoopTokenRetriever",Sk.a,[119]);n.prototype.initSession=function(){var u=this,N,V,ka,wa;return D.Td(function(Ga){switch(Ga.pc){case 1:return Ga.oJ=2,Ga.Rb(u.CRc.getToken(),4);case 4:return N=Ga.Jc,u.BRc={serviceUrl:n.serviceUrl,appName:n.appName,authToken:N,appVersion:n.appVersion,releaseAudienceGroup:null,releaseChannel:null,releaseFork:null},Cf(u.BRc),Ga.Rb(Zg(),5);case 5:return V=Ga.Jc,Ga.Rb(V.getSession(),6);case 6:return ka=Ga.Jc,Ga.Rb(u.j8d(ka),7);case 7:u.Iff=!0;iv(Ga,0);
break;case 2:wa=uz(Ga),fj.ULS.sendTraceTag(508130177,jm.W7b,Cq.error,"Failed to initialize the augloop session: {0}",wa),mt(Ga)}})};n.prototype.j8d=function(u){var N=this;return D.Td(function(V){return V.Rb(N.activateAnnotation(u,Ml.getTypeName(),N.Yqe.bind(N)),0)})};n.prototype.activateAnnotation=function(u,N,V){return D.Td(function(ka){u.activateAnnotation(N,{callback:V}).then(function(wa){return D.Td(function(Ga){fj.ULS.sendTraceTag(508130147,jm.W7b,Cq.info,"Annotation Token: {0}",wa.token);mt(Ga)})}).catch(function(wa){fj.ULS.sendTraceTag(508130146,
jm.W7b,Cq.warning,"error in activating: {0}",wa)});mt(ka)})};n.prototype.Yqe=function(u){var N;u=D.makeIterator(u.items);for(var V=u.next();!V.done;V=u.next())if(V=V.value,null===(N=V.body)||void 0===N?0:N.H_){var ka=V.body.H_.T_;if(this.zPc.pb(ka)){ka=this.zPc.ia(ka);ka=D.makeIterator(ka);for(var wa=ka.next();!wa.done;wa=ka.next())wa=wa.value,wa(V)}}};n.serviceUrl="https://augloop-int.officeppe.com/v2";n.appName="Visio_Online";n.appVersion="Client";Object(Yd.a)(n,"AugLoopManager",null,[]);b.prototype.createDataGraph=
function(u,N,V,ka,wa){return this.createDataGraph(u,N,V,ka,wa)};b.prototype.focusToScope=function(u,N){Md.a.focusToScope(u,N)};b.prototype.getStencilInfo=function(u,N){b.Pld&&(fj.ULS.sendTraceTag(509360139,700,50,"JSApi:Application:Get Stencil Info"),b.Pld=!1);var V="";return OfficeExtension.WacRuntime.Utility.createPromise(function(ka,wa){if(!qf.AFrameworkApplication.H.J("VisioWebEditAPIsEnabled")){if(!u.endsWith(".vssx")){V="Invalid Input Stencil Name";fj.ULS.sendTraceTag(509360138,700,10,V);wa(V);
return}}else if(!u.endsWith(".vssx")&&"$$doc$$"!==u){V="Invalid Input Stencil Name";fj.ULS.sendTraceTag(509359836,700,10,V);wa(V);return}var Ga="";Ga=qf.AFrameworkApplication.H.J("VisioWebEditAPIsEnabled")?"$$doc$$"!==u?sp.a.avb(u,u.length-5):"$$doc$$":sp.a.avb(u,u.length-5);Ga=b.Hl.M$c(Ga);void 0===Ga||null===Ga?(V="Input Stencil is not supported",fj.ULS.sendTraceTag(509360137,700,10,V),wa(V)):0===Ga.$e?ka(b.lZc(Ga,N)):(Ga.ycb(function(la){0===la.stencil.$e?ka(b.lZc(la.stencil,N)):2===la.stencil.$e&&
(V="Stencil Load Failed",fj.ULS.sendTraceTag(509360136,700,10,V),wa(V))}),Ga.load())})};b.prototype.openInClient=function(){Md.a.openInClient()};b.prototype.setFocusRegionChangeKey=function(u,N){qf.AFrameworkApplication.ea.na(ch.a.setFocusRegionChangeKey,2,[vq.a.l6c(u),vq.a.l6c(N)])};b.prototype.showHideToolbar=function(u,N){b.hnd&&(fj.ULS.sendTraceTag(509360135,700,50,"JSApi:Application:ShowHideToolbar"),b.hnd=!1);void 0===u||null===u?fj.ULS.sendTraceTag(509360134,700,50,"ToolBarId parameter is null in api ShowHideToolbar"):
void 0===N||null===N?Md.a.showToolbar(u,!1):Md.a.showToolbar(u,N)};b.prototype.showToolbar=function(u,N){b.lnd&&(fj.ULS.sendTraceTag(509360133,700,50,"JSApi:Application:ShowToolbar"),b.lnd=!1);void 0===u||null===u?fj.ULS.sendTraceTag(509360132,700,50,"ToolBarId parameter is null in api ShowToolbar"):void 0===N||null===N?Md.a.showToolbar(u,!1):Md.a.showToolbar(u,N)};b.prototype.getTypeName=function(){return"Microsoft.Visio.Application"};b.prototype.invokePropertyGet=function(u){switch(u){case 3:return this.activeDocument;
case 4:return this.activePage;case 5:return this.documents;case 8:return this.isVisible;case 6:return this.name;case 1:return this.pageLoadMetrics;case 2:return this.showBorders;case 1001:return this.showToolbars;case 7:return this.userName}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};b.prototype.invokePropertyGetAsync=function(u){u=this.invokePropertyGet(u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)};b.prototype.invokePropertySet=function(u,N){switch(u){case 8:this.isVisible=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"boolean");return;case 2:this.showBorders=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"boolean");return;case 1001:this.showToolbars=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"boolean");return;case 7:this.userName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};b.prototype.invokePropertySetAsync=function(u,
N){this.invokePropertySet(u,N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};b.prototype.invokeMethod=function(u,N){switch(u){case 1005:return this.JMe(N);case 1003:return this.byf();case 1006:return this.GSf(N);case 1002:return this.zZf(N);case 1004:return this.N_f(N)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};b.prototype.invokeMethodAsync=function(u,N){switch(u){case 1008:return this.yue(N);case 1007:return this.x0e(N)}u=this.invokeMethod(u,
N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)};b.prototype.yue=function(u){var N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,Mw.a),V=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,1,"string"),ka=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,2,"string"),wa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,3,"string");u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,4,"string");return this.createDataGraph(N,
V,ka,wa,u)};b.prototype.JMe=function(u){var N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"string");u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,1,"boolean");this.focusToScope(N,u);return null};b.prototype.x0e=function(u){var N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"string");u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,1,"boolean");return this.getStencilInfo(N,u)};b.prototype.byf=function(){this.openInClient();return null};
b.prototype.GSf=function(u){var N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,on.a);u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,1,on.a);this.setFocusRegionChangeKey(N,u);return null};b.prototype.zZf=function(u){var N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"int");u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,1,"boolean");this.showHideToolbar(N,u);return null};b.prototype.N_f=function(u){var N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,
0,"int");u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,1,"boolean");this.showToolbar(N,u);return null};b.prototype.GetVisioWebImage=function(u){return dl.a.vf(u)};b.instance=function(){b.Myb||(b.Myb=new b);return b.Myb};b.bka=function(){b.BZ||(b.BZ=Md.a.Vd.o$);return b.BZ};b.cR=function(){b.oJb||(b.oJb=Md.a.Vd.GAa);return b.oJb};b.bW=function(){b.Xzb||(b.Xzb=Md.a.Vd.Ya);return b.Xzb};b.Uw=function(){b.rf||(b.rf=Md.a.Vd.Jo);return b.rf};b.LXe=function(){b.Ksa||(b.Ksa=Md.a.Vd.iAf);return b.Ksa};
b.Shb=function(){return Md.a.Shb()};b.gW=function(){return Md.a.gW()};b.sZb=function(){return qf.AFrameworkApplication.H};b.sXc=function(u,N){N=void 0===N?null:N;u=new Nn.a(null,u,null);u.closeable=!0;u.rn=5;qf.AFrameworkApplication.ga.Xa.Gs||(u.du=!1);u.xl=function(){b.cme();N&&N()};return u};b.showBusinessBar=function(u,N){u=this.sXc(u,N);qf.AFrameworkApplication.ga.ve.am(u,!1);return u};b.showBusinessBarWithButton=function(u,N,V){u=this.sXc(u);u.addButton(N,V,"");qf.AFrameworkApplication.ga.ve.am(u,
!1);return u};b.hideBusinessBar=function(u){qf.AFrameworkApplication.ga.ve.removeEntry(u)};b.isBusinessBarVisible=function(u,N){for(var V=qf.AFrameworkApplication.ga.ve.entries,ka=0;ka<V.length;ka++)if(null!=u&&V[ka].title===u||null!=N&&V[ka].message===N)return!0;return!1};b.logFeatureUsage=function(u){Md.a.logFeatureUsage(u)};b.sendTraceTag=function(u,N,V,ka){for(var wa=[],Ga=3;Ga<arguments.length;++Ga)wa[Ga-3]=arguments[Ga];fj.ULS.sendTraceTag.apply(null,[u,700,N,V].concat(wa))};b.getBRS=function(u,
N){if(void 0===u||null===u)throw Error.argumentNull("brsName");switch(typeof N){case "number":return b.sZb().T9(u,N);case "boolean":return b.sZb().J(u);case "string":return b.sZb().qa(u);default:throw Error.notImplemented("BRS Type not supported");}};b.getLocalizedString=function(u){return Sm[u]?Sm[u]:""};b.lZc=function(u,N){var V=new qt.a;V.title=u.title;V.name=u.id+".vssx";for(var ka=new qh.a,wa=0;wa<u.masters.count;wa++){var Ga=u.masters.getItemAt(wa);if(!Ga.YB||N)Ga=gm.a.Oeb(Ga),ka.add(Ga)}V.mastersInfo=
ka.toArray();return V};b.cme=function(){var u=yq.a.instance();u.Dg(Og.a.Do);u.Xs(Og.a.Xq)};b.registerKeyboardShortcuts=function(u,N,V){return Md.a.registerKeyboardShortcuts(u,N,V)};b.unRegisterKeyboardShortcuts=function(u,N){return Md.a.unRegisterKeyboardShortcuts(u,N)};D.global.Object.defineProperties(b.prototype,{activeDocument:{configurable:!0,enumerable:!0,get:function(){return null}},activePage:{configurable:!0,enumerable:!0,get:function(){return null}},documents:{configurable:!0,enumerable:!0,
get:function(){return null}},isVisible:{configurable:!0,enumerable:!0,get:function(){return!1},set:function(){}},name:{configurable:!0,enumerable:!0,get:function(){return null}},pageLoadMetrics:{configurable:!0,enumerable:!0,get:function(){return this.Jn=b.Hl.pageLoadMetrics}},showBorders:{configurable:!0,enumerable:!0,get:function(){b.Nld&&(fj.ULS.sendTraceTag(509360142,700,50,"JSApi:Application:Get ShowBorders"),b.Nld=!1);return this.vzb},set:function(u){b.Omd&&(fj.ULS.sendTraceTag(509360141,700,
50,"JSApi:Application:Set ShowBorders"),b.Omd=!1);this.vzb!==u&&(Md.a.showBorders(u),this.vzb=u)}},showToolbars:{configurable:!0,enumerable:!0,get:function(){b.Old&&(fj.ULS.sendTraceTag(509360140,700,50,"JSApi:Application: Get ShowToolbars"),b.Old=!1);return this.Lab},set:function(u){b.Pmd&&(fj.ULS.sendTraceTag(21611072,700,50,"JSApi:Application:Set ShowToolbars"),b.Pmd=!1);if(null==this.Lab||this.Lab!==u)Md.a.mic(u),this.Lab=u}},userName:{configurable:!0,enumerable:!0,get:function(){return null},
set:function(){}},CommandingManager:{configurable:!0,enumerable:!0,get:function(){this.vAb||(this.vAb=new pd);return this.vAb}},AugLoopManager:{configurable:!0,enumerable:!0,get:function(){this.Zyb||(this.Zyb=new n);return this.Zyb}},TaskPaneManager:{configurable:!0,enumerable:!0,get:function(){this.Rc||(this.Rc=new zg);return this.Rc}}});D.global.Object.defineProperties(b,{Hl:{configurable:!0,enumerable:!0,get:function(){return Md.a.Vd}}});b.BZ=null;b.oJb=null;b.Xzb=null;b.rf=null;b.Ksa=null;b.Myb=
null;b.Pmd=!0;b.Old=!0;b.hnd=!0;b.Nld=!0;b.Omd=!0;b.Pld=!0;b.lnd=!0;Object(Yd.a)(b,"Application",null,[])},1080:function(C,H,e){function b(Da){this.COb=this.v8a=null;this.SZc=this.TZc=0;this._document=Da;this.Gda=new v;b.Cu=this;this.dbb=new X.a(Object(I.a)(this,this.nAe,"createUser"));b.yaf();Q.AFrameworkApplication.H.J("VisioEditAddonManagerEnabled")&&(b.SGf(),R.a.instance.resolve("VisioWeb.IVisioAddonFeatureManager"),b.TGf(),R.a.instance.resolve("VisioWeb.IVisioAddonManager"))}function n(){var Da=
this;this.kBc=0;this.uO=null;this.Cra=new T.a;this.RFa=new T.a;this.cta=new T.a;var Ua=e(1144).DownloadableFirstPartyAddonAdapter.aif(),Sa=e(1080).Document.S9().a4.r4c;R.a.instance.resolve("VisioWeb.ILicensingInfoProvider").eUa.then(function(kb){Da.kBc=kb.licenseType;kb=D.makeIterator(Ua);for(var zb=kb.next();!zb.done;zb=kb.next())zb=zb.value,zb.isEnabled&&Da.Eoe(zb)&&Da.iaf(zb,Sa)})}function k(){this.T_d=Y.a.uag();this.p_d=Y.a.isAnonymousUser()}function r(Da,Ua){this.title=Da;this.isVisible=!1;this.taskPaneId=
"";this.paneType=Ua}function m(Da){this.Xt=this.RB=0;this.Vm=Da;this.hi=Da.pages;this.c1a=new T.a}function w(){}function v(){this.IGa=this.Gda=null;P.Application.Hl&&(this.Gda=P.Application.Hl.dataGraphicsCollection,this.IGa=new T.a)}function x(Da){this.Cpa=Da}function A(Da,Ua,Sa){var kb=new B;if(!Sa)return kb;kb.borderType=Sa.borderType;kb.calloutOffsetX=Sa.calloutOffsetX;kb.calloutWidth=Sa.calloutWidth;kb.fill=Sa.fill;kb.label=Sa.label;kb.labelFontSize=Sa.labelFontSize;kb.labelPosition=Sa.labelPosition;
kb.showValue=Sa.showValue;kb.valueFontSize=Sa.valueFontSize;kb.horizontalPosition=Sa.horizontalPosition;kb.verticalPosition=Sa.verticalPosition;kb.textColor=Sa.textColor;Sa=Sa.mapping;if(!Sa)return kb;if(1===Da&&0===Ua&&Sa.cbvMapping)for(Da=new E,Da.cbvMapping={},kb.mapping=Da,Da=D.makeIterator(Sa.cbvMapping),Sa=Da.next();!Sa.done;Sa=Da.next())Sa=Sa.value,kb.mapping.cbvMapping[Sa.data]=Sa.color;else if(1===Da&&1===Ua&&Sa.cbvRangeList)for(Da=new E,Da.cbvRangeList=new ia.a,kb.mapping=Da,Da=D.makeIterator(Sa.cbvRangeList),
Sa=Da.next();!Sa.done;Sa=Da.next())Sa=Sa.value,Ua=new S,Ua.start=Sa.start,Ua.end=Sa.end,Ua.color=Sa.color,kb.mapping.cbvRangeList.add(Ua);else if(3===Da&&Sa.iconSettings)for(Da=new E,Da.iconSettings=new ia.a,kb.mapping=Da,Ua=D.makeIterator(Sa.iconSettings),Sa=Ua.next();!Sa.done;Sa=Ua.next()){Sa=Sa.value;var zb=new L;zb.iconIndex=Sa.iconIndex;zb.operator=Sa.operator;zb.value=Sa.value;zb.value2=Sa.value2;Da.iconSettings.add(zb)}return kb}function B(){this.calloutWidth=this.calloutOffsetX=this.borderType=
0;this.label=this.fill=null;this.labelPosition=this.labelFontSize=0;this.mapping=null;this.showValue=!1;this.horizontalPosition=this.verticalPosition=this.valueFontSize=0;this.textColor=null}function E(){this.iconSettings=this.cbvRangeList=this.cbvMapping=null}function L(){this.operator=0;this.value2=this.value=null;this.iconIndex=0}function S(){this.end=this.start=0;this.color=null}e.r(H);e.d(H,"Document",function(){return b});C=e(0);var J=e(31),Q=e(1),R=e(36),F=e(27),K=e(328),I=e(73),Y=e(168),X=
e(92),ca=e(7),W=e(772),P=e(1078),T=e(805),Z=e(1099),ia=e(190);Object(C.a)(S,"CBVRange",null,[]);Object(C.a)(L,"DGIconSetting",null,[]);Object(C.a)(E,"DGMapping",null,[]);Object(C.a)(B,"DGProperties",null,[]);x.prototype.updateProperties=function(Da){x.Ykd&&(J.ULS.sendTraceTag(25810958,700,50,"JSApi:DataGraphics:UpdateProperties"),x.Ykd=!1);void 0!==Da&&null!==Da&&this.Cpa.updateProperties(A(this.type,this.dgSubType,Da))};x.prototype.getTypeName=function(){return"Microsoft.Visio.DataGraphics"};x.prototype.invokePropertyGet=
function(Da){switch(Da){case 3:return this.dgSubType;case 1:return this.id;case 2:return this.type}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Da);};x.prototype.invokePropertyGetAsync=function(Da){Da=this.invokePropertyGet(Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Da)};x.prototype.invokePropertySet=function(Da){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Da);};x.prototype.invokePropertySetAsync=function(Da,Ua){this.invokePropertySet(Da,
Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};x.prototype.invokeMethod=function(Da,Ua){switch(Da){case 1001:return this.f$f(Ua)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Da);};x.prototype.invokeMethodAsync=function(Da,Ua){Da=this.invokeMethod(Da,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Da)};x.prototype.f$f=function(Da){Da=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,0,Z.a);this.updateProperties(Da);
return null};D.global.Object.defineProperties(x.prototype,{dgSubType:{configurable:!0,enumerable:!0,get:function(){x.Wkd&&(J.ULS.sendTraceTag(25810955,700,50,"JSApi:DataGraphics:DGSubType"),x.Wkd=!1);return this.Cpa.dgSubType}},id:{configurable:!0,enumerable:!0,get:function(){x.Vkd&&(J.ULS.sendTraceTag(25810956,700,50,"JSApi:DataGraphics:Id"),x.Vkd=!1);return this.Cpa.id}},type:{configurable:!0,enumerable:!0,get:function(){x.Xkd&&(J.ULS.sendTraceTag(25810957,700,50,"JSApi:DataGraphics:Type"),x.Xkd=
!1);return this.Cpa.l9}}});x.Wkd=!0;x.Vkd=!0;x.Xkd=!0;x.Ykd=!0;Object(C.a)(x,"DataGraphics",null,[]);var na=e(1090);v.prototype.getCount=function(){v.Skd&&(J.ULS.sendTraceTag(25810959,700,50,"JSApi:DataGraphicsCollection:Count"),v.Skd=!1);return this.Gda.count};v.prototype.getItem=function(Da){v.Tkd&&(J.ULS.sendTraceTag(25810960,700,50,"JSApi:DataGraphicsCollection:GetItem"),v.Tkd=!1);Da=parseInt(Da.toString());return!isNaN(Da)&&0<=Da&&Da<this.Gda.count?(Da=this.Gda.getItemAt(Da),this.IGa.pb(Da.id)||
this.IGa.U(Da.id,new x(Da)),this.IGa.ia(Da.id)):null};v.prototype.getItemByID=function(Da){v.Ukd&&(J.ULS.sendTraceTag(25810961,700,50,"JSApi:DataGraphicsCollection:GetItemById"),v.Ukd=!1);return this.IGa.ia(Da)};v.prototype.getAsyncEnumerator=function(Da,Ua){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new na.a(Da,Ua,this))};v.prototype.getTypeName=function(){return"Microsoft.Visio.DataGraphicsCollection"};v.prototype.invokePropertyGet=function(Da){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Da);
};v.prototype.invokePropertyGetAsync=function(Da){Da=this.invokePropertyGet(Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Da)};v.prototype.invokePropertySet=function(Da){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Da);};v.prototype.invokePropertySetAsync=function(Da,Ua){this.invokePropertySet(Da,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};v.prototype.invokeMethod=function(Da,Ua){switch(Da){case 1001:return this.HJ();
case 1:return this.JJ(Ua);case 1002:return this.KVe(Ua)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Da);};v.prototype.invokeMethodAsync=function(Da,Ua){Da=this.invokeMethod(Da,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Da)};v.prototype.HJ=function(){return this.getCount()};v.prototype.JJ=function(Da){Da=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,0,"any");return this.getItem(Da)};v.prototype.KVe=function(Da){Da=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,
0,"int");return this.getItemByID(Da)};v.prototype.length=function(){return this.Gda.count};v.prototype.getItemByIndex=function(Da){return this.getItem(Da)};v.Tkd=!0;v.Ukd=!0;v.Skd=!0;Object(C.a)(v,"DataGraphicsCollection",null,[395]);w.prototype.createDataGraphics=function(Da,Ua,Sa){w.Rkd&&(J.ULS.sendTraceTag(25810970,700,50,"JSApi:DocumentView:CreateDataGraphics"),w.Rkd=!1);return void 0===Sa||null===Sa?0:P.Application.Hl.createDataGraphics(Da,Ua,A(Da,Ua,Sa))};w.prototype.getTypeName=function(){return"Microsoft.Visio.DocumentView"};
w.prototype.invokePropertyGet=function(Da){switch(Da){case 6:return this.disableErrorDialogs;case 1:return this.disableHyperlinks;case 3:return this.disablePan;case 5:return this.disablePanZoomWindow;case 2:return this.disableZoom;case 4:return this.hideDiagramBoundary}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Da);};w.prototype.invokePropertyGetAsync=function(Da){Da=this.invokePropertyGet(Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Da)};w.prototype.invokePropertySet=
function(Da,Ua){switch(Da){case 6:this.disableErrorDialogs=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ua,0,"boolean");return;case 1:this.disableHyperlinks=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ua,0,"boolean");return;case 3:this.disablePan=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ua,0,"boolean");return;case 5:this.disablePanZoomWindow=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ua,0,"boolean");return;case 2:this.disableZoom=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ua,
0,"boolean");return;case 4:this.hideDiagramBoundary=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ua,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Da);};w.prototype.invokePropertySetAsync=function(Da,Ua){this.invokePropertySet(Da,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};w.prototype.invokeMethod=function(Da,Ua){switch(Da){case 1001:return this.zue(Ua)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Da);
};w.prototype.invokeMethodAsync=function(Da,Ua){Da=this.invokeMethod(Da,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Da)};w.prototype.zue=function(Da){var Ua=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,0,"int"),Sa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,1,"int");Da=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,2,Z.a);return this.createDataGraphics(Ua,Sa,Da)};D.global.Object.defineProperties(w.prototype,{disableErrorDialogs:{configurable:!0,
enumerable:!0,get:function(){return Y.a.disableErrorDialogs},set:function(Da){Y.a.disableErrorDialogs=Da}},disableHyperlinks:{configurable:!0,enumerable:!0,get:function(){w.Bld&&(J.ULS.sendTraceTag(25810966,700,50,"JSApi:DocumentView:DisableHyperlinks:Get"),w.Bld=!1);return P.Application.Shb().disableHyperlinks},set:function(Da){w.Fmd&&(J.ULS.sendTraceTag(21611078,700,50,"JSApi:DocumentView:DisableHyperlinks"),w.Fmd=!1);P.Application.Shb().disableHyperlinks=Da}},disablePan:{configurable:!0,enumerable:!0,
get:function(){w.Gld&&(J.ULS.sendTraceTag(25810967,700,50,"JSApi:DocumentView:DisablePan:Get"),w.Gld=!1);return P.Application.Uw().disablePan},set:function(Da){w.Gmd&&(J.ULS.sendTraceTag(21611079,700,50,"JSApi:DocumentView:DisablePan"),w.Gmd=!1);P.Application.Uw().disablePan=Da}},disablePanZoomWindow:{configurable:!0,enumerable:!0,get:function(){w.Hld&&(J.ULS.sendTraceTag(38549335,700,50,"JSApi:DocumentView:DisablePanZoomWindow:Get"),w.Hld=!1);return P.Application.Uw().disablePanZoomWindow},set:function(Da){w.Hmd&&
(J.ULS.sendTraceTag(38549336,700,50,"JSApi:DocumentView:DisablePanZoomWindow"),w.Hmd=!1);P.Application.Uw().disablePanZoomWindow=Da}},disableZoom:{configurable:!0,enumerable:!0,get:function(){w.Rld&&(J.ULS.sendTraceTag(25810968,700,50,"JSApi:DocumentView:DisableZoom:Get"),w.Rld=!1);return P.Application.gW().hY},set:function(Da){w.Imd&&(J.ULS.sendTraceTag(21611080,700,50,"JSApi:DocumentView:DisableZoom"),w.Imd=!1);P.Application.gW().hY=Da}},hideDiagramBoundary:{configurable:!0,enumerable:!0,get:function(){w.Ald&&
(J.ULS.sendTraceTag(25810969,700,50,"JSApi:DocumentView:HideDiagramBoundary:Get"),w.Ald=!1);return P.Application.Uw().hideDiagramBoundary},set:function(Da){w.Kmd&&(J.ULS.sendTraceTag(21611081,700,50,"JSApi:DocumentView:HideDiagramBoundary"),w.Kmd=!1);P.Application.Uw().hideDiagramBoundary=Da}}});w.Fmd=!0;w.Bld=!0;w.Imd=!0;w.Rld=!0;w.Gmd=!0;w.Gld=!0;w.Hmd=!0;w.Hld=!0;w.Kmd=!0;w.Ald=!0;w.Rkd=!0;Object(C.a)(w,"DocumentView",null,[]);var ba=e(1082),ea=e(1104),oa=e(1138);m.prototype.add=function(){return null};
m.prototype.getCount=function(){m.kmd&&(J.ULS.sendTraceTag(25811013,700,50,"JSApi:PageCollection:Count"),m.kmd=!1);return this.hi.count};m.prototype.getItem=function(Da){this.RB++;m.Fld&&(J.ULS.sendTraceTag(25811014,700,50,"JSApi:PageCollection:GetItem"),m.Fld=!1);if(void 0===Da||null===Da)throw this.Xt++,J.ULS.sendTraceTag(25805664,700,10,"JSApi:HyperlinkCollection:GetItem: Total Calls: "+this.RB+"  Failure Count: "+this.Xt),OfficeExtension.WacRuntime.Utility.createRichApiException(ba.a.invalidArgument,
"InvalidArgument");var Ua=parseInt(Da.toString());if(!isNaN(Ua)&&0<=Ua)for(var Sa=D.makeIterator(this.hi.items),kb=Sa.next();!kb.done;kb=Sa.next())if(kb=kb.value,parseInt(kb.id)===Ua)return this.a$(parseInt(kb.id));Da=Da.toString().toLowerCase();Ua=D.makeIterator(this.hi.items);for(kb=Ua.next();!kb.done;kb=Ua.next())if(kb=kb.value,kb.internalName.toLowerCase()===Da)return this.a$(parseInt(kb.id));this.Xt++;J.ULS.sendTraceTag(25805665,700,10,"JSApi:HyperlinkCollection:GetItem: Total Calls: "+this.RB+
"  Failure Count: "+this.Xt);throw OfficeExtension.WacRuntime.Utility.createRichApiException(ba.a.qR,"ItemNotFound");};m.prototype.getItemOrNullObject=function(){return null};m.prototype.getAsyncEnumerator=function(Da,Ua){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new na.a(Da,Ua,this))};m.prototype.getTypeName=function(){return"Microsoft.Visio.PageCollection"};m.prototype.invokePropertyGet=function(Da){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Da);
};m.prototype.invokePropertyGetAsync=function(Da){Da=this.invokePropertyGet(Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Da)};m.prototype.invokePropertySet=function(Da){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Da);};m.prototype.invokePropertySetAsync=function(Da,Ua){this.invokePropertySet(Da,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};m.prototype.invokeMethod=function(Da,Ua){switch(Da){case 1003:return this.TNa(Ua);
case 1001:return this.HJ();case 1:return this.JJ(Ua);case 1002:return this.SRa(Ua)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Da);};m.prototype.invokeMethodAsync=function(Da,Ua){Da=this.invokeMethod(Da,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Da)};m.prototype.TNa=function(Da){Da=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,0,"string");return this.add(Da)};m.prototype.HJ=function(){return this.getCount()};m.prototype.JJ=function(Da){Da=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,0,"any");return this.getItem(Da)};m.prototype.SRa=function(Da){Da=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,0,"int");return this.getItemOrNullObject(Da)};m.prototype.length=function(){return this.hi.count};m.prototype.a$=function(Da){if(isNaN(Da))throw OfficeExtension.WacRuntime.Utility.createRichApiException(ba.a.invalidArgument,"InvalidArgument");var Ua=this.hi.Ga(Da.toString());if(this.c1a.pb(Da))return Da=this.c1a.ia(Da),
void 0!==Ua&&null!==Ua&&Da.UpdatePageObject(Ua),Da;if(void 0!==Ua&&null!==Ua)return this.c1a.U(Da,new oa.a(this.Vm,Ua)),this.c1a.ia(Da);throw OfficeExtension.WacRuntime.Utility.createRichApiException(ba.a.qR,"ItemNotFound");};m.prototype.getItemByIndex=function(Da){if(void 0===Da||null===Da)throw OfficeExtension.WacRuntime.Utility.createRichApiException(ba.a.invalidArgument,"InvalidArgument");Da=parseInt(Da.toString());if(!isNaN(Da)&&0<=Da&&Da<this.hi.count)return Da=this.hi.getItemAt(Da).id,this.a$(parseInt(Da));
throw OfficeExtension.WacRuntime.Utility.createRichApiException(ba.a.qR,"ItemNotFound");};m.Fld=!0;m.kmd=!0;Object(C.a)(m,"PageCollection",null,[395]);Object(C.a)(r,"SDXTaskPaneInfo",null,[]);var sa=e(1100);k.prototype.addVisualID=function(Da){P.Application.LXe().KOf(Da)};k.prototype.getTypeName=function(){return"Microsoft.Visio.User"};k.prototype.invokePropertyGet=function(Da){switch(Da){case 3:return this.isAnonymous;case 1:return this.isLicensed;case 2:return this.maxVisualCount}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Da);
};k.prototype.invokePropertyGetAsync=function(Da){Da=this.invokePropertyGet(Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Da)};k.prototype.invokePropertySet=function(Da){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Da);};k.prototype.invokePropertySetAsync=function(Da,Ua){this.invokePropertySet(Da,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};k.prototype.invokeMethod=function(Da,Ua){switch(Da){case 1001:return this.Nae(Ua)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Da);
};k.prototype.invokeMethodAsync=function(Da,Ua){Da=this.invokeMethod(Da,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Da)};k.prototype.Nae=function(Da){Da=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,0,"string");this.addVisualID(Da);return null};D.global.Object.defineProperties(k.prototype,{isAnonymous:{configurable:!0,enumerable:!0,get:function(){return this.p_d}},isLicensed:{configurable:!0,enumerable:!0,get:function(){return this.T_d}},maxVisualCount:{configurable:!0,
enumerable:!0,get:function(){return Y.a.maxVisualCount()}}});Object(C.a)(k,"User",null,[]);var M=e(1085),za=e(1120),xa=e(158),ua=e(542);n.prototype.Skb=function(Da){return this.Cra.pb(Da)};n.prototype.Ffd=function(){if(!this.RFa.pb("OrgChart"))return!1;var Da=this.RFa.ia("OrgChart");return this.Skb(Da)&&this.Cra.ia(Da).nR};n.prototype.runAddon=function(Da,Ua){return this.cPe(Da).then(function(Sa){if(!Sa)return!1;try{return Sa.Run(Ua),!0}catch(kb){return J.ULS.sendTraceTag(509434008,700,15,"Exception while running the solution - {0}. Stack: {1}",
kb.message,kb.stack),!1}})};n.prototype.tyd=function(Da){var Ua=this;new Promise(function(Sa){if(Ua.RFa.pb(Da)){var kb=Ua.RFa.ia(Da);if(Ua.Skb(kb)){var zb=Ua.Cra.ia(kb);zb.nR?Sa(!0):Ua.ref()?(J.ULS.sendTraceTag(508052545,700,15,"Failed to register solution as other shape add solution is already present- {0}.",kb),Sa(!1),Ua.TZf()):(Ua.cta.U(1,1),zb.dqb(1).then(function(Fa){Sa(Fa)}))}else J.ULS.sendTraceTag(509434007,700,15,"Failed to register unknown solution - {0}.",kb),Sa(!1)}else J.ULS.sendTraceTag(509434006,
700,15,"Failed to get addon for the shape category - {0}.",Da),Sa(!1)})};n.prototype.cPe=function(Da){var Ua=this;return new Promise(function(Sa){if(Ua.Skb(Da)){var kb=Ua.Cra.ia(Da);kb.nR?Sa(kb.Icc):kb.dqb(2).then(function(zb){zb&&kb.nR?Sa(kb.Icc):(J.ULS.sendTraceTag(509434004,700,15,"Registeration failed for solution - {0}.",kb.id),Sa(null))})}else J.ULS.sendTraceTag(509434005,700,15,"Failed to register unknown solution - {0}.",Da),Sa(null)})};n.prototype.Eoe=function(Da){return Da?this.Doe(Da)&&
this.Coe(Da):!1};n.prototype.Doe=function(Da){if(!Da.supportedLocales.length)return!0;var Ua=P.Application.getBRS("Lcid","1033");return Array.contains(Da.supportedLocales,Ua)};n.prototype.Coe=function(Da){return Da.supportedLocales.length&&Da.supportedLicenses.length?Array.contains(Da.supportedLicenses,this.kBc):!0};n.prototype.ref=function(){if(!Q.AFrameworkApplication.H.J("VisioWebDisableMultipleSolutionRegisterations"))return!1;for(var Da=0,Ua=D.makeIterator([1,0]),Sa=Ua.next();!Sa.done;Sa=Ua.next())Sa=
Sa.value,this.cta.pb(Sa)&&(Da+=this.cta.ia(Sa));return 0<Da?!0:!1};n.prototype.TZf=function(){Q.AFrameworkApplication.H.J("VisioWebDisableMultipleSolutionRegisterations")&&isNullOrUndefined(this.uO)&&(this.uO=new ua.a(null,VisioWebIntl.VisioWebStrings.L_DisableMultipleSolutionRegisteration,null),this.uO.closeable=!0,this.uO.rn=1,this.uO.du=!1,this.uO.xl=this.Qpe.bind(this),Q.AFrameworkApplication.ga.ve.am(this.uO,!1),this.uO.AZa())};n.prototype.Qpe=function(){isNullOrUndefined(this.uO)||(Q.AFrameworkApplication.ga.ve.removeEntry(this.uO),
this.uO=null)};n.prototype.iaf=function(Da,Ua){this.Cra.add(Da.id,Da);this.RFa.add(Da.shapeCategory,Da.id);var Sa=1;Da.isGlobal?(Sa=3,Da.dqb(Sa)):!xa.a.ka(Ua)&&xa.a.contains(Ua,Da.id)&&(Sa=0,Da.dqb(Sa));!Q.AFrameworkApplication.H.J("VisioWebDisableMultipleSolutionRegisterations")||3!==Sa&&0!==Sa||(Da=1,this.cta.pb(Sa)&&(Da=this.cta.ia(Sa),Da++),this.cta.U(Sa,Da))};n.prototype.dispose=function(){this.Cra.values.forEach(function(Da){Da.nR&&Da.Icc.Dispose();return!0})};Object(C.a)(n,"VisioAddonManager",
null,[396,8]);var Pa=e(1136);b.prototype.close=function(){};b.prototype.createFirstDiagramFromData=function(Da,Ua,Sa,kb,zb,Fa){b.$Xc(Da,Ua,Sa,kb,zb,Fa)};b.prototype.createFirstDiagramFromDataWithTemplate=function(Da,Ua,Sa,kb,zb,Fa,Za){b.$Xc(Da,Ua,Sa,kb,zb,Fa,Za)};b.prototype.generateBootBundle=function(Da){b.old&&(J.ULS.sendTraceTag(508434583,700,50,"JSApi:Document:GenerateBootBundle"),b.old=!1);P.Application.Hl.generateBootBundle(Da)};b.prototype.generateStream=function(Da){P.Application.Hl.generateStream(Da)};
b.prototype.getActivePage=function(){var Da=F.a.Fb();b.qld&&(J.ULS.sendTraceTag(21611074,700,50,"JSApi:Document:GetActivePage"),b.qld=!1);var Ua=P.Application.cR().activePage.id;if(void 0===Ua||null===Ua)return Ua=F.a.Fb(),J.ULS.sendTraceTag(508434582,700,50,"[VO_Perf] JSApi:Document:GetActivePage: Time taken (ms): {0}",Ua-Da),J.ULS.sendTraceTag(508434581,700,10,"GetActivePage is null"),null;Ua=this.h$b.a$(parseInt(Ua));var Sa=F.a.Fb();J.ULS.sendTraceTag(508434580,700,50,"[VO_Perf] JSApi:Document:GetActivePage: Time taken (ms): {0}",
Sa-Da);return Ua};b.prototype.initializeWithBootBundle=function(Da){b.Zld&&(J.ULS.sendTraceTag(508434579,700,50,"JSApi:Document:InitializeWithBootBundle"),b.Zld=!1);P.Application.Hl.tRf(Da)};b.prototype.registerEventCopilotDialogSubmitted=function(){};b.prototype.setActivePage=function(Da){var Ua=F.a.Fb();b.Bmd&&(J.ULS.sendTraceTag(21611076,700,50,"JSApi:Document:SetActivePage"),b.Bmd=!1);Da=this.h$b.getItem(Da);void 0!==Da.index&&null!==Da.index&&(Da=Da.index.toString(),P.Application.cR().activePage.id!==
Da&&P.Application.cR().setActivePage(Da,!1));Da=F.a.Fb();J.ULS.sendTraceTag(508434578,700,50,"[VO_Perf] JSApi:Document:SetActivePage: Time taken (ms): {0}",Da-Ua)};b.prototype.showTaskPane=function(Da,Ua,Sa){b.knd&&(J.ULS.sendTraceTag(508434577,700,50,"JSApi:Document:ShowTaskPane"),b.knd=!1);if(void 0===Da||null===Da)throw OfficeExtension.WacRuntime.Utility.createRichApiException(ba.a.invalidArgument,"Taskpane type cannot be null");var kb="",zb=b.FU,Fa;for(Fa in zb){var Za=Fa;if(Da===zb[Fa].paneType){kb=
Za;break}}if(ca.a.ka(kb))throw OfficeExtension.WacRuntime.Utility.createRichApiException(ba.a.qR,"Given TaskPane Type is not supported");Da=b.FU[kb];zb=Da.isVisible;(void 0===Sa||null===Sa)&&zb||void 0!==Sa&&null!==Sa&&Sa===zb||(Sa=new W.a,Sa.guid=K.a.create(),Sa.initialProps=Ua,Sa.sdxAssetId=kb,Sa.title=Da.title,Y.a.Lkc(Sa))};b.prototype.startDataRefresh=function(){var Da=F.a.Fb();this.TZc++;b.mnd&&(J.ULS.sendTraceTag(21611077,700,50,"JSApi:Document:StartDataRefresh"),b.mnd=!1);var Ua=new Date;if(void 0===
b.Qlb||null===b.Qlb||3E5<=Ua.getTime()-b.Qlb.getTime())b.Qlb=Ua,Y.a.startDataRefresh(!1),Ua=F.a.Fb(),J.ULS.sendTraceTag(508434576,700,50,"[VO_Perf] JSApi:Document:StartDataRefresh: Time taken (ms): {0}",Ua-Da);else throw this.SZc++,J.ULS.sendTraceTag(508434575,700,50,"JSApi:Document:StartDataRefresh:Total calls: "+this.TZc+"  Failure Count: "+this.SZc),Ua=F.a.Fb(),J.ULS.sendTraceTag(508434574,700,50,"[VO_Perf] JSApi:Document:StartDataRefresh: Time taken (ms): {0}",Ua-Da),OfficeExtension.WacRuntime.Utility.createRichApiException("NotSupported",
"DataRefresh is not supported within 5 minutes");};b.prototype.unregisterEventCopilotDialogSubmitted=function(){};b.prototype._RegisterDataVisualizerDiagramOperationCompletedEvent=function(){OfficeExtension.WacRuntime.RichApi.getEventManager().register(b.REa,"",3)};b.prototype._RegisterSelectionChangedEvent=function(){OfficeExtension.WacRuntime.RichApi.getEventManager().register(b.REa,"",2)};b.prototype._RegisterShapeAddedEvent=function(){};b.prototype._UnregisterDataVisualizerDiagramOperationCompletedEvent=
function(){OfficeExtension.WacRuntime.RichApi.getEventManager().unregister(b.REa,"",3)};b.prototype._UnregisterSelectionChangedEvent=function(){OfficeExtension.WacRuntime.RichApi.getEventManager().unregister(b.REa,"",2)};b.prototype._UnregisterShapeAddedEvent=function(){};b.prototype.getTypeName=function(){return"Microsoft.Visio.Document"};b.prototype.invokePropertyGet=function(Da){switch(Da){case 2:return this.application;case 4:return this.dataGraphicsCollection;case 6:return this.description;case 28:return this.diagrams;
case 7:return this.fullName;case 8:return this.id;case 30:return this.models;case 9:return this.index;case 10:return this.name;case 3:return this.pages;case 5:return this.user;case 1:return this.view}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Da);};b.prototype.invokePropertyGetAsync=function(Da){Da=this.invokePropertyGet(Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Da)};b.prototype.invokePropertySet=function(Da,Ua){switch(Da){case 6:this.description=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ua,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Da);};b.prototype.invokePropertySetAsync=function(Da,Ua){this.invokePropertySet(Da,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};b.prototype.invokeMethod=function(Da,Ua){switch(Da){case 1004:return this.Ppe();case 1005:return this.tve(Ua);case 1010:return this.uve(Ua);case 1007:return this.KNe(Ua);case 1009:return this.rOe(Ua);
case 1002:return this.OOe();case 1008:return this.Maf(Ua);case 26:return this.hHf();case 1003:return this.dRf(Ua);case 1006:return this.J_f(Ua);case 1001:return this.Y0f();case 27:return this.G7f();case 15:return this.BUd();case 13:return this.CUd();case 11:return this.DUd();case 16:return this.EUd();case 14:return this.FUd();case 12:return this.GUd()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Da);};b.prototype.invokeMethodAsync=function(Da,Ua){Da=this.invokeMethod(Da,Ua);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Da)};b.prototype.Ppe=function(){this.close();return null};b.prototype.tve=function(Da){var Ua=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,0,"int"),Sa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,1,"Array<Array<string>>"),kb=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,2,sa.a),zb=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,3,ea.a),Fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,
4,"boolean");Da=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,5,"boolean");this.createFirstDiagramFromData(Ua,Sa,kb,zb,Fa,Da);return null};b.prototype.uve=function(Da){var Ua=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,0,"int"),Sa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,1,"Array<Array<string>>"),kb=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,2,sa.a),zb=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,3,ea.a),Fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,
4,"boolean"),Za=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,5,"boolean");Da=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,6,"string");this.createFirstDiagramFromDataWithTemplate(Ua,Sa,kb,zb,Fa,Za,Da);return null};b.prototype.KNe=function(Da){Da=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,0,"int");this.generateBootBundle(Da);return null};b.prototype.rOe=function(Da){Da=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,0,"int");this.generateStream(Da);
return null};b.prototype.OOe=function(){return this.getActivePage()};b.prototype.Maf=function(Da){Da=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,0,"string");this.initializeWithBootBundle(Da);return null};b.prototype.hHf=function(){this.registerEventCopilotDialogSubmitted();return null};b.prototype.dRf=function(Da){Da=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,0,"string");this.setActivePage(Da);return null};b.prototype.J_f=function(Da){var Ua=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,
0,"int"),Sa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,1,"any");Da=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,2,"boolean?");this.showTaskPane(Ua,Sa,Da);return null};b.prototype.Y0f=function(){this.startDataRefresh();return null};b.prototype.G7f=function(){this.unregisterEventCopilotDialogSubmitted();return null};b.prototype.BUd=function(){this._RegisterDataVisualizerDiagramOperationCompletedEvent();return null};b.prototype.CUd=function(){this._RegisterSelectionChangedEvent();
return null};b.prototype.DUd=function(){this._RegisterShapeAddedEvent();return null};b.prototype.EUd=function(){this._UnregisterDataVisualizerDiagramOperationCompletedEvent();return null};b.prototype.FUd=function(){this._UnregisterSelectionChangedEvent();return null};b.prototype.GUd=function(){this._UnregisterShapeAddedEvent();return null};b.prototype.resetSelectionState=function(){P.Application.bW().Ht()};b.prototype.showTeachingCallout=function(Da){P.Application.Uw().showTeachingCallout(Da)};b.prototype.nAe=
function(){return new k};b.prototype.reload=function(){this.v8a=new m(this.a4)};b.prototype.registerMouseEnterEvent=function(Da){P.Application.Uw().Tde(Da)};b.prototype.registerMouseLeaveEvent=function(Da){P.Application.Uw().Ude(Da)};b.prototype.registerPageAddedEvent=function(Da){return Pa.a(Da)};b.prototype.registerPageDeletedEvent=function(Da){return Pa.b(Da)};b.prototype.registerPageLoadedEvent=function(Da){return Pa.c(Da)};b.prototype.registerSelectedShapesChangedEvent=function(Da){return Pa.d(Da)};
b.prototype.registerToggleUserActionOnViewEvent=function(Da){return Pa.i(Da)};b.prototype.unregisterToggleUserActionOnViewEvent=function(Da){Pa.r(Da)};b.prototype.unRegisterMouseEnterEvent=function(Da){P.Application.Uw().IKf(Da)};b.prototype.unRegisterMouseLeaveEvent=function(Da){P.Application.Uw().JKf(Da)};b.prototype.unregisterPageAddedEvent=function(Da){Pa.j(Da)};b.prototype.unregisterPageDeletedEvent=function(Da){Pa.k(Da)};b.prototype.unregisterPageLoadedEvent=function(Da){Pa.l(Da)};b.prototype.unregisterSelectedShapesChangedEvent=
function(Da){Pa.m(Da)};b.S9=function(){return b.Cu};b.eRf=function(Da){b.REa=Da};b.oSe=function(){return b.Ftc};b.TZe=function(){return b.FU};b.yaf=function(){if(void 0===b.FU||null===b.FU)b.FU={},b.FU[b.Ftc]=new r(VisioWebIntl.VisioWebStrings.L_DVMappingPaneTitle,1)};b.TGf=function(){R.a.instance.register(396,"VisioWeb.IVisioAddonManager").as("VisioWeb.IVisioAddonManager").Ab().xb(function(){return new n})};b.SGf=function(){R.a.instance.register(397,"VisioWeb.IVisioAddonFeatureManager").as("VisioWeb.IVisioAddonFeatureManager").Ab().xb(function(){return za.a.instance})};
b.VFd=function(Da,Ua,Sa){if(void 0===Da||null===Da)J.ULS.sendTraceTag(508434573,700,10,"AssetId is null");else{var kb=b.FU,zb;for(zb in kb){var Fa=zb,Za=kb[zb];if(Da===Fa){Da=Za;Da.taskPaneId=Ua;Da.isVisible=Sa;b.FU[Fa]=Da;return}}J.ULS.sendTraceTag(508434572,700,10,"AssetId did not match in SDX TaskPane Info")}};b.S0e=function(Da){var Ua=null;if(void 0===Da||null===Da)return J.ULS.sendTraceTag(508434571,700,10,"TaskPane ID is null"),Ua;var Sa=b.FU,kb;for(kb in Sa){var zb=Sa[kb];if(Da===zb.taskPaneId)return Ua=
zb}J.ULS.sendTraceTag(508434570,700,10,"TaskPaneID did not match in SDX TaskPane Info");return Ua};b.$Xc=function(Da,Ua,Sa,kb,zb,Fa,Za){Za=void 0===Za?null:Za;if(void 0===Da||null===Da)throw OfficeExtension.WacRuntime.Utility.createRichApiException(ba.a.invalidArgument,"DiagramType cannot be null");if(void 0===Ua||null===Ua)throw OfficeExtension.WacRuntime.Utility.createRichApiException(ba.a.invalidArgument,"TableData cannot be null");M.a.ewb(kb);Da=M.a.j6c(Da,Ua,Sa,kb,zb,Fa);Y.a.APa(Da,Za);J.ULS.sendTraceTag(508434569,
700,50,"Create DV API called to create first diagram.")};D.global.Object.defineProperties(b.prototype,{application:{configurable:!0,enumerable:!0,get:function(){b.fld&&(J.ULS.sendTraceTag(508434587,700,50,"JSApi:Document:Application"),b.fld=!1);return P.Application.instance()}},dataGraphicsCollection:{configurable:!0,enumerable:!0,get:function(){b.gld&&(J.ULS.sendTraceTag(508434586,700,50,"JSApi:Document:DataGraphicsCollection"),b.gld=!1);return this.Gda}},description:{configurable:!0,enumerable:!0,
get:function(){return null},set:function(){}},diagrams:{configurable:!0,enumerable:!0,get:function(){return null}},fullName:{configurable:!0,enumerable:!0,get:function(){return null}},id:{configurable:!0,enumerable:!0,get:function(){b.hld&&(J.ULS.sendTraceTag(508434585,700,50,"JSApi:Document:Id"),b.hld=!1);return void 0!==this.a4&&null!==this.a4?this.a4.id:"0"}},index:{configurable:!0,enumerable:!0,get:function(){return 0}},models:{configurable:!0,enumerable:!0,get:function(){return null}},name:{configurable:!0,
enumerable:!0,get:function(){return null}},pages:{configurable:!0,enumerable:!0,get:function(){b.ild&&(J.ULS.sendTraceTag(21611073,700,50,"JSApi:Document:Pages"),b.ild=!1);return this.h$b}},user:{configurable:!0,enumerable:!0,get:function(){return this.dbb.instance}},commonViewEventRegistrar:{configurable:!0,enumerable:!0,get:function(){return Y.a.Vd.commonViewEventRegistrar}},view:{configurable:!0,enumerable:!0,get:function(){b.jld&&(J.ULS.sendTraceTag(508434584,700,50,"JSApi:Document:DocumentView"),
b.jld=!1);this.COb||(this.COb=new w);return this.COb}},h$b:{configurable:!0,enumerable:!0,get:function(){this.v8a||(this.v8a=new m(this.a4));return this.v8a}},a4:{configurable:!0,enumerable:!0,get:function(){if(void 0===this._document||null===this._document)this._document=P.Application.Hl.kf;return this._document}},isMetric:{configurable:!0,enumerable:!0,get:function(){return void 0!==this.a4&&null!==this.a4?this.a4.isMetric:!1}},FeatureManager:{configurable:!0,enumerable:!0,get:function(){return za.a.instance}}});
b.Cu=null;b.REa=null;b.Ftc="FA000000032";b.FU=null;b.Qlb=null;b.mnd=!0;b.qld=!0;b.Bmd=!0;b.hld=!0;b.ild=!0;b.fld=!0;b.gld=!0;b.jld=!0;b.knd=!0;b.old=!0;b.Zld=!0;Object(C.a)(b,"Document",null,[])},1082:function(C,H,e){function b(){}e.d(H,"a",function(){return b});C=e(0);b.invalidArgument="InvalidArgument";b.qR="ItemNotFound";b.noError=0;Object(C.a)(b,"ErrorCodes",null,[])},1083:function(C,H,e){function b(ca){this.nd=this.Tq=this.pMb=this.cMb=this.$O=null;this.Ma=ca}function n(ca){this.gqa=this.Cqa=
null;this.Fob=this.Iob=0;this.Ma=ca;this.su=new L.a}function k(){this.color=null;this.iUa=0}function r(ca){this.Xt=this.RB=0;this.Eda=ca;this.dMb=new L.a}function m(ca){this.w3a=ca}function w(ca){this.Xt=this.RB=0;this.$O=ca;this.tEb=new L.a}function v(ca){this.mw=ca}e.r(H);e.d(H,"Shape",function(){return b});C=e(0);var x=e(31),A=e(1078),B=e(1122),E=e(1139),L=e(805),S=e(1090),J=e(1082);v.prototype.getTypeName=function(){return"Microsoft.Visio.Hyperlink"};v.prototype.getRowName=function(){return this.mw.Iy};
v.prototype.invokePropertyGet=function(ca){switch(ca){case 1:return this.address;case 3:return this.description;case 4:return this.extraInfo;case 2:return this.subAddress}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ca);};v.prototype.invokePropertyGetAsync=function(ca){ca=this.invokePropertyGet(ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ca)};v.prototype.invokePropertySet=function(ca){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ca);
};v.prototype.invokePropertySetAsync=function(ca,W){this.invokePropertySet(ca,W);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};v.prototype.invokeMethod=function(ca){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ca);};v.prototype.invokeMethodAsync=function(ca,W){ca=this.invokeMethod(ca,W);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ca)};D.global.Object.defineProperties(v.prototype,{address:{configurable:!0,enumerable:!0,get:function(){v.Tld&&
(x.ULS.sendTraceTag(509347725,700,50,"JSApi:Hyperlink:Address"),v.Tld=!1);return this.mw.address}},description:{configurable:!0,enumerable:!0,get:function(){v.Vld&&(x.ULS.sendTraceTag(509347724,700,50,"JSApi:Hyperlink:Description"),v.Vld=!1);return this.mw.description}},extraInfo:{configurable:!0,enumerable:!0,get:function(){v.Wld&&(x.ULS.sendTraceTag(509347723,700,50,"JSApi:Hyperlink:ExtraInfo"),v.Wld=!1);return this.mw.extraInfo}},subAddress:{configurable:!0,enumerable:!0,get:function(){v.Xld&&
(x.ULS.sendTraceTag(509347722,700,50,"JSApi:Hyperlink:SubAddress"),v.Xld=!1);return this.mw.subAddress}}});v.Tld=!0;v.Vld=!0;v.Xld=!0;v.Wld=!0;Object(C.a)(v,"Hyperlink",null,[]);w.prototype.getCount=function(){w.Uld&&(x.ULS.sendTraceTag(25810975,700,50,"JSApi:HyperlinkCollection:Count"),w.Uld=!1);return this.length()};w.prototype.getItem=function(ca){this.RB++;w.Eld&&(x.ULS.sendTraceTag(25810976,700,50,"JSApi:HyperlinkCollection:GetItem"),w.Eld=!1);if(void 0===ca||null===ca)throw this.Xt++,x.ULS.sendTraceTag(25805661,
700,10,"JSApi:HyperlinkCollection:GetItem: Total Calls: "+this.RB+"  Failure Count: "+this.Xt),OfficeExtension.WacRuntime.Utility.createRichApiException(J.a.invalidArgument,"InvalidArgument");ca=parseInt(ca.toString());if(isNaN(ca)||0>ca||ca>=this.$O.count)throw this.Xt++,x.ULS.sendTraceTag(25805662,700,10,"JSApi:HyperlinkCollection:GetItem: Total Calls: "+this.RB+"  Failure Count: "+this.Xt),OfficeExtension.WacRuntime.Utility.createRichApiException(J.a.invalidArgument,"InvalidArgument");if(!this.tEb.pb(ca)){var W=
this.$O.getItemAt(ca);if(void 0===W||null===W)throw this.Xt++,x.ULS.sendTraceTag(25805663,700,10,"JSApi:HyperlinkCollection:GetItem: Total Calls: "+this.RB+"  Failure Count: "+this.Xt),x.ULS.sendTraceTag(21623907,700,10,"JSApi:Hyperlink is null"),OfficeExtension.WacRuntime.Utility.createRichApiException(J.a.qR,"ItemNotFound");this.tEb.U(ca,new v(W))}return this.tEb.ia(ca)};w.prototype.getAsyncEnumerator=function(ca,W){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new S.a(ca,W,
this))};w.prototype.getTypeName=function(){return"Microsoft.Visio.HyperlinkCollection"};w.prototype.invokePropertyGet=function(ca){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ca);};w.prototype.invokePropertyGetAsync=function(ca){ca=this.invokePropertyGet(ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ca)};w.prototype.invokePropertySet=function(ca){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ca);};w.prototype.invokePropertySetAsync=
function(ca,W){this.invokePropertySet(ca,W);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};w.prototype.invokeMethod=function(ca,W){switch(ca){case 1001:return this.HJ();case 1:return this.JJ(W)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ca);};w.prototype.invokeMethodAsync=function(ca,W){ca=this.invokeMethod(ca,W);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ca)};w.prototype.HJ=function(){return this.getCount()};w.prototype.JJ=
function(ca){ca=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"any");return this.getItem(ca)};w.prototype.length=function(){return this.$O?this.$O.count:0};w.prototype.getItemByIndex=function(ca){return this.getItem(ca)};w.Eld=!0;w.Uld=!0;Object(C.a)(w,"HyperlinkCollection",null,[395]);var Q=e(1093),R=e(1098);m.prototype.getTypeName=function(){return"Microsoft.Visio.ShapeDataItem"};m.prototype.invokePropertyGet=function(ca){switch(ca){case 3:return this.format;case 4:return this.formattedValue;
case 1:return this.label;case 2:return this.value}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ca);};m.prototype.invokePropertyGetAsync=function(ca){ca=this.invokePropertyGet(ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ca)};m.prototype.invokePropertySet=function(ca){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ca);};m.prototype.invokePropertySetAsync=function(ca,W){this.invokePropertySet(ca,W);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
m.prototype.invokeMethod=function(ca){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ca);};m.prototype.invokeMethodAsync=function(ca,W){ca=this.invokeMethod(ca,W);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ca)};D.global.Object.defineProperties(m.prototype,{format:{configurable:!0,enumerable:!0,get:function(){m.Tmd&&(x.ULS.sendTraceTag(25811028,700,50,"JSApi:ShapeDataItem:Format"),m.Tmd=!1);return this.w3a.format}},formattedValue:{configurable:!0,enumerable:!0,
get:function(){m.Umd&&(x.ULS.sendTraceTag(25811029,700,50,"JSApi:ShapeDataItem:FormattedValue"),m.Umd=!1);return this.w3a.value}},label:{configurable:!0,enumerable:!0,get:function(){m.Xmd&&(x.ULS.sendTraceTag(25811030,700,50,"JSApi:ShapeDataItem:Label"),m.Xmd=!1);return this.w3a.label}},value:{configurable:!0,enumerable:!0,get:function(){m.Ymd&&(x.ULS.sendTraceTag(25811031,700,50,"JSApi:ShapeDataItem:Value"),m.Ymd=!1);return this.w3a.value}}});m.Xmd=!0;m.Tmd=!0;m.Ymd=!0;m.Umd=!0;Object(C.a)(m,"ShapeDataItem",
null,[]);r.prototype.getCount=function(){r.Vmd&&(x.ULS.sendTraceTag(25811032,700,50,"JSApi:ShapeDataItemCollection:Count"),r.Vmd=!1);return this.length()};r.prototype.getItem=function(ca){this.RB++;r.Kld&&(x.ULS.sendTraceTag(25811033,700,50,"JSApi:ShapeDataItemCollection:GetItem"),r.Kld=!1);if(void 0===ca||null===ca)throw this.Xt++,x.ULS.sendTraceTag(25805666,700,10,"JSApi:HyperlinkCollection:GetItem: Total Calls: "+this.RB+"  Failure Count: "+this.Xt),OfficeExtension.WacRuntime.Utility.createRichApiException(J.a.invalidArgument,
"InvalidArgument");ca=parseInt(ca.toString());if(isNaN(ca)||0>ca||ca>=this.Eda.count)throw OfficeExtension.WacRuntime.Utility.createRichApiException(J.a.invalidArgument,"InvalidArgument");if(!this.dMb.pb(ca)){var W=this.Eda.getItemAt(ca);if(void 0===W||null===W)throw this.Xt++,x.ULS.sendTraceTag(25805667,700,10,"JSApi:HyperlinkCollection:GetItem: Total Calls: "+this.RB+"  Failure Count: "+this.Xt),x.ULS.sendTraceTag(21623936,700,10,"JSApi:ShapeDataItem is null"),OfficeExtension.WacRuntime.Utility.createRichApiException(J.a.qR,
"ItemNotFound");this.dMb.U(ca,new m(W))}return this.dMb.ia(ca)};r.prototype.getAsyncEnumerator=function(ca,W){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new S.a(ca,W,this))};r.prototype.getTypeName=function(){return"Microsoft.Visio.ShapeDataItemCollection"};r.prototype.invokePropertyGet=function(ca){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ca);};r.prototype.invokePropertyGetAsync=function(ca){ca=this.invokePropertyGet(ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ca)};
r.prototype.invokePropertySet=function(ca){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ca);};r.prototype.invokePropertySetAsync=function(ca,W){this.invokePropertySet(ca,W);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};r.prototype.invokeMethod=function(ca,W){switch(ca){case 1001:return this.HJ();case 1:return this.JJ(W)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ca);};r.prototype.invokeMethodAsync=function(ca,W){ca=this.invokeMethod(ca,
W);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ca)};r.prototype.HJ=function(){return this.getCount()};r.prototype.JJ=function(ca){ca=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"any");return this.getItem(ca)};r.prototype.length=function(){return this.Eda?this.Eda.count:0};r.prototype.getItemByIndex=function(ca){return this.getItem(ca)};r.Kld=!0;r.Vmd=!0;Object(C.a)(r,"ShapeDataItemCollection",null,[395]);var F=e(27),K=e(1);Object(C.a)(k,"HighlightArgs",null,
[]);var I=e(1105),Y=e(1085),X=e(863);n.prototype.addOverlay=function(ca,W,P,T,Z,ia){this.Iob++;var na=F.a.Fb();n.Gmb&&(x.ULS.sendTraceTag(21611095,700,50,"JSApi:ShapeView:Add Overlay"),n.Gmb=!1);if(2===ca&&!Y.a.ihd(W)){this.Fob++;x.ULS.sendTraceTag(25805696,700,50,"JSApi:ShapeView:Add Overlay: Total calls: "+this.Iob+"  Failure count: "+this.Fob);var ba=F.a.Fb();x.ULS.sendTraceTag(25801049,700,50,"[VO_Perf] JSApi:ShapeView:AddOverlay: Time taken (ms): {0}",ba-na);throw Error.argument("Unsupported content type for image overlay.");
}ba=-1;ca=A.Application.bka().addOverlay(this.Ma,W,P,T,Z,ia,ca-1);void 0!==ca&&null!==ca&&(ba=ca.gH,K.AFrameworkApplication.H.J("VisioIsMindmapStencilsEnabled")&&this.su.add(ba,ca));ca=F.a.Fb();x.ULS.sendTraceTag(25801050,700,50,"[VO_Perf] JSApi:ShapeView:AddOverlay: Time taken (ms): {0}",ca-na);return ba};n.prototype.removeOverlay=function(ca){var W=F.a.Fb();n.wmd&&(x.ULS.sendTraceTag(25811037,700,50,"JSApi:ShapeView:Remove Overlay"),n.wmd=!1);K.AFrameworkApplication.H.J("VisioIsMindmapStencilsEnabled")?
this.su.pb(ca)&&(this.su.ia(ca).remove(),this.su.remove(ca)):A.Application.bka().removeOverlay(ca);ca=F.a.Fb();x.ULS.sendTraceTag(25801051,700,50,"[VO_Perf] JSApi:ShapeView:RemoveOverlay: Time taken (ms): {0}",ca-W)};n.prototype.setText=function(ca){K.AFrameworkApplication.H.J("isVisioWebSetTextAPIEnabled")&&(n.Qmd&&(x.ULS.sendTraceTag(540678040,700,50,"JSApi:ShapeView:Set Text"),n.Qmd=!1),X.a.NUf(this.Ma,ca))};n.prototype.showOverlay=function(ca,W){n.ind&&(x.ULS.sendTraceTag(41739419,700,50,"JSApi:ShapeView:Show Overlay"),
n.ind=!1);K.AFrameworkApplication.H.J("VisioIsMindmapStencilsEnabled")?this.su.pb(ca)&&(W?this.su.ia(ca).show():this.su.ia(ca).hide()):A.Application.bka().showOverlay(ca,W)};n.prototype.getTypeName=function(){return"Microsoft.Visio.ShapeView"};n.prototype.invokePropertyGet=function(ca){switch(ca){case 2:return this.fill;case 1:return this.highlight}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ca);};n.prototype.invokePropertyGetAsync=function(ca){ca=this.invokePropertyGet(ca);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ca)};n.prototype.invokePropertySet=function(ca,W){switch(ca){case 2:this.fill=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(W,0,"string");return;case 1:this.highlight=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(W,0,I.a);return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ca);};n.prototype.invokePropertySetAsync=function(ca,W){this.invokePropertySet(ca,W);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
n.prototype.invokeMethod=function(ca,W){switch(ca){case 1001:return this.p$d(W);case 1002:return this.kJf(W);case 1004:return this.LUf(W);case 1003:return this.YZf(W)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ca);};n.prototype.invokeMethodAsync=function(ca,W){ca=this.invokeMethod(ca,W);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ca)};n.prototype.p$d=function(ca){var W=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"int"),P=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,
1,"string"),T=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,2,"int"),Z=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,3,"int"),ia=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,4,"int");ca=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,5,"int");return this.addOverlay(W,P,T,Z,ia,ca)};n.prototype.kJf=function(ca){ca=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"int");this.removeOverlay(ca);return null};n.prototype.LUf=function(ca){ca=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"string");this.setText(ca);return null};n.prototype.YZf=function(ca){var W=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"int");ca=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,1,"boolean");this.showOverlay(W,ca);return null};n.prototype.addOverlayWithMargins=function(ca,W,P,T,Z,ia,na){this.Iob++;var ba=F.a.Fb();n.Gmb&&(x.ULS.sendTraceTag(522826519,700,50,"JSApi:ShapeView:Add Overlay"),n.Gmb=!1);if(2===
ca&&!Y.a.ihd(W)){this.Fob++;x.ULS.sendTraceTag(522826518,700,50,"JSApi:ShapeView:Add Overlay: Total calls: "+this.Iob+"  Failure count: "+this.Fob);var ea=F.a.Fb();x.ULS.sendTraceTag(522826517,700,50,"[VO_Perf] JSApi:ShapeView:AddOverlay: Time taken (ms): {0}",ea-ba);throw Error.argument("Unsupported content type for image overlay.");}ea=-1;ca=A.Application.bka().addOverlay(this.Ma,W,P,T,Z,ia,ca-1,na);void 0!==ca&&null!==ca&&(ea=ca.gH,K.AFrameworkApplication.H.J("VisioIsMindmapStencilsEnabled")&&
this.su.add(ea,ca));ca=F.a.Fb();x.ULS.sendTraceTag(522826516,700,50,"[VO_Perf] JSApi:ShapeView:AddOverlay: Time taken (ms): {0}",ca-ba);return ea};n.prototype.updateOverlay=function(ca,W,P,T,Z,ia,na,ba){ba=void 0===ba?0:ba;A.Application.bka().updateOverlay(this.Ma,ca,W,P-1,T,Z,ia,na,ba)};n.prototype.registerOverlayClickHandler=function(ca,W){K.AFrameworkApplication.H.J("VisioIsMindmapStencilsEnabled")&&this.su.pb(ca)&&this.su.ia(ca).Ybe(W)};n.prototype.unregisterOverlayClickHandler=function(ca,W){K.AFrameworkApplication.H.J("VisioIsMindmapStencilsEnabled")&&
this.su.pb(ca)&&this.su.ia(ca).hKf(W)};n.prototype.registerOverlayMouseHoverInHandler=function(ca,W){K.AFrameworkApplication.H.J("VisioIsMindmapStencilsEnabled")&&this.su.pb(ca)&&this.su.ia(ca).pce(W)};n.prototype.unregisterOverlayMouseHoverInHandler=function(ca,W){K.AFrameworkApplication.H.J("VisioIsMindmapStencilsEnabled")&&this.su.pb(ca)&&this.su.ia(ca).nKf(W)};n.prototype.registerOverlayMouseHoverOutHandler=function(ca,W){K.AFrameworkApplication.H.J("VisioIsMindmapStencilsEnabled")&&this.su.pb(ca)&&
this.su.ia(ca).qce(W)};n.prototype.unregisterOverlayMouseHoverOutHandler=function(ca,W){K.AFrameworkApplication.H.J("VisioIsMindmapStencilsEnabled")&&this.su.pb(ca)&&this.su.ia(ca).oKf(W)};D.global.Object.defineProperties(n.prototype,{fill:{configurable:!0,enumerable:!0,get:function(){n.Cld&&(x.ULS.sendTraceTag(25811034,700,50,"JSApi:ShapeView:Get Fill"),n.Cld=!1);return this.gqa},set:function(ca){n.Jmd&&(x.ULS.sendTraceTag(25811035,700,50,"JSApi:ShapeView:Set Fill"),n.Jmd=!1);this.gqa=ca;A.Application.Uw().dqd(this.Ma.ta.id,
this.Ma.id,this.gqa)}},highlight:{configurable:!0,enumerable:!0,get:function(){n.Dld&&(x.ULS.sendTraceTag(25811036,700,50,"JSApi:ShapeView:Get highlight"),n.Dld=!1);return this.Cqa},set:function(ca){try{if(n.Lmd&&(x.ULS.sendTraceTag(21611094,700,50,"JSApi:ShapeView:Set highlight"),n.Lmd=!1),this.Cqa=ca,this.Cqa.color.length||this.Cqa.width){var W=new k;W.color=this.Cqa.color;W.iUa=this.Cqa.width;A.Application.bka().MSa(this.Ma,W)}else A.Application.bka().MSa(this.Ma,null)}catch(P){throw x.ULS.sendTraceTag(34984267,
700,50,"JSApi:ShapeView:Set highlight failed Message: {0}. Stack: {1}",P.message,P.stack),P;}}}});n.Lmd=!0;n.Dld=!0;n.Gmb=!0;n.Jmd=!0;n.Cld=!0;n.wmd=!0;n.ind=!0;n.Qmd=!0;Object(C.a)(n,"ShapeView",null,[]);b.prototype.boundingBox=function(){};b.prototype.getBounds=function(){b.rld&&(x.ULS.sendTraceTag(21611093,700,50,"JSApi:Shape:GetBounds"),b.rld=!1);return new B.a(this.Ma)};b.prototype.getAbsoluteBounds=function(){b.pld&&(x.ULS.sendTraceTag(508389599,700,50,"JSApi:Shape:GetAbsoluteBounds"),b.pld=
!1);var ca=new B.a(this.Ma,!0),W=A.Application.Hl.Caa.d0b();ca.x=W.left+ca.x;ca.y=W.bottom-ca.y-ca.height;return ca};b.prototype.getTypeName=function(){return"Microsoft.Visio.Shape"};b.prototype.invokePropertyGet=function(ca){switch(ca){case 11:return this.application;case 9:return this.comments;case 12:return this.document;case 4:return this.hyperlinks;case 2:return this.id;case 17:return this.isBoundToData;case 13:return this.isCallout;case 14:return this.isDataGraphicCallout;case 15:return this.isOpenForTextEdit;
case 1:return this.name;case 16:return this.objType;case 10:return this.renderType;case 7:return this.select;case 5:return this.shapeDataItems;case 8:return this.subShapes;case 3:return this.text;case 6:return this.view}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ca);};b.prototype.invokePropertyGetAsync=function(ca){ca=this.invokePropertyGet(ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ca)};b.prototype.invokePropertySet=function(ca,W){switch(ca){case 7:this.select=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(W,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ca);};b.prototype.invokePropertySetAsync=function(ca,W){this.invokePropertySet(ca,W);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};b.prototype.invokeMethod=function(ca,W){switch(ca){case 1002:return this.hSb(W);case 1001:return this.cQe();case 1003:if(A.Application.getBRS("VisioWebExtensionShapeAbsoluteBoundsEnabled",!1))return this.EOe()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ca);
};b.prototype.invokeMethodAsync=function(ca,W){ca=this.invokeMethod(ca,W);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ca)};b.prototype.hSb=function(ca){var W=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"int"),P=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,1,"number"),T=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,2,"number"),Z=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,3,"number");ca=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,
4,"number");this.boundingBox(W,P,T,Z,ca);return null};b.prototype.cQe=function(){return this.getBounds()};b.prototype.EOe=function(){return this.getAbsoluteBounds()};b.prototype.UpdateShapeObject=function(ca){this.Ma=ca};b.prototype.GetDimensions=function(){var ca,W,P,T,Z,ia;var na=ca=W=P=T=Z=ia=0;this.Ma.Zd||void 0===this.Ma.xForm||null===this.Ma.xForm?this.Ma.Zd&&void 0!==this.Ma.Ua&&null!==this.Ma.Ua&&(na=this.Ma.Ua.ki,ca=this.Ma.Ua.li,W=this.Ma.Ua.endX,P=this.Ma.Ua.endY):(T=this.Ma.getDimensions(),
na=T.startX,ca=T.startY,Z=T.width,ia=T.height,T=this.Ma.xForm.pinY);return{startX:na,startY:ca,endX:W,endY:P,pinY:T,width:Z,height:ia}};b.prototype.GetBeginEndShapeId=function(){var ca;var W=ca=null;this.Ma.Zd&&void 0!==this.Ma.Ua&&null!==this.Ma.Ua&&(ca=this.Ma.Ua.beginShapeId,W=this.Ma.Ua.endShapeId);return{BeginShapeId:ca,EndShapeId:W}};b.prototype.getRelatedShapes=function(ca,W){return this.oe.getRelatedShapes(ca,W)};D.global.Object.defineProperties(b.prototype,{application:{configurable:!0,enumerable:!0,
get:function(){return A.Application.instance()}},comments:{configurable:!0,enumerable:!0,get:function(){b.Pkd&&(x.ULS.sendTraceTag(21611089,700,50,"JSApi:Shape:Comments"),b.Pkd=!1);this.nd=null;var ca=this.Ma.ta.id;ca=e(1080).Document.S9().pages.a$(parseInt(ca)).C_e(this.Ma.id);void 0!==ca&&null!==ca&&0<ca.length&&(this.nd=new E.a(ca));return this.nd}},document:{configurable:!0,enumerable:!0,get:function(){return e(1080).Document.S9()}},hyperlinks:{configurable:!0,enumerable:!0,get:function(){b.Zmd&&
(x.ULS.sendTraceTag(21611090,700,50,"JSApi:Shape:Hyperlinks"),b.Zmd=!1);this.$O||(this.$O=new w(this.Ma.hyperlinks));return this.$O}},id:{configurable:!0,enumerable:!0,get:function(){b.$md&&(x.ULS.sendTraceTag(509166657,700,50,"JSApi:Shape:Id"),b.$md=!1);return parseInt(this.Ma.id)}},isBoundToData:{configurable:!0,enumerable:!0,get:function(){b.bnd&&(x.ULS.sendTraceTag(509166656,700,50,"JSApi:Shape:IsBoundToData"),b.bnd=!1);return this.Ma.isBoundToData}},isCallout:{configurable:!0,enumerable:!0,get:function(){return!1}},
isDataGraphicCallout:{configurable:!0,enumerable:!0,get:function(){return!1}},isOpenForTextEdit:{configurable:!0,enumerable:!0,get:function(){return!1}},name:{configurable:!0,enumerable:!0,get:function(){b.cnd&&(x.ULS.sendTraceTag(509166627,700,50,"JSApi:Shape:Name"),b.cnd=!1);return this.Ma.internalName}},objType:{configurable:!0,enumerable:!0,get:function(){return this.Ma.ic?this.Ma.Zd?2:1:0}},renderType:{configurable:!0,enumerable:!0,get:function(){b.dnd&&(x.ULS.sendTraceTag(509166626,700,50,"JSApi:Shape:RenderType"),
b.dnd=!1);return this.Ma.ue}},select:{configurable:!0,enumerable:!0,get:function(){b.Mld&&(x.ULS.sendTraceTag(509166625,700,50,"JSApi:Shape:isSelect"),b.Mld=!1);return A.Application.bW().isShapeSelected(this.Ma)},set:function(ca){b.Nmd&&(x.ULS.sendTraceTag(509166624,700,50,"JSApi:Shape:SetSelect"),b.Nmd=!1);ca?A.Application.bW().mx([this.Ma]):ca||A.Application.bW().Saa([this.Ma])}},shapeDataItems:{configurable:!0,enumerable:!0,get:function(){b.Wmd&&(x.ULS.sendTraceTag(21611091,700,50,"JSApi:Shape:ShapeDataItems"),
b.Wmd=!1);this.cMb||(this.cMb=new r(this.Ma.fm));return this.cMb}},subShapes:{configurable:!0,enumerable:!0,get:function(){b.ond&&(x.ULS.sendTraceTag(21611092,700,50,"JSApi:Shape:SubShapes"),b.ond=!1);this.Tq||void 0===this.Ma.subShapes||null===this.Ma.subShapes||(this.Tq=new R.a(this.Ma.subShapes.items));return this.Tq}},isVisible:{configurable:!0,enumerable:!0,get:function(){return this.Ma.isVisible}},isLocked:{configurable:!0,enumerable:!0,get:function(){return this.Ma.isLocked}},text:{configurable:!0,
enumerable:!0,get:function(){b.fnd&&(x.ULS.sendTraceTag(509166623,700,50,"JSApi:Shape:Text"),b.fnd=!1);if(void 0===this.Ma.textStream||null===this.Ma.textStream)return null;for(var ca="",W=this.Ma.textStream.iterator;W.moveNext();){var P=W.current;0===P.get_type()&&(ca+=P.get_text())}return ca}},view:{configurable:!0,enumerable:!0,get:function(){b.gnd&&(x.ULS.sendTraceTag(509166622,700,50,"JSApi:Shape:ShapeView"),b.gnd=!1);this.pMb||(this.pMb=new n(this.Ma));return this.pMb}},oe:{configurable:!0,
enumerable:!0,get:function(){return this.Ma}},IsItLocalLie:{configurable:!0,enumerable:!0,get:function(){return void 0!==this.Ma&&null!==this.Ma?this.Ma.Rka:!1}},shapeId:{configurable:!0,enumerable:!0,get:function(){return this.Ma.id}},MasterInfo:{configurable:!0,enumerable:!0,get:function(){return void 0!==this.Ma.ke&&null!==this.Ma.ke?Q.a.Oeb(this.Ma.ke.ta):null}},UserRows:{configurable:!0,enumerable:!0,get:function(){return this.Ma.userRows}},ParentPage:{configurable:!0,enumerable:!0,get:function(){return e(1080).Document.S9().pages.a$(parseInt(this.Ma.ta.id))}},
localId:{configurable:!0,enumerable:!0,get:function(){return this.Ma.id}},beginConnectionPointIndex:{configurable:!0,enumerable:!0,get:function(){return this.Ma.Ua.beginConnectionPointIndex}},endConnectionPointIndex:{configurable:!0,enumerable:!0,get:function(){return this.Ma.Ua.endConnectionPointIndex}},connectionPoints:{configurable:!0,enumerable:!0,get:function(){return this.Ma.connectionPoints}},pinX:{configurable:!0,enumerable:!0,get:function(){return this.Ma.xForm.pinX}},pinY:{configurable:!0,
enumerable:!0,get:function(){return this.Ma.xForm.pinY}},xForm:{configurable:!0,enumerable:!0,get:function(){return this.Ma.xForm}}});b.ond=!0;b.Zmd=!0;b.Wmd=!0;b.Pkd=!0;b.rld=!0;b.pld=!0;b.$md=!0;b.bnd=!0;b.fnd=!0;b.Mld=!0;b.Nmd=!0;b.dnd=!0;b.cnd=!0;b.gnd=!0;Object(C.a)(b,"Shape",null,[])},1085:function(C,H,e){function b(){}function n(){this._dataValidationErrors=null;this.diagramId=this.pageId=this._operationType=0;this._resultTitle=this._resultMessage=null;this._resultType=0;this._tabularData=
null}function k(){}function r(){this.shapeBindingRowData=null;this.connectorDirection=this.connectorChoice=0;this.cffBindingRowData=this.connectorBindingRowData=null;this.swimlaneOrdered=this.phaseOrdered=!1;this.shapeMasterSelectorRowData=null;this.layout=0}function m(F,K,I,Y,X,ca){this.keyCode=F;this.altKey=K;this.ctrlKey=I;this.shiftKey=Y;this.metaKey=X;this.handleAltGr=ca}e.d(H,"a",function(){return b});C=e(0);var w=e(31),v=e(158),x=e(36),A=e(7);Object(C.a)(m,"FocusRegionChangeKey",null,[]);var B=
e(1112);Object(C.a)(r,"DVMappingsData",null,[]);Object(C.a)(k,"UpdateDVMappingsCommandData",null,[]);var E=e(1089),L=e(1113),S=e(1097),J=e(1114),Q=e(1091);n.prototype.getTypeName=function(){return"Microsoft.Visio.DataVisualizerDiagramOperationCompleteEventArgs"};n.prototype.invokePropertyGet=function(F){switch(F){case 7:return this.dataValidationErrors;case 3:return this.diagramID;case 1:return this.operationType;case 2:return this.pageID;case 6:return this.resultMessage;case 5:return this.resultTitle;
case 4:return this.resultType;case 8:return this.tabularData}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};n.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};n.prototype.invokePropertySet=function(F,K){switch(F){case 7:this.dataValidationErrors=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"Array<Visio.Extension.DataValidationError>");return;case 3:this.diagramID=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"int");return;case 1:this.operationType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"int");return;case 2:this.pageID=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"int");return;case 6:this.resultMessage=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"string");return;case 5:this.resultTitle=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"string");return;case 4:this.resultType=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"int");return;case 8:this.tabularData=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,Q.a);return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};n.prototype.invokePropertySetAsync=function(F,K){this.invokePropertySet(F,K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};n.prototype.invokeMethod=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
};n.prototype.invokeMethodAsync=function(F,K){F=this.invokeMethod(F,K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};D.global.Object.defineProperties(n.prototype,{dataValidationErrors:{configurable:!0,enumerable:!0,get:function(){return this._dataValidationErrors},set:function(F){this._dataValidationErrors=F}},diagramID:{configurable:!0,enumerable:!0,get:function(){return this.diagramId},set:function(F){this.diagramId=F}},operationType:{configurable:!0,enumerable:!0,get:function(){return this._operationType},
set:function(F){this._operationType=F}},pageID:{configurable:!0,enumerable:!0,get:function(){return this.pageId},set:function(F){this.pageId=F}},resultMessage:{configurable:!0,enumerable:!0,get:function(){return this._resultMessage},set:function(F){this._resultMessage=F}},resultTitle:{configurable:!0,enumerable:!0,get:function(){return this._resultTitle},set:function(F){this._resultTitle=F}},resultType:{configurable:!0,enumerable:!0,get:function(){return this._resultType},set:function(F){this._resultType=
F}},tabularData:{configurable:!0,enumerable:!0,get:function(){return this._tabularData},set:function(F){this._tabularData=F}}});Object(C.a)(n,"DataVisualizerDiagramOperationCompleteEventArgs",null,[]);var R=e(1082);b.ihd=function(F){if(void 0===F||null===F||!F.length)return!1;for(var K=F.toLowerCase(),I=D.makeIterator(b.oNb),Y=I.next();!Y.done;Y=I.next())if(K.startsWith(Y.value))return!0;return b.Agf(F)?!0:!1};b.Agf=function(F){try{var K=RegExp("^data:.+\\/(.+);base64,(.*)$").exec(F);if(void 0===
K||null===K||3!==K.length)return!1;var I=K[2];if(A.a.ka(I))return!1;atob(I);return!0}catch(Y){return w.ULS.sendTraceTag(575689698,700,15,"Invalid data uri. Failed to parse with exception {0}",Y.message),!1}};b.ewb=function(F){if(void 0===F||null===F)throw OfficeExtension.WacRuntime.Utility.createRichApiException(R.a.invalidArgument,"ExcelConnection cannot be null");if(void 0===F.filePath||null===F.filePath)throw OfficeExtension.WacRuntime.Utility.createRichApiException(R.a.invalidArgument,"ExcelConnection.FilePath cannot be null");
if(void 0===F.isTable||null===F.isTable)throw OfficeExtension.WacRuntime.Utility.createRichApiException(R.a.invalidArgument,"ExcelConnection.Istable cannot be null");if(void 0===F.tableOrSheetName||null===F.tableOrSheetName)throw OfficeExtension.WacRuntime.Utility.createRichApiException(R.a.invalidArgument,"ExcelConnection.TableOrSheetName cannot be null");if(void 0===F.dataRange||null===F.dataRange)throw OfficeExtension.WacRuntime.Utility.createRichApiException(R.a.invalidArgument,"ExcelConnection.DataRange cannot be null");
};b.j6c=function(F,K,I,Y,X,ca,W){W=void 0===W?null:W;var P=new B.a;switch(F){case 1:P.diagramType=0;break;case 2:P.diagramType=1;break;case 3:P.diagramType=2;break;case 4:P.diagramType=3;break;case 5:P.diagramType=4;break;default:P.diagramType=0}P.recordSetData=K;P.fitPageToDrawing=X;P.deleteAllShapes=ca;P.filePath=Y.filePath;P.isTable=Y.isTable;P.tableOrSheetName=Y.tableOrSheetName;P.dataRange=Y.dataRange;P.parentPage=W;P.runHeuristics=!1;F=new r;void 0!==I&&null!==I&&(void 0!==I.connectorBinding&&
null!==I.connectorBinding&&(F.connectorBindingRowData=[I.connectorBinding.targetIndexColumn,I.connectorBinding.connectorLabelColumn,I.connectorBinding.delimiter],F.connectorChoice=I.connectorBinding.connectorBindingType,F.connectorDirection=I.connectorBinding.connectorDirection),void 0!==I.cffBinding&&null!==I.cffBinding&&(F.cffBindingRowData=[I.cffBinding.swimlaneColumn,I.cffBinding.phaseColumn],F.swimlaneOrdered=I.cffBinding.swimlaneOrdered,F.phaseOrdered=I.cffBinding.phaseOrdered),void 0!==I.shapeBinding&&
null!==I.shapeBinding&&(F.shapeBindingRowData=[I.shapeBinding.indexColumn,I.shapeBinding.shapeTypeColumn,I.shapeBinding.shapeLabelColumn,I.shapeBinding.altTextColumn]),void 0!==I.masterSelector&&null!==I.masterSelector&&(F.shapeMasterSelectorRowData=[I.masterSelector.defaultMasterStencil,I.masterSelector.defaultMaster],b.DBf(I.masterSelector.masterMappings,F.shapeMasterSelectorRowData)),F.layout=I.layout,P.hideHeading=!0);P.dvMappings=F;return P};b.l6c=function(F){return new m(F.keyCode,F.altKey,
F.ctrlKey,F.shiftKey,F.metaKey,F.handleAltGr)};b.DBf=function(F,K){F=D.makeIterator(F);for(var I=F.next();!I.done;I=F.next())I=I.value,K.push(I.shapeType),K.push(I.stencil),K.push(I.master)};b.p0b=function(F){var K=[];if(v.a.ka(F.rowValuesAsString)||v.a.ka(F.rowValuesAsString[0]))throw OfficeExtension.WacRuntime.Utility.createRichApiException(R.a.invalidArgument,"data cannot be null");for(var I=[],Y=D.makeIterator(F.headers),X=Y.next();!X.done;X=Y.next())Array.add(I,X.value.name);Array.add(K,I);F=
D.makeIterator(F.rowValuesAsString);for(I=F.next();!I.done;I=F.next())Array.add(K,I.value);return K};b.uOe=function(F,K){var I=new k;void 0!==F&&null!==F&&(I.containerShape=F);I.dvMappings=b.nac(F.bja.diagramType,K);return I};b.nac=function(F,K){var I=new r;void 0!==K&&null!==K&&(void 0!==K.connectorBinding&&null!==K.connectorBinding?(I.connectorDirection=K.connectorBinding.direction,void 0!==K.connectorBinding.targetColumnName&&null!==K.connectorBinding.targetColumnName?(I.connectorBindingRowData=
[K.connectorBinding.targetColumnName,K.connectorBinding.labelColumnName,K.connectorBinding.delimiter],I.connectorChoice=0):I.connectorChoice=K.connectorBinding.connectSequentially?1:2):I.connectorChoice=2,1!==F&&2!==F||void 0===K.cffBinding||null===K.cffBinding||(I.cffBindingRowData=[K.cffBinding.swimlaneColumnName,K.cffBinding.phaseColumnName],I.swimlaneOrdered=K.cffBinding.preserveSwimlaneOrder,I.phaseOrdered=K.cffBinding.preservePhaseOrder),void 0!==K.shapeBinding&&null!==K.shapeBinding&&(I.shapeBindingRowData=
[K.shapeBinding.uniqueIDColumnName,"",K.shapeBinding.labelColumnName,K.shapeBinding.alternativeTextColumnName]),void 0!==K.shapeBinding.masterMap&&null!==K.shapeBinding.masterMap&&(I.shapeBindingRowData[1]=K.shapeBinding.masterMap.masterColumnName,I.shapeMasterSelectorRowData=[K.shapeBinding.masterMap.defaultMasterStencilName,K.shapeBinding.masterMap.defaultMasterNameU],b.EBf(K.shapeBinding.masterMap.mappings,I.shapeMasterSelectorRowData)),I.layout=K.layout);return I};b.RNe=function(F,K,I){var Y=
new B.a;Y.recordSetData=b.p0b(K);Y.dataRange=K.range;Y.fitPageToDrawing=!0;Y.deleteAllShapes=!1;Y.hideHeading=!0;Y.runHeuristics=!1;Y.parentPage=F.ta;Y.containerID=F.id;Y.diagramType=F.bja.diagramType;Y.dvMappings=b.nac(F.bja.diagramType,I);return Y};b.EBf=function(F,K){if(void 0!==F&&null!==F){F=D.makeIterator(F);for(var I=F.next();!I.done;I=F.next())I=I.value,void 0!==I.value&&null!==I.value&&void 0!==I.stencilName&&null!==I.stencilName&&void 0!==I.masterNameU&&null!==I.masterNameU&&(K.push(I.value),
K.push(I.stencilName),K.push(I.masterNameU))}};b.uue=function(F){var K=new n;K.pageID=F.pageID;K.diagramID=F.containerID;K.resultType=b.jSe(F.errorType);K.resultMessage=F.JHe;K.resultTitle=F.$D;K.operationType=b.kSe(F.VTb);K.dataValidationErrors=b.r2e(F.NPd);K.tabularData=b.P0e(F.data);return K};b.P0e=function(F){if(void 0===F||null===F)return null;for(var K=Array(F.headers.length),I=0;I<F.headers.length;I++)K[I]=new S.a,K[I].name=F.headers[I],K[I].columnType=1;return new Q.a(K,"",F.range,F.rowValuesAsString)};
b.r2e=function(F){if(!v.a.ka(F)){var K=Array(F.length),I=0;F=D.makeIterator(F);for(var Y=F.next();!Y.done;Y=F.next()){Y=Y.value;var X=null;if(!v.a.ka(Y.Uwa)&&!v.a.ka(Y.Vwa)&&Y.Uwa.length===Y.Vwa.length){var ca=Y.Vwa.length;X=Array(ca);for(var W=0;W<ca;W++)X[W]=new L.a(parseInt(Y.Uwa[W]),Y.Vwa[W])}K[I++]=new J.a(null,Y.XR,Y.Lcc,X,Y.errorType)}return K}return null};b.kSe=function(F){switch(F){case 0:return 1;case 4:return 4;case 1:return 3;case 3:return 2;default:return 0}};b.jSe=function(F){switch(F){case 1:return 2;
case 2:return 3;case 0:return 1;default:return 0}};b.downloadLayoutJsFiles=function(F){var K=e(1078).Application;switch(F){case E.a.mindmapAddonCategory:K.getBRS("VisioWebMindmapClientSideEnabled",!1)&&(x.a.instance.resolve("Visio.Extension.VisioExtensionScriptLoaderBase").tkd(),x.a.instance.resolve("Visio.Extension.VisioExtensionScriptLoaderBase").alf());break;case E.a.orgChartAddonCategory:-1!==K.getBRS("VisioWebClientSideLayoutEnabled","").indexOf("ORGCHART")&&(x.a.instance.resolve("Visio.Extension.VisioExtensionScriptLoaderBase").tkd(),
x.a.instance.resolve("Visio.Extension.VisioExtensionScriptLoaderBase").ilf())}};b.oNb=["http://","https://","ftp://"];Object(C.a)(b,"Utility",null,[])},1089:function(C,H,e){function b(){}e.d(H,"a",function(){return b});C=e(0);b.defaultFontSize=12;b.none="none";b.pixelsPerInch=96;b.invalidShapeId=4294967295;b.textColor="#000000";b.mindmapAddonCategory="MindMap";b.orgChartAddonCategory="OrgChart";Object(C.a)(b,"Constants",null,[])},1090:function(C,H,e){function b(n,k,r){this.byb=this.Dd=-1;this.Ef=
r;0<n&&(this.Dd+=n);this.byb=0<k?n+k<this.Ef.length()?n+k:this.Ef.length():this.Ef.length()}e.d(H,"a",function(){return b});C=e(0);b.prototype.get_current=function(){return this.Dd<this.byb?this.Ef.getItemByIndex(this.Dd):null};b.prototype.moveNext=function(){var n=this.B6f();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)};b.prototype.B6f=function(){this.Dd++;return this.Dd<this.byb?!0:!1};Object(C.a)(b,"ElementEnumerator",null,[415])},1091:function(C,H,e){function b(n,k,r,m){this._range=
this._rowValuesAsString=this._name=this._headers=null;this._headers=n;this._name=k;this._range=r;this._rowValuesAsString=m}e.d(H,"a",function(){return b});C=e(0);b.prototype.getTypeName=function(){return"Microsoft.Visio.TabularData"};b.prototype.invokePropertyGet=function(n){switch(n){case 2:return this.headers;case 1:return this.name;case 4:return this.range;case 3:return this.rowValuesAsString}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokePropertyGetAsync=
function(n){n=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)};b.prototype.invokePropertySet=function(n,k){switch(n){case 2:this.headers=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"Array<Visio.Extension.DataHeader>");return;case 1:this.name=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"string");return;case 4:this.range=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"string");return;case 3:this.rowValuesAsString=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"Array<Array<string>>");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokePropertySetAsync=function(n,k){this.invokePropertySet(n,k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};b.prototype.invokeMethod=function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokeMethodAsync=function(n,k){n=this.invokeMethod(n,k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)};
D.global.Object.defineProperties(b.prototype,{headers:{configurable:!0,enumerable:!0,get:function(){return this._headers},set:function(n){this._headers=n}},name:{configurable:!0,enumerable:!0,get:function(){return this._name},set:function(n){this._name=n}},range:{configurable:!0,enumerable:!0,get:function(){return this._range},set:function(n){this._range=n}},rowValuesAsString:{configurable:!0,enumerable:!0,get:function(){return this._rowValuesAsString},set:function(n){this._rowValuesAsString=n}}});
Object(C.a)(b,"TabularData",null,[])},1093:function(C,H,e){function b(){this._id=this.bDc=this._name=null;this._width=this._height=0;this._uniqueID=this._stencil=this._master=this._stencilId=this.sLc=null}e.d(H,"a",function(){return b});C=e(0);b.prototype.getTypeName=function(){return"Microsoft.Visio.MasterInfo"};b.prototype.invokePropertyGet=function(n){switch(n){case 1:return this.name;case 2:return this.nameU}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokePropertyGetAsync=
function(n){n=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)};b.prototype.invokePropertySet=function(n,k){switch(n){case 1:this.name=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"string");return;case 2:this.nameU=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokePropertySetAsync=function(n,k){this.invokePropertySet(n,
k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};b.prototype.invokeMethod=function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokeMethodAsync=function(n,k){n=this.invokeMethod(n,k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)};b.Oeb=function(n){var k=new b;k.name=n.internalName;k.nameU=n.displayName;k.masterId=n.id;k._stencilId=n.Ub.id;k._master=n;k.height=n.shapes.getItemAt(0).xForm.height;k.width=n.shapes.getItemAt(0).xForm.width;
k.userRows=n.shapes.getItemAt(0).userRows;k._stencil=n.Ub;k._uniqueID=n.uniqueId;return k};D.global.Object.defineProperties(b.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name},set:function(n){this._name=n}},nameU:{configurable:!0,enumerable:!0,get:function(){return this.bDc},set:function(n){this.bDc=n}},masterId:{configurable:!0,enumerable:!0,get:function(){return this._id},set:function(n){this._id=n}},stencilId:{configurable:!0,enumerable:!0,get:function(){return this._stencilId}},
userRows:{configurable:!0,enumerable:!0,get:function(){return this.sLc},set:function(n){this.sLc=n}},height:{configurable:!0,enumerable:!0,get:function(){return this._height},set:function(n){this._height=n}},width:{configurable:!0,enumerable:!0,get:function(){return this._width},set:function(n){this._width=n}},master:{configurable:!0,enumerable:!0,get:function(){return this._master}},stencil:{configurable:!0,enumerable:!0,get:function(){return this._stencil}},uniqueID:{configurable:!0,enumerable:!0,
get:function(){return this._uniqueID}}});Object(C.a)(b,"MasterInfo",null,[])},1095:function(C,H){var e="undefined"!==typeof self?self:this,b=function(){function n(){this.fetch=!1;this.DOMException=e.DOMException}n.prototype=e;return new n}();(function(n){(function(k){function r(W){"string"!==typeof W&&(W=String(W));if(/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(W))throw new TypeError("Invalid character in header field name");return W.toLowerCase()}function m(W){"string"!==typeof W&&(W=String(W));return W}function w(W){var P=
{next:function(){var T=W.shift();return{done:void 0===T,value:T}}};K.Aid&&(P[Symbol.iterator]=function(){return P});return P}function v(W){this.map={};W instanceof v?W.forEach(function(P,T){this.append(T,P)},this):Array.isArray(W)?W.forEach(function(P){this.append(P[0],P[1])},this):W&&Object.getOwnPropertyNames(W).forEach(function(P){this.append(P,W[P])},this)}function x(W){if(W.bodyUsed)return Promise.reject(new TypeError("Already read"));W.bodyUsed=!0}function A(W){return new Promise(function(P,
T){W.onload=function(){P(W.result)};W.onerror=function(){T(W.error)}})}function B(W){var P=new FileReader,T=A(P);P.readAsArrayBuffer(W);return T}function E(W){if(W.slice)return W.slice(0);var P=new Uint8Array(W.byteLength);P.set(new Uint8Array(W));return P.buffer}function L(){this.bodyUsed=!1;this.Vwc=function(W){(this.Vca=W)?"string"===typeof W?this.yFa=W:K.blob&&Blob.prototype.isPrototypeOf(W)?this.Uca=W:K.formData&&FormData.prototype.isPrototypeOf(W)?this.jqc=W:K.searchParams&&URLSearchParams.prototype.isPrototypeOf(W)?
this.yFa=W.toString():K.arrayBuffer&&K.blob&&W&&DataView.prototype.isPrototypeOf(W)?(this.C4=E(W.buffer),this.Vca=new Blob([this.C4])):K.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(W)||Y(W))?this.C4=E(W):this.yFa=W=Object.prototype.toString.call(W):this.yFa="";this.headers.get("content-type")||("string"===typeof W?this.headers.set("content-type","text/plain;charset=UTF-8"):this.Uca&&this.Uca.type?this.headers.set("content-type",this.Uca.type):K.searchParams&&URLSearchParams.prototype.isPrototypeOf(W)&&
this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))};K.blob&&(this.blob=function(){var W=x(this);if(W)return W;if(this.Uca)return Promise.resolve(this.Uca);if(this.C4)return Promise.resolve(new Blob([this.C4]));if(this.jqc)throw Error("could not read FormData body as blob");return Promise.resolve(new Blob([this.yFa]))},this.arrayBuffer=function(){return this.C4?x(this)||Promise.resolve(this.C4):this.blob().then(B)});this.text=function(){var W=x(this);if(W)return W;
if(this.Uca){W=this.Uca;var P=new FileReader,T=A(P);P.readAsText(W);return T}if(this.C4){W=Promise;P=W.resolve;T=new Uint8Array(this.C4);for(var Z=Array(T.length),ia=0;ia<T.length;ia++)Z[ia]=String.fromCharCode(T[ia]);T=Z.join("");return P.call(W,T)}if(this.jqc)throw Error("could not read FormData body as text");return Promise.resolve(this.yFa)};K.formData&&(this.formData=function(){return this.text().then(J)});this.json=function(){return this.text().then(JSON.parse)};return this}function S(W,P){P=
P||{};var T=P.body;if(W instanceof S){if(W.bodyUsed)throw new TypeError("Already read");this.url=W.url;this.credentials=W.credentials;P.headers||(this.headers=new v(W.headers));this.method=W.method;this.mode=W.mode;this.signal=W.signal;T||null==W.Vca||(T=W.Vca,W.bodyUsed=!0)}else this.url=String(W);this.credentials=P.credentials||this.credentials||"same-origin";if(P.headers||!this.headers)this.headers=new v(P.headers);W=P.method||this.method||"GET";var Z=W.toUpperCase();this.method=-1<X.indexOf(Z)?
Z:W;this.mode=P.mode||this.mode||null;this.signal=P.signal||this.signal;this.referrer=null;if(("GET"===this.method||"HEAD"===this.method)&&T)throw new TypeError("Body not allowed for GET or HEAD requests");this.Vwc(T)}function J(W){var P=new FormData;W.trim().split("&").forEach(function(T){if(T){var Z=T.split("=");T=Z.shift().replace(/\+/g," ");Z=Z.join("=").replace(/\+/g," ");P.append(decodeURIComponent(T),decodeURIComponent(Z))}});return P}function Q(W){var P=new v;W.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(T){var Z=
T.split(":");if(T=Z.shift().trim())Z=Z.join(":").trim(),P.append(T,Z)});return P}function R(W,P){P||(P={});this.type="default";this.status=void 0===P.status?200:P.status;this.ok=200<=this.status&&300>this.status;this.statusText="statusText"in P?P.statusText:"OK";this.headers=new v(P.headers);this.url=P.url||"";this.Vwc(W)}function F(W,P){return new Promise(function(T,Z){function ia(){ba.abort()}var na=new S(W,P);if(na.signal&&na.signal.aborted)return Z(new k.DOMException("Aborted","AbortError"));
var ba=new XMLHttpRequest;ba.onload=function(){var ea={status:ba.status,statusText:ba.statusText,headers:Q(ba.getAllResponseHeaders()||"")};ea.url="responseURL"in ba?ba.responseURL:ea.headers.get("X-Request-URL");T(new R("response"in ba?ba.response:ba.responseText,ea))};ba.onerror=function(){Z(new TypeError("Network request failed"))};ba.ontimeout=function(){Z(new TypeError("Network request failed"))};ba.onabort=function(){Z(new k.DOMException("Aborted","AbortError"))};ba.open(na.method,na.url,!0);
"include"===na.credentials?ba.withCredentials=!0:"omit"===na.credentials&&(ba.withCredentials=!1);"responseType"in ba&&K.blob&&(ba.responseType="blob");na.headers.forEach(function(ea,oa){ba.setRequestHeader(oa,ea)});na.signal&&(na.signal.addEventListener("abort",ia),ba.onreadystatechange=function(){4===ba.readyState&&na.signal.removeEventListener("abort",ia)});ba.send("undefined"===typeof na.Vca?null:na.Vca)})}var K={searchParams:"URLSearchParams"in n,Aid:"Symbol"in n&&"iterator"in Symbol,blob:"FileReader"in
n&&"Blob"in n&&!0,formData:"FormData"in n,arrayBuffer:"ArrayBuffer"in n};if(K.arrayBuffer)var I="[object Int8Array];[object Uint8Array];[object Uint8ClampedArray];[object Int16Array];[object Uint16Array];[object Int32Array];[object Uint32Array];[object Float32Array];[object Float64Array]".split(";"),Y=ArrayBuffer.isView||function(W){return W&&-1<I.indexOf(Object.prototype.toString.call(W))};v.prototype.append=function(W,P){W=r(W);P=m(P);var T=this.map[W];this.map[W]=T?T+", "+P:P};v.prototype["delete"]=
function(W){delete this.map[r(W)]};v.prototype.get=function(W){W=r(W);return this.has(W)?this.map[W]:null};v.prototype.has=function(W){return this.map.hasOwnProperty(r(W))};v.prototype.set=function(W,P){this.map[r(W)]=m(P)};v.prototype.forEach=function(W,P){for(var T in this.map)this.map.hasOwnProperty(T)&&W.call(P,this.map[T],T,this)};v.prototype.keys=function(){var W=[];this.forEach(function(P,T){W.push(T)});return w(W)};v.prototype.values=function(){var W=[];this.forEach(function(P){W.push(P)});
return w(W)};v.prototype.entries=function(){var W=[];this.forEach(function(P,T){W.push([T,P])});return w(W)};K.Aid&&(v.prototype[Symbol.iterator]=v.prototype.entries);var X="DELETE GET HEAD OPTIONS POST PUT".split(" ");S.prototype.clone=function(){return new S(this,{body:this.Vca})};L.call(S.prototype);L.call(R.prototype);R.prototype.clone=function(){return new R(this.Vca,{status:this.status,statusText:this.statusText,headers:new v(this.headers),url:this.url})};R.error=function(){var W=new R(null,
{status:0,statusText:""});W.type="error";return W};var ca=[301,302,303,307,308];R.redirect=function(W,P){if(-1===ca.indexOf(P))throw new RangeError("Invalid status code");return new R(null,{status:P,headers:{location:W}})};k.DOMException=n.DOMException;try{new k.DOMException}catch(W){k.DOMException=function(P,T){this.message=P;this.name=T;this.stack=Error(P).stack},k.DOMException.prototype=Object.create(Error.prototype),k.DOMException.prototype.constructor=k.DOMException}F.QAa=!0;n.fetch||(n.fetch=
F,n.Headers=v,n.Request=S,n.Response=R);k.Headers=v;k.Request=S;k.Response=R;k.fetch=F;Object.defineProperty(k,"__esModule",{value:!0});return k})({})})(b);b.fetch.Pog=!0;delete b.fetch.QAa;H=b.fetch;H.default=b.fetch;H.fetch=b.fetch;H.Headers=b.Headers;H.Request=b.Request;H.Response=b.Response;C.exports=H},1097:function(C,H,e){function b(){this._columnType=0;this._name=null}e.d(H,"a",function(){return b});C=e(0);b.prototype.getTypeName=function(){return"Microsoft.Visio.DataHeader"};b.prototype.invokePropertyGet=
function(n){switch(n){case 2:return this.columnType;case 1:return this.name}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokePropertyGetAsync=function(n){n=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)};b.prototype.invokePropertySet=function(n,k){switch(n){case 2:this.columnType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"int");return;case 1:this.name=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,
0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokePropertySetAsync=function(n,k){this.invokePropertySet(n,k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};b.prototype.invokeMethod=function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokeMethodAsync=function(n,k){n=this.invokeMethod(n,k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)};D.global.Object.defineProperties(b.prototype,
{columnType:{configurable:!0,enumerable:!0,get:function(){return this._columnType},set:function(n){this._columnType=n}},name:{configurable:!0,enumerable:!0,get:function(){return this._name},set:function(n){this._name=n}}});Object(C.a)(b,"DataHeader",null,[])},1098:function(C,H,e){function b(v){this.xa=v;this.K7=new k.a}e.d(H,"a",function(){return b});C=e(0);var n=e(31),k=e(805),r=e(1090),m=e(1082),w=e(1078);b.prototype.add=function(){return null};b.prototype.getCount=function(){b.Smd&&(n.ULS.sendTraceTag(509089692,
700,50,"JSApi:ShapeCollection:Count"),b.Smd=!1);return this.length()};b.prototype.getItem=function(v){b.Lld&&(n.ULS.sendTraceTag(509089691,700,50,"JSApi:ShapeCollection:GetItem"),b.Lld=!1);if(void 0===v||null===v)throw OfficeExtension.WacRuntime.Utility.createRichApiException(m.a.invalidArgument,"InvalidArgument");var x=parseInt(v.toString());if(!isNaN(x)&&0<x)return this.eR(x);x=this.B_e(v.toString());if(void 0===x||null===x)x=this.F0b(v);return x};b.prototype.getItemOrNullObject=function(v){if(void 0===
v||null===v)throw OfficeExtension.WacRuntime.Utility.createRichApiException(m.a.invalidArgument,"InvalidArgument");v=parseInt(v.toString());if(!isNaN(v)&&0<v)try{return this.eR(v)}catch(x){}return null};b.prototype.getAsyncEnumerator=function(v,x){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new r.a(v,x,this))};b.prototype.getTypeName=function(){return"Microsoft.Visio.ShapeCollection"};b.prototype.invokePropertyGet=function(v){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);
};b.prototype.invokePropertyGetAsync=function(v){v=this.invokePropertyGet(v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)};b.prototype.invokePropertySet=function(v){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);};b.prototype.invokePropertySetAsync=function(v,x){this.invokePropertySet(v,x);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};b.prototype.invokeMethod=function(v,x){switch(v){case 1004:return this.TNa(x);case 1002:return this.HJ();
case 1:return this.JJ(x);case 1003:return this.SRa(x)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);};b.prototype.invokeMethodAsync=function(v,x){v=this.invokeMethod(v,x);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)};b.prototype.TNa=function(v){v=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"string");return this.add(v)};b.prototype.HJ=function(){return this.getCount()};b.prototype.JJ=function(v){v=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,
0,"any");return this.getItem(v)};b.prototype.SRa=function(v){v=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"int");return this.getItemOrNullObject(v)};b.prototype.length=function(){return this.xa?this.xa.length:0};b.prototype.kka=function(v){var x=e(1083).Shape;if(void 0===v||null===v)return null;if(this.K7.pb(v.id))return x=this.K7.ia(v.id),x.UpdateShapeObject(v),x;this.K7.U(v.id,new x(v));return this.K7.ia(v.id)};b.prototype.getItemByIndex=function(v){if(void 0===v||null===v)throw OfficeExtension.WacRuntime.Utility.createRichApiException(m.a.invalidArgument,
"InvalidArgument");v=parseInt(v.toString());if(!isNaN(v)&&0<=v&&v<this.xa.length)return this.kka(this.xa[v]);throw OfficeExtension.WacRuntime.Utility.createRichApiException(m.a.invalidArgument,"InvalidArgument");};b.prototype.F0b=function(v){v=v.toString().toLowerCase();for(var x=D.makeIterator(this.xa),A=x.next();!A.done;A=x.next())if(A=A.value,A.internalName.toLowerCase()===v)return this.kka(A);throw OfficeExtension.WacRuntime.Utility.createRichApiException(m.a.qR,"ItemNotFound");};b.prototype.getItemByIndexV2=
function(v){if(void 0===v||null===v)throw OfficeExtension.WacRuntime.Utility.createRichApiException(m.a.invalidArgument,"InvalidArgument");v=parseInt(v.toString());if(!isNaN(v)&&0<=v&&v<this.xa.length)return this.V_e(this.xa[v]);throw OfficeExtension.WacRuntime.Utility.createRichApiException(m.a.invalidArgument,"InvalidArgument");};b.prototype.V_e=function(v){var x=e(1083).Shape;if(void 0===v||null===v)return null;if(!w.Application.getBRS("VisioWebOrgChartPartialSelectionOperationFixEnabled",!1)&&
this.K7.pb(v.id))return x=this.K7.ia(v.id),x.UpdateShapeObject(v),x;this.K7.U(v.id,new x(v));return this.K7.ia(v.id)};b.prototype.eR=function(v){for(var x=D.makeIterator(this.xa),A=x.next();!A.done;A=x.next())if(A=A.value,parseInt(A.id)===v)return this.kka(A);throw OfficeExtension.WacRuntime.Utility.createRichApiException(m.a.qR,"ItemNotFound");};b.prototype.B_e=function(v){for(var x=D.makeIterator(this.xa),A=x.next();!A.done;A=x.next())if(A=A.value,A.id===v)return this.kka(A);return null};b.Lld=
!0;b.Smd=!0;Object(C.a)(b,"ShapeCollection",null,[395])},1099:function(C,H,e){function b(){this.MIc=!0;this.wLc=n.a.defaultFontSize;this._label=k.a.empty;this.qAc=0;this.pAc=n.a.defaultFontSize;this.lqc=0;this.gqa=n.a.none;this.Nqc=this.Lqc=0;this.YBc=null;this.rwc=6;this.ALc=3;this.UMa=n.a.textColor}e.d(H,"a",function(){return b});C=e(0);var n=e(1089),k=e(7),r=e(1116);b.prototype.getTypeName=function(){return"Microsoft.Visio.DGProperties"};b.prototype.invokePropertyGet=function(m){switch(m){case 6:return this.borderType;
case 8:return this.calloutOffsetX;case 9:return this.calloutWidth;case 7:return this.fill;case 12:return this.horizontalPosition;case 3:return this.label;case 5:return this.labelFontSize;case 4:return this.labelPosition;case 10:return this.mapping;case 1:return this.showValue;case 13:return this.textColor;case 2:return this.valueFontSize;case 11:return this.verticalPosition}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);};b.prototype.invokePropertyGetAsync=function(m){m=this.invokePropertyGet(m);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(m)};b.prototype.invokePropertySet=function(m,w){switch(m){case 6:this.borderType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(w,0,"int");return;case 8:this.calloutOffsetX=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(w,0,"int");return;case 9:this.calloutWidth=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(w,0,"int");return;case 7:this.fill=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(w,
0,"string");return;case 12:this.horizontalPosition=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(w,0,"int");return;case 3:this.label=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(w,0,"string");return;case 5:this.labelFontSize=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(w,0,"int");return;case 4:this.labelPosition=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(w,0,"int");return;case 10:this.mapping=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(w,
0,r.a);return;case 1:this.showValue=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(w,0,"boolean");return;case 13:this.textColor=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(w,0,"string");return;case 2:this.valueFontSize=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(w,0,"int");return;case 11:this.verticalPosition=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(w,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);};b.prototype.invokePropertySetAsync=
function(m,w){this.invokePropertySet(m,w);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};b.prototype.invokeMethod=function(m){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);};b.prototype.invokeMethodAsync=function(m,w){m=this.invokeMethod(m,w);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(m)};D.global.Object.defineProperties(b.prototype,{borderType:{configurable:!0,enumerable:!0,get:function(){return this.lqc},set:function(m){this.lqc=
m}},calloutOffsetX:{configurable:!0,enumerable:!0,get:function(){return this.Lqc},set:function(m){this.Lqc=m}},calloutWidth:{configurable:!0,enumerable:!0,get:function(){return this.Nqc},set:function(m){this.Nqc=m}},fill:{configurable:!0,enumerable:!0,get:function(){return this.gqa},set:function(m){this.gqa=m}},horizontalPosition:{configurable:!0,enumerable:!0,get:function(){return this.rwc},set:function(m){this.rwc=m}},label:{configurable:!0,enumerable:!0,get:function(){return this._label},set:function(m){this._label=
m}},labelFontSize:{configurable:!0,enumerable:!0,get:function(){return this.pAc},set:function(m){this.pAc=m}},labelPosition:{configurable:!0,enumerable:!0,get:function(){return this.qAc},set:function(m){this.qAc=m}},mapping:{configurable:!0,enumerable:!0,get:function(){return this.YBc},set:function(m){this.YBc=m}},showValue:{configurable:!0,enumerable:!0,get:function(){return this.MIc},set:function(m){this.MIc=m}},textColor:{configurable:!0,enumerable:!0,get:function(){return this.UMa},set:function(m){this.UMa=
m}},valueFontSize:{configurable:!0,enumerable:!0,get:function(){return this.wLc},set:function(m){this.wLc=m}},verticalPosition:{configurable:!0,enumerable:!0,get:function(){return this.ALc},set:function(m){this.ALc=m}}});Object(C.a)(b,"DGProperties",null,[])},1100:function(C,H,e){function b(){this._shapeBinding=this._masterSelector=this._connectorBinding=this._cffBinding=null;this._layout=0}e.d(H,"a",function(){return b});C=e(0);var n=e(1117),k=e(1101),r=e(1119),m=e(1103);b.prototype.getTypeName=
function(){return"Microsoft.Visio.SmartDiagramSettings"};b.prototype.invokePropertyGet=function(w){switch(w){case 4:return this.cffBinding;case 3:return this.connectorBinding;case 5:return this.layout;case 2:return this.masterSelector;case 1:return this.shapeBinding}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(w);};b.prototype.invokePropertyGetAsync=function(w){w=this.invokePropertyGet(w);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(w)};b.prototype.invokePropertySet=
function(w,v){switch(w){case 4:this.cffBinding=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,n.a);return;case 3:this.connectorBinding=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,k.a);return;case 5:this.layout=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"int");return;case 2:this.masterSelector=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,r.a);return;case 1:this.shapeBinding=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,
0,m.a);return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(w);};b.prototype.invokePropertySetAsync=function(w,v){this.invokePropertySet(w,v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};b.prototype.invokeMethod=function(w){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(w);};b.prototype.invokeMethodAsync=function(w,v){w=this.invokeMethod(w,v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(w)};D.global.Object.defineProperties(b.prototype,
{cffBinding:{configurable:!0,enumerable:!0,get:function(){return this._cffBinding},set:function(w){this._cffBinding=w}},connectorBinding:{configurable:!0,enumerable:!0,get:function(){return this._connectorBinding},set:function(w){this._connectorBinding=w}},layout:{configurable:!0,enumerable:!0,get:function(){return this._layout},set:function(w){this._layout=w}},masterSelector:{configurable:!0,enumerable:!0,get:function(){return this._masterSelector},set:function(w){this._masterSelector=w}},shapeBinding:{configurable:!0,
enumerable:!0,get:function(){return this._shapeBinding},set:function(w){this._shapeBinding=w}}});Object(C.a)(b,"SmartDiagramSettings",null,[])},1101:function(C,H,e){function b(k){this.vh=1;this.CNb=this.lfa=null;this.CAb=!1;this.asa=null;this._connectorBindingType=2;this._connectorDirection=1;this._targetIndexColumn=this._sourceIndexColumn=this._delimiter=this._connectorLabelColumn=null;k&&(this._delimiter=k.delimiter,this._connectorDirection=k.direction,this._connectorLabelColumn=k.labelColumnName,
this._targetIndexColumn=k.targetColumnName,this.vh=k.direction,this.CAb=k.connectSequentially,this.lfa=k.labelColumnName,this.CNb=k.targetColumnName)}e.d(H,"a",function(){return b});C=e(0);var n=e(1102);b.prototype.getTypeName=function(){return"Microsoft.Visio.ConnectorBinding"};b.prototype.invokePropertyGet=function(k){switch(k){case 9:return this.connectSequentially;case 1:return this.connectorBindingType;case 4:return this.connectorDirection;case 5:return this.connectorLabelColumn;case 6:return this.delimiter;
case 7:return this.direction;case 11:return this.labelColumnName;case 8:return this.masterMap;case 2:return this.sourceIndexColumn;case 10:return this.targetColumnName;case 3:return this.targetIndexColumn}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(k);};b.prototype.invokePropertyGetAsync=function(k){k=this.invokePropertyGet(k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(k)};b.prototype.invokePropertySet=function(k,r){switch(k){case 9:this.connectSequentially=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,0,"boolean");return;case 1:this.connectorBindingType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,0,"int");return;case 4:this.connectorDirection=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,0,"int");return;case 5:this.connectorLabelColumn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,0,"string");return;case 6:this.delimiter=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,0,"string");
return;case 7:this.direction=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,0,"int");return;case 11:this.labelColumnName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,0,"string");return;case 8:this.masterMap=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,0,n.a);return;case 2:this.sourceIndexColumn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,0,"string");return;case 10:this.targetColumnName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,
0,"string");return;case 3:this.targetIndexColumn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(k);};b.prototype.invokePropertySetAsync=function(k,r){this.invokePropertySet(k,r);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};b.prototype.invokeMethod=function(k){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(k);};b.prototype.invokeMethodAsync=function(k,
r){k=this.invokeMethod(k,r);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(k)};D.global.Object.defineProperties(b.prototype,{connectSequentially:{configurable:!0,enumerable:!0,get:function(){return this.CAb},set:function(k){this.CAb=k}},connectorBindingType:{configurable:!0,enumerable:!0,get:function(){return this._connectorBindingType},set:function(k){this._connectorBindingType=k}},connectorDirection:{configurable:!0,enumerable:!0,get:function(){return this._connectorDirection},
set:function(k){this._connectorDirection=k}},connectorLabelColumn:{configurable:!0,enumerable:!0,get:function(){return this._connectorLabelColumn},set:function(k){this._connectorLabelColumn=k}},delimiter:{configurable:!0,enumerable:!0,get:function(){return this._delimiter},set:function(k){this._delimiter=k}},direction:{configurable:!0,enumerable:!0,get:function(){return this.vh},set:function(k){this.vh=k}},labelColumnName:{configurable:!0,enumerable:!0,get:function(){return this.lfa},set:function(k){this.lfa=
k}},masterMap:{configurable:!0,enumerable:!0,get:function(){return this.asa},set:function(k){this.asa=k}},sourceIndexColumn:{configurable:!0,enumerable:!0,get:function(){return this._sourceIndexColumn},set:function(k){this._sourceIndexColumn=k}},targetColumnName:{configurable:!0,enumerable:!0,get:function(){return this.CNb},set:function(k){this.CNb=k}},targetIndexColumn:{configurable:!0,enumerable:!0,get:function(){return this._targetIndexColumn},set:function(k){this._targetIndexColumn=k}}});Object(C.a)(b,
"ConnectorBinding",null,[])},1102:function(C,H,e){function b(k){this._mappings=this.cIb=this.sBb=this.rBb=null;if(k){this.rBb=k.defaultMasterNameU;this.sBb=k.HBe;this.cIb=k.T6f;this._mappings=Array(k.t7b.length);for(var r=0;r<k.t7b.length;r++)this._mappings[r]=new n.a(k.t7b[r])}}e.d(H,"a",function(){return b});C=e(0);var n=e(1118);b.prototype.getTypeName=function(){return"Microsoft.Visio.MasterMap"};b.prototype.invokePropertyGet=function(k){switch(k){case 3:return this.defaultMasterNameU;case 2:return this.defaultMasterStencilName;
case 4:return this.mappings;case 1:return this.masterColumnName}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(k);};b.prototype.invokePropertyGetAsync=function(k){k=this.invokePropertyGet(k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(k)};b.prototype.invokePropertySet=function(k,r){switch(k){case 3:this.defaultMasterNameU=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,0,"string");return;case 2:this.defaultMasterStencilName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,
0,"string");return;case 4:this.mappings=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,0,"Array<Visio.Extension.MasterValueMap>");return;case 1:this.masterColumnName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(k);};b.prototype.invokePropertySetAsync=function(k,r){this.invokePropertySet(k,r);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};b.prototype.invokeMethod=
function(k){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(k);};b.prototype.invokeMethodAsync=function(k,r){k=this.invokeMethod(k,r);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(k)};D.global.Object.defineProperties(b.prototype,{defaultMasterNameU:{configurable:!0,enumerable:!0,get:function(){return this.rBb},set:function(k){this.rBb=k}},defaultMasterStencilName:{configurable:!0,enumerable:!0,get:function(){return this.sBb},set:function(k){this.sBb=k}},mappings:{configurable:!0,
enumerable:!0,get:function(){return this._mappings},set:function(k){this._mappings=k}},masterColumnName:{configurable:!0,enumerable:!0,get:function(){return this.cIb},set:function(k){this.cIb=k}}});Object(C.a)(b,"MasterMap",null,[])},1103:function(C,H,e){function b(k){this.Fyb=this.asa=this.lfa=this._altTextColumn=this._shapeLabelColumn=this._shapeTypeColumn=this._indexColumn=null;k&&(this._indexColumn=k.uniqueIDColumnName,this._altTextColumn=k.tPc,this._shapeLabelColumn=k.labelColumnName,this.Fyb=
k.tPc,this.lfa=k.labelColumnName,this.asa=new n.a(k.masterSelector))}e.d(H,"a",function(){return b});C=e(0);var n=e(1102);b.prototype.getTypeName=function(){return"Microsoft.Visio.ShapeBinding"};b.prototype.invokePropertyGet=function(k){switch(k){case 4:return this.altTextColumn;case 8:return this.alternativeTextColumnName;case 1:return this.indexColumn;case 7:return this.labelColumnName;case 5:return this.masterMap;case 3:return this.shapeLabelColumn;case 2:return this.shapeTypeColumn;case 6:return this.uniqueIDColumnName}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(k);
};b.prototype.invokePropertyGetAsync=function(k){k=this.invokePropertyGet(k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(k)};b.prototype.invokePropertySet=function(k,r){switch(k){case 4:this.altTextColumn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,0,"string");return;case 8:this.alternativeTextColumnName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,0,"string");return;case 1:this.indexColumn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,
0,"string");return;case 7:this.labelColumnName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,0,"string");return;case 5:this.masterMap=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,0,n.a);return;case 3:this.shapeLabelColumn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,0,"string");return;case 2:this.shapeTypeColumn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,0,"string");return;case 6:this.uniqueIDColumnName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,
0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(k);};b.prototype.invokePropertySetAsync=function(k,r){this.invokePropertySet(k,r);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};b.prototype.invokeMethod=function(k){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(k);};b.prototype.invokeMethodAsync=function(k,r){k=this.invokeMethod(k,r);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(k)};D.global.Object.defineProperties(b.prototype,
{altTextColumn:{configurable:!0,enumerable:!0,get:function(){return this._altTextColumn},set:function(k){this._altTextColumn=k}},alternativeTextColumnName:{configurable:!0,enumerable:!0,get:function(){return this.Fyb},set:function(k){this.Fyb=k}},indexColumn:{configurable:!0,enumerable:!0,get:function(){return this._indexColumn},set:function(k){this._indexColumn=k}},labelColumnName:{configurable:!0,enumerable:!0,get:function(){return this.lfa},set:function(k){this.lfa=k}},masterMap:{configurable:!0,
enumerable:!0,get:function(){return this.asa},set:function(k){this.asa=k}},shapeLabelColumn:{configurable:!0,enumerable:!0,get:function(){return this._shapeLabelColumn},set:function(k){this._shapeLabelColumn=k}},shapeTypeColumn:{configurable:!0,enumerable:!0,get:function(){return this._shapeTypeColumn},set:function(k){this._shapeTypeColumn=k}},uniqueIDColumnName:{configurable:!0,enumerable:!0,get:function(){return this._indexColumn},set:function(k){this._indexColumn=k}}});Object(C.a)(b,"ShapeBinding",
null,[])},1104:function(C,H,e){function b(){this.rsc=this.Auc=null;this.qJa=!1;this.XJc=null}e.d(H,"a",function(){return b});C=e(0);b.prototype.getTypeName=function(){return"Microsoft.Visio.ExcelConnection"};b.prototype.invokePropertyGet=function(n){switch(n){case 4:return this.dataRange;case 1:return this.filePath;case 2:return this.isTable;case 3:return this.tableOrSheetName}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokePropertyGetAsync=function(n){n=
this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)};b.prototype.invokePropertySet=function(n,k){switch(n){case 4:this.dataRange=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"string");return;case 1:this.filePath=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"string");return;case 2:this.isTable=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"boolean");return;case 3:this.tableOrSheetName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,
0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokePropertySetAsync=function(n,k){this.invokePropertySet(n,k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};b.prototype.invokeMethod=function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokeMethodAsync=function(n,k){n=this.invokeMethod(n,k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)};D.global.Object.defineProperties(b.prototype,
{dataRange:{configurable:!0,enumerable:!0,get:function(){return this.rsc},set:function(n){this.rsc=n}},filePath:{configurable:!0,enumerable:!0,get:function(){return this.Auc},set:function(n){this.Auc=n}},isTable:{configurable:!0,enumerable:!0,get:function(){return this.qJa},set:function(n){this.qJa=n}},tableOrSheetName:{configurable:!0,enumerable:!0,get:function(){return this.XJc},set:function(n){this.XJc=n}}});Object(C.a)(b,"ExcelConnection",null,[])},1105:function(C,H,e){function b(){this.nIa="";
this.h7a=0}e.d(H,"a",function(){return b});C=e(0);b.prototype.getTypeName=function(){return"Microsoft.Visio.Highlight"};b.prototype.invokePropertyGet=function(n){switch(n){case 2:return this.color;case 1:return this.width}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokePropertyGetAsync=function(n){n=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)};b.prototype.invokePropertySet=function(n,k){switch(n){case 2:this.color=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"string");return;case 1:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokePropertySetAsync=function(n,k){this.invokePropertySet(n,k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};b.prototype.invokeMethod=function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);
};b.prototype.invokeMethodAsync=function(n,k){n=this.invokeMethod(n,k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)};D.global.Object.defineProperties(b.prototype,{color:{configurable:!0,enumerable:!0,get:function(){return this.nIa},set:function(n){this.nIa=n}},width:{configurable:!0,enumerable:!0,get:function(){return this.h7a},set:function(n){this.h7a=n}}});Object(C.a)(b,"Highlight",null,[])},1106:function(C,H,e){function b(m){this._connectorBinding=this.Jzb=null;this.AHb=
0;this._shapeBinding=null;m&&(void 0!==m.cffBinding&&null!==m.cffBinding&&(this.Jzb=new k.a(m.cffBinding)),this._connectorBinding=new n.a(m.connectorBinding),this._shapeBinding=new r.a(m.shapeBinding),this.AHb=m.layout)}e.d(H,"a",function(){return b});C=e(0);var n=e(1101),k=e(1125),r=e(1103);b.prototype.getTypeName=function(){return"Microsoft.Visio.DataVisualizerMappings"};b.prototype.invokePropertyGet=function(m){switch(m){case 3:return this.cffBinding;case 2:return this.connectorBinding;case 4:return this.layout;
case 1:return this.shapeBinding}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);};b.prototype.invokePropertyGetAsync=function(m){m=this.invokePropertyGet(m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(m)};b.prototype.invokePropertySet=function(m,w){switch(m){case 3:this.cffBinding=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(w,0,k.a);return;case 2:this.connectorBinding=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(w,0,n.a);return;
case 4:this.layout=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(w,0,"int");return;case 1:this.shapeBinding=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(w,0,r.a);return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);};b.prototype.invokePropertySetAsync=function(m,w){this.invokePropertySet(m,w);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};b.prototype.invokeMethod=function(m){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);
};b.prototype.invokeMethodAsync=function(m,w){m=this.invokeMethod(m,w);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(m)};D.global.Object.defineProperties(b.prototype,{cffBinding:{configurable:!0,enumerable:!0,get:function(){return this.Jzb},set:function(m){this.Jzb=m}},connectorBinding:{configurable:!0,enumerable:!0,get:function(){return this._connectorBinding},set:function(m){this._connectorBinding=m}},layout:{configurable:!0,enumerable:!0,get:function(){return this.AHb},set:function(m){this.AHb=
m}},shapeBinding:{configurable:!0,enumerable:!0,get:function(){return this._shapeBinding},set:function(m){this._shapeBinding=m}}});Object(C.a)(b,"DataVisualizerMappings",null,[])},1107:function(C){function H(){}function e(m,w,v){this.fn=m;this.context=w;this.once=v||!1}function b(m,w,v,x,A){if("function"!==typeof v)throw new TypeError("The listener must be a function");v=new e(v,x||m,A);w=r?r+w:w;m.ja[w]?m.ja[w].fn?m.ja[w]=[m.ja[w],v]:m.ja[w].push(v):(m.ja[w]=v,m.GO++);return m}function n(m,w){0===
--m.GO?m.ja=new H:delete m.ja[w]}function k(){this.ja=new H;this.GO=0}var r="~";Object.create&&(H.prototype=Object.create(null),(new H).__proto__||(r=!1));k.prototype.listeners=function(m){m=this.ja[r?r+m:m];if(!m)return[];if(m.fn)return[m.fn];for(var w=0,v=m.length,x=Array(v);w<v;w++)x[w]=m[w].fn;return x};k.prototype.emit=function(m,w,v,x,A,B){var E=r?r+m:m;if(!this.ja[E])return!1;E=this.ja[E];var L=arguments.length,S;if(E.fn){E.once&&this.removeListener(m,E.fn,void 0,!0);switch(L){case 1:return E.fn.call(E.context),
!0;case 2:return E.fn.call(E.context,w),!0;case 3:return E.fn.call(E.context,w,v),!0;case 4:return E.fn.call(E.context,w,v,x),!0;case 5:return E.fn.call(E.context,w,v,x,A),!0;case 6:return E.fn.call(E.context,w,v,x,A,B),!0}var J=1;for(S=Array(L-1);J<L;J++)S[J-1]=arguments[J];E.fn.apply(E.context,S)}else{var Q=E.length;for(J=0;J<Q;J++)switch(E[J].once&&this.removeListener(m,E[J].fn,void 0,!0),L){case 1:E[J].fn.call(E[J].context);break;case 2:E[J].fn.call(E[J].context,w);break;case 3:E[J].fn.call(E[J].context,
w,v);break;case 4:E[J].fn.call(E[J].context,w,v,x);break;default:if(!S){var R=1;for(S=Array(L-1);R<L;R++)S[R-1]=arguments[R]}E[J].fn.apply(E[J].context,S)}}return!0};k.prototype.on=function(m,w,v){return b(this,m,w,v,!1)};k.prototype.once=function(m,w,v){return b(this,m,w,v,!0)};k.prototype.removeListener=function(m,w,v,x){m=r?r+m:m;if(!this.ja[m])return this;if(!w)return n(this,m),this;var A=this.ja[m];if(A.fn)A.fn!==w||x&&!A.once||v&&A.context!==v||n(this,m);else{for(var B=0,E=[],L=A.length;B<L;B++)(A[B].fn!==
w||x&&!A[B].once||v&&A[B].context!==v)&&E.push(A[B]);E.length?this.ja[m]=1===E.length?E[0]:E:n(this,m)}return this};k.prototype.mqb=function(m){m?(m=r?r+m:m,this.ja[m]&&n(this,m)):(this.ja=new H,this.GO=0);return this};k.prototype.off=k.prototype.removeListener;k.prototype.addListener=k.prototype.on;k.yEa=k;C.exports=k;Object.defineProperty(C.exports,"EventEmitter",{enumerable:!0,get:function(){return C.exports.yEa}})},1112:function(C,H,e){function b(){}e.d(H,"a",function(){return b});C=e(0);Object(C.a)(b,
"CreateDVCommandData",null,[])},1113:function(C,H,e){function b(n,k){this._columnValue=null;this.rowNo=0;void 0!==n&&null!==n&&void 0!==k&&null!==k&&(this.rowNo=n,this._columnValue=k)}e.d(H,"a",function(){return b});C=e(0);b.prototype.getTypeName=function(){return"Microsoft.Visio.DataErrorRecord"};b.prototype.invokePropertyGet=function(n){switch(n){case 2:return this.columnValue;case 1:return this.rowNumber}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokePropertyGetAsync=
function(n){n=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)};b.prototype.invokePropertySet=function(n,k){switch(n){case 2:this.columnValue=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"string");return;case 1:this.rowNumber=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokePropertySetAsync=function(n,k){this.invokePropertySet(n,
k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};b.prototype.invokeMethod=function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokeMethodAsync=function(n,k){n=this.invokeMethod(n,k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)};D.global.Object.defineProperties(b.prototype,{columnValue:{configurable:!0,enumerable:!0,get:function(){return this._columnValue},set:function(n){this._columnValue=n}},rowNumber:{configurable:!0,
enumerable:!0,get:function(){return this.rowNo},set:function(n){this.rowNo=n}}});Object(C.a)(b,"DataErrorRecord",null,[])},1114:function(C,H,e){function b(n,k,r,m,w){this._recordList=this._secondaryColumnName=this._primaryColumnName=this._description=null;this._type=0;void 0!==n&&null!==n&&(this._description=n);void 0!==k&&null!==k&&(this._primaryColumnName=k);void 0!==r&&null!==r&&(this._secondaryColumnName=r);void 0!==m&&null!==m&&(this._recordList=m);n=w+1;void 0!==n&&null!==n&&(this._type=n)}
e.d(H,"a",function(){return b});C=e(0);b.prototype.getTypeName=function(){return"Microsoft.Visio.DataValidationError"};b.prototype.invokePropertyGet=function(n){switch(n){case 2:return this.description;case 3:return this.primaryColumnName;case 5:return this.recordList;case 4:return this.secondaryColumnName;case 1:return this.type}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokePropertyGetAsync=function(n){n=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)};
b.prototype.invokePropertySet=function(n,k){switch(n){case 2:this.description=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"string");return;case 3:this.primaryColumnName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"string");return;case 5:this.recordList=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"Array<Visio.Extension.DataErrorRecord>");return;case 4:this.secondaryColumnName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"string");
return;case 1:this.type=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokePropertySetAsync=function(n,k){this.invokePropertySet(n,k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};b.prototype.invokeMethod=function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokeMethodAsync=function(n,k){n=this.invokeMethod(n,k);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)};D.global.Object.defineProperties(b.prototype,{description:{configurable:!0,enumerable:!0,get:function(){return this._description},set:function(n){this._description=n}},primaryColumnName:{configurable:!0,enumerable:!0,get:function(){return this._primaryColumnName},set:function(n){this._primaryColumnName=n}},recordList:{configurable:!0,enumerable:!0,get:function(){return this._recordList},set:function(n){this._recordList=n}},secondaryColumnName:{configurable:!0,
enumerable:!0,get:function(){return this._secondaryColumnName},set:function(n){this._secondaryColumnName=n}},type:{configurable:!0,enumerable:!0,get:function(){return this._type},set:function(n){this._type=n}}});Object(C.a)(b,"DataValidationError",null,[])},1115:function(C,H,e){function b(){this.iAc=0;this.Qvc=this.vP=this.ML=this.wx=this.toa=!1}e.d(H,"a",function(){return b});C=e(0);b.prototype.getTypeName=function(){return"Microsoft.Visio.FocusRegionChangeKey"};b.prototype.invokePropertyGet=function(n){switch(n){case 2:return this.altKey;
case 3:return this.ctrlKey;case 6:return this.handleAltGr;case 1:return this.keyCode;case 5:return this.metaKey;case 4:return this.shiftKey}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokePropertyGetAsync=function(n){n=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)};b.prototype.invokePropertySet=function(n,k){switch(n){case 2:this.altKey=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"boolean");
return;case 3:this.ctrlKey=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"boolean");return;case 6:this.handleAltGr=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"boolean");return;case 1:this.keyCode=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"int");return;case 5:this.metaKey=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"boolean");return;case 4:this.shiftKey=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"boolean");
return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokePropertySetAsync=function(n,k){this.invokePropertySet(n,k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};b.prototype.invokeMethod=function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokeMethodAsync=function(n,k){n=this.invokeMethod(n,k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)};D.global.Object.defineProperties(b.prototype,
{altKey:{configurable:!0,enumerable:!0,get:function(){return this.toa},set:function(n){this.toa=n}},ctrlKey:{configurable:!0,enumerable:!0,get:function(){return this.wx},set:function(n){this.wx=n}},handleAltGr:{configurable:!0,enumerable:!0,get:function(){return this.Qvc},set:function(n){this.Qvc=n}},keyCode:{configurable:!0,enumerable:!0,get:function(){return this.iAc},set:function(n){this.iAc=n}},metaKey:{configurable:!0,enumerable:!0,get:function(){return this.vP},set:function(n){this.vP=n}},shiftKey:{configurable:!0,
enumerable:!0,get:function(){return this.ML},set:function(n){this.ML=n}}});Object(C.a)(b,"FocusRegionChangeKey",null,[])},1116:function(C,H,e){function b(){this.Ooc=this.Noc=this.Moc=null}e.d(H,"a",function(){return b});C=e(0);b.prototype.getTypeName=function(){return"Microsoft.Visio.DGMapping"};b.prototype.invokePropertyGet=function(n){switch(n){case 1:return this.cbvMapping;case 2:return this.cbvRangeList;case 3:return this.iconSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);
};b.prototype.invokePropertyGetAsync=function(n){n=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)};b.prototype.invokePropertySet=function(n,k){switch(n){case 1:this.cbvMapping=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"Array<Visio.Extension.CBVData>");return;case 2:this.cbvRangeList=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"Array<Visio.Extension.CBVRange>");return;case 3:this.iconSettings=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,
0,"Array<Visio.Extension.DGIconSetting>");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokePropertySetAsync=function(n,k){this.invokePropertySet(n,k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};b.prototype.invokeMethod=function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokeMethodAsync=function(n,k){n=this.invokeMethod(n,k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)};
D.global.Object.defineProperties(b.prototype,{cbvMapping:{configurable:!0,enumerable:!0,get:function(){return this.Moc},set:function(n){this.Moc=n}},cbvRangeList:{configurable:!0,enumerable:!0,get:function(){return this.Noc},set:function(n){this.Noc=n}},iconSettings:{configurable:!0,enumerable:!0,get:function(){return this.Ooc},set:function(n){this.Ooc=n}}});Object(C.a)(b,"DGMapping",null,[])},1117:function(C,H,e){function b(){this._phaseColumn=null;this._phaseOrdered=!1;this._swimlaneColumn=null;
this._swimlaneOrdered=!1}e.d(H,"a",function(){return b});C=e(0);b.prototype.getTypeName=function(){return"Microsoft.Visio.CFFBinding"};b.prototype.invokePropertyGet=function(n){switch(n){case 2:return this.phaseColumn;case 4:return this.phaseOrdered;case 1:return this.swimlaneColumn;case 3:return this.swimlaneOrdered}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokePropertyGetAsync=function(n){n=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)};
b.prototype.invokePropertySet=function(n,k){switch(n){case 2:this.phaseColumn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"string");return;case 4:this.phaseOrdered=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"boolean");return;case 1:this.swimlaneColumn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"string");return;case 3:this.swimlaneOrdered=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);
};b.prototype.invokePropertySetAsync=function(n,k){this.invokePropertySet(n,k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};b.prototype.invokeMethod=function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokeMethodAsync=function(n,k){n=this.invokeMethod(n,k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)};D.global.Object.defineProperties(b.prototype,{phaseColumn:{configurable:!0,enumerable:!0,get:function(){return this._phaseColumn},
set:function(n){this._phaseColumn=n}},phaseOrdered:{configurable:!0,enumerable:!0,get:function(){return this._phaseOrdered},set:function(n){this._phaseOrdered=n}},swimlaneColumn:{configurable:!0,enumerable:!0,get:function(){return this._swimlaneColumn},set:function(n){this._swimlaneColumn=n}},swimlaneOrdered:{configurable:!0,enumerable:!0,get:function(){return this._swimlaneOrdered},set:function(n){this._swimlaneOrdered=n}}});Object(C.a)(b,"CFFBinding",null,[])},1118:function(C,H,e){function b(n){this._value=
this.h0=this.ZZ=null;n&&(this._value=n.sof,this.h0=n.stencilName,this.ZZ=n.MUa)}e.d(H,"a",function(){return b});C=e(0);b.prototype.getTypeName=function(){return"Microsoft.Visio.MasterValueMap"};b.prototype.invokePropertyGet=function(n){switch(n){case 3:return this.masterNameU;case 2:return this.stencilName;case 1:return this.value}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokePropertyGetAsync=function(n){n=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)};
b.prototype.invokePropertySet=function(n,k){switch(n){case 3:this.masterNameU=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"string");return;case 2:this.stencilName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"string");return;case 1:this.value=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokePropertySetAsync=function(n,k){this.invokePropertySet(n,
k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};b.prototype.invokeMethod=function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokeMethodAsync=function(n,k){n=this.invokeMethod(n,k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)};D.global.Object.defineProperties(b.prototype,{masterNameU:{configurable:!0,enumerable:!0,get:function(){return this.ZZ},set:function(n){this.ZZ=n}},stencilName:{configurable:!0,
enumerable:!0,get:function(){return this.h0},set:function(n){this.h0=n}},value:{configurable:!0,enumerable:!0,get:function(){return this._value},set:function(n){this._value=n}}});Object(C.a)(b,"MasterValueMap",null,[])},1119:function(C,H,e){function b(){this._masterMappings=this._defaultMasterStencil=this._defaultMaster=null}e.d(H,"a",function(){return b});C=e(0);b.prototype.getTypeName=function(){return"Microsoft.Visio.MasterSelector"};b.prototype.invokePropertyGet=function(n){switch(n){case 1:return this.defaultMaster;
case 3:return this.defaultMasterStencil;case 2:return this.masterMappings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokePropertyGetAsync=function(n){n=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)};b.prototype.invokePropertySet=function(n,k){switch(n){case 1:this.defaultMaster=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"string");return;case 3:this.defaultMasterStencil=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,
0,"string");return;case 2:this.masterMappings=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"Array<Visio.Extension.MasterValuePair>");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokePropertySetAsync=function(n,k){this.invokePropertySet(n,k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};b.prototype.invokeMethod=function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokeMethodAsync=
function(n,k){n=this.invokeMethod(n,k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)};D.global.Object.defineProperties(b.prototype,{defaultMaster:{configurable:!0,enumerable:!0,get:function(){return this._defaultMaster},set:function(n){this._defaultMaster=n}},defaultMasterStencil:{configurable:!0,enumerable:!0,get:function(){return this._defaultMasterStencil},set:function(n){this._defaultMasterStencil=n}},masterMappings:{configurable:!0,enumerable:!0,get:function(){return this._masterMappings},
set:function(n){this._masterMappings=n}}});Object(C.a)(b,"MasterSelector",null,[])},1120:function(C,H,e){function b(){this.TC=new n.a;this.Zj=new n.a;this.ezb=new n.a;this.FAb=new n.a;this.sKb=new n.a;this.$zb=new n.a;this.L1a=new n.a;this.iea=k.a.instance.resolve("VisioWeb.IVisioFeatureHelper")}e.d(H,"a",function(){return b});C=e(0);var n=e(805),k=e(36),r=e(1078),m=e(1085),w=e(1121);b.prototype.getAddonAutoConnectionFeatureData=function(v,x){x=void 0===x?null:x;return r.Application.getBRS("VisioWebEnableQuickShapePlusButtonInMindmap",
!1)&&this.L1a.pb(v)?this.L1a.ia(v)(x):this.ezb.ia(v)};b.prototype.getAddonQuickShapeTrayViewData=function(v){return this.sKb.ia(v)};b.prototype.getAddonConnectionNodeViewData=function(v){return this.FAb.ia(v)};b.prototype.getAddonChangeShapeTrayViewData=function(v){return this.$zb.ia(v)};b.prototype.overrideAutoConnectionNodeForAddonViaCallback=function(v,x){r.Application.sendTraceTag(508074122,50,"VisioAddonFeatureManager - OverrideAutoConnectionNodeForAddonViaCallback Called for addon : {0}",v);
this.Zj.count&&this.Zj.ia(v)||this.Zj.U(v,[]);Array.contains(this.Zj.ia(v),5)||(Array.add(this.Zj.ia(v),5),this.L1a.add(v,null));this.L1a.U(v,x)};b.prototype.overrideAutoConnectionNodeViewFeatureForAddon=function(v,x){r.Application.sendTraceTag(509617160,50,"VisioAddonFeatureManager - OverrideAutoConnectionNodeViewFeatureForAddon Called for addon : {0}",v);this.Zj.count&&this.Zj.ia(v)||this.Zj.U(v,[]);Array.contains(this.Zj.ia(v),5)||(Array.add(this.Zj.ia(v),5),this.ezb.add(v,null));this.ezb.U(v,
x)};b.prototype.overrideRMAOptionsFeatureForAddon=function(v){r.Application.sendTraceTag(508683780,50,"VisioAddonFeatureManager - overrideRMAOptionsFeatureForAddon Called for addon : {0}",v);this.Zj.count&&this.Zj.ia(v)||this.Zj.U(v,[]);Array.contains(this.Zj.ia(v),17)||Array.add(this.Zj.ia(v),17)};b.prototype.overrideQuickShapeTrayViewForAddon=function(v,x){r.Application.sendTraceTag(509617159,50,"VisioAddonFeatureManager - OverrideQuickShapeTrayViewForAddon Called for addon : {0}",v);this.Zj.count&&
this.Zj.ia(v)||this.Zj.U(v,[]);Array.contains(this.Zj.ia(v),6)||(Array.add(this.Zj.ia(v),6),this.sKb.add(v,null));this.sKb.U(v,x)};b.prototype.overrideConnectionNodeViewFeatureForAddon=function(v,x){r.Application.sendTraceTag(509617158,50,"VisioAddonFeatureManager - OverrideConnectionNodeViewFeatureForAddon Called for addon : {0}",v);this.TC&&this.TC.pb(v)&&Array.contains(this.TC.ia(v),2)?r.Application.sendTraceTag(509617157,15,"VisioAddonFeatureManager - OverrideConnectionNodeViewFeatureForAddon Called after disabling the feature for addon : {0}",
v):(this.Zj.count&&this.Zj.ia(v)||this.Zj.U(v,[]),Array.contains(this.Zj.ia(v),2)||(Array.add(this.Zj.ia(v),2),this.FAb.add(v,null)),this.FAb.U(v,x))};b.prototype.overrideChangeShapeMasters=function(v,x){r.Application.sendTraceTag(508601474,50,"VisioAddonFeatureManager - OverrideChangeShapeMasters Called for addon : {0}",v);this.Zj.count&&this.Zj.ia(v)||this.Zj.U(v,[]);Array.contains(this.Zj.ia(v),20)||(Array.add(this.Zj.ia(v),20),this.$zb.add(v,null));this.$zb.U(v,x)};b.prototype.addDisableFeatureListForAddon=
function(v,x){if(void 0===v||null===v)throw Error.argumentNull("shape category is null");if(void 0===x||null===x)throw Error.argumentNull("feature list is null");if(r.Application.getBRS("VisioWebSolutionLoadExperienceImprovementEnabled",!1)){x=D.makeIterator(x);for(var A=x.next();!A.done;A=x.next())this.disableFeature(v,A.value)}else this.TC.add(v,x)};b.prototype.addEnableFeatureListForAddon=function(v,x){if(void 0===v||null===v)throw Error.argumentNull("shape category is null");if(void 0===x||null===
x)throw Error.argumentNull("feature list is null");x=D.makeIterator(x);for(var A=x.next();!A.done;A=x.next())this.enableFeature(v,A.value)};b.prototype.isFeatureDisabled=function(v,x){if(void 0===v||null===v)throw Error.argumentNull("shape category is null");if(void 0===x||null===x)throw Error.argumentNull("feature is null");return 0<this.TC.keys.toArray().length&&this.TC.pb(v)&&Array.contains(this.TC.ia(v),x)?!0:!1};b.prototype.isFeatureDisabledForDocument=function(v){if(void 0===v||null===v)throw Error.argumentNull("feature is null");
for(var x=0;x<this.TC.keys.length;x++){var A=this.TC.keys.ia(x);if(Array.contains(this.TC.ia(A),v))return!0}return!1};b.prototype.isFeatureOverriden=function(v,x){if(void 0===v||null===v)throw Error.argumentNull("shape category is null");if(void 0===x||null===x)throw Error.argumentNull("feature is null");return this.Zj&&this.Zj.pb(v)&&0<this.Zj.keys.toArray().length&&Array.contains(this.Zj.ia(v),x)?!0:!1};b.prototype.$V=function(v){for(var x=D.makeIterator(w.a.Hee),A=x.next();!A.done;A=x.next())if(A=
A.value,Array.contains(v,A))return A;return w.a.none};b.prototype.enableFeature=function(v,x){switch(x){case 4:m.a.downloadLayoutJsFiles(v);break;default:this.isFeatureDisabled(v,x)?Array.remove(this.TC.ia(v),x):r.Application.sendTraceTag(509617161,15,"{0} Feature is already enabled for {1} addon and it can't be enabled",x,v)}};b.prototype.disableFeature=function(v,x){if(this.TC.pb(v))this.TC.ia(v).includes(x)||Array.add(this.TC.ia(v),x);else{var A=[];Array.add(A,x);this.TC.add(v,A)}};b.prototype.V9=
function(v){return this.iea.V9(v)};b.prototype.dispose=function(){};D.global.Object.defineProperties(b,{instance:{configurable:!0,enumerable:!0,get:function(){b._instance||(b._instance=new b);return b._instance}}});b._instance=null;Object(C.a)(b,"VisioAddonFeatureManager",null,[397,8])},1121:function(C,H,e){function b(){}e.d(H,"a",function(){return b});C=e(0);b.Hee=["MindMap","OrgChart"];b.none="None";Object(C.a)(b,"VisioAddonManagerConstants",null,[])},1122:function(C,H,e){function b(m,w){w=void 0===
w?!1:w;this.$l=this.Zl=this._height=this._width=0;if(this.Ma=m)m=k.b(this.Ma).boundingBox,r.Application.getBRS("VisioWebExtensionShapeAbsoluteBoundsEnabled",!1)&&w&&(m.width=m.width*r.Application.gW().rv/100,m.height=m.height*r.Application.gW().rv/100,m.startX=m.startX*r.Application.gW().rv/100,m.startY=m.startY*r.Application.gW().rv/100),this._width=m.width,this._height=m.height,this.Zl=m.startX,this.$l=m.startY,w=this.Ma.ta.properties,w=w.ng/w.gg,this._width*=w,this._height*=w,this.Zl*=w,this.$l*=
w}e.d(H,"a",function(){return b});C=e(0);var n=e(1089),k=e(202),r=e(1078);b.prototype.getTypeName=function(){return"Microsoft.Visio.BoundingBox"};b.prototype.invokePropertyGet=function(m){switch(m){case 2:return this.height;case 1:return this.width;case 3:return this.x;case 4:return this.y}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);};b.prototype.invokePropertyGetAsync=function(m){m=this.invokePropertyGet(m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(m)};
b.prototype.invokePropertySet=function(m,w){switch(m){case 2:this.height=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(w,0,"int");return;case 1:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(w,0,"int");return;case 3:this.x=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(w,0,"int");return;case 4:this.y=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(w,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);};b.prototype.invokePropertySetAsync=
function(m,w){this.invokePropertySet(m,w);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};b.prototype.invokeMethod=function(m){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);};b.prototype.invokeMethodAsync=function(m,w){m=this.invokeMethod(m,w);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(m)};D.global.Object.defineProperties(b.prototype,{height:{configurable:!0,enumerable:!0,get:function(){return Math.round(this._height*n.a.pixelsPerInch)},
set:function(m){isNaN(m)||(this._height=m/n.a.pixelsPerInch)}},width:{configurable:!0,enumerable:!0,get:function(){return Math.round(this._width*n.a.pixelsPerInch)},set:function(m){isNaN(m)||(this._width=m/n.a.pixelsPerInch)}},x:{configurable:!0,enumerable:!0,get:function(){return Math.round(this.Zl*n.a.pixelsPerInch)},set:function(m){isNaN(m)||(this.Zl=m/n.a.pixelsPerInch)}},y:{configurable:!0,enumerable:!0,get:function(){return Math.round(this.$l*n.a.pixelsPerInch)},set:function(m){isNaN(m)||(this.$l=
m/n.a.pixelsPerInch)}},xInInches:{configurable:!0,enumerable:!0,get:function(){return this.Zl}},yInInches:{configurable:!0,enumerable:!0,get:function(){return this.$l}},heightInInches:{configurable:!0,enumerable:!0,get:function(){return this._height}},widthInInches:{configurable:!0,enumerable:!0,get:function(){return this._width}}});Object(C.a)(b,"BoundingBox",null,[])},1123:function(C,H,e){function b(n,k){this.Zl=n;this.$l=k}e.d(H,"a",function(){return b});C=e(0);b.prototype.getTypeName=function(){return"Microsoft.Visio.Position"};
b.prototype.invokePropertyGet=function(n){switch(n){case 1:return this.x;case 2:return this.y}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokePropertyGetAsync=function(n){n=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)};b.prototype.invokePropertySet=function(n,k){switch(n){case 1:this.x=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"int");return;case 2:this.y=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,
0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokePropertySetAsync=function(n,k){this.invokePropertySet(n,k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};b.prototype.invokeMethod=function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokeMethodAsync=function(n,k){n=this.invokeMethod(n,k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)};D.global.Object.defineProperties(b.prototype,
{x:{configurable:!0,enumerable:!0,get:function(){return this.Zl},set:function(n){this.Zl=n}},y:{configurable:!0,enumerable:!0,get:function(){return this.$l},set:function(n){this.$l=n}}});Object(C.a)(b,"Position",null,[])},1124:function(C,H,e){function b(n,k){n=void 0===n?0:n;k=void 0===k?0:k;this.y=this.x=0;this.x=void 0===n||null===n?0:n;this.y=void 0===k||null===k?0:k}e.d(H,"a",function(){return b});C=e(0);Object(C.a)(b,"Location",null,[])},1125:function(C,H,e){function b(n){this.gJb=this.fJb=!1;
this.l_=0;this.vNb=this.UJb=null;n&&(this.gJb=n.uyf,this.fJb=n.tyf,this.l_=n.orientation,this.UJb=n.phaseColumnName,this.vNb=n.swimlaneColumnName)}e.d(H,"a",function(){return b});C=e(0);b.prototype.getTypeName=function(){return"Microsoft.Visio.CrossFunctionalFlowchartBinding"};b.prototype.invokePropertyGet=function(n){switch(n){case 1:return this.orientation;case 3:return this.phaseColumnName;case 5:return this.preservePhaseOrder;case 4:return this.preserveSwimlaneOrder;case 2:return this.swimlaneColumnName}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);
};b.prototype.invokePropertyGetAsync=function(n){n=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)};b.prototype.invokePropertySet=function(n,k){switch(n){case 1:this.orientation=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"int");return;case 3:this.phaseColumnName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"string");return;case 5:this.preservePhaseOrder=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,
"boolean");return;case 4:this.preserveSwimlaneOrder=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"boolean");return;case 2:this.swimlaneColumnName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokePropertySetAsync=function(n,k){this.invokePropertySet(n,k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};b.prototype.invokeMethod=function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);
};b.prototype.invokeMethodAsync=function(n,k){n=this.invokeMethod(n,k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)};D.global.Object.defineProperties(b.prototype,{orientation:{configurable:!0,enumerable:!0,get:function(){return this.l_},set:function(n){this.l_=n}},phaseColumnName:{configurable:!0,enumerable:!0,get:function(){return this.UJb},set:function(n){this.UJb=n}},preservePhaseOrder:{configurable:!0,enumerable:!0,get:function(){return this.fJb},set:function(n){this.fJb=
n}},preserveSwimlaneOrder:{configurable:!0,enumerable:!0,get:function(){return this.gJb},set:function(n){this.gJb=n}},swimlaneColumnName:{configurable:!0,enumerable:!0,get:function(){return this.vNb},set:function(n){this.vNb=n}}});Object(C.a)(b,"CrossFunctionalFlowchartBinding",null,[])},1126:function(C,H,e){function b(){this.qJa=!1;this.$Ic=this.ZIc=null;this.aJc=0}e.d(H,"a",function(){return b});C=e(0);b.prototype.getTypeName=function(){return"Microsoft.Visio.ConnectionInfo"};b.prototype.invokePropertyGet=
function(n){switch(n){case 3:return this.isTabularData;case 4:return this.sourceName;case 2:return this.sourcePath;case 1:return this.sourceType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokePropertyGetAsync=function(n){n=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)};b.prototype.invokePropertySet=function(n,k){switch(n){case 3:this.isTabularData=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,
0,"boolean");return;case 4:this.sourceName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"string");return;case 2:this.sourcePath=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"string");return;case 1:this.sourceType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokePropertySetAsync=function(n,k){this.invokePropertySet(n,k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
b.prototype.invokeMethod=function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokeMethodAsync=function(n,k){n=this.invokeMethod(n,k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)};D.global.Object.defineProperties(b.prototype,{isTabularData:{configurable:!0,enumerable:!0,get:function(){return this.qJa},set:function(n){this.qJa=n}},sourceName:{configurable:!0,enumerable:!0,get:function(){return this.ZIc},set:function(n){this.ZIc=n}},
sourcePath:{configurable:!0,enumerable:!0,get:function(){return this.$Ic},set:function(n){this.$Ic=n}},sourceType:{configurable:!0,enumerable:!0,get:function(){return this.aJc},set:function(n){this.aJc=n}}});Object(C.a)(b,"ConnectionInfo",null,[])},1127:function(C,H,e){function b(){this.Ida=0;this.h0=this.ZZ=this._mappings=null}e.d(H,"a",function(){return b});C=e(0);var n=e(1106);b.prototype.getTypeName=function(){return"Microsoft.Visio.DataVisualizerSettings"};b.prototype.invokePropertyGet=function(k){switch(k){case 3:return this.diagramType;
case 4:return this.mappings;case 2:return this.masterNameU;case 1:return this.stencilName}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(k);};b.prototype.invokePropertyGetAsync=function(k){k=this.invokePropertyGet(k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(k)};b.prototype.invokePropertySet=function(k,r){switch(k){case 3:this.diagramType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,0,"int");return;case 4:this.mappings=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,
0,n.a);return;case 2:this.masterNameU=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,0,"string");return;case 1:this.stencilName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(r,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(k);};b.prototype.invokePropertySetAsync=function(k,r){this.invokePropertySet(k,r);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};b.prototype.invokeMethod=function(k){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(k);
};b.prototype.invokeMethodAsync=function(k,r){k=this.invokeMethod(k,r);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(k)};D.global.Object.defineProperties(b.prototype,{diagramType:{configurable:!0,enumerable:!0,get:function(){return this.Ida},set:function(k){this.Ida=k}},mappings:{configurable:!0,enumerable:!0,get:function(){return this._mappings},set:function(k){this._mappings=k}},masterNameU:{configurable:!0,enumerable:!0,get:function(){return this.ZZ},set:function(k){this.ZZ=
k}},stencilName:{configurable:!0,enumerable:!0,get:function(){return this.h0},set:function(k){this.h0=k}}});Object(C.a)(b,"DataVisualizerSettings",null,[])},1128:function(C,H,e){function b(){}e.d(H,"a",function(){return b});C=e(0);var n=e(1129);b.prototype.createMindmapVirtualNodeDetails=function(k,r,m,w,v,x){var A=new n.a;A.shapeWidth=m;A.shapeHeight=w;A.addedNodeDirection=k;A.beginShapeId=r;A.id=v;A.endShapeId=x;return A};b.prototype.createOrgChartVirtualNodeDetails=function(k,r,m,w,v){var x=new n.a;
x.shapeWidth=k;x.shapeHeight=r;x.beginShapeId=m;x.id=w;x.endShapeId=v;return x};D.global.Object.defineProperties(b,{instance:{configurable:!0,enumerable:!0,get:function(){b._instance||(b._instance=new b);return b._instance}}});b._instance=null;Object(C.a)(b,"VirtualNodeDetailsFactory",null,[400])},1129:function(C,H,e){function b(){this.newShapeHeight=this.newShapeWidth=0;this.fNodeAddedOnRightSide=!1;this.aqa=this.Joa=null;this.verticalOrderID=-1;this._id=null;this.Gpd=this.Fpd=Number.NaN}e.d(H,"a",
function(){return b});C=e(0);b.prototype.isShapeNode=function(){return(void 0===this.beginShapeId||null===this.beginShapeId)&&(void 0===this.endShapeId||null===this.endShapeId)||""===this.beginShapeId&&""===this.endShapeId};b.prototype.isConnectorNode=function(){return!(void 0===this.beginShapeId||null===this.beginShapeId)&&!(void 0===this.endShapeId||null===this.endShapeId)&&""!==this.beginShapeId&&""!==this.endShapeId};D.global.Object.defineProperties(b.prototype,{shapeWidth:{configurable:!0,enumerable:!0,
get:function(){return this.newShapeWidth},set:function(n){this.newShapeWidth=n}},shapeHeight:{configurable:!0,enumerable:!0,get:function(){return this.newShapeHeight},set:function(n){this.newShapeHeight=n}},addedNodeDirection:{configurable:!0,enumerable:!0,get:function(){return this.fNodeAddedOnRightSide},set:function(n){this.fNodeAddedOnRightSide=n}},beginShapeId:{configurable:!0,enumerable:!0,get:function(){return this.Joa},set:function(n){this.Joa=n}},endShapeId:{configurable:!0,enumerable:!0,
get:function(){return this.aqa},set:function(n){this.aqa=n}},getVerticalOrderID:{configurable:!0,enumerable:!0,get:function(){return this.verticalOrderID}},id:{configurable:!0,enumerable:!0,get:function(){return this._id},set:function(n){this._id=n}},pinX:{configurable:!0,enumerable:!0,get:function(){return this.Fpd},set:function(n){this.Fpd=n}},pinY:{configurable:!0,enumerable:!0,get:function(){return this.Gpd},set:function(n){this.Gpd=n}}});Object(C.a)(b,"VirtualNodeDetails",null,[401])},1130:function(C,
H,e){(function(b){e.d(H,"a",function(){return n});var n=function(){return"undefined"!=typeof b&&b.B8e?function(){var k=b.B8e();return 1E3*k[0]+k[1]/1E6}:"undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return Date.now()}}()}).call(this,e(1131))},1131:function(C){function H(){throw Error("setTimeout has not been defined");}function e(){throw Error("clearTimeout has not been defined");}function b(S){if(v===setTimeout)return setTimeout(S,0);if((v===H||
!v)&&setTimeout)return v=setTimeout,setTimeout(S,0);try{return v(S,0)}catch(J){try{return v.call(null,S,0)}catch(Q){return v.call(this,S,0)}}}function n(S){if(x===clearTimeout)return clearTimeout(S);if((x===e||!x)&&clearTimeout)return x=clearTimeout,clearTimeout(S);try{return x(S)}catch(J){try{return x.call(null,S)}catch(Q){return x.call(this,S)}}}function k(){B&&E&&(B=!1,E.length?A=E.concat(A):L=-1,A.length&&r())}function r(){if(!B){var S=b(k);B=!0;for(var J=A.length;J;){E=A;for(A=[];++L<J;)E&&E[L].run();
L=-1;J=A.length}E=null;B=!1;n(S)}}function m(S,J){this.DNe=S;this.CRb=J}function w(){}C=C.exports={};try{var v="function"===typeof setTimeout?setTimeout:H}catch(S){v=H}try{var x="function"===typeof clearTimeout?clearTimeout:e}catch(S){x=e}var A=[],B=!1,E,L=-1;C.Tng=function(S){var J=Array(arguments.length-1);if(1<arguments.length)for(var Q=1;Q<arguments.length;Q++)J[Q-1]=arguments[Q];A.push(new m(S,J));1!==A.length||B||b(r)};m.prototype.run=function(){this.DNe.apply(null,this.CRb)};C.title="browser";
C.browser=!0;C.env={};C.tfg=[];C.version="";C.versions={};C.on=w;C.addListener=w;C.once=w;C.off=w;C.removeListener=w;C.mqb=w;C.emit=w;C.cwd=w;C.GCf=w;C.listeners=function(){return[]};C.zfg=function(){throw Error("process.binding is not supported");};C.igg=function(){return"/"};C.Gfg=function(){throw Error("process.chdir is not supported");};C.rqg=function(){return 0}},1132:function(C){C.exports=function n(e,b){if(e===b)return!0;if(e&&b&&"object"==typeof e&&"object"==typeof b){if(e.constructor!==b.constructor)return!1;
var k;if(Array.isArray(e)){var r=e.length;if(r!=b.length)return!1;for(k=r;0!==k--;)if(!n(e[k],b[k]))return!1;return!0}if(e.constructor===RegExp)return e.source===b.source&&e.flags===b.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===b.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===b.toString();var m=Object.keys(e);r=m.length;if(r!==Object.keys(b).length)return!1;for(k=r;0!==k--;)if(!Object.prototype.hasOwnProperty.call(b,m[k]))return!1;for(k=r;0!==k--;)if(r=
m[k],!n(e[r],b[r]))return!1;return!0}return e!==e&&b!==b}},1133:function(C,H,e){function b(){this.hCc=this._title=this._name=null}e.d(H,"a",function(){return b});C=e(0);b.prototype.getTypeName=function(){return"Microsoft.Visio.StencilInfo"};b.prototype.invokePropertyGet=function(n){switch(n){case 3:return this.mastersInfo;case 1:return this.name;case 2:return this.title}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokePropertyGetAsync=function(n){n=this.invokePropertyGet(n);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)};b.prototype.invokePropertySet=function(n,k){switch(n){case 3:this.mastersInfo=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"Array<Visio.Extension.MasterInfo>");return;case 1:this.name=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"string");return;case 2:this.title=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(k,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);
};b.prototype.invokePropertySetAsync=function(n,k){this.invokePropertySet(n,k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};b.prototype.invokeMethod=function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);};b.prototype.invokeMethodAsync=function(n,k){n=this.invokeMethod(n,k);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)};D.global.Object.defineProperties(b.prototype,{mastersInfo:{configurable:!0,enumerable:!0,get:function(){return this.hCc},
set:function(n){this.hCc=n}},name:{configurable:!0,enumerable:!0,get:function(){return this._name},set:function(n){this._name=n}},title:{configurable:!0,enumerable:!0,get:function(){return this._title},set:function(n){this._title=n}}});Object(C.a)(b,"StencilInfo",null,[])},1136:function(C,H,e){function b(Sa){Da.Application.Hl.commonViewEventRegistrar.remove_toggleUserActionOnView(Sa)}function n(Sa){function kb(zb,Fa){var Za=new I;Za.initEventChangeRecord(zb,Fa);Sa(Za)}Da.Application.Hl.commonViewEventRegistrar.add_toggleUserActionOnView(kb);
return kb}function k(Sa,kb){Da.Application.Hl.kf.pages.Ga(Sa).EXa(kb)}function r(Sa,kb){function zb(Fa){var Za=new W;Za.initEventChangeRecord(Fa);kb(Za)}Da.Application.Hl.kf.pages.Ga(Sa).O0(zb);return zb}function m(Sa,kb){Da.Application.Hl.kf.pages.Ga(Sa).CBa(kb)}function w(Sa,kb){function zb(Fa){var Za=new Z;Za.initEventChangeRecord(Fa);kb(Za)}Da.Application.Hl.kf.pages.Ga(Sa).rQ(zb);return zb}function v(Sa,kb){Da.Application.Hl.kf.pages.Ga(Sa).DBa(kb)}function x(Sa,kb){function zb(Fa){var Za=new Y;
Za.initEventChangeRecord(Sa,Fa);kb(Za)}Da.Application.Hl.kf.pages.Ga(Sa.id.toString()).iJ(zb);return zb}function A(Sa){Da.Application.bW().CXa(Sa)}function B(Sa){function kb(zb,Fa){zb=new ea;zb.initEventChangeRecord(Fa);Sa(zb)}Da.Application.bW().xB(kb);return kb}function E(Sa,kb){Da.Application.Hl.kf.pages.Ga(Sa).DXa(kb)}function L(Sa,kb){function zb(Fa){var Za=new na;Za.initEventChangeRecord(Fa);kb(Za)}Da.Application.Hl.kf.pages.Ga(Sa).dOa(zb);return zb}function S(Sa){Da.Application.Hl.kf.Mzd(Sa)}
function J(Sa){function kb(zb){var Fa=new za;Fa.initEventChangeRecord(e(1080).Document.S9(),zb);Sa(Fa)}Da.Application.Hl.kf.cQb(kb);return kb}function Q(Sa){Da.Application.Hl.kf.Nzd(Sa)}function R(Sa){function kb(zb){var Fa=new sa;Fa.initEventChangeRecord(e(1080).Document.S9(),zb);Sa(Fa)}Da.Application.Hl.kf.dQb(kb);return kb}function F(Sa){Da.Application.Hl.kf.Cqb(Sa)}function K(Sa){function kb(zb){var Fa=new ua;Fa.initEventChangeRecord(e(1080).Document.S9(),zb);Sa(Fa)}Da.Application.Hl.kf.cOa(kb);
return kb}function I(){this.gzc=this.lLc=!1}function Y(){this.nIc=null}function X(Sa,kb){var zb=kb.E$c(),Fa=[];if(zb)for(;zb.moveNext();){var Za=new ca(zb.current);Array.add(Fa,Za)}this.C4d=Fa;this.ma=Sa;this.ut=kb.relatedRevisionIds}function ca(Sa){this.fda=Sa.changeType;this.xq=new Ua.Shape(Sa.associatedShape);this.g3d=Sa.property;this.X1d=Sa.oldPropertyValue;this.K1d=Sa.newPropertyValue;this.PY=Sa.changeRecordType}function W(){this.$Hc=null}function P(Sa){Sa=Sa.Amc;var kb=[];if(Sa)for(;Sa.moveNext();){var zb=
new T(Sa.current);Array.add(kb,zb)}this.H4d=kb}function T(Sa){this.RIb=Sa.oldShapeId;this.xq=new Ua.Shape(Sa.associatedShape)}function Z(){this.kIc=null}function ia(Sa){var kb=Sa.eSa(),zb=[];if(kb)for(;kb.moveNext();)Array.add(zb,new Ua.Shape(kb.current.associatedShape));this.K4d=zb;this.ut=Sa.relatedRevisionIds}function na(){this.jIc=null}function ba(Sa){Sa=Sa.I0b();var kb=[];if(Sa)for(;Sa.moveNext();)Array.add(kb,new Ua.Shape(Sa.current.associatedShape));this.J4d=kb}function ea(){this.jHc=null}
function oa(Sa){this.Gyb=new Ua.Shape(Sa.anchorShape);this.Jd=[];if(Sa.selectedShapes)for(var kb=D.makeIterator(Sa.selectedShapes),zb=kb.next();!zb.done;zb=kb.next())Array.add(this.Jd,new Ua.Shape(zb.value));this.Of=[];if(Sa.addedShapes)for(kb=D.makeIterator(Sa.addedShapes),zb=kb.next();!zb.done;zb=kb.next())Array.add(this.Of,new Ua.Shape(zb.value));this.FKb=[];if(Sa.removedShapes)for(kb=D.makeIterator(Sa.removedShapes),zb=kb.next();!zb.done;zb=kb.next())Array.add(this.FKb,new Ua.Shape(zb.value));
this.kDb=Sa.firedByMergePipeline;this.oIb=Sa.modifiedDuringResponseApply;this.p4d=Sa.selectedUsingKeyboard}function sa(){this.CEc=null}function M(Sa,kb){this.tm=Sa.pages.a$(parseInt(kb.associatedPage.id))}function za(){this.zEc=null}function xa(Sa,kb){this.cT=kb;this.EVd=Sa}function ua(){this.xEc=null}function Pa(Sa,kb){this.tm=Sa.pages.a$(parseInt(kb.associatedPage.id));this.B8a=kb.pageIndex;this.Sea=kb.gTa}e.d(H,"a",function(){return K});e.d(H,"j",function(){return F});e.d(H,"c",function(){return R});
e.d(H,"l",function(){return Q});e.d(H,"b",function(){return J});e.d(H,"k",function(){return S});e.d(H,"e",function(){return L});e.d(H,"n",function(){return E});e.d(H,"d",function(){return B});e.d(H,"m",function(){return A});e.d(H,"h",function(){return x});e.d(H,"q",function(){return v});e.d(H,"f",function(){return w});e.d(H,"o",function(){return m});e.d(H,"g",function(){return r});e.d(H,"p",function(){return k});e.d(H,"i",function(){return n});e.d(H,"r",function(){return b});var Da=e(1078);C=e(0);
D.global.Object.defineProperties(Pa.prototype,{gTa:{configurable:!0,enumerable:!0,get:function(){return this.Sea}},pageIndex:{configurable:!0,enumerable:!0,get:function(){return this.B8a}},associatedPage:{configurable:!0,enumerable:!0,get:function(){return this.tm}}});Object(C.a)(Pa,"PageAddRecord",null,[]);ua.prototype.initEventChangeRecord=function(Sa,kb){kb&&(this.xEc=new Pa(Sa,kb))};D.global.Object.defineProperties(ua.prototype,{pageAddRecordEventObj:{configurable:!0,enumerable:!0,get:function(){return this.xEc}}});
Object(C.a)(ua,"PageAddedEvent",null,[426]);D.global.Object.defineProperties(xa.prototype,{associatedPageId:{configurable:!0,enumerable:!0,get:function(){return this.cT}},associatedDocument:{configurable:!0,enumerable:!0,get:function(){return this.EVd}}});Object(C.a)(xa,"PageDeleteRecord",null,[]);za.prototype.initEventChangeRecord=function(Sa,kb){kb&&(this.zEc=new xa(Sa,kb))};D.global.Object.defineProperties(za.prototype,{pageDeleteRecordEventObj:{configurable:!0,enumerable:!0,get:function(){return this.zEc}}});
Object(C.a)(za,"PageDeletedEvent",null,[426]);D.global.Object.defineProperties(M.prototype,{associatedPage:{configurable:!0,enumerable:!0,get:function(){return this.tm}}});Object(C.a)(M,"PageLoadRecord",null,[]);sa.prototype.initEventChangeRecord=function(Sa,kb){kb&&(this.CEc=new M(Sa,kb))};D.global.Object.defineProperties(sa.prototype,{pageLoadRecordEventObj:{configurable:!0,enumerable:!0,get:function(){return this.CEc}}});Object(C.a)(sa,"PageLoadedEvent",null,[426]);var Ua=e(1083);D.global.Object.defineProperties(oa.prototype,
{anchorShape:{configurable:!0,enumerable:!0,get:function(){return this.Gyb}},selectedShapes:{configurable:!0,enumerable:!0,get:function(){return this.Jd}},addedShapes:{configurable:!0,enumerable:!0,get:function(){return this.Jd}},removedShapes:{configurable:!0,enumerable:!0,get:function(){return this.Jd}},firedByMergePipeline:{configurable:!0,enumerable:!0,get:function(){return this.kDb}},modifiedDuringResponseApply:{configurable:!0,enumerable:!0,get:function(){return this.oIb}},selectedUsingKeyboard:{configurable:!0,
enumerable:!0,get:function(){return this.p4d}}});Object(C.a)(oa,"SelectedShapesChangedRecord",null,[]);ea.prototype.initEventChangeRecord=function(Sa){Sa&&(this.jHc=new oa(Sa))};D.global.Object.defineProperties(ea.prototype,{selectedShapesChangedRecordEventObj:{configurable:!0,enumerable:!0,get:function(){return this.jHc}}});Object(C.a)(ea,"SelectedShapesChangedEvent",null,[]);D.global.Object.defineProperties(ba.prototype,{shapesAdded:{configurable:!0,enumerable:!0,get:function(){return this.J4d}}});
Object(C.a)(ba,"ShapesAddedRecord",null,[]);na.prototype.initEventChangeRecord=function(Sa){Sa&&(this.jIc=new ba(Sa))};D.global.Object.defineProperties(na.prototype,{shapesAddedRecordEventObj:{configurable:!0,enumerable:!0,get:function(){return this.jIc}}});Object(C.a)(na,"ShapesAddedEvent",null,[]);D.global.Object.defineProperties(ia.prototype,{shapesDeleted:{configurable:!0,enumerable:!0,get:function(){return this.K4d}},relatedRevisionIds:{configurable:!0,enumerable:!0,get:function(){return this.ut}}});
Object(C.a)(ia,"ShapesDeletedRecord",null,[]);Z.prototype.initEventChangeRecord=function(Sa){Sa&&(this.kIc=new ia(Sa))};D.global.Object.defineProperties(Z.prototype,{shapesDeletedRecordEventObj:{configurable:!0,enumerable:!0,get:function(){return this.kIc}}});Object(C.a)(Z,"ShapesDeletedEvent",null,[]);D.global.Object.defineProperties(T.prototype,{oldShapeId:{configurable:!0,enumerable:!0,get:function(){return this.RIb}},associatedShape:{configurable:!0,enumerable:!0,get:function(){return this.xq}}});
Object(C.a)(T,"ShapeIdUpdateRecord",null,[]);D.global.Object.defineProperties(P.prototype,{shapeIdUpdatedRecords:{configurable:!0,enumerable:!0,get:function(){return this.H4d}}});Object(C.a)(P,"ShapesIdUpdatedRecord",null,[]);W.prototype.initEventChangeRecord=function(Sa){Sa&&(this.$Hc=new P(Sa))};D.global.Object.defineProperties(W.prototype,{shapesIdUpdatedRecordEventObj:{configurable:!0,enumerable:!0,get:function(){return this.$Hc}}});Object(C.a)(W,"ShapesIdUpdatedEvent",null,[]);D.global.Object.defineProperties(ca.prototype,
{changeType:{configurable:!0,enumerable:!0,get:function(){return this.fda}},associatedShape:{configurable:!0,enumerable:!0,get:function(){return this.xq}},property:{configurable:!0,enumerable:!0,get:function(){return this.g3d}},oldPropertyValue:{configurable:!0,enumerable:!0,get:function(){return this.X1d}},newPropertyValue:{configurable:!0,enumerable:!0,get:function(){return this.K1d}},changeRecordType:{configurable:!0,enumerable:!0,get:function(){return this.PY}}});Object(C.a)(ca,"ShapeChangeRecord",
null,[]);D.global.Object.defineProperties(X.prototype,{shapeChangeRecords:{configurable:!0,enumerable:!0,get:function(){return this.C4d}},associatedPage:{configurable:!0,enumerable:!0,get:function(){return this.ma}},relatedRevisionIds:{configurable:!0,enumerable:!0,get:function(){return this.ut}}});Object(C.a)(X,"ShapesUpdatedRecord",null,[]);Y.prototype.initEventChangeRecord=function(Sa,kb){kb&&(this.nIc=new X(Sa,kb))};D.global.Object.defineProperties(Y.prototype,{shapesUpdatedRecordEventObj:{configurable:!0,
enumerable:!0,get:function(){return this.nIc}}});Object(C.a)(Y,"ShapesUpdatedEvent",null,[]);I.prototype.initEventChangeRecord=function(Sa,kb){this.lLc=Sa;this.gzc=kb};D.global.Object.defineProperties(I.prototype,{userActionEnabled:{configurable:!0,enumerable:!0,get:function(){return this.lLc}},isOperationInProgress:{configurable:!0,enumerable:!0,get:function(){return this.gzc}}});Object(C.a)(I,"ToggleUserActionEvent",null,[])},1137:function(C,H,e){function b(){this.BHc=this.xHc=this.YLb=this.WIc=
this.WKc=this.IEc=this.pyb=this.tpc=this.bIc=this.gMb=this.bMb=this.eMb=this.lMb=null}function n(ca){this.eventId=null;this.ev=[];this.MO=0;if(isNullOrUndefined(ca))throw Error.create("SetSetTextFontSizeEvent:SetTextFontSize data passed is null");this.MO=ca.fontSize;ca=D.makeIterator(ca.shapes);for(var W=ca.next();!W.done;W=ca.next())this.ev.push(W.value.id);return this}function k(ca){this.eventId=null;this._shapeIDs=[];this.Nvc=this.Qd=0;if(isNullOrUndefined(ca))throw Error.create("SetGrowAndShrinkFontSizeEvent:GrowAndShrinkFontSizeCommand data passed is null");
this._shapeIDs.push.apply(this._shapeIDs,D.Nh(ca.shapeIDs));this.Qd=Number.parseInt(ca.pageID);this.Nvc=ca.growStepCount;return this}function r(ca){this.eventId=null;K.AFrameworkApplication.H.J("VisioWebSerializableTextCommandDataEnabled")?this.cRd(ca):this.dRd(ca);return this}function m(ca){this.eventId=null;this.XKc={};this.sOb=ca;for(var W=0;W<ca.length;W++){var P=[],T;for(T in ca[W].editShapeDataInfo)P[0]=ca[W].editShapeDataInfo[T].Label,P[1]=ca[W].editShapeDataInfo[T].DataType,P[2]=ca[W].editShapeDataInfo[T].Format,
P[3]=ca[W].editShapeDataInfo[T].Value;this.XKc[ca[W].shapeID]=P}return this}function w(ca){this.eventId=null;this.fXd=ca.controlIdentifier;this.Q0d=ca.legacyControlIdentifier;return this}function v(ca){this.eventId=null;this.eventId=ca.guid.toString();this.an=new X.a(ca.parentPage.Ub,ca.parentPage);this.Vha=ca.xPosition;this.Zha=ca.yPosition;this.x_d=ca.isCrossSessionPaste;this.i2a=ca.CCPID;this.i7d=ca.wacDatacenter;this.oWd=ca.ccpLogID;return this}function x(ca){this.eventId=null;this.ev=[];this.eventId=
ca.guid.toString();this._posX=ca.translateX;this._posY=ca.translateY;for(var W=0;W<ca.shapesData.length;W++)this.ev.push(ca.shapesData[W].shape.id);return this}function A(ca){this.eventId=null;this.eventId=ca.guid.toString();this.ev=[];for(var W=D.makeIterator(ca.shapes),P=W.next();!P.done;P=W.next())Array.add(this.ev,P.value.id);this.s6d=ca.translateX;this.t6d=ca.translateY;this.D_d=ca.isDrag;this.R4d=ca.shouldGlue;return this}function B(ca){this.eventId=null;this.ev=[];if(K.AFrameworkApplication.H.J("VisioWebUniversalCommandDataEnabled"))for(var W=
D.makeIterator(ca.selectedShapes),P=W.next();!P.done;P=W.next())Array.add(this.ev,P.value.id);else for(W=D.makeIterator(ca.shapes),P=W.next();!P.done;P=W.next())Array.add(this.ev,P.value.id);this.eventId=ca.guid.toString();return this}function E(ca){this.eventId=null;this.ev=[];for(var W=D.makeIterator(ca.shapes),P=W.next();!P.done;P=W.next())this.ev.push(P.value.id);this.A_d=ca.isCut;this.Q_d=ca.isKeyboardEvent;this.eventId=ca.guid.toString();return this}function L(ca){this.eventId=null;this.oab=
ca.switchFromPageId;this.pab=ca.switchToPageId;return this}function S(ca){this.eventId=null;this._posX=ca.pin.xPosition;this._posY=ca.pin.yPosition;this.ey=Y.a.Oeb(ca.stencilMaster);return this}function J(ca){this.eventId=null;this._posY=this._posX=0;this.Tf=this.vg=this.AJb=this._uniqueID=this.ey=null;this.vh=this.rKb=0;this.Pta=!1;this.Qi=0;this.oda=null;K.AFrameworkApplication.H.J("VisioWebUniversalCommandDataEnabled")?this.E$d(ca):this.F$d(ca);return this}function Q(ca){this.D7d=this.A7d=ca.xPosition;
this.rZd=ca.glueType;this._shapeID=ca.shapeID;this.D0d=ca.isCustomConnector;this.qZd=ca.gluePointConnectionPointIndex}function R(){this.eventId=null}e.r(H);e.d(H,"BeginEventBuilder",function(){return b});C=e(0);var F=e(158),K=e(1);Object(C.a)(R,"BeginEvent",null,[]);var I=e(646),Y=e(1093);D.global.Object.defineProperties(Q.prototype,{xPosition:{configurable:!0,enumerable:!0,get:function(){return this.A7d}},yPosition:{configurable:!0,enumerable:!0,get:function(){return this.D7d}},glueType:{configurable:!0,
enumerable:!0,get:function(){return this.rZd}},isCustomConnector:{configurable:!0,enumerable:!0,get:function(){return this.D0d}},shapeID:{configurable:!0,enumerable:!0,get:function(){return this._shapeID}},gluePointConnectionPointIndex:{configurable:!0,enumerable:!0,get:function(){return this.qZd}}});Object(C.a)(Q,"GlueInformation",null,[]);D.ha(J,R);J.prototype.E$d=function(ca){var W=new Y.a;W.masterId=ca.stencilMasterID;this.ey=W;this._uniqueID=ca.stencilID;this.AJb=ca.parentPageID;this.vg=new Q(ca.begin);
this.Tf=new Q(ca.end);this._posX=ca.pin.xPosition;this._posY=ca.pin.yPosition;this.rKb=ca.quickShapeConnectionPointIndex;this.vh=ca.direction;this.Pta=ca.shouldPerformLocalLie;this.Qi=ca.connectorType;this.oda=ca.connectorPoints.CH()};J.prototype.F$d=function(ca){this.ey=Y.a.Oeb(ca.stencilMaster);this._uniqueID=ca.stencilMaster.uniqueId;this.AJb=ca.parentPage.id;this.vg=new Q(new I.a(ca.begin));this.Tf=new Q(new I.a(ca.end));this._posX=ca.pin.xPosition;this._posY=ca.pin.yPosition;this.rKb=ca.quickShapeConnectionPointIndex;
this.vh=ca.direction;this.Pta=ca.shouldPerformLocalLie;this.Qi=ca.connectorType;this.oda=ca.connectorPoints.CH()};D.global.Object.defineProperties(J.prototype,{positionX:{configurable:!0,enumerable:!0,get:function(){return this._posX}},positionY:{configurable:!0,enumerable:!0,get:function(){return this._posY}},stencilMaster:{configurable:!0,enumerable:!0,get:function(){return this.ey}},uniqueID:{configurable:!0,enumerable:!0,get:function(){return this._uniqueID}},parentPageID:{configurable:!0,enumerable:!0,
get:function(){return this.AJb}},begin:{configurable:!0,enumerable:!0,get:function(){return this.vg}},end:{configurable:!0,enumerable:!0,get:function(){return this.Tf}},quickShapeConnectionPointIndex:{configurable:!0,enumerable:!0,get:function(){return this.rKb}},direction:{configurable:!0,enumerable:!0,get:function(){return this.vh}},shouldPerformLocalLie:{configurable:!0,enumerable:!0,get:function(){return this.Pta}},connectorType:{configurable:!0,enumerable:!0,get:function(){return this.Qi}},connectorPoints:{configurable:!0,
enumerable:!0,get:function(){return this.oda}}});Object(C.a)(J,"AddQuickShapeBeginEvent",R,[]);D.ha(S,R);D.global.Object.defineProperties(S.prototype,{positionX:{configurable:!0,enumerable:!0,get:function(){return this._posX}},positionY:{configurable:!0,enumerable:!0,get:function(){return this._posY}},stencilMaster:{configurable:!0,enumerable:!0,get:function(){return this.ey}}});Object(C.a)(S,"AddShapeHavingMasterBeginEvent",R,[]);D.ha(L,R);D.global.Object.defineProperties(L.prototype,{switchFromPageId:{configurable:!0,
enumerable:!0,get:function(){return this.oab}},switchToPageId:{configurable:!0,enumerable:!0,get:function(){return this.pab}}});Object(C.a)(L,"PageSwitchBeginEvent",R,[]);D.ha(E,R);D.global.Object.defineProperties(E.prototype,{shapeIds:{configurable:!0,enumerable:!0,get:function(){return this.ev}},isCut:{configurable:!0,enumerable:!0,get:function(){return this.A_d}},isKeyboardEvent:{configurable:!0,enumerable:!0,get:function(){return this.Q_d}}});Object(C.a)(E,"ShapeCutCopyBeginEvent",R,[]);D.ha(B,
R);D.global.Object.defineProperties(B.prototype,{shapeIds:{configurable:!0,enumerable:!0,get:function(){return this.ev}}});Object(C.a)(B,"ShapeDeleteBeginEvent",R,[]);D.ha(A,R);D.global.Object.defineProperties(A.prototype,{shapeIds:{configurable:!0,enumerable:!0,get:function(){return this.ev}},translateX:{configurable:!0,enumerable:!0,get:function(){return this.s6d}},translateY:{configurable:!0,enumerable:!0,get:function(){return this.t6d}},isDrag:{configurable:!0,enumerable:!0,get:function(){return this.D_d}},
shouldGlue:{configurable:!0,enumerable:!0,get:function(){return this.R4d}}});Object(C.a)(A,"ShapeDuplicateBeginEvent",R,[]);D.ha(x,R);x.prototype.addShapeIdsToEvent=function(ca){this.ev||(this.ev=[]);Array.add(this.ev,ca)};D.global.Object.defineProperties(x.prototype,{positionX:{configurable:!0,enumerable:!0,get:function(){return this._posX}},positionY:{configurable:!0,enumerable:!0,get:function(){return this._posY}},shapeIds:{configurable:!0,enumerable:!0,get:function(){return this.ev}}});Object(C.a)(x,
"ShapeMoveBeginEvent",R,[]);var X=e(1138);D.ha(v,R);D.global.Object.defineProperties(v.prototype,{parentPage:{configurable:!0,enumerable:!0,get:function(){return this.an}},xPosition:{configurable:!0,enumerable:!0,get:function(){return this.Vha},set:function(ca){this.Vha=ca}},yPosition:{configurable:!0,enumerable:!0,get:function(){return this.Zha},set:function(ca){this.Zha=ca}},isCrossSessionPaste:{configurable:!0,enumerable:!0,get:function(){return this.x_d}},CCPID:{configurable:!0,enumerable:!0,
get:function(){return this.i2a}},wacDatacenter:{configurable:!0,enumerable:!0,get:function(){return this.i7d}},ccpLogID:{configurable:!0,enumerable:!0,get:function(){return this.oWd}}});Object(C.a)(v,"ShapePasteBeginEvent",R,[]);D.ha(w,R);D.global.Object.defineProperties(w.prototype,{legacyControlIdentifier:{configurable:!0,enumerable:!0,get:function(){return this.Q0d}},controlIdentifier:{configurable:!0,enumerable:!0,get:function(){return this.fXd}}});Object(C.a)(w,"SolutionRMAOptionsBeginEvent",
R,[]);D.ha(m,R);D.global.Object.defineProperties(m.prototype,{UpdateShapeDataInfo:{configurable:!0,enumerable:!0,get:function(){return this.XKc}}});Object(C.a)(m,"UpdateShapeDataBeginEvent",R,[]);D.ha(r,R);r.prototype.cRd=function(ca){this.dv=ca.shapeID;this.Bua=ca.textVerticalAlign;this.pHc=ca.textStream;this.nHc=ca.charFormats;this.oHc=ca.paraFormats;this.Qd=ca.pageID;this.lKc=ca.textFieldIndexes;this.qKc=null};r.prototype.dRd=function(ca){this.dv=ca.shape.id;this.lKc=ca.textFieldIndexes;this.qKc=
ca.textTokens;this.Bua=ca.textVerticalAlign;this.Qd=this.oHc=this.nHc=this.pHc=null};D.global.Object.defineProperties(r.prototype,{shapeId:{configurable:!0,enumerable:!0,get:function(){return this.dv}},pageId:{configurable:!0,enumerable:!0,get:function(){return this.Qd}},verticalAlignment:{configurable:!0,enumerable:!0,get:function(){return this.Bua}},textTokens:{configurable:!0,enumerable:!0,get:function(){return this.qKc}},textFieldIndexes:{configurable:!0,enumerable:!0,get:function(){return this.lKc}},
serializedTextStreamToken:{configurable:!0,enumerable:!0,get:function(){return this.pHc}},serializedCharacterFormatting:{configurable:!0,enumerable:!0,get:function(){return this.nHc}},serializedParagraphFormatting:{configurable:!0,enumerable:!0,get:function(){return this.oHc}}});Object(C.a)(r,"SetTextBeginEvent",R,[]);D.ha(k,R);D.global.Object.defineProperties(k.prototype,{shapeIds:{configurable:!0,enumerable:!0,get:function(){return this._shapeIDs}},pageId:{configurable:!0,enumerable:!0,get:function(){return this.Qd}},
growStepCount:{configurable:!0,enumerable:!0,get:function(){return this.Nvc}}});Object(C.a)(k,"SetGrowAndShrinkFontSizeEvent",R,[]);D.ha(n,R);D.global.Object.defineProperties(n.prototype,{shapeIds:{configurable:!0,enumerable:!0,get:function(){return this.ev}},fontSize:{configurable:!0,enumerable:!0,get:function(){return this.MO}}});Object(C.a)(n,"SetTextFontSizeEvent",R,[]);b.prototype.initBeginEvent=function(ca){var W=this;F.a.ka(ca.snb)||(this.lMb=[],ca.snb.forEach(function(P){W.lMb.push(new x(P))}));
F.a.ka(ca.A_c)||(this.eMb=[],ca.A_c.forEach(function(P){W.eMb.push(new B(P))}));F.a.ka(ca.KZc)||(this.bMb=[],ca.KZc.forEach(function(P){W.bMb.push(new E(P))}));F.a.ka(ca.t1c)||(this.gMb=[],ca.t1c.forEach(function(P){W.gMb.push(new A(P))}));ca.Uud&&(this.bIc=new v(ca.Uud));ca.KOd&&(this.WKc=new m(ca.KOd));ca.QNc&&(this.tpc=new S(ca.QNc));ca.FNc&&(this.pyb=new J(ca.FNc));ca.GNc&&(this.pyb=new J(ca.GNc));ca.Kud&&(this.IEc=new L(ca.Kud));ca.cCd&&(this.WIc=new w(ca.cCd));ca.YFd&&(this.YLb=new r(ca.YFd));
ca.XFd&&(this.YLb=new r(ca.XFd));ca.Uad&&(this.xHc=new k(ca.Uad));ca.ZFd&&(this.BHc=new n(ca.ZFd))};D.global.Object.defineProperties(b.prototype,{shapeMoveBeginEventObj:{configurable:!0,enumerable:!0,get:function(){return this.lMb}},shapeDeleteBeginEventObj:{configurable:!0,enumerable:!0,get:function(){return this.eMb}},shapeCutCopyBeginEventObj:{configurable:!0,enumerable:!0,get:function(){return this.bMb}},shapeDuplicateBeginEventObj:{configurable:!0,enumerable:!0,get:function(){return this.gMb}},
shapePasteBeginEventObj:{configurable:!0,enumerable:!0,get:function(){return this.bIc}},addShapeHavingMasterBeginEventObj:{configurable:!0,enumerable:!0,get:function(){return this.tpc}},pageSwitchBeginEventObj:{configurable:!0,enumerable:!0,get:function(){return this.IEc}},addQuickShapeBeginEventObj:{configurable:!0,enumerable:!0,get:function(){return this.pyb}},updateShapeDataBeginEventObj:{configurable:!0,enumerable:!0,get:function(){return this.WKc}},solutionRMAOptionsBeginEventObj:{configurable:!0,
enumerable:!0,get:function(){return this.WIc}},setTextBeginEventObj:{configurable:!0,enumerable:!0,get:function(){return this.YLb}},setGrowAndShrinkFontSizeEvent:{configurable:!0,enumerable:!0,get:function(){return this.xHc}},setTextFontSizeEvent:{configurable:!0,enumerable:!0,get:function(){return this.BHc}}});Object(C.a)(b,"BeginEventBuilder",null,[])},1138:function(C,H,e){function b(Fa,Za){this.kGa=this.nd=this.DBb=this.xd=this.xY=this.kLb=null;this.ma=Za;this.Vm=Fa}function n(Fa){this.ma=Fa;this.q4d=
new xa.a(function(){return new k})}function k(){this.Yb=ca.Application.bW()}function r(){this.data=this.shapeID=null}function m(Fa,Za,Ea){this.ma=Fa;this.Jda=Za;this.y3a=Ea}function w(Fa){this.ma=this.mBb=null;this.wld=this.$kd=this.cld=this.bld=this.dld=this.ald=!0;this.Ma=Fa}function v(){}function x(){}function A(Fa,Za,Ea,Na){this._masterSelector=Fa;this.fCc=Za;this.gKc=Ea;this.vh=Na}function B(){}function E(){}function L(Fa,Za){this.ZZ=Fa;this.h0=Za}function S(){}function J(){}function Q(){}e.d(H,
"a",function(){return b});C=e(0);var R=e(31),F=e(27),K=e(1072),I=e(805),Y=e(651),X=e(168);Object(C.a)(Q,"SetDataSourceToDiagramCommandData",null,[]);Object(C.a)(J,"UpdateDVCommandData",null,[]);var ca=e(1078),W=e(1139),P=e(1089);S.prototype.getTypeName=function(){return"Microsoft.Visio.DataGraph"};S.prototype.invokePropertyGet=function(Fa){switch(Fa){case 1:return this.entities;case 2:return this.relationships}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Fa);};S.prototype.invokePropertyGetAsync=
function(Fa){Fa=this.invokePropertyGet(Fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Fa)};S.prototype.invokePropertySet=function(Fa){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Fa);};S.prototype.invokePropertySetAsync=function(Fa,Za){this.invokePropertySet(Fa,Za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};S.prototype.invokeMethod=function(Fa){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Fa);};S.prototype.invokeMethodAsync=
function(Fa,Za){Fa=this.invokeMethod(Fa,Za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Fa)};D.global.Object.defineProperties(S.prototype,{entities:{configurable:!0,enumerable:!0,get:function(){return this.entities}},relationships:{configurable:!0,enumerable:!0,get:function(){return this.relationships}}});Object(C.a)(S,"DataGraph",null,[]);L.prototype.getTypeName=function(){return"Microsoft.Visio.MasterDescription"};L.prototype.invokePropertyGet=function(Fa){switch(Fa){case 2:return this.masterNameU;
case 1:return this.stencilName}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Fa);};L.prototype.invokePropertyGetAsync=function(Fa){Fa=this.invokePropertyGet(Fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Fa)};L.prototype.invokePropertySet=function(Fa,Za){switch(Fa){case 2:this.masterNameU=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Za,0,"string");return;case 1:this.stencilName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Za,0,
"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Fa);};L.prototype.invokePropertySetAsync=function(Fa,Za){this.invokePropertySet(Fa,Za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};L.prototype.invokeMethod=function(Fa){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Fa);};L.prototype.invokeMethodAsync=function(Fa,Za){Fa=this.invokeMethod(Fa,Za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Fa)};
D.global.Object.defineProperties(L.prototype,{masterNameU:{configurable:!0,enumerable:!0,get:function(){return this.ZZ},set:function(Fa){this.ZZ=Fa}},stencilName:{configurable:!0,enumerable:!0,get:function(){return this.h0},set:function(Fa){this.h0=Fa}}});Object(C.a)(L,"MasterDescription",null,[]);E.prototype.addMapping=function(Fa,Za){this.addMapping(Fa,Za)};E.prototype.getTypeName=function(){return"Microsoft.Visio.DataItemMasterSelector"};E.prototype.invokePropertyGet=function(Fa){switch(Fa){case 1:return this.defaultMaster;
case 2:return this.masterMapping}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Fa);};E.prototype.invokePropertyGetAsync=function(Fa){Fa=this.invokePropertyGet(Fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Fa)};E.prototype.invokePropertySet=function(Fa,Za){switch(Fa){case 1:this.defaultMaster=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Za,0,L);return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Fa);};E.prototype.invokePropertySetAsync=
function(Fa,Za){this.invokePropertySet(Fa,Za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};E.prototype.invokeMethod=function(Fa,Za){switch(Fa){case 1001:return this.a$d(Za)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Fa);};E.prototype.invokeMethodAsync=function(Fa,Za){Fa=this.invokeMethod(Fa,Za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Fa)};E.prototype.a$d=function(Fa){var Za=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,
0,"string");Fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,1,L);this.addMapping(Za,Fa);return null};D.global.Object.defineProperties(E.prototype,{defaultMaster:{configurable:!0,enumerable:!0,get:function(){return this.defaultMaster},set:function(){}},masterMapping:{configurable:!0,enumerable:!0,get:function(){return this.masterMapping}}});Object(C.a)(E,"DataItemMasterSelector",null,[]);B.prototype.getTypeName=function(){return"Microsoft.Visio.DataEntityShapeBinding"};B.prototype.invokePropertyGet=
function(Fa){switch(Fa){case 2:return this.masterSelector;case 1:return this.masterSelectorAttributeName;case 4:return this.subShapeTextAttributeNameMap;case 3:return this.textAttributeName}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Fa);};B.prototype.invokePropertyGetAsync=function(Fa){Fa=this.invokePropertyGet(Fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Fa)};B.prototype.invokePropertySet=function(Fa,Za){switch(Fa){case 2:this.masterSelector=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Za,
0,E);return;case 1:this.masterSelectorAttributeName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Za,0,"string");return;case 4:this.subShapeTextAttributeNameMap=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Za,0,"Array<Visio.Extension.AttributeToSubShapeIdMapItem>");return;case 3:this.textAttributeName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Za,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Fa);};B.prototype.invokePropertySetAsync=
function(Fa,Za){this.invokePropertySet(Fa,Za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};B.prototype.invokeMethod=function(Fa){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Fa);};B.prototype.invokeMethodAsync=function(Fa,Za){Fa=this.invokeMethod(Fa,Za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Fa)};D.global.Object.defineProperties(B.prototype,{masterSelector:{configurable:!0,enumerable:!0,get:function(){return this.masterSelector},
set:function(){}},masterSelectorAttributeName:{configurable:!0,enumerable:!0,get:function(){return this.masterSelectorAttributeName},set:function(){}},subShapeTextAttributeNameMap:{configurable:!0,enumerable:!0,get:function(){return this.subShapeTextAttributeNameMap},set:function(){}},textAttributeName:{configurable:!0,enumerable:!0,get:function(){return this.textAttributeName},set:function(){}}});Object(C.a)(B,"DataEntityShapeBinding",null,[]);A.prototype.getTypeName=function(){return"Microsoft.Visio.DataRelationshipConnectorBinding"};
A.prototype.invokePropertyGet=function(Fa){switch(Fa){case 3:return this.direction;case 2:return this.masterSelector;case 1:return this.masterSelectorAttributeName;case 4:return this.textAttributeName}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Fa);};A.prototype.invokePropertyGetAsync=function(Fa){Fa=this.invokePropertyGet(Fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Fa)};A.prototype.invokePropertySet=function(Fa,Za){switch(Fa){case 3:this.direction=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Za,0,"int");return;case 2:this.masterSelector=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Za,0,E);return;case 1:this.masterSelectorAttributeName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Za,0,"string");return;case 4:this.textAttributeName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Za,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Fa);};A.prototype.invokePropertySetAsync=
function(Fa,Za){this.invokePropertySet(Fa,Za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};A.prototype.invokeMethod=function(Fa){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Fa);};A.prototype.invokeMethodAsync=function(Fa,Za){Fa=this.invokeMethod(Fa,Za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Fa)};D.global.Object.defineProperties(A.prototype,{direction:{configurable:!0,enumerable:!0,get:function(){return this.vh},set:function(Fa){this.vh=
Fa}},masterSelector:{configurable:!0,enumerable:!0,get:function(){return this._masterSelector},set:function(Fa){this._masterSelector=Fa}},masterSelectorAttributeName:{configurable:!0,enumerable:!0,get:function(){return this.fCc},set:function(Fa){this.fCc=Fa}},textAttributeName:{configurable:!0,enumerable:!0,get:function(){return this.gKc},set:function(Fa){this.gKc=Fa}}});Object(C.a)(A,"DataRelationshipConnectorBinding",null,[]);x.prototype.getTypeName=function(){return"Microsoft.Visio.DataGraphBindingSettings"};
x.prototype.invokePropertyGet=function(Fa){switch(Fa){case 2:return this.connectorBinding;case 1:return this.shapeBinding}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Fa);};x.prototype.invokePropertyGetAsync=function(Fa){Fa=this.invokePropertyGet(Fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Fa)};x.prototype.invokePropertySet=function(Fa,Za){switch(Fa){case 2:this.connectorBinding=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Za,0,A);return;
case 1:this.shapeBinding=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Za,0,B);return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Fa);};x.prototype.invokePropertySetAsync=function(Fa,Za){this.invokePropertySet(Fa,Za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};x.prototype.invokeMethod=function(Fa){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Fa);};x.prototype.invokeMethodAsync=function(Fa,Za){Fa=this.invokeMethod(Fa,
Za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Fa)};D.global.Object.defineProperties(x.prototype,{connectorBinding:{configurable:!0,enumerable:!0,get:function(){return this.connectorBinding},set:function(){}},shapeBinding:{configurable:!0,enumerable:!0,get:function(){return this.shapeBinding},set:function(){}}});Object(C.a)(x,"DataGraphBindingSettings",null,[]);Object(C.a)(v,"DVDataInfoCommandData",null,[]);var T=e(1126),Z=e(1097),ia=e(1106),na=e(1082),ba=e(1091),ea=e(1085);
w.prototype.getDataHeaders=function(){var Fa=this;this.$kd&&(R.ULS.sendTraceTag(42475653,700,50,"JSApi:DataVisualizerDiagram:DataHeaders"),this.$kd=!1);return OfficeExtension.WacRuntime.Utility.createPromise(function(Za,Ea){var Na=new v;Na.pageID=Fa.Ma.ta.id;Na.containerID=Fa.Ma.id;Na.fetchUniqueColumnValues=!1;X.a.y7c(Na)?Na.successHandler=function($a){if(void 0!==$a.dataHeaders&&null!==$a.dataHeaders){Fa.mBb=Array($a.dataHeaders.length);var Ba=0;$a=D.makeIterator($a.dataHeaders);for(var Xa=$a.next();!Xa.done;Xa=
$a.next()){Xa=Xa.value;var Oa=new Z.a;Oa.columnType=1;Oa.name=Xa;Fa.mBb[Ba++]=Oa}Za(Fa.mBb)}}:Ea("Cancelled")})};w.prototype.deleteObject=function(){};w.prototype.getDataColumnValuesAsString=function(Fa){var Za=this;this.wld&&(R.ULS.sendTraceTag(42771918,700,50,"JSApi:DataVisualizerDiagram:GetDataColumnValuesAsString"),this.wld=!1);if(void 0===Fa||null===Fa)throw OfficeExtension.WacRuntime.Utility.createRichApiException(na.a.invalidArgument,"columnName cannot be null");return OfficeExtension.WacRuntime.Utility.createPromise(function(Ea,
Na){var $a=new v;$a.pageID=Za.Ma.ta.id;$a.containerID=Za.Ma.id;$a.fetchUniqueColumnValues=!0;$a.columnName=Fa;X.a.y7c($a)?$a.successHandler=function(Ba){if(void 0!==Ba.columnValues&&null!==Ba.columnValues){var Xa=Array(Ba.columnValues.length),Oa=0;Ba=D.makeIterator(Ba.columnValues);for(var Fb=Ba.next();!Fb.done;Fb=Ba.next())Fb=Fb.value,Xa[Oa++]=Fb;Ea(Xa)}}:Na("Cancelled")})};w.prototype.setConnection=function(Fa){if(void 0===Fa||null===Fa)throw OfficeExtension.WacRuntime.Utility.createRichApiException(na.a.invalidArgument,
"connectionInfo cannot be null");Fa=this.ONe(Fa);X.a.setDataSourceToDiagram(Fa);R.ULS.sendTraceTag(51230540,700,50,"SetConnection API called")};w.prototype.update=function(Fa,Za,Ea){if(void 0!==Za&&null!==Za&&void 0!==Fa&&null!==Fa)Fa=ea.a.RNe(this.Ma,Fa,Za),X.a.hlc(VisioWebIntl.VisioWebStrings.L_DVRecreateDiagramSpinnerTitle),X.a.APa(Fa);else if(void 0!==Fa&&null!==Fa)Za=new J,Za.dataRange=Fa.range,Za.recordSetData=ea.a.p0b(Fa),Za.containerShape=this.Ma,Za.fitPageToDrawing=!0,Za.overrideConflicts=
Ea,X.a.hlc(VisioWebIntl.VisioWebStrings.L_DVUpdateDiagramSpinnerTitle),X.a.NNd(Za);else throw OfficeExtension.WacRuntime.Utility.createRichApiException(na.a.invalidArgument,"Invalid parameters");};w.prototype.updateMappings=function(Fa){if(void 0===Fa||null===Fa)throw OfficeExtension.WacRuntime.Utility.createRichApiException(na.a.invalidArgument,"UpdateMappings: mappings cannot be null");Fa=ea.a.uOe(this.Ma,Fa);X.a.hlc(VisioWebIntl.VisioWebStrings.L_DVUpdateMappingSpinnerTitle);X.a.E8f(Fa);R.ULS.sendTraceTag(50366404,
700,50,"Update DV Mappings API called")};w.prototype.getTypeName=function(){return"Microsoft.Visio.DataVisualizerDiagram"};w.prototype.invokePropertyGet=function(Fa){switch(Fa){case 1:return this.id;case 2:return this.mappings;case 5:return this.page;case 3:return this.type}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Fa);};w.prototype.invokePropertyGetAsync=function(Fa){switch(Fa){case 4:return this.getDataHeaders()}Fa=this.invokePropertyGet(Fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Fa)};
w.prototype.invokePropertySet=function(Fa){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Fa);};w.prototype.invokePropertySetAsync=function(Fa,Za){this.invokePropertySet(Fa,Za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};w.prototype.invokeMethod=function(Fa,Za){switch(Fa){case 1005:return this.$Be();case 1002:return this.DRf(Za);case 1004:return this.z9f(Za);case 1003:return this.G9f(Za)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Fa);
};w.prototype.invokeMethodAsync=function(Fa,Za){switch(Fa){case 1001:return this.rSe(Za)}Fa=this.invokeMethod(Fa,Za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Fa)};w.prototype.$Be=function(){this.deleteObject();return null};w.prototype.rSe=function(Fa){Fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,0,"string");return this.getDataColumnValuesAsString(Fa)};w.prototype.DRf=function(Fa){Fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,0,T.a);this.setConnection(Fa);
return null};w.prototype.z9f=function(Fa){var Za=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,0,ba.a),Ea=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,1,ia.a);Fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,2,"boolean");this.update(Za,Ea,Fa);return null};w.prototype.G9f=function(Fa){Fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,0,ia.a);this.updateMappings(Fa);return null};w.prototype.kka=function(){return this.Ma};w.prototype.ONe=function(Fa){var Za=
new Q;if(void 0!==Fa.sourcePath&&null!==Fa.sourcePath&&void 0!==Fa.sourceName&&null!==Fa.sourceName)if(Za.containerID=this.Ma.id,Za.pageID=this.Ma.ta.id,Za.filePath=Fa.sourcePath,Za.isTable=Fa.isTabularData,Za.isTable)Za.tableOrSheetName=Fa.sourceName;else if(Fa=Fa.sourceName.split("!"),2===Fa.length)Za.tableOrSheetName=Fa[0],Za.dataRange=Fa[1];else throw OfficeExtension.WacRuntime.Utility.createRichApiException(na.a.invalidArgument,"SetConnection: dataSourceName is not in correct format");else throw OfficeExtension.WacRuntime.Utility.createRichApiException(na.a.invalidArgument,
"SetConnection: dara is not in correct format");return Za};w.C2e=function(Fa){switch(Fa){case 0:return 1;case 1:return 2;case 2:return 3;case 5:return 4;default:return 0}};D.global.Object.defineProperties(w.prototype,{id:{configurable:!0,enumerable:!0,get:function(){this.ald&&(R.ULS.sendTraceTag(42475654,700,50,"JSApi:DataVisualizerDiagram:ID"),this.ald=!1);return parseInt(this.Ma.id)}},mappings:{configurable:!0,enumerable:!0,get:function(){this.bld&&(R.ULS.sendTraceTag(42475655,700,50,"JSApi:DataVisualizerDiagram:ID"),
this.bld=!1);return new ia.a(this.Ma.bja.WZc)}},page:{configurable:!0,enumerable:!0,get:function(){this.cld&&(R.ULS.sendTraceTag(42475656,700,50,"JSApi:DataVisualizerDiagram:Page"),this.cld=!1);if(void 0===this.ma||null===this.ma)this.ma=this.Ma.ta;return this.ma}},type:{configurable:!0,enumerable:!0,get:function(){this.dld&&(R.ULS.sendTraceTag(42475657,700,50,"JSApi:DataVisualizerDiagram:Type"),this.dld=!1);return w.C2e(this.Ma.bja.diagramType)}}});Object(C.a)(w,"DataVisualizerDiagram",null,[]);
var oa=e(1112),sa=e(1127),M=e(1090);m.prototype.add=function(Fa,Za){m.Ekd&&(R.ULS.sendTraceTag(42475658,700,50,"JSApi:DataVisualizerDiagramCollection:Add"),m.Ekd=!1);if(void 0===Za||null===Za)throw OfficeExtension.WacRuntime.Utility.createRichApiException(na.a.invalidArgument,"settings cannot be null");if(void 0===Fa||null===Fa)throw OfficeExtension.WacRuntime.Utility.createRichApiException(na.a.invalidArgument,"TableData cannot be null");Fa=this.k6c(Za.diagramType,Fa,Za.mappings);X.a.APa(Fa);return null};
m.prototype.addPreferred=function(Fa,Za){m.Fkd&&(R.ULS.sendTraceTag(42475659,700,50,"JSApi:DataVisualizerDiagramCollection:AddPreferred"),m.Fkd=!1);if(void 0===Za||null===Za)throw OfficeExtension.WacRuntime.Utility.createRichApiException(na.a.invalidArgument,"settings cannot be null");if(void 0===Fa||null===Fa)throw OfficeExtension.WacRuntime.Utility.createRichApiException(na.a.invalidArgument,"TableData cannot be null");Fa=this.k6c(Za,Fa,null);X.a.APa(Fa);return null};m.prototype.getCount=function(){m.Zkd&&
(R.ULS.sendTraceTag(42475660,700,50,"JSApi:DataVisualizerDiagramCollection:Count"),m.Zkd=!1);return this.length()};m.prototype.getItem=function(Fa){if(void 0===Fa||null===Fa)throw OfficeExtension.WacRuntime.Utility.createRichApiException(na.a.invalidArgument,"key cannot be null");m.yld&&(R.ULS.sendTraceTag(42475661,700,50,"JSApi:DataVisualizerDiagramCollection:GetItem"),m.yld=!1);Fa=parseInt(Fa.toString());if(!isNaN(Fa)&&0<Fa)return this.uSe(Fa);throw OfficeExtension.WacRuntime.Utility.createRichApiException(na.a.qR,
"ItemNotFound");};m.prototype.getItemAt=function(Fa){if(void 0===Fa||null===Fa)throw OfficeExtension.WacRuntime.Utility.createRichApiException(na.a.invalidArgument,"index cannot be null");m.zld&&(R.ULS.sendTraceTag(42475662,700,50,"JSApi:DataVisualizerDiagramCollection:GetItemAt"),m.zld=!1);if(0<=Fa&&Fa<this.Jda.length)return this.Jda[Fa];throw OfficeExtension.WacRuntime.Utility.createRichApiException(na.a.invalidArgument,"InvalidArgument");};m.prototype.getItemOrNullObject=function(){return null};
m.prototype.getAsyncEnumerator=function(Fa,Za){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new M.a(Fa,Za,this))};m.prototype.getTypeName=function(){return"Microsoft.Visio.DataVisualizerDiagramCollection"};m.prototype.invokePropertyGet=function(Fa){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Fa);};m.prototype.invokePropertyGetAsync=function(Fa){Fa=this.invokePropertyGet(Fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Fa)};m.prototype.invokePropertySet=
function(Fa){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Fa);};m.prototype.invokePropertySetAsync=function(Fa,Za){this.invokePropertySet(Fa,Za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};m.prototype.invokeMethod=function(Fa,Za){switch(Fa){case 1001:return this.TNa(Za);case 1005:return this.B$d(Za);case 1002:return this.HJ();case 1:return this.JJ(Za);case 1003:return this.JVe(Za);case 1004:return this.SRa(Za)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Fa);
};m.prototype.invokeMethodAsync=function(Fa,Za){Fa=this.invokeMethod(Fa,Za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Fa)};m.prototype.TNa=function(Fa){var Za=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,0,ba.a);Fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,1,sa.a);return this.add(Za,Fa)};m.prototype.B$d=function(Fa){var Za=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,0,ba.a);Fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,
1,"int");return this.addPreferred(Za,Fa)};m.prototype.HJ=function(){return this.getCount()};m.prototype.JJ=function(Fa){Fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,0,"any");return this.getItem(Fa)};m.prototype.JVe=function(Fa){Fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,0,"int");return this.getItemAt(Fa)};m.prototype.SRa=function(Fa){Fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,0,"any");return this.getItemOrNullObject(Fa)};m.prototype.length=
function(){return void 0===this.Jda||null===this.Jda?0:this.Jda.length};m.prototype.getItemByIndex=function(Fa){m.xld&&(R.ULS.sendTraceTag(42475663,700,50,"JSApi:DataVisualizerDiagramCollection:GetItemByIndex"),m.xld=!1);if(void 0===Fa||null===Fa)throw OfficeExtension.WacRuntime.Utility.createRichApiException(na.a.invalidArgument,"InvalidArgument");Fa=parseInt(Fa.toString());if(!isNaN(Fa)&&0<=Fa&&Fa<this.Jda.length)return this.q9d(this.Jda[Fa]);throw OfficeExtension.WacRuntime.Utility.createRichApiException(na.a.invalidArgument,
"InvalidArgument");};m.prototype.uSe=function(Fa){return void 0===Fa||null===Fa?null:this.y3a.ia(Fa.toString())};m.prototype.q9d=function(Fa){this.y3a.pb(Fa.id.toString())||this.y3a.U(Fa.id.toString(),new w(Fa.kka()));return this.y3a.ia(Fa.id.toString())};m.prototype.k6c=function(Fa,Za,Ea){var Na=new oa.a;Na.recordSetData=ea.a.p0b(Za);Na.dataRange=Za.range;Na.fitPageToDrawing=!0;Na.deleteAllShapes=!1;Na.hideHeading=!0;Na.runHeuristics=void 0===Ea||null===Ea?!0:!1;Na.parentPage=this.ma;switch(Fa){case 2:Fa=
1;break;case 3:Fa=2;break;default:Fa=0}Na.diagramType=Fa;Na.dvMappings=ea.a.nac(Fa,Ea);return Na};m.Ekd=!0;m.Fkd=!0;m.Zkd=!0;m.yld=!0;m.zld=!0;m.xld=!0;Object(C.a)(m,"DataVisualizerDiagramCollection",null,[395]);var za=e(1104),xa=e(804),ua=e(190);Object(C.a)(r,"DGShapeData",null,[]);var Pa=e(1123),Da=e(1098);k.prototype.getTypeName=function(){return"Microsoft.Visio.Selection"};k.prototype.invokePropertyGet=function(Fa){switch(Fa){case 1:return this.shapes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Fa);
};k.prototype.invokePropertyGetAsync=function(Fa){Fa=this.invokePropertyGet(Fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Fa)};k.prototype.invokePropertySet=function(Fa){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Fa);};k.prototype.invokePropertySetAsync=function(Fa,Za){this.invokePropertySet(Fa,Za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};k.prototype.invokeMethod=function(Fa){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Fa);
};k.prototype.invokeMethodAsync=function(Fa,Za){Fa=this.invokeMethod(Fa,Za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Fa)};D.global.Object.defineProperties(k.prototype,{shapes:{configurable:!0,enumerable:!0,get:function(){return new Da.a(this.Yb.selectedShapes)}}});Object(C.a)(k,"Selection",null,[]);var Ua=e(1083);n.prototype.applyDataGraphics=function(Fa,Za){n.Ikd&&(R.ULS.sendTraceTag(25811017,700,50,"JSApi:PageView:ApplyDataGraphics"),n.Ikd=!1);if(void 0===Za||null===Za)throw Error.argumentNull("dgDataItems");
if(ca.Application.cR().activePage.id!==this.ma.index.toString())throw Error.invalidOperation("Data graphics can be applied only on the Active Page view.");var Ea=new ua.a;Za=D.makeIterator(Za);for(var Na=Za.next();!Na.done;Na=Za.next()){Na=Na.value;var $a=new r;$a.data=Na.data;$a.shapeID=Na.shapeID;Ea.add($a)}ca.Application.Hl.applyDataGraphics(Fa,Ea)};n.prototype.centerViewportOnShape=function(Fa){var Za=F.a.Fb();n.Lkd&&(R.ULS.sendTraceTag(21611084,700,50,"JSApi:PageView:CenterViewportOnShape"),
n.Lkd=!1);if(isNaN(Fa))Fa=F.a.Fb(),R.ULS.sendTraceTag(25801046,700,50,"[VO_Perf] JSApi:PageView:CenterViewportOnShape: Time taken (ms): {0}",Fa-Za);else{var Ea=this.ma.P2.shapes;void 0===Ea||null===Ea?(Fa=F.a.Fb(),R.ULS.sendTraceTag(25801047,700,50,"[VO_Perf] JSApi:PageView:CenterViewportOnShape: Time taken (ms): {0}",Fa-Za)):(Fa=Ea.Ga(Fa.toString()),Fa=this.ma.shapes.kka(Fa),void 0!==Fa&&null!==Fa&&ca.Application.Uw().$ne(Fa.oe),Fa=F.a.Fb(),R.ULS.sendTraceTag(25801048,700,50,"[VO_Perf] JSApi:PageView:CenterViewportOnShape: Time taken (ms): {0}",
Fa-Za))}};n.prototype.fitToWindow=function(){n.nld&&(R.ULS.sendTraceTag(21611085,700,50,"JSApi:PageView:FitToWindow"),n.nld=!1);ca.Application.Uw().fitToPage()};n.prototype.getPosition=function(){n.Ild&&(R.ULS.sendTraceTag(21611086,700,50,"JSApi:PageView:GetPosition"),n.Ild=!1);var Fa=ca.Application.Hl.Caa.O1();return new Pa.a(Math.round(Fa.x*P.a.pixelsPerInch),Math.round(Fa.y*P.a.pixelsPerInch))};n.prototype.getSelection=function(){n.Jld&&(R.ULS.sendTraceTag(21611087,700,50,"JSApi:PageView:GetSelection"),
n.Jld=!1);return this.q4d.value};n.prototype.isShapeInViewport=function(Fa){n.bmd&&(R.ULS.sendTraceTag(21611088,700,50,"JSApi:PageView:IsShapeInViewport"),n.bmd=!1);return void 0!==Fa&&null!==Fa?ca.Application.Uw().isShapeInViewport(Fa.oe):!1};n.prototype.setPosition=function(Fa){n.Mmd&&(R.ULS.sendTraceTag(25811018,700,50,"JSApi:PageView:SetPosition"),n.Mmd=!1);void 0!==Fa&&null!==Fa&&ca.Application.Hl.Caa.A3(Fa.x/P.a.pixelsPerInch,Fa.y/P.a.pixelsPerInch)};n.prototype.getTypeName=function(){return"Microsoft.Visio.PageView"};
n.prototype.invokePropertyGet=function(Fa){switch(Fa){case 1:return this.zoom}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Fa);};n.prototype.invokePropertyGetAsync=function(Fa){Fa=this.invokePropertyGet(Fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Fa)};n.prototype.invokePropertySet=function(Fa,Za){switch(Fa){case 1:this.zoom=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Za,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Fa);
};n.prototype.invokePropertySetAsync=function(Fa,Za){this.invokePropertySet(Fa,Za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};n.prototype.invokeMethod=function(Fa,Za){switch(Fa){case 1007:return this.Lge(Za);case 1001:return this.boe(Za);case 1003:return this.YLe();case 1005:return this.vYe();case 1004:return this.o_e();case 1002:return this.Kff(Za);case 1006:return this.FTf(Za)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Fa);};n.prototype.invokeMethodAsync=
function(Fa,Za){Fa=this.invokeMethod(Fa,Za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Fa)};n.prototype.Lge=function(Fa){var Za=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,0,"int");Fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,1,"Array<Visio.Extension.DGShapeData>");this.applyDataGraphics(Za,Fa);return null};n.prototype.boe=function(Fa){Fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,0,"int");this.centerViewportOnShape(Fa);
return null};n.prototype.YLe=function(){this.fitToWindow();return null};n.prototype.vYe=function(){return this.getPosition()};n.prototype.o_e=function(){return this.getSelection()};n.prototype.Kff=function(Fa){Fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,0,Ua.Shape);return this.isShapeInViewport(Fa)};n.prototype.FTf=function(Fa){Fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,0,Pa.a);this.setPosition(Fa);return null};D.global.Object.defineProperties(n.prototype,
{zoom:{configurable:!0,enumerable:!0,get:function(){n.Qld&&(R.ULS.sendTraceTag(25811015,700,50,"JSApi:PageView:GetZoom"),n.Qld=!1);return ca.Application.gW().rv},set:function(Fa){n.Rmd&&(R.ULS.sendTraceTag(25811016,700,50,"JSApi:PageView:SetZoom"),n.Rmd=!1);ca.Application.gW().lx(Fa/100,!0)}}});n.Lkd=!0;n.bmd=!0;n.nld=!0;n.Jld=!0;n.Ild=!0;n.Mmd=!0;n.Qld=!0;n.Rmd=!0;n.Ikd=!0;Object(C.a)(n,"PageView",null,[]);var Sa=e(1100),kb=e(1136),zb=e(1124);b.prototype.activate=function(){var Fa=F.a.Fb();b.hmd&&
(R.ULS.sendTraceTag(21611083,700,50,"JSApi:Page:Activate"),b.hmd=!1);ca.Application.cR().activePage.id!==this.ma.id&&ca.Application.cR().setActivePage(this.ma.id,!1);var Za=F.a.Fb();R.ULS.sendTraceTag(509360093,700,50,"[VO_Perf] JSApi:Page:Activate: Time taken (ms): {0}",Za-Fa)};b.prototype.SetShapeFillFormat=function(Fa,Za,Ea,Na){Za=void 0===Za?0:Za;Ea=void 0===Ea?0:Ea;Na=void 0===Na?0:Na;if(void 0===Fa||null===Fa)throw OfficeExtension.WacRuntime.Utility.createRichApiException(na.a.invalidArgument,
"shapeID cannot be null");if(!(0<=Za&&255>=Za&&0<=Ea&&255>=Ea&&0<=Na&&255>=Na))throw OfficeExtension.WacRuntime.Utility.createRichApiException(na.a.invalidArgument,"Invalid R G B value");var $a=this.shapes.eR(Number.parseInt(Fa));Fa=[];var Ba=this.application.CommandingManager;Za=Ba.createSetShapeFillFormatCommand($a,Za,Ea,Na);Fa.push(Za);try{var Xa=Ba.executeCommands(Fa)}catch(Oa){return!1}return Xa?!0:!1};b.prototype.MoveShape=function(Fa,Za,Ea){Za=void 0===Za?0:Za;Ea=void 0===Ea?0:Ea;if(void 0===
Fa||null===Fa)throw OfficeExtension.WacRuntime.Utility.createRichApiException(na.a.invalidArgument,"shapeID cannot be null");var Na=this.shapes.eR(Number.parseInt(Fa));Fa=[];var $a=this.application.CommandingManager;Za=$a.createBulkMoveShapeCommand([Na],[Za],[Ea]);Fa.push(Za);try{var Ba=$a.executeCommands(Fa)}catch(Xa){return!1}return Ba?!0:!1};b.prototype.DeleteShape=function(Fa){if(void 0===Fa||null===Fa)throw OfficeExtension.WacRuntime.Utility.createRichApiException(na.a.invalidArgument,"shapeID cannot be null");
var Za=this.shapes.eR(Number.parseInt(Fa));Fa=[];var Ea=this.application.CommandingManager;Za=Ea.createDeleteShapesCommand([Za]);Fa.push(Za);try{var Na=Ea.executeCommands(Fa)}catch($a){return!1}return Na?!0:!1};b.prototype.AddOrUpdateHyperlink=function(Fa,Za,Ea,Na,$a,Ba){$a=void 0===$a?"":$a;Ba=void 0===Ba?0:Ba;if(void 0===Fa||null===Fa)throw OfficeExtension.WacRuntime.Utility.createRichApiException(na.a.invalidArgument,"shapeID cannot be null");var Xa=this.shapes.eR(Number.parseInt(Fa));Fa=[];var Oa=
this.application.CommandingManager;Za=Oa.createAddHyperlinkCommand(Xa,Za,Ea,Na,this.ma.id,$a,Ba);if(null==Za)return!1;Fa.push(Za);try{var Fb=Oa.executeCommands(Fa)}catch(ub){return!1}return Fb?!0:!1};b.prototype.ChangeLayout=function(Fa,Za){Za=void 0===Za?null:Za;if(void 0===Fa||null===Fa)throw OfficeExtension.WacRuntime.Utility.createRichApiException(na.a.invalidArgument,"layoutType cannot be null");var Ea=[];if(Za)for(var Na in Za)Ea.push(this.shapes.eR(Number.parseInt(Za[Na])));Za=[];Fa=this.application.CommandingManager.createPageLayoutCommand(Ea,
this.P2.id,Fa);Za.push(Fa);try{var $a=this.application.CommandingManager.executeCommands(Za)}catch(Ba){return!1}return $a?!0:!1};b.prototype.AddShapeText=function(Fa,Za){Za=void 0===Za?"":Za;if(void 0===Fa||null===Fa)throw OfficeExtension.WacRuntime.Utility.createRichApiException(na.a.invalidArgument,"shapeID cannot be null");var Ea=this.shapes.eR(Number.parseInt(Fa));Fa=[];var Na=this.application.CommandingManager;Za=Na.createSetTextCommand(Ea,Za);Fa.push(Za);try{var $a=Na.executeCommands(Fa)}catch(Ba){return!1}return $a?
!0:!1};b.prototype.ChangeConnectorType=function(Fa,Za){Za=void 0===Za?null:Za;var Ea=[],Na=ca.Application.cR().activePage,$a=[];if(null!=Za)for(var Ba=0;Ba<Za.length;++Ba){var Xa=this.allShapes.eR(Za[Ba]);Array.add($a,Xa)}Fa=this.application.CommandingManager.createChangeConnectorTypeOnPageCommand(Fa,Na,$a);Array.add(Ea,Fa);this.application.CommandingManager.executeCommands(Ea)};b.prototype.ChangeShape=function(Fa,Za,Ea){var Na=this;this.application.getStencilInfo(Za,!0).then(function($a){var Ba,
Xa,Oa,Fb,ub,Wb;return D.Td(function(Kc){Ba=$a;Xa=Na.bib(Ba,Ea);Oa=[];Fb=[];for(ub in Fa)Fb.push(Na.shapes.eR(Fa[ub]));Wb=Na.application.CommandingManager.createChangeShapeCommand(Fb,Xa.masterId,Xa.stencilId);Array.add(Oa,Wb);Na.application.CommandingManager.executeChangeShapeCommands(Oa);mt(Kc)})},function($a){console.log($a.toString())})};b.prototype.AddShape=function(Fa,Za,Ea,Na){var $a=this;return this.application.getStencilInfo(Fa,!0).then(function(Ba){var Xa,Oa,Fb,ub,Wb,Kc,dc;return D.Td(function(eb){Xa=
Ba;Oa=$a.bib(Xa,Za);Fb=new zb.a;Fb.x=Ea;Fb.y=Na;ub=[];Wb=$a.application.CommandingManager.createAddShapeHavingMasterCommand($a,Oa,Fb);Array.add(ub,Wb);Kc=$a.application.CommandingManager.executeAddShapeCommands(ub);dc=function(Bb){$a.registerShapesIdUpdatedEvent(function(Ib){Ib.shapesIdUpdatedRecordEventObj.shapeIdUpdatedRecords[0].oldShapeId!=Kc.oe.id&&Bb(Kc.oe.id)})};return eb.return(OfficeExtension.WacRuntime.Utility.createPromise(dc))})},function(Ba){console.log(Ba.toString());return Promise.reject(null)})};
b.prototype.AddConnector=function(Fa,Za,Ea,Na){var $a=this,Ba=[],Xa=this.application.CommandingManager;if(0==Na){var Oa=0;var Fb=1}else 1==Na?(Oa=1,Fb=0):2==Na?(Oa=2,Fb=3):3==Na&&(Oa=3,Fb=2);Fa=this.allShapes.getItem(Fa);Za=this.allShapes.getItem(Za);Ea=Xa.createAddLineConnectorCommand(Oa,Fb,Fa,Za,null,!0,Ea);Ba.push(Ea);var ub=this.application.CommandingManager.executeAddShapeCommands(Ba);return OfficeExtension.WacRuntime.Utility.createPromise(function(Wb){$a.registerShapesIdUpdatedEvent(function(Kc){Kc.shapesIdUpdatedRecordEventObj.shapeIdUpdatedRecords[0].oldShapeId!=
ub.oe.id&&Wb(ub.oe.id)})})};b.prototype.UpdateShapeData=function(Fa,Za,Ea){if(void 0===Fa||null===Fa)throw OfficeExtension.WacRuntime.Utility.createRichApiException(na.a.invalidArgument,"shapeID cannot be null for Update shape data command");var Na=this.shapes.eR(Number.parseInt(Fa));Fa=[];var $a=this.application.CommandingManager;Za=$a.updateShapeDataCommand(Na,this.ma.id,Za,Ea);Fa.push(Za);try{var Ba=$a.executeCommands(Fa)}catch(Xa){return!1}return Ba?!0:!1};b.prototype.WQd=function(Fa,Za,Ea,Na,
$a){var Ba=this;Ea=void 0===Ea?0:Ea;Na=void 0===Na?0:Na;$a=void 0===$a?0:$a;var Xa=[],Oa=this.application.CommandingManager;if(null==Fa||void 0==Fa||null==Za||void 0==Za)throw OfficeExtension.WacRuntime.Utility.createRichApiException(na.a.invalidArgument,"shapeIDs cannot be null");Fa=this.allShapes.getItem(Fa);Za=this.allShapes.getItem(Za);if(!Fa.oe.connectionPoints.getItemAt(Ea)||!Za.oe.connectionPoints.getItemAt(Na))throw OfficeExtension.WacRuntime.Utility.createRichApiException(na.a.invalidArgument,
"Invalid connection points");Ea=Oa.createAddLineConnectorCommand(Ea,Na,Fa,Za,null,!0,$a);Xa.push(Ea);var Fb=this.application.CommandingManager.executeAddShapeCommands(Xa);return OfficeExtension.WacRuntime.Utility.createPromise(function(ub){Ba.registerShapesIdUpdatedEvent(function(Wb){Wb.shapesIdUpdatedRecordEventObj.shapeIdUpdatedRecords[0].oldShapeId!=Fb.oe.id&&ub(Fb.oe.id)})})};b.prototype.boundingBox=function(){};b.prototype.createDiagramFromData=function(Fa,Za,Ea,Na,$a,Ba){if(void 0===Fa||null===
Fa)throw OfficeExtension.WacRuntime.Utility.createRichApiException(na.a.invalidArgument,"DiagramType cannot be null");if(void 0===Za||null===Za)throw OfficeExtension.WacRuntime.Utility.createRichApiException(na.a.invalidArgument,"TableData cannot be null");ea.a.ewb(Na);Fa=ea.a.j6c(Fa,Za,Ea,Na,$a,Ba,this.ma);X.a.APa(Fa);R.ULS.sendTraceTag(509360092,700,50,"Create DV API called")};b.prototype.createVisualization=function(Fa,Za){this.createVisualization(Fa,Za)};b.prototype.setDataSourceToDiagram=function(Fa,
Za){if(void 0===Fa||null===Fa)throw OfficeExtension.WacRuntime.Utility.createRichApiException(na.a.invalidArgument,"ContainerID cannot be null");ea.a.ewb(Za);Fa=this.nOe(Fa,Za);X.a.setDataSourceToDiagram(Fa);R.ULS.sendTraceTag(509360091,700,50,"SetDataSourceToDiagram API called")};b.prototype.updateDiagramFromData=function(Fa,Za,Ea,Na){if(void 0===Za||null===Za)throw OfficeExtension.WacRuntime.Utility.createRichApiException(na.a.invalidArgument,"TableData cannot be null");ea.a.ewb(Ea);Fa=this.tOe(Fa,
Za,Ea,Na);X.a.NNd(Fa);R.ULS.sendTraceTag(509360090,700,50,"Update DV API called")};b.prototype.getTypeName=function(){return"Microsoft.Visio.Page"};b.prototype.invokePropertyGet=function(Fa){switch(Fa){case 9:return this.allShapes;case 10:return this.application;case 8:return this.comments;case 13:return this.dataVisualizerDiagrams;case 11:return this.document;case 7:return this.height;case 12:return this.id;case 1:return this.index;case 3:return this.isBackground;case 2:return this.name;case 4:return this.shapes;
case 5:return this.view;case 6:return this.width}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Fa);};b.prototype.invokePropertyGetAsync=function(Fa){Fa=this.invokePropertyGet(Fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Fa)};b.prototype.invokePropertySet=function(Fa){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Fa);};b.prototype.invokePropertySetAsync=function(Fa,Za){this.invokePropertySet(Fa,Za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
b.prototype.invokeMethod=function(Fa,Za){switch(Fa){case 1001:return this.m8d();case 1014:return this.vTd(Za);case 1007:if(ca.Application.getBRS("VisioWebEditAPIsEnabled",!1))return this.USd(Za);break;case 1018:if(ca.Application.getBRS("VisioWebEditAPIsEnabled",!0))return this.zRd(Za);break;case 1008:if(ca.Application.getBRS("VisioWebEditAPIsEnabled",!1))return this.aSd(Za);break;case 1020:if(ca.Application.getBRS("VisioWebEditAPIsEnabled",!1))return this.bRd(Za);break;case 1021:if(ca.Application.getBRS("VisioWebEditAPIsEnabled",
!1))return this.BRd(Za);break;case 1013:if(ca.Application.getBRS("VisioWebEditAPIsEnabled",!1))return this.ARd(Za);break;case 1009:if(ca.Application.getBRS("VisioWebEditAPIsEnabled",!1))return this.fRd(Za);break;case 1022:if(ca.Application.getBRS("VisioWebEditAPIsEnabled",!1))return this.LTd(Za);break;case 1004:return this.hSb(Za);case 1002:return this.Eue(Za);case 1006:return this.uAe(Za);case 1005:return this.QRf(Za);case 1003:return this.I8f(Za)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Fa);
};b.prototype.invokeMethodAsync=function(Fa,Za){switch(Fa){case 1010:if(ca.Application.getBRS("VisioWebEditAPIsEnabled",!1))return this.eRd(Za);break;case 1011:if(ca.Application.getBRS("VisioWebEditAPIsEnabled",!1))return this.YQd(Za);break;case 1012:if(ca.Application.getBRS("VisioWebEditAPIsEnabled",!1))return this.XQd(Za)}Fa=this.invokeMethod(Fa,Za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Fa)};b.prototype.m8d=function(){this.activate();return null};b.prototype.vTd=function(Fa){var Za=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,0,"string"),Ea=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,1,"number"),Na=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,2,"number");Fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,3,"number");return this.SetShapeFillFormat(Za,Ea,Na,Fa)};b.prototype.USd=function(Fa){var Za=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,0,"string"),Ea=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,
1,"number");Fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,2,"number");return this.MoveShape(Za,Ea,Fa)};b.prototype.aSd=function(Fa){Fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,0,"string");return this.DeleteShape(Fa)};b.prototype.fRd=function(Fa){var Za=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,0,"string");Fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,1,"string");return this.AddShapeText(Za,Fa)};b.prototype.zRd=function(Fa){var Za=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,0,"number");Fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,1,"number[]");return this.ChangeConnectorType(Za,Fa)};b.prototype.BRd=function(Fa){var Za=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,0,"Array<int>"),Ea=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,1,"string");Fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,2,"string");return this.ChangeShape(Za,Ea,Fa)};b.prototype.eRd=
function(Fa){var Za=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,0,"string"),Ea=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,1,"string"),Na=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,2,"number");Fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,3,"number");return this.AddShape(Za,Ea,Na,Fa)};b.prototype.YQd=function(Fa){var Za=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,0,"string"),Ea=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,
1,"string"),Na=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,2,"number");Fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,3,"number");return this.AddConnector(Za,Ea,Na,Fa)};b.prototype.bRd=function(Fa){var Za=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,0,"string"),Ea=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,1,"string"),Na=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,2,"number"),$a=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,
3,"number"),Ba=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,4,"string");Fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,5,"number");return this.AddOrUpdateHyperlink(Za,Ea,Na,$a,Ba,Fa)};b.prototype.XQd=function(Fa){var Za=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,0,"string"),Ea=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,1,"string"),Na=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,2,"number"),$a=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,
3,"number");Fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,4,"number");return this.WQd(Za,Ea,Na,$a,Fa)};b.prototype.ARd=function(Fa){var Za=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,0,"number");Fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,1,"Array<string>");return this.ChangeLayout(Za,Fa)};b.prototype.LTd=function(Fa){var Za=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,0,"string"),Ea=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,
1,"string");Fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,2,"string");return this.UpdateShapeData(Za,Ea,Fa)};b.prototype.bib=function(Fa,Za){for(var Ea=0;Ea<Fa.mastersInfo.length;Ea++)if(Fa.mastersInfo[Ea].nameU===Za)return Fa.mastersInfo[Ea]};b.prototype.hSb=function(Fa){var Za=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,0,"int"),Ea=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,1,"number"),Na=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,
2,"number"),$a=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,3,"number");Fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,4,"number");this.boundingBox(Za,Ea,Na,$a,Fa);return null};b.prototype.Eue=function(Fa){var Za=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,0,"int"),Ea=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,1,"Array<Array<string>>"),Na=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,2,Sa.a),$a=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,
3,za.a),Ba=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,4,"boolean");Fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,5,"boolean");this.createDiagramFromData(Za,Ea,Na,$a,Ba,Fa);return null};b.prototype.uAe=function(Fa){var Za=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,0,S);Fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,1,x);this.createVisualization(Za,Fa);return null};b.prototype.QRf=function(Fa){var Za=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,
0,"string");Fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,1,za.a);this.setDataSourceToDiagram(Za,Fa);return null};b.prototype.I8f=function(Fa){var Za=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,0,"string"),Ea=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,1,"Array<Array<string>>"),Na=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,2,za.a);Fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Fa,3,"boolean");this.updateDiagramFromData(Za,
Ea,Na,Fa);return null};b.prototype.UpdatePageObject=function(Fa){this.ma=Fa};b.prototype.mYe=function(Fa){try{var Za=K.a.I7c(Fa);if(void 0===Za||null===Za||void 0===Za.ops||null===Za.ops)return Fa;for(var Ea=new Sys.StringBuilder,Na=D.makeIterator(Za.ops),$a=Na.next();!$a.done;$a=Na.next()){var Ba=$a.value;if(void 0===Ba.insert||null===Ba.insert)return Fa;Ea.append(Ba.insert)}return Ea.toString()}catch(Xa){return Fa}};b.prototype.Gvd=function(){this.kGa=null;this.nd=new I.a;var Fa=this.Vm.comments;
if(void 0!==Fa&&null!==Fa){var Za=Fa.GJ();Fa=[];Za=D.makeIterator(Za);for(var Ea=Za.next();!Ea.done;Ea=Za.next()){var Na=Ea.value,$a=this.mYe(Na.text[0]);Ea=new Y.Comment(Na.id,Na.qSa,Na.author,Na.date,Na.nf,Na.done,[],Na.TB,Na.KWc,Na.authorId,Na.Hie,Na.usersByReactionType);Array.add(Ea.text,$a);Na.TB===this.index&&(Na=parseInt(Na.ul),Na===P.a.invalidShapeId?Array.add(Fa,Ea):(this.nd.pb(Na)||this.nd.add(Na,[]),Array.add(this.nd.ia(Na),Ea)))}0<Fa.length&&(this.kGa=new W.a(Fa))}};b.prototype.C_e=function(Fa){void 0!==
this.nd&&null!==this.nd||this.Gvd();return this.nd.ia(parseInt(Fa))};b.prototype.tOe=function(Fa,Za,Ea,Na){var $a=new J;$a.recordSetData=Za;$a.dataRange=Ea.dataRange;Za=this.ma.shapes;if(void 0===Za||null===Za)throw OfficeExtension.WacRuntime.Utility.createRichApiException(na.a.qR,"No Shapes in Page");$a.containerShape=Za.Ga(Fa);if(void 0===$a.containerShape||null===$a.containerShape)throw OfficeExtension.WacRuntime.Utility.createRichApiException(na.a.qR,"Invalid ContainerId");$a.fitPageToDrawing=
!0;$a.overrideConflicts=Na;return $a};b.prototype.nOe=function(Fa,Za){var Ea=new Q;Ea.containerID=Fa;Ea.pageID=this.ma.id;Ea.filePath=Za.filePath;Ea.isTable=Za.isTable;Ea.tableOrSheetName=Za.tableOrSheetName;Ea.dataRange=Za.dataRange;return Ea};b.prototype.oBf=function(){for(var Fa=[],Za=new I.a,Ea=D.makeIterator(this.ma.shapes.items),Na=Ea.next();!Na.done;Na=Ea.next())Na=Na.value,Na.isBoundToData&&Na.zkb&&(Na=new w(Na),Array.add(Fa,Na),Za.U(Na.id.toString(),Na));this.DBb=new m(this.ma,Fa,Za)};b.prototype.registerShapesAddedEvent=
function(Fa){return kb.e(this.ma.id,Fa)};b.prototype.unregisterShapesAddedEvent=function(Fa){kb.n(this.ma.id,Fa)};b.prototype.registerShapesUpdatedEvent=function(Fa,Za){return kb.h(Fa,Za)};b.prototype.unregisterShapesUpdatedEvent=function(Fa){kb.q(this.ma.id,Fa)};b.prototype.registerShapesDeletedEvent=function(Fa){return kb.f(this.ma.id,Fa)};b.prototype.unregisterShapesDeletedEvent=function(Fa){kb.o(this.ma.id,Fa)};b.prototype.registerShapesIdUpdatedEvent=function(Fa){return kb.g(this.ma.id,Fa)};
b.prototype.unregisterShapesIdUpdatedEvent=function(Fa){kb.p(this.ma.id,Fa)};b.prototype.getIntersectionShapePercentage=function(Fa,Za,Ea,Na,$a,Ba,Xa){var Oa=Xa.GetDimensions();Ea=Oa.startX;Xa=Oa.startY;Na=Oa.width;Oa=Oa.height;if(Xa>=Za){if(Xa>Za+$a)return 0;Za=Math.min(Za+$a,Xa+Oa)-Xa}else{if(Za>Xa+Oa)return 0;Za=Math.min(Za+$a,Xa+Oa)-Za}if(Ea>=Fa){if(Ea>Fa+Ba)return 0;Fa=Math.min(Fa+Ba,Ea+Na)-Ea}else{if(Fa>Ea+Na)return 0;Fa=Math.min(Fa+Ba,Ea+Na)-Fa}return Za*Fa*100/($a*Ba)};D.global.Object.defineProperties(b.prototype,
{allShapes:{configurable:!0,enumerable:!0,get:function(){b.imd&&(R.ULS.sendTraceTag(509360131,700,50,"JSApi:Page:AllShapes"),b.imd=!1);this.xY||void 0===this.ma.allShapes||null===this.ma.allShapes||(this.xY=new Da.a(this.ma.allShapes.items));return this.xY}},application:{configurable:!0,enumerable:!0,get:function(){return ca.Application.instance()}},comments:{configurable:!0,enumerable:!0,get:function(){b.jmd&&(R.ULS.sendTraceTag(21611082,700,50,"JSApi:Page:Comments"),b.jmd=!1);void 0!==this.kGa&&
null!==this.kGa||this.Gvd();return this.kGa}},dataVisualizerDiagrams:{configurable:!0,enumerable:!0,get:function(){b.lmd&&(R.ULS.sendTraceTag(509360130,700,50,"JSApi:Page:DataVisualizerDiagrams"),b.lmd=!1);this.DBb||this.oBf();return this.DBb}},document:{configurable:!0,enumerable:!0,get:function(){return null}},height:{configurable:!0,enumerable:!0,get:function(){b.mmd&&(R.ULS.sendTraceTag(509360129,700,50,"JSApi:Page:Height"),b.mmd=!1);return this.ma&&void 0!==this.ma.properties&&null!==this.ma.properties?
this.ma.properties.Nf:-1}},id:{configurable:!0,enumerable:!0,get:function(){b.nmd&&(R.ULS.sendTraceTag(509360128,700,50,"JSApi:Page:ID"),b.nmd=!1);return parseInt(this.ma.id)}},index:{configurable:!0,enumerable:!0,get:function(){b.omd&&(R.ULS.sendTraceTag(509360099,700,50,"JSApi:Page:Index"),b.omd=!1);return parseInt(this.ma.id)}},isBackground:{configurable:!0,enumerable:!0,get:function(){b.pmd&&(R.ULS.sendTraceTag(509360098,700,50,"JSApi:Page:IsBackground"),b.pmd=!1);return this.ma.Gp}},name:{configurable:!0,
enumerable:!0,get:function(){b.qmd&&(R.ULS.sendTraceTag(509360097,700,50,"JSApi:Page:Name"),b.qmd=!1);return this.ma.internalName}},shapes:{configurable:!0,enumerable:!0,get:function(){b.rmd&&(R.ULS.sendTraceTag(509360096,700,50,"JSApi:Page:Shapes"),b.rmd=!1);this.kLb||void 0===this.ma.shapes||null===this.ma.shapes||(this.kLb=new Da.a(this.ma.shapes.items));return this.kLb}},view:{configurable:!0,enumerable:!0,get:function(){b.smd&&(R.ULS.sendTraceTag(509360095,700,50,"JSApi:Page:PageView"),b.smd=
!1);this.xd||(this.xd=new n(this));return this.xd}},width:{configurable:!0,enumerable:!0,get:function(){b.tmd&&(R.ULS.sendTraceTag(509360094,700,50,"JSApi:Page:Width"),b.tmd=!1);return this.ma&&void 0!==this.ma.properties&&null!==this.ma.properties?this.ma.properties.Sg:-1}},UserRows:{configurable:!0,enumerable:!0,get:function(){return this.ma&&void 0!==this.ma.properties&&null!==this.ma.properties?this.ma.properties.userRows:{}}},P2:{configurable:!0,enumerable:!0,get:function(){return this.ma}},
selectedShapes:{configurable:!0,enumerable:!0,get:function(){var Fa=ca.Application.bW().selectedShapes;return new Da.a(Fa)}}});b.jmd=!0;b.hmd=!0;b.nmd=!0;b.omd=!0;b.qmd=!0;b.pmd=!0;b.rmd=!0;b.tmd=!0;b.mmd=!0;b.smd=!0;b.imd=!0;b.lmd=!0;Object(C.a)(b,"Page",null,[])},1139:function(C,H,e){function b(v){this.Xt=this.RB=0;this.nd=v;this.zAb=new r.a}function n(v,x,A){this.Y4=this._text=null;this.lFa=v;void 0!==x&&null!==x&&(this.Y4=x.toDateString());void 0!==A&&null!==A&&(this._text=A.join("\n"))}e.d(H,
"a",function(){return b});C=e(0);var k=e(31),r=e(805);n.prototype.getTypeName=function(){return"Microsoft.Visio.Comment"};n.prototype.invokePropertyGet=function(v){switch(v){case 1:return this.author;case 3:return this.date;case 2:return this.text}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);};n.prototype.invokePropertyGetAsync=function(v){v=this.invokePropertyGet(v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)};n.prototype.invokePropertySet=function(v,
x){switch(v){case 1:this.author=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(x,0,"string");return;case 3:this.date=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(x,0,"string");return;case 2:this.text=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(x,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);};n.prototype.invokePropertySetAsync=function(v,x){this.invokePropertySet(v,x);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
n.prototype.invokeMethod=function(v){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);};n.prototype.invokeMethodAsync=function(v,x){v=this.invokeMethod(v,x);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)};D.global.Object.defineProperties(n.prototype,{author:{configurable:!0,enumerable:!0,get:function(){n.vld&&(k.ULS.sendTraceTag(25810947,700,50,"JSApi:Comment: Get Author"),n.vld=!1);return this.lFa},set:function(v){n.Emd&&(k.ULS.sendTraceTag(25810948,700,
50,"JSApi:Comment: Set Author"),n.Emd=!1);this.lFa=v}},date:{configurable:!0,enumerable:!0,get:function(){n.sld&&(k.ULS.sendTraceTag(25810949,700,50,"JSApi:Comment: Get Date"),n.sld=!1);return this.Y4},set:function(v){n.Cmd&&(k.ULS.sendTraceTag(25810950,700,50,"JSApi:Comment:Set Date"),n.Cmd=!1);this.Y4=v}},text:{configurable:!0,enumerable:!0,get:function(){n.uld&&(k.ULS.sendTraceTag(25810951,700,50,"JSApi:Comment Text:Get Start"),n.uld=!1);return this._text},set:function(v){n.Dmd&&(k.ULS.sendTraceTag(25810952,
700,50,"JSApi:Comment Text:Set Start"),n.Dmd=!1);this._text=v}}});n.vld=!0;n.Emd=!0;n.uld=!0;n.Dmd=!0;n.sld=!0;n.Cmd=!0;Object(C.a)(n,"Comment",null,[]);var m=e(1090),w=e(1082);b.prototype.getCount=function(){b.Okd&&(k.ULS.sendTraceTag(25810953,700,50,"JSApi:CommentCollection:Count"),b.Okd=!1);return this.length()};b.prototype.getItem=function(v){this.RB++;b.tld&&(k.ULS.sendTraceTag(25810954,700,50,"JSApi:CommentCollection:GetItem"),b.tld=!1);if(void 0===v||null===v)throw this.Xt++,k.ULS.sendTraceTag(25805658,
700,10,"JSApi:HyperlinkCollection:GetItem: Total Calls: "+this.RB+"  Failure Count: "+this.Xt),OfficeExtension.WacRuntime.Utility.createRichApiException(w.a.invalidArgument,"InvalidArgument");var x=parseInt(v.toString());if(!isNaN(x)&&0<=x&&x<this.nd.length){v=this.nd[x].id;if(this.zAb.pb(v))return this.zAb.ia(v);x=new n(this.nd[x].author,this.nd[x].date,this.nd[x].text);this.zAb.U(v,x);return x}this.Xt++;k.ULS.sendTraceTag(25805659,700,10,"JSApi:HyperlinkCollection:GetItem: Total Calls: "+this.RB+
"  Failure Count: "+this.Xt);throw OfficeExtension.WacRuntime.Utility.createRichApiException(w.a.invalidArgument,"InvalidArgument");};b.prototype.getAsyncEnumerator=function(v,x){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new m.a(v,x,this))};b.prototype.getTypeName=function(){return"Microsoft.Visio.CommentCollection"};b.prototype.invokePropertyGet=function(v){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);};b.prototype.invokePropertyGetAsync=function(v){v=
this.invokePropertyGet(v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)};b.prototype.invokePropertySet=function(v){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);};b.prototype.invokePropertySetAsync=function(v,x){this.invokePropertySet(v,x);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};b.prototype.invokeMethod=function(v,x){switch(v){case 1001:return this.HJ();case 1:return this.JJ(x)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);
};b.prototype.invokeMethodAsync=function(v,x){v=this.invokeMethod(v,x);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)};b.prototype.HJ=function(){return this.getCount()};b.prototype.JJ=function(v){v=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"any");return this.getItem(v)};b.prototype.length=function(){return void 0===this.nd||null===this.nd?0:this.nd.length};b.prototype.getItemByIndex=function(v){return this.getItem(v)};b.tld=!0;b.Okd=!0;Object(C.a)(b,"CommentCollection",
null,[395])},1144:function(C,H,e){function b(J,Q,R,F,K,I,Y,X,ca,W){ca=void 0===ca?[]:ca;W=void 0===W?[]:W;this.t1a=null;this.u1a=!1;this._name=J;this._id=Q;this.dAc=R;this.$Yd=F;this.L_d=K;this.J5d=I;this.I5d=Y;this.B4d=X;this.OXd=ca;this.tCb=W}e.r(H);e.d(H,"DownloadableFirstPartyAddonAdapter",function(){return b});C=e(0);var n=e(31),k=e(1),r=e(328),m=e(221),w=e(260),v=e(494),x=e(1080),A=e(7),B=e(98),E=e(99),L=e(60),S=e(1120);b.prototype.dqb=function(J){var Q=this,R=r.a.create().toString();B.a.Ra(E.a.Ftb,
R,L.a.Etb,1,new Date);return new Promise(function(F){if(Q.nR)F(!0);else if(Q.u1a)n.ULS.sendTraceTag(509212899,700,15,"Not retrying addin as registeration have already failed - {0}",Q._id),F(!1);else{k.AFrameworkApplication.H.J("VisioWebSolutionLoadExperienceImprovementEnabled")&&Q.g0c(!0);var K=k.AFrameworkApplication.H.qa("VisioWebJsOverrideURLEnabled");K=A.a.ka(K)?k.AFrameworkApplication.Np(Q.dAc,5).replace("Debug.","debug."):K+Q.dAc.replace("debug","Debug");K=m.a.create(K);K.qG(function(I,Y){if(Y.succeeded)try{Q.t1a=
new (Type.parse(Q.$Yd))(Q),Q.t1a.Init(x.Document.S9(),J),B.a.Ra(E.a.Ftb,R,L.a.Etb,2,new Date),F(!0)}catch(X){n.ULS.sendTraceTag(509212898,700,15,"Exception during addon registration - {0}, Exception Message: {1}, Stack: {2}",Q.id,X.message,X.stack),Q.u1a=!0,B.a.Ra(E.a.Ftb,R,L.a.Etb,2,new Date),F(!1)}else n.ULS.sendTraceTag(509145250,700,15,"Addon registration failed as script download failed - {0}",Q.id),Q.u1a=!0,B.a.Ra(E.a.Ftb,R,L.a.Etb,2,new Date),F(!1);k.AFrameworkApplication.H.J("VisioWebSolutionLoadExperienceImprovementEnabled")&&
Q.u1a&&Q.g0c(!1)});w.a.KB(K)}})};b.prototype.g0c=function(J){0<this.disabledFeatures.length&&(J?S.a.instance.addDisableFeatureListForAddon(this.shapeCategory,this.disabledFeatures):S.a.instance.addEnableFeatureListForAddon(this.shapeCategory,this.disabledFeatures));0<this.enabledFeatures.length&&(J?S.a.instance.addEnableFeatureListForAddon(this.shapeCategory,this.tCb):S.a.instance.addDisableFeatureListForAddon(this.shapeCategory,this.tCb))};b.aif=function(){var J=k.AFrameworkApplication.H.J("VisioWeb1JSTypescriptBundlesEnabled");
var Q=[];var R=k.AFrameworkApplication.H.J("VisioWebOrgChartSolutionAllLocalesEnabled")?[]:["1033"];b.gHb||(b.gHb=[new b("Demo Solution","VizJSAddon_Demo",v.a.JG(J?"Visio.DemoSolution.{0}js":"VisioWebSolutions.DemoSolutionDS.{0}js"),"Visio.DemoSolution.DemoAddon",!1,["1033"],[],"Demo",[],[]),new b("Org Chart Solution","VizJSAddon_Orgchart",v.a.JG(J?"Visio.OrgchartSolution.{0}js":"VisioWebSolutions.OrgChartSolutionDS.{0}js"),"Visio.OrgchartSolution.OrgchartAddon",!1,R,Q,"OrgChart",[],[]),new b("MindMap Solution",
"VizJSAddon_MindMap",v.a.JG(J?"Visio.MindMapSolution.{0}js":"VisioWebSolutions.MindMapSolutionDS.{0}js"),"Visio.MindMapSolution.MindMapAddon",!1,["1033"],[],"MindMap",[21,0,2,3,15,14,11,8,9,13,19,18,10,12,7,1],[]),new b("SemanticFramework Demo Solution","VizJSAddon_SemanticFrameworkDemo",v.a.JG(J?"Visio.SemanticFrameworkDemoSolution.{0}js":"VisioWebSolutions.SemanticFrameworkDemoSolutionDS.{0}js"),"Visio.SemanticFrameworkDemoSolution.SemanticFrameworkDemoAddon",!0,["1033"],[],"SemanticFrameworkDemo",
[],[])]);return b.gHb};D.global.Object.defineProperties(b.prototype,{isEnabled:{configurable:!0,enumerable:!0,get:function(){return k.AFrameworkApplication.H.J("VisioEditAddonEnabled_"+this.id)}},isGlobal:{configurable:!0,enumerable:!0,get:function(){return this.L_d}},id:{configurable:!0,enumerable:!0,get:function(){return this._id}},name:{configurable:!0,enumerable:!0,get:function(){return this._name}},supportedLocales:{configurable:!0,enumerable:!0,get:function(){return this.J5d}},supportedLicenses:{configurable:!0,
enumerable:!0,get:function(){return this.I5d}},shapeCategory:{configurable:!0,enumerable:!0,get:function(){return this.B4d}},disabledFeatures:{configurable:!0,enumerable:!0,get:function(){return this.OXd}},enabledFeatures:{configurable:!0,enumerable:!0,get:function(){return this.tCb}},nR:{configurable:!0,enumerable:!0,get:function(){return!!this.t1a}},Icc:{configurable:!0,enumerable:!0,get:function(){return this.t1a}}});b.gHb=null;Object(C.a)(b,"DownloadableFirstPartyAddonAdapter",null,[422,423])},
1145:function(C){function H(){H.init.call(this)}function e(B){if("function"!==typeof B)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof B);}function b(B,E,L,S){e(L);var J=B.ja;if(void 0===J)J=B.ja=Object.create(null),B.GO=0;else{void 0!==J.Qng&&(B.emit("newListener",E,L.listener?L.listener:L),J=B.ja);var Q=J[E]}void 0===Q?(J[E]=L,++B.GO):("function"===typeof Q?Q=J[E]=S?[L,Q]:[Q,L]:S?Q.unshift(L):Q.push(L),L=void 0===B.D7a?H.kgg:B.D7a,0<L&&Q.length>L&&!Q.wcg&&
(Q.wcg=!0,L=Error("Possible EventEmitter memory leak detected. "+Q.length+" "+String(E)+" listeners added. Use emitter.setMaxListeners() to increase limit"),L.name="MaxListenersExceededWarning",L.Dgg=B,L.type=E,L.count=Q.length,console&&console.warn&&console.warn(L)));return B}function n(){if(!this.fired)return this.target.removeListener(this.type,this.vQd),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function k(B,E,L){B={fired:!1,vQd:void 0,
target:B,type:E,listener:L};E=n.bind(B);E.listener=L;return B.vQd=E}function r(B,E,L){"function"===typeof B.on&&m(B,"error",E,L)}function m(B,E,L,S){if("function"===typeof B.on)if(S.once)B.once(E,L);else B.on(E,L);else if("function"===typeof B.addEventListener)B.addEventListener(E,function R(Q){S.once&&B.removeEventListener(E,R);L(Q)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof B);}var w="object"===typeof Reflect?Reflect:null,v=w&&"function"===
typeof w.apply?w.apply:function(B,E,L){return Function.prototype.apply.call(B,E,L)},x=Number.isNaN||function(B){return B!==B};C.exports=H;C.exports.once=function(B,E){return new Promise(function(L,S){function J(R){B.removeListener(E,Q);S(R)}function Q(){"function"===typeof B.removeListener&&B.removeListener("error",J);L([].slice.call(arguments))}m(B,E,Q,{once:!0});"error"!==E&&r(B,J,{once:!0})})};H.yEa=H;H.prototype.ja=void 0;H.prototype.GO=0;H.prototype.D7a=void 0;var A=10;Object.defineProperty(H,
"defaultMaxListeners",{enumerable:!0,get:function(){return A},set:function(B){if("number"!==typeof B||0>B||x(B))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+B+".");A=B}});H.init=function(){if(void 0===this.ja||this.ja===Object.getPrototypeOf(this).ja)this.ja=Object.create(null),this.GO=0;this.D7a=this.D7a||void 0};H.prototype.emit=function(B){for(var E=[],L=1;L<arguments.length;L++)E.push(arguments[L]);var S="error"===B;L=this.ja;
if(void 0!==L)S=S&&void 0===L.error;else if(!S)return!1;if(S){var J;0<E.length&&(J=E[0]);if(J instanceof Error)throw J;E=Error("Unhandled error."+(J?" ("+J.message+")":""));E.context=J;throw E;}L=L[B];if(void 0===L)return!1;if("function"===typeof L)v(L,this,E);else{J=L.length;S=Array(J);for(var Q=0;Q<J;++Q)S[Q]=L[Q];for(L=0;L<J;++L)v(S[L],this,E)}return!0};H.prototype.addListener=function(B,E){return b(this,B,E,!1)};H.prototype.on=H.prototype.addListener;H.prototype.cwd=function(B,E){return b(this,
B,E,!0)};H.prototype.once=function(B,E){e(E);this.on(B,k(this,B,E));return this};H.prototype.GCf=function(B,E){e(E);this.cwd(B,k(this,B,E));return this};H.prototype.removeListener=function(B,E){var L;e(E);var S=this.ja;if(void 0===S)return this;var J=S[B];if(void 0===J)return this;if(J===E||J.listener===E)0===--this.GO?this.ja=Object.create(null):(delete S[B],S.removeListener&&this.emit("removeListener",B,J.listener||E));else if("function"!==typeof J){var Q=-1;for(L=J.length-1;0<=L;L--)if(J[L]===
E||J[L].listener===E){var R=J[L].listener;Q=L;break}if(0>Q)return this;if(0===Q)J.shift();else{for(;Q+1<J.length;Q++)J[Q]=J[Q+1];J.pop()}1===J.length&&(S[B]=J[0]);void 0!==S.removeListener&&this.emit("removeListener",B,R||E)}return this};H.prototype.off=H.prototype.removeListener;H.prototype.mqb=function(B){var E=this.ja;if(void 0===E)return this;if(void 0===E.removeListener)return 0===arguments.length?(this.ja=Object.create(null),this.GO=0):void 0!==E[B]&&(0===--this.GO?this.ja=Object.create(null):
delete E[B]),this;if(0===arguments.length){var L=Object.keys(E);for(E=0;E<L.length;++E){var S=L[E];"removeListener"!==S&&this.mqb(S)}this.mqb("removeListener");this.ja=Object.create(null);this.GO=0;return this}L=E[B];if("function"===typeof L)this.removeListener(B,L);else if(void 0!==L)for(E=L.length-1;0<=E;E--)this.removeListener(B,L[E]);return this};H.prototype.listeners=function(B){var E=this.ja;if(void 0===E)B=[];else if(B=E[B],void 0===B)B=[];else if("function"===typeof B)B=[B.listener||B];else{E=
Array(B.length);for(var L=0;L<E.length;++L)E[L]=B[L].listener||B[L];B=E}return B};Object.defineProperty(C.exports,"EventEmitter",{enumerable:!0,get:function(){return C.exports.yEa}})},1146:function(C,H,e){e.d(H,"a",function(){return b});var b;(b||(b={})).Log="Log"},1147:function(C){C.exports=JSON.parse('{"version":"2.35.327"}')},1148:function(C,H,e){H=e(754);e=null;"undefined"!==typeof WebSocket?e=WebSocket:"undefined"!==typeof MozWebSocket?e=MozWebSocket:"undefined"!==typeof H?e=H.WebSocket||H.poc:
"undefined"!==typeof window?e=window.WebSocket||window.poc:"undefined"!==typeof self&&(e=self.WebSocket||self.poc);C.exports=e},1149:function(C,H,e){e.d(H,"b",function(){return b});e.d(H,"a",function(){return n});C=function(){if("undefined"===typeof TextEncoder){e(1150);var k={AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder};TextDecoder=TextEncoder=void 0;return k}return{AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder}}();var b=C.AugLoopTextEncoder,n=C.AugLoopTextDecoder},
1150:function(C,H,e){(function(b,n){(function(k){function r(F,K,I){if(F)throw Error("".concat("Failed to ").concat(K,": the '").concat(I,"' option is unsupported."));}function m(F){return n.from(F)}function w(F,K){var I;return F instanceof n?I=F:I=n.from(F.buffer,F.byteOffset,F.byteLength),I.toString(K)}function v(F){for(var K=0,I=Math.min(65536,F.length+1),Y=new Uint16Array(I),X=[],ca=0;;){var W=K<F.length;if(!W||ca>=I-1){if(X.push(String.fromCharCode.apply(null,Y.subarray(0,ca))),!W)return X.join("");
F=F.subarray(K);ca=K=0}W=F[K++];if(0===(W&128))Y[ca++]=W;else if(192===(W&224)){var P=F[K++]&63;Y[ca++]=(W&31)<<6|P}else if(224===(W&240)){P=F[K++]&63;var T=F[K++]&63;Y[ca++]=(W&31)<<12|P<<6|T}else if(240===(W&248)){P=F[K++]&63;T=F[K++]&63;var Z=F[K++]&63;W=(W&7)<<18|P<<12|T<<6|Z;65535<W&&(W-=65536,Y[ca++]=W>>>10&1023|55296,W=56320|W&1023);Y[ca++]=W}}}function x(F){for(var K=0,I=F.length,Y=0,X=Math.max(32,I+(I>>>1)+7),ca=new Uint8Array(X>>>3<<3);K<I;){var W=F.charCodeAt(K++);if(55296<=W&&56319>=W){if(K<
I){var P=F.charCodeAt(K);56320===(P&64512)&&(++K,W=((W&1023)<<10)+(P&1023)+65536)}if(55296<=W&&56319>=W)continue}Y+4>ca.length&&(X+=8,X*=1+K/F.length*2,X=X>>>3<<3,P=new Uint8Array(X),P.set(ca),ca=P);if(0===(W&4294967168))ca[Y++]=W;else{if(0===(W&4294965248))ca[Y++]=W>>>6&31|192;else if(0===(W&4294901760))ca[Y++]=W>>>12&15|224,ca[Y++]=W>>>6&63|128;else if(0===(W&4292870144))ca[Y++]=W>>>18&7|240,ca[Y++]=W>>>12&63|128,ca[Y++]=W>>>6&63|128;else continue;ca[Y++]=W&63|128}}return ca.slice?ca.slice(0,Y):
ca.subarray(0,Y)}function A(){this.encoding="utf-8"}function B(F,K){r(K&&K.fatal,"construct 'TextDecoder'","fatal");F=F||"utf-8";var I;if(E?I=n.q4b(F):I=-1!==J.indexOf(F.toLowerCase()),!I)throw new RangeError("".concat(R," encoding label provided ('").concat(F,"') is invalid."));this.encoding=F;this.ignoreBOM=this.fatal=!1}var E="function"==typeof n&&n.from,L=E?m:x;A.prototype.encode=function(F,K){return r(K&&K.stream,"encode","stream"),L(F)};var S=!E&&"function"==typeof Blob&&"function"==typeof URL&&
"function"==typeof URL.createObjectURL,J=["utf-8","utf8","unicode-1-1-utf-8"],Q=v;E?Q=w:S&&(Q=function(F){try{a:{try{var K=URL.createObjectURL(new Blob([F],{type:"text/plain;charset=UTF-8"}));var I=new XMLHttpRequest;var Y=(I.open("GET",K,!1),I.send(),I.responseText);break a}finally{K&&URL.revokeObjectURL(K)}Y=void 0}return Y}catch(X){return v(F)}});var R="".concat("Failed to "," ").concat("construct 'TextDecoder'",": the ");B.prototype.decode=function(F,K){r(K&&K.stream,"decode","stream");var I;
return F instanceof Uint8Array?I=F:F.buffer instanceof ArrayBuffer?I=new Uint8Array(F.buffer):I=new Uint8Array(F),Q(I,this.encoding)};k.TextEncoder=k.TextEncoder||A;k.TextDecoder=k.TextDecoder||B})("undefined"!==typeof window?window:"undefined"!==typeof b?b:this)}).call(this,e(754),e(881).Buffer)},1151:function(C){function H(n){this.GC=e(n);this.kz=this.Mu=0;if(b(n)){for(var k=n.length,r=0;r<k;++r)this[r]=n[r];this.Mu=k}}function e(n){if("number"!==typeof n)if(b(n))n=n.length;else return 16;n=Math.min(Math.max(16,
n),1073741824);n=(n>>>0)-1;n|=n>>1;n|=n>>2;n|=n>>4;n|=n>>8;return(n|n>>16)+1}H.prototype.toArray=function(){for(var n=this.Mu,k=Array(n),r=this.kz,m=this.GC,w=0;w<n;++w)k[w]=this[r+w&m-1];return k};H.prototype.push=function(n){var k=arguments.length,r=this.Mu;if(1<k){var m=this.GC;if(r+k>m){for(var w=0;w<k;++w){this.l2a(r+1);var v=this.kz+r&this.GC-1;this[v]=arguments[w];r++;this.Mu=r}return r}v=this.kz;for(w=0;w<k;++w)this[v+r&m-1]=arguments[w],v++;this.Mu=r+k;return r+k}if(0===k)return r;this.l2a(r+
1);w=this.kz+r&this.GC-1;this[w]=n;this.Mu=r+1;return r+1};H.prototype.pop=function(){var n=this.Mu;if(0!==n){var k=this.kz+n-1&this.GC-1,r=this[k];this[k]=void 0;this.Mu=n-1;return r}};H.prototype.shift=function(){var n=this.Mu;if(0!==n){var k=this.kz,r=this[k];this[k]=void 0;this.kz=k+1&this.GC-1;this.Mu=n-1;return r}};H.prototype.unshift=function(n){var k=this.Mu,r=arguments.length;if(1<r){var m=this.GC;if(k+r>m){for(var w=r-1;0<=w;w--){this.l2a(k+1);m=this.GC;var v=(this.kz-1&m-1^m)-m;this[v]=
arguments[w];k++;this.Mu=k;this.kz=v}return k}v=this.kz;for(w=r-1;0<=w;w--)v=(v-1&m-1^m)-m,this[v]=arguments[w];this.kz=v;this.Mu=k+r;return k+r}if(0===r)return k;this.l2a(k+1);m=this.GC;w=(this.kz-1&m-1^m)-m;this[w]=n;this.Mu=k+1;this.kz=w;return k+1};H.prototype.get=function(n){if(n===(n|0)){var k=this.Mu;0>n&&(n+=k);if(!(0>n||n>=k))return this[this.kz+n&this.GC-1]}};H.prototype.isEmpty=function(){return 0===this.Mu};H.prototype.clear=function(){for(var n=this.Mu,k=this.kz,r=this.GC,m=0;m<n;++m)this[k+
m&r-1]=void 0;this.kz=this.Mu=0};H.prototype.toString=function(){return this.toArray().toString()};H.prototype.valueOf=H.prototype.toString;H.prototype.enqueue=H.prototype.push;H.prototype.dequeue=H.prototype.shift;H.prototype.toJSON=H.prototype.toArray;Object.defineProperty(H.prototype,"length",{get:function(){return this.Mu},set:function(){throw new RangeError("");}});H.prototype.l2a=function(n){this.GC<n&&this.Q3d(e(1.5*this.GC+16))};H.prototype.Q3d=function(n){var k=this.GC;this.GC=n;n=this.kz;
var r=this.Mu;if(n+r>k)for(n=n+r&k-1,r=0;r<n;++r)this[r+k]=this[r+0],this[r+0]=void 0};var b=Array.isArray;C.exports=H},1170:function(C,H,e){(function(b){function n(){}function k(na,ba,ea,oa){ba=void 0===ba?!1:ba;var sa,M,za,xa,ua;null==ea&&(ea=w(na.traceLevel));oa=oa||T;if(0<ea.length||0<oa.length){na.serviceName=Q;if(!ba&&I&&(ba=I())){na.cv=na.cv?na.cv:ba.cv.toString();na.sessionKey=na.sessionKey?na.sessionKey:ba.sessionKey;na.workflow=na.workflow?na.workflow:ba.workflow;var Pa=null===(sa=ba.clientMetadata)||
void 0===sa?void 0:sa.appName;na.clientAppName=na.clientAppName?na.clientAppName:Pa;sa=null===(M=ba.clientMetadata)||void 0===M?void 0:M.appPlatform;na.clientAppPlatform=na.clientAppPlatform?na.clientAppPlatform:sa;M=null===(za=ba.clientMetadata)||void 0===za?void 0:za.releaseAudienceGroup;na.clientReleaseAudienceGroup=na.clientReleaseAudienceGroup?na.clientReleaseAudienceGroup:M;za=null===(xa=ba.clientMetadata)||void 0===xa?void 0:xa.flights;null!==(ua=na.clientFlights)&&void 0!==ua?ua:na.clientFlights=
za}xa=D.makeIterator(ea);for(ea=xa.next();!ea.done;ea=xa.next())ea.value.log(na);oa=D.makeIterator(oa);for(ea=oa.next();!ea.done;ea=oa.next())ea.value.log(na)}}function r(na,ba,ea,oa,sa,M,za,xa,ua,Pa,Da){ea=W.get(na)||ea;var Ua=w(ea),Sa=m(ea,oa);if(0!=Ua.length||0!=Sa.length){var kb=L(J.a.Log),zb="abcdefghijklmnopqrstuvwxyz0123456789"[na>>24&63]+"abcdefghijklmnopqrstuvwxyz0123456789"[na>>18&63]+"abcdefghijklmnopqrstuvwxyz0123456789"[na>>12&63]+"abcdefghijklmnopqrstuvwxyz0123456789"[na>>6&63]+"abcdefghijklmnopqrstuvwxyz0123456789"[na>>
0&63],Fa=A(oa,sa,M,za,xa,ua,Pa,Da);if(ba.name===n.WorkflowMetricsOnly.name&&ba.root===n.WorkflowMetricsOnly.root)!Array.isArray(Fa)&&"object"===typeof Fa&&k({eventName:"Metrics",tagId:zb,category:ba.root+"."+ba.name,traceLevel:ea,message:"",getMetrics:function(){return Fa}},!1,Ua,Sa);else if(Array.isArray(Fa)||"object"!==typeof Fa)k({eventName:"Log",tagId:zb,category:ba.root+"."+ba.name,traceLevel:ea,message:x(Fa),getMetrics:function(){var Za;return"Core"===ba.root?{teg:{dimensionNames:function(){return Z},
dimensionValues:[String(ea),zb],value:1}}:{veg:{dimensionNames:function(){return ia},dimensionValues:[String(ea),zb,I?null===(Za=I())||void 0===Za?void 0:Za.workflow:""],value:1}}}},!1,Ua,Sa);else if(Fa.tagId=zb,Fa.category=ba.root+"."+ba.name,"Operation"===Fa.eventName&&"Workflow"===ba.root&&(Fa.eventName="WorkflowOperation",I&&(Fa.joinContextId=I().joinContextId)),Fa.traceLevel=ea,na=Y.get(Fa.eventName))for(Ua=0;Ua<na.length&&(!(Sa=na[Ua])||!Sa.add(Fa,Ua===na.length-1));++Ua);else k(Fa,!1,Ua,Sa);
E(kb)}}function m(na,ba){return(void 0!==na?ca.get(na)||[]:K).filter(function(ea){return ea.shouldLog(ba)})}function w(na){return void 0!==na?X.get(na)||T:F}function v(na){return w(na).length}function x(na){if("string"===typeof na)return na;for(var ba="",ea=0;ea<na.length;ea++){0<ea&&(ba+=" ");var oa=na[ea];ba=oa instanceof Error?ba+JSON.stringify({message:oa.message,name:oa.name,stack:oa.stack}):"object"===typeof oa?ba+JSON.stringify(oa):ba+oa}return ba}function A(na,ba,ea,oa,sa,M,za,xa){if(void 0===
ba&&("string"===typeof na||"object"===typeof na))return na;if(void 0===ba&&"function"===typeof na)return na();var ua=[];na=D.makeIterator([na,ba,ea,oa,sa,M,za,xa]);for(ba=na.next();!ba.done;ba=na.next())ba=ba.value,void 0!==ba&&ua.push("function"===typeof ba?ba():ba);return ua}function B(na,ba){var ea=ba.level;Object.keys(S.a).map(function(oa){return S.a[oa]}).filter(function(oa){return"string"!==typeof oa}).filter(function(oa){return oa<=ea}).forEach(function(oa){na.has(oa)?na.get(oa).push(ba):na.set(oa,
[ba])})}function E(){}function L(){return null}e.d(H,"a",function(){return P});e.d(H,"c",function(){return v});e.d(H,"b",function(){return n});var S=e(1171),J=e(1146),Q="undefined"!=typeof b&&b.env?b.env.eeg:"client",R={97:0,98:1,99:2,100:3,101:4,102:5,103:6,104:7,105:8,106:9,107:10,108:11,109:12,110:13,111:14,112:15,113:16,114:17,115:18,116:19,117:20,118:21,119:22,120:23,121:24,122:25,48:26,49:27,50:28,51:29,52:30,53:31,54:32,55:33,56:34,57:35},F=[],K=[],I,Y=new Map,X=new Map,ca=new Map,W=new Map,
P;(function(na){na.defineCoreLogCategory=function(ba){return{root:"Core",name:ba}};na.defineWorkflowLogCategory=function(ba){return{root:"Workflow",name:ba}};na.clearLoggers=function(){F=[];K=[];X.clear();ca.clear()};na.clearAggregators=function(){Y.clear()};na.addLogger=function(ba){-1===F.indexOf(ba)&&(F.push(ba),B(X,ba))};na.addDecidingLogger=function(ba){-1===K.indexOf(ba)&&(K.push(ba),B(ca,ba))};na.setCorrelationContextCallback=function(ba){I=ba};na.setStartPerformanceEventCallback=function(ba){L=
ba};na.setStopPerformanceEventCallback=function(ba){E=ba};na.addAggregator=function(ba){ba.init(function(ea,oa){k(ea,oa)});Y.has(ba.eventName)?Y.get(ba.eventName).push(ba):Y.set(ba.eventName,[ba])};na.flushAggregators=function(ba){Y.forEach(function(ea){ea.forEach(function(oa){return oa.flush(ba)})})};na.setTagLevelOverride=function(ba,ea){W.set(ba&&5===ba.length?R[ba.charCodeAt(0)]<<24|R[ba.charCodeAt(1)]<<18|R[ba.charCodeAt(2)]<<12|R[ba.charCodeAt(3)]<<6|R[ba.charCodeAt(4)]:-1,ea)};na.resetTagLevelOverrides=
function(){W.clear()};na.error=function(ba,ea,oa,sa,M,za,xa,ua,Pa,Da){r(ba,ea,S.a.error,oa,sa,M,za,xa,ua,Pa,Da)};na.warn=function(ba,ea,oa,sa,M,za,xa,ua,Pa,Da){r(ba,ea,S.a.warn,oa,sa,M,za,xa,ua,Pa,Da)};na.info=function(ba,ea,oa,sa,M,za,xa,ua,Pa,Da){r(ba,ea,S.a.info,oa,sa,M,za,xa,ua,Pa,Da)};na.verbose=function(ba,ea,oa,sa,M,za,xa,ua,Pa,Da){r(ba,ea,S.a.verbose,oa,sa,M,za,xa,ua,Pa,Da)};na.debug=function(ba,ea,oa,sa,M,za,xa,ua,Pa,Da){r(ba,ea,S.a.debug,oa,sa,M,za,xa,ua,Pa,Da)};na.metric=function(ba,ea,
oa,sa,M,za,xa,ua,Pa,Da){r(ba,ea,S.a.metric,oa,sa,M,za,xa,ua,Pa,Da)};na.formatMetric=function(ba,ea,oa,sa){var M={};M[ba]={dimensionNames:oa,dimensionValues:sa,value:ea};return M};na.dynamic=function(ba){k(ba)}})(P||(P={}));var T=[],Z=["Level","Tag"],ia=["Level","Tag","Workflow"];n.CoreDefault=P.defineCoreLogCategory("Default");n.CoreSystem=P.defineCoreLogCategory("System");n.WorkflowDefault=P.defineWorkflowLogCategory("Default");n.WorkflowUnsampled=P.defineWorkflowLogCategory("Unsampled");n.WorkflowMetricsOnly=
P.defineWorkflowLogCategory("MetricsOnly");n.PrivacyGuardEvent=P.defineCoreLogCategory("PrivacyGuardEvent")}).call(this,e(1131))},1171:function(C,H,e){e.d(H,"a",function(){return b});var b;(function(n){n[n.error=0]="error";n[n.warn=1]="warn";n[n.info=3]="info";n[n.metric=4]="metric";n[n.verbose=5]="verbose";n[n.debug=6]="debug";n[n.disabled=7]="disabled"})(b||(b={}))},1172:function(C,H,e){(function(b){function n(){}e.d(H,"a",function(){return n});var k=e(1149);n.deserialize=function(r,m){m=void 0===
m?function(B){return B}:m;if(r[0]!==n.IDENTIFIERBYTE)throw Error("Invalid Binary: Incorrect Identifier");for(var w=1,v=[],x=new DataView(r.buffer,r.byteOffset,r.byteLength);w<r.byteLength;){if(w+4>r.byteLength)throw Error("Invalid Binary: Error reading fragment length");var A=x.getUint32(w);if(w+A+4>r.byteLength)throw Error("Invalid Binary: Fragment out of range");"undefined"!==typeof b&&b.from?v.push(b.from(r.buffer,r.byteOffset+w+4,A)):v.push(new Uint8Array(r.buffer,r.byteOffset+w+4,A));w+=4+A}if(1>
v.length)throw Error("Invalid Binary: No fragments found");r=n.textDecoder.decode(v[0]);return JSON.parse(r,function(B,E){if("string"===typeof E){if(E.substring(0,n.BINARYKEYWORD.length)===n.BINARYKEYWORD){B=parseInt(E.substring(n.BINARYKEYWORD.length),10);if("number"!==typeof B||B>=v.length-1)throw Error("Invalid Binary: Binary index out of range");return m(v[B+1])}if(E.substring(0,n.ESCAPEKEYWORD.length)===n.ESCAPEKEYWORD)return E.substring(n.ESCAPEKEYWORD.length)}return E})};n.serialize=function(r){var m=
[void 0];r=JSON.stringify(r,function(B,E){return ArrayBuffer.isView(E)?(m.push(E),""+n.BINARYKEYWORD+(m.length-2)):E&&"Buffer"===E.type&&Array.isArray(E.data)?(m.push(new Uint8Array(E.data)),""+n.BINARYKEYWORD+(m.length-2)):"string"===typeof E&&E.substring(0,n.ESCAPEKEYWORD.length)===n.ESCAPEKEYWORD?n.ESCAPEKEYWORD+E:E});m[0]=n.textEncoder.encode(r);r=m.reduce(function(B,E){return B+4+E.byteLength},0);r=new Uint8Array(r+1);r[0]=n.IDENTIFIERBYTE;for(var w=1,v=new DataView(r.buffer,r.byteOffset,r.byteLength),
x=D.makeIterator(m),A=x.next();!A.done;A=x.next())A=A.value,v.setUint32(w,A.byteLength),r.set(A,w+4),w+=4+A.byteLength;return r};n.IDENTIFIERBYTE=3;n.BINARYKEYWORD=":b";n.ESCAPEKEYWORD=":";n.textDecoder=new k.a;n.textEncoder=new k.b}).call(this,e(881).Buffer)},1174:function(C,H,e){function b(){}function n(){this.O6a=ca.AFrameworkApplication.H.J("VisioWeb1JSTypescriptBundlesEnabled");this.Yzc=!1;return this}function k(){}function r(){}function m(Ea){this.E6=Ea}function w(Ea,Na){Na=void 0===Na?0:Na;
this.Csc=0;this.YMb=null;if(Ea){var $a=J.Application.getBRS("VisioWebSolutionsMaxQuickShapeTrayEntriesAllowed",5);this.Csc=Na;this.YMb=new Y.a;for(var Ba in Ea){Na=Ba;for(var Xa=[],Oa=Ea[Ba],Fb=0;Fb<Oa.length&&Fb<$a;Fb++)Array.add(Xa,Oa[Fb].master);this.YMb.add(Na,Xa)}}}function v(Ea,Na){this.k2d=Ea;this.o_d=Na}function x(Ea,Na,$a,Ba,Xa){this.AXd=Ea;this.RUd=Na;this.dtc=[];this.E7d=void 0===Ba?1:Ba;this.G7d=void 0===Xa?400:Xa;Ea=D.makeIterator($a);for(Na=Ea.next();!Na.done;Na=Ea.next())Array.add(this.dtc,
Na.value)}function A(Ea,Na,$a){this.vh=Ea;this.z7d=void 0===Na?0:Na;this.C7d=void 0===$a?0:$a}function B(){this.title=this.taskPaneId=null;this.location=this.width=0;this.onManualClose=this.props=null}function E(Ea,Na,$a,Ba){this.Wl=new F.a(Ea,Na,$a,Ba)}function L(){}function S(Ea,Na,$a){this.multi=this.allowSelfLoops=!1;this.type=null;this.allowSelfLoops=void 0===Ea?!1:Ea;this.multi=void 0===Na?!1:Na;this.type=void 0===$a?"directed":$a}e.r(H);var J=e(1078);C=e(1089);H=e(0);Object(H.a)(S,"CoreGraphOptions",
null,[]);L.count=function(Ea){var Na=0,$a;for($a in Ea)Na++;return Na};L.getItemAt=function(Ea,Na){var $a=0,Ba;for(Ba in Ea){var Xa={key:Ba,value:Ea[Ba]};if($a===Na)return Xa;$a++}return null};Object(H.a)(L,"DictionaryUtils",null,[]);var Q=e(1105),R=e(1124),F=e(122);E.prototype.boxContainsPoint=function(Ea,Na){return this.Wl.left<=Ea&&this.Wl.right>=Ea&&this.Wl.top>=Na&&this.Wl.bottom<=Na};E.prototype.boxOverlapsWithBox=function(Ea){return!(Ea.bottom>=this.Wl.top||Ea.top<=this.Wl.bottom||Ea.left>=
this.Wl.right||Ea.right<=this.Wl.left)};E.prototype.fitToBoundingBox=function(Ea){this.Wl.left=Math.min(this.Wl.left,Ea.xInInches);this.Wl.right=Math.max(this.Wl.right,Ea.xInInches+Ea.widthInInches);this.Wl.bottom=Math.min(this.Wl.bottom,Ea.yInInches);this.Wl.top=Math.max(this.Wl.top,Ea.yInInches+Ea.heightInInches)};E.prototype.fitToRectangle=function(Ea){this.Wl.left=Math.min(this.Wl.left,Ea.left);this.Wl.right=Math.max(this.Wl.right,Ea.right);this.Wl.bottom=Math.min(this.Wl.bottom,Ea.bottom);this.Wl.top=
Math.max(this.Wl.top,Ea.top)};E.createRectangleWithMinBounds=function(){return new E(1.7E308,-1.7E308,-1.7E308,1.7E308)};D.global.Object.defineProperties(E.prototype,{left:{configurable:!0,enumerable:!0,get:function(){return this.Wl.left}},right:{configurable:!0,enumerable:!0,get:function(){return this.Wl.right}},top:{configurable:!0,enumerable:!0,get:function(){return this.Wl.top}},bottom:{configurable:!0,enumerable:!0,get:function(){return this.Wl.bottom}},width:{configurable:!0,enumerable:!0,get:function(){return this.Wl.right-
this.Wl.left}}});Object(H.a)(E,"RectangularBox",null,[]);var K=e(1129),I=e(1128);Object(H.a)(B,"TaskPaneInfo",null,[]);D.global.Object.defineProperties(A.prototype,{direction:{configurable:!0,enumerable:!0,get:function(){return this.vh}},x_Offset:{configurable:!0,enumerable:!0,get:function(){return this.z7d}},y_Offset:{configurable:!0,enumerable:!0,get:function(){return this.C7d}}});Object(H.a)(A,"AddonAutoConnectionPointDirectionAndOffsets",null,[406]);D.global.Object.defineProperties(x.prototype,
{defaultIcon:{configurable:!0,enumerable:!0,get:function(){return this.AXd}},activeIcon:{configurable:!0,enumerable:!0,get:function(){return this.RUd}},directionAndOffsets:{configurable:!0,enumerable:!0,get:function(){return this.dtc}},zoomLowerLimit:{configurable:!0,enumerable:!0,get:function(){return this.E7d}},zoomUpperLimit:{configurable:!0,enumerable:!0,get:function(){return this.G7d}}});Object(H.a)(x,"AddonAutoConnectionNodeViewData",null,[407]);D.global.Object.defineProperties(v.prototype,
{inwardConnectionPoint:{configurable:!0,enumerable:!0,get:function(){return this.o_d}},outwardConnectionPoint:{configurable:!0,enumerable:!0,get:function(){return this.k2d}}});Object(H.a)(v,"AddonConnectionNodeViewData",null,[404]);var Y=e(805);D.global.Object.defineProperties(w.prototype,{delayInMiliSeconds:{configurable:!0,enumerable:!0,get:function(){return this.Csc}},stencilIdToMasterMap:{configurable:!0,enumerable:!0,get:function(){return this.YMb}}});Object(H.a)(w,"AddonQuickShapeTrayViewData",
null,[403]);D.global.Object.defineProperties(m.prototype,{masters:{configurable:!0,enumerable:!0,get:function(){return this.E6}}});Object(H.a)(m,"AddonChangeShapeTrayViewData",null,[405]);r.add_Button_Active_Icon="AddButton_Mindmap_Active.svg";r.add_Button_Default_Icon="AddButton_Mindmap_Default.svg";r.add_Button_Grey_Icon="AddButton_Grey.svg";Object(H.a)(r,"VisioAddonAvailableIcons",null,[]);var X=e(1121),ca=e(1),W=e(36),P=e(90),T=e(1080),Z=e(494),ia=e(1071),na=e(260),ba=e(221);Object(H.a)(k,"VisioExtensionScriptLoaderBase",
null,[]);var ea=e(2),oa=e(7);D.ha(n,k);n.prototype.Gjf=function(){var Ea=ca.AFrameworkApplication.Np(Z.a.JG(this.O6a?"VisioWeb.EditAppsForOffice.{0}js":"VisioWebEditDS.{0}EditAppsForOffice.js"),5);Ea=ia.a.create(Ea,null,function(){return e.e(2).then(e.bind(null,1173))});na.a.KB(Ea);Ea.xza.isCompleted?ca.AFrameworkApplication.ea.fb(ea.a.A8b,2):Ea.qG(function(){ca.AFrameworkApplication.ea.fb(ea.a.A8b,2)})};n.prototype.Clf=function(){var Ea=ca.AFrameworkApplication.H.qa("VisioWebJsOverrideURLEnabled");
var Na=Z.a.JG("Visio.SemanticFramework.{0}js");var $a=oa.a.ka(Ea)?ca.AFrameworkApplication.Np(Na,5).replace("Debug.","debug."):Ea+Na.replace("debug","Debug");Ea=ba.a.create($a);Ea.qG(function(Ba,Xa){Xa.succeeded?J.Application.sendTraceTag(508162393,100,"Visio semantic framework script {0} download succeded",$a):J.Application.sendTraceTag(508162392,15,"Visio semantic framework script {0} download failed",$a)});na.a.KB(Ea)};n.prototype.alf=function(){var Ea=ca.AFrameworkApplication.H.J("IsWebpack5RibbonEnabled")?
"wp5/":"",Na=String.format("visioClientMindmapLayout{0}.js",".min"),$a=ca.AFrameworkApplication.Np(Ea+Na,5);Ea=ba.a.create($a);Ea.qG(function(Ba,Xa){Xa.succeeded?J.Application.sendTraceTag(509207682,100,"Visio mindmap client layout script {0} download succeded",$a):J.Application.sendTraceTag(509207681,15,"Visio mindmap client layout script {0} download failed",$a)});na.a.KB(Ea)};n.prototype.ilf=function(){var Ea=ca.AFrameworkApplication.H.J("IsWebpack5RibbonEnabled")?"wp5/":"",Na=String.format("visioClientOrgChartLayout{0}.js",
".min"),$a=ca.AFrameworkApplication.Np(Ea+Na,5);Ea=ba.a.create($a);Ea.qG(function(Ba,Xa){Xa.succeeded?J.Application.sendTraceTag(509207680,100,"Visio orgchart client layout script {0} download succeded",$a):J.Application.sendTraceTag(509207651,15,"Visio orgchart client layout script {0} download failed",$a)});na.a.KB(Ea)};n.prototype.tkd=function(){var Ea=this;if(!this.Yzc){var Na=String.format("visioClientLayout{0}.js",".min"),$a=ca.AFrameworkApplication.Np(Na,5);Na=ba.a.create($a);Na.qG(function(Ba,
Xa){Xa.succeeded?(Ea.Yzc=!0,J.Application.sendTraceTag(509207650,100,"Visio client layout script {0} download succeded",$a)):J.Application.sendTraceTag(509207649,15,"Visio client layout script {0} download failed",$a)});na.a.KB(Na)}};Object(H.a)(n,"VisioEditExtensionScriptLoader",k,[]);b.prototype.init=function(){};b.prototype.dispose=function(){};b.prototype.Vf=function(Ea){ca.AFrameworkApplication.H.J("ClientApp_Temporary")&&(Ea.register(T.Document,"Visio.Extension.Document"),Ea.resolve("Visio.Extension.Document"))};
b.A2=function(){var Ea=ca.AFrameworkApplication.H.J("VisioWebSDXEnabled"),Na=ca.AFrameworkApplication.H.J("VisioEditAddonManagerEnabled");if(Ea||Na)W.a.instance.register(k,"Visio.Extension.VisioExtensionScriptLoaderBase").as("Visio.Extension.VisioExtensionScriptLoaderBase").Ab().xb(function(){return new n}),W.a.instance.resolve("Visio.Extension.VisioExtensionScriptLoaderBase").Gjf();Na&&ca.AFrameworkApplication.H.J("VisioEditSemanticFrameworkEnabled")&&W.a.instance.resolve("Visio.Extension.VisioExtensionScriptLoaderBase").Clf()};
b.main=function(){P.a.instance.rh(new b);b.A2()};D.global.Object.defineProperties(b.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Visio.Extension"}}});Object(H.a)(b,"VisioEditExtensionPackage",null,[1,2]);var sa;(function(Ea){Ea[Ea.cancel=0]="cancel";Ea[Ea.action=1]="action";Ea[Ea.ok=1]="ok";Ea[Ea.yes=1]="yes";Ea[Ea.secondaryAction=2]="secondaryAction";Ea[Ea.retry=2]="retry";Ea[Ea.no=2]="no"})(sa||(sa={}));Object(H.b)("DialogButton",sa);var M;(function(Ea){Ea[Ea.left=0]="left";
Ea[Ea.center=1]="center";Ea[Ea.right=2]="right"})(M||(M={}));Object(H.b)("OverlayHorizontalAlignment",M);var za;(function(Ea){Ea[Ea.text=1]="text";Ea[Ea.image=2]="image";Ea[Ea.html=3]="html"})(za||(za={}));Object(H.b)("OverlayType",za);var xa;(function(Ea){Ea[Ea.top=0]="top";Ea[Ea.middle=1]="middle";Ea[Ea.bottom=2]="bottom"})(xa||(xa={}));Object(H.b)("OverlayVerticalAlignment",xa);var ua;(function(Ea){Ea[Ea.error=0]="error";Ea[Ea.warning=1]="warning";Ea[Ea.info=2]="info";Ea[Ea.wait=3]="wait"})(ua||
(ua={}));Object(H.b)("SolutionDialogType",ua);var Pa;(function(Ea){Ea[Ea.Error=10]="Error";Ea[Ea.Warning=15]="Warning";Ea[Ea.Info=50]="Info";Ea[Ea.Verbose=100]="Verbose";Ea[Ea.Spam=200]="Spam";Ea[Ea.ShiftFactor=1E3]="ShiftFactor"})(Pa||(Pa={}));Object(H.b)("BrowserULSTraceLevel",Pa);var Da;(function(Ea){Ea[Ea.left=1]="left";Ea[Ea.right=2]="right"})(Da||(Da={}));Object(H.b)("SolutionTaskPaneLocation",Da);var Ua;(function(Ea){Ea[Ea.fileOpened=0]="fileOpened";Ea[Ea.shapeAdded=1]="shapeAdded";Ea[Ea.runAddon=
2]="runAddon";Ea[Ea.globalAddon=3]="globalAddon"})(Ua||(Ua={}));Object(H.b)("AddonInitReason",Ua);var Sa=e(1074),kb;(function(Ea){Ea[Ea.none=-1]="none";Ea[Ea.rightAngle=0]="rightAngle";Ea[Ea.straightLines=1]="straightLines";Ea[Ea.curvedLines=2]="curvedLines"})(kb||(kb={}));Object(H.b)("ConnectorType",kb);var zb;(function(Ea){Ea[Ea.CustomConnectionPoints=0]="CustomConnectionPoints";Ea[Ea.QuickShape=1]="QuickShape";Ea[Ea.ConnectionPoints=2]="ConnectionPoints";Ea[Ea.ShapeSelection=3]="ShapeSelection";
Ea[Ea.AutoLayout=4]="AutoLayout";Ea[Ea.OverrideAutoConnectionNodeView=5]="OverrideAutoConnectionNodeView";Ea[Ea.OverrideQuickShapeTrayView=6]="OverrideQuickShapeTrayView";Ea[Ea.AutoConnectPointDragMovement=7]="AutoConnectPointDragMovement";Ea[Ea.Flip=8]="Flip";Ea[Ea.ZOrder=9]="ZOrder";Ea[Ea.DiagramLayouts=10]="DiagramLayouts";Ea[Ea.GroupUngroupShapes=11]="GroupUngroupShapes";Ea[Ea.ChangeConnectorType=12]="ChangeConnectorType";Ea[Ea.Rotate=13]="Rotate";Ea[Ea.ConnectorEditPoints=14]="ConnectorEditPoints";
Ea[Ea.ConnectorMovement=15]="ConnectorMovement";Ea[Ea.ShapeDataEdit=16]="ShapeDataEdit";Ea[Ea.showSolutionRMAOptions=17]="showSolutionRMAOptions";Ea[Ea.ShowSmartGuides=18]="ShowSmartGuides";Ea[Ea.Resize=19]="Resize";Ea[Ea.ChangeShape=20]="ChangeShape";Ea[Ea.DrawConnector=21]="DrawConnector";Ea[Ea.QuickShapeTray=22]="QuickShapeTray";Ea[Ea.RemoveQuickShapeButtonOnSelectionChange=23]="RemoveQuickShapeButtonOnSelectionChange"})(zb||(zb={}));Object(H.b)("FeatureType",zb);var Fa;(function(Ea){Ea[Ea.up=
0]="up";Ea[Ea.right=1]="right";Ea[Ea.down=2]="down";Ea[Ea.left=3]="left"})(Fa||(Fa={}));Object(H.b)("AddonAutoConnectionNodeDirection",Fa);var Za;(function(Ea){Ea[Ea.top=0]="top";Ea[Ea.bottom=1]="bottom";Ea[Ea.left=2]="left";Ea[Ea.right=3]="right"})(Za||(Za={}));Object(H.b)("AddonConnectionNodeDirection",Za);Type.registerNamespace("Visio.AddonManager");Type.registerNamespace("Visio.Extension");Type.registerNamespace("VisioWeb");window.Visio.Extension.DialogButton=sa;window.Visio.Extension.OverlayHorizontalAlignment=
M;window.Visio.Extension.OverlayType=za;window.Visio.Extension.OverlayVerticalAlignment=xa;window.Visio.Extension.SolutionDialogType=ua;window.Visio.Extension.BrowserULSTraceLevel=Pa;window.Visio.Extension.SolutionTaskPaneLocation=Da;window.Visio.Extension.AddonInitReason=Ua;window.Visio.Extension.LayoutType=Sa.a;window.Visio.Extension.ConnectorType=kb;window.Visio.Extension.FeatureType=zb;window.Visio.Extension.AddonAutoConnectionNodeDirection=Fa;window.Visio.Extension.AddonConnectionNodeDirection=
Za;"undefined"==typeof OfficeExtension&&Type.registerNamespace("OfficeExtension");"undefined"==typeof OfficeExtension.WacRuntime&&Type.registerNamespace("OfficeExtension.WacRuntime");"undefined"==typeof OfficeExtension.WacRuntime.IAsyncEnumerator&&(OfficeExtension.WacRuntime.IAsyncEnumerator=function(){},OfficeExtension.WacRuntime.IAsyncEnumerator.prototype={get_current:null,moveNext:null},OfficeExtension.WacRuntime.IAsyncEnumerator.registerInterface("OfficeExtension.WacRuntime.IAsyncEnumerator"));
window.Visio.Extension.Application=J.Application;window.Visio.Extension.Constants=C.a;window.Visio.Extension.CoreGraphOptions=S;window.Visio.Extension.DictionaryUtils=L;window.Visio.Extension.Highlight=Q.a;window.Visio.Extension.Location=R.a;window.Visio.Extension.RectangularBox=E;window.Visio.Extension.VirtualNodeDetails=K.a;window.Visio.Extension.VirtualNodeDetailsFactory=I.a;window.Visio.Extension.TaskPaneInfo=B;window.Visio.Extension.AddonAutoConnectionPointDirectionAndOffsets=A;window.Visio.Extension.AddonAutoConnectionNodeViewData=
x;window.Visio.Extension.AddonConnectionNodeViewData=v;window.Visio.Extension.AddonQuickShapeTrayViewData=w;window.Visio.Extension.AddonChangeShapeTrayViewData=m;window.Visio.Extension.VisioAddonAvailableIcons=r;window.Visio.Extension.VisioAddonManagerConstants=X.a;b.main()}}]);

//# sourceMappingURL=VisioWeb.editextension.js.map