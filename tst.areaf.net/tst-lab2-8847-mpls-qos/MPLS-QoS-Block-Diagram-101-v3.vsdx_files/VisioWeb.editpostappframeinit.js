(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[3],{1175:function(C,H,e){function b(){var Q=this;this.BLb=this.tKb=this.QLa=this.Za=null;this.fu=function(){var R=S.AFrameworkApplication.H,F=!!S.AFrameworkApplication.ga.Xa&&4===S.AFrameworkApplication.ga.Xa.Ji;if(R.J("WordEditorAutoSaveImprovementIsEnabled")||R.J("PptEditorSaveStatusInHeaderEnabled")||F&&R.J("SimplifiedReactRibbonUxIsEnabled")||R.J("ExcelSaveStatusInHeaderEnabled")||R.J("VisioSaveStatusInHeaderEnabled"))S.AFrameworkApplication.H.J("PostMessageEmbedded")&&
S.AFrameworkApplication.OJ?(Q.BLb=Q.Za.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"),Q.BLb&&Q.BLb.hu()):S.AFrameworkApplication.ga.Xa.$hd||S.AFrameworkApplication.hideHeader||(S.AFrameworkApplication.ga.Xa.VG?(Q.tKb=Q.Za.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"),Q.tKb&&Q.tKb.initialize(R.J("IsSkyDrive"),R.qa("HostNameToIncludeInSavedStatus"),S.AFrameworkApplication.H)):(Q.QLa=Q.Za.resolve("Common.App.SaveStatus.SaveStatusUIHandler"),Q.QLa&&Q.QLa.initialize(R.J("IsSkyDrive"),
R.qa("HostNameToIncludeInSavedStatus"))))}}function n(Q,R,F,K){this.N_=this.C_=this.R_=this.Q_=null;this.Ffa=0;this.Sx=this.ALb=this.Jca=this.Oyb=this.cOb=null;this.Nc=Q;this.L5=R;this.yO=F;this.$f=K;this.tyc=!0;this.tw=!1;this.ur=3;this.w7=!0}function k(Q,R){this.eA=null;this.Q_=CommonUIStrings.l_SavedStatus;this.R_=CommonUIStrings.l_SavingStatus;this.C_=CommonUIStrings.l_ReadOnlyStatus;this.N_=CommonUIStrings.l_ReviewModeStatus;this.CZ=R;this.yO=Q;this.ur=3;this.w7=!0}function r(Q){this.N_=this.C_=
this.R_=this.Q_=null;this.Zvc=this.ltc=this.$vc=this.BAc=this.$j=this.tw=!1;this.PKb=this.RAc=null;this.LAc=0;this.ya=this.OAc=null;this.yO=Q;this.ur=3;this.Vqa=!0}e.r(H);C=e(0);var m=e(31),w=e(73),v=e(68),x=e(27);r.prototype.initialize=function(Q,R,F){var K=this;this.Q_=this.y0b(Q,R);this.R_=CommonUIStrings.l_SavingStatus;this.C_=CommonUIStrings.l_ReadOnlyStatus;this.N_=CommonUIStrings.l_ReviewModeStatus;this.yO&&this.yO.execute(function(I){I.TPb(Object(w.a)(K,K.O_a,"updateToSavingStatus"))});this.$j=
!0;this.ya=F;this.ltc=this.ya.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIcons",!1);return!0};r.prototype.J_a=function(Q,R){this.tw=Q;this.ur=R;this.BS(this.Vqa)};r.prototype.BS=function(Q){!this.Vqa&&Q&&(this.OAc=new Date);this.Vqa=Q;this.Zvc=!1;Q=null;3===this.ur&&(Q=this.Vqa?this.Q_:this.R_);this.dEe(Q)};r.prototype.y0b=function(Q,R){return Q?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):R&&R.length?String.format(CommonUIStrings.l_SavedToStatus,
R):CommonUIStrings.l_SavedStatus};r.prototype.O_a=function(){this.BS(!1)};r.prototype.EWe=function(){switch(this.ur){case 1:return this.C_;case 2:return this.N_;default:return null}};r.prototype.DWe=function(){if(3!==this.ur)switch(this.ur){case 1:return"ReadOnly";case 2:return"ReviewOnly";default:return null}return this.Zvc?"FailedToSave":this.Vqa?"Saved":"Saving"};r.prototype.Kcf=function(Q){return this.BAc===this.tw&&this.LAc===this.ur&&this.RAc===Q};r.prototype.oWb=function(Q){var R=this;appChrome.getHeaderApi().then(function(F){F.updateDocumentTitleStatus(R.tw,
Q,R.EWe(),R.OAc,R.Vqa,R.ltc?F.getHeaderSaveStatusIconProps(R.DWe()):null);R.$vc=!0;return null});this.PKb=null};r.prototype.dEe=function(Q){var R=this;this.$j&&v.c()&&!this.Kcf(Q)&&(!this.$vc&&this.ya.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.oWb(Q):x.a.JXa()?(this.PKb&&m.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.PKb=window.requestIdleCallback(function(){R.oWb(Q)})):window.requestAnimationFrame(function(){R.oWb(Q)}),
this.BAc=this.tw,this.RAc=Q,this.LAc=this.ur)};Object(C.a)(r,"ReactSaveStatusUIHandler",null,[891]);var A=e(46);k.prototype.hu=function(){var Q=this;this.yO&&this.yO.execute(function(R){R.TPb(Object(w.a)(Q,Q.O_a,"updateToSavingStatus"))});this.CZ.execute(function(R){Q.eA=R})};k.prototype.J_a=function(Q,R){this.ur=R;3===R?this.BS(this.w7):2===R?this.Alc(this.N_):this.Alc(this.C_)};k.prototype.O_a=function(){this.BS(!1)};k.prototype.BS=function(Q){this.w7=Q;this.Alc(this.w7?this.Q_:this.R_)};k.prototype.Alc=
function(Q){this.eA&&this.eA.sendMessage(A.a.U6f,this.Jre(Q))};k.prototype.Jre=function(Q){var R={};R.StatusText=Q;return R};Object(C.a)(k,"SaveStatusPostMessageHandler",null,[891]);var B=e(177),E=e(91),L=e(49);n.prototype.initialize=function(Q,R){if(!this.Nc)return!1;this.Q_=this.y0b(Q,R);this.R_=CommonUIStrings.l_SavingStatus;this.C_=CommonUIStrings.l_ReadOnlyStatus;this.N_=CommonUIStrings.l_ReviewModeStatus;this.hu();return!0};n.prototype.y0b=function(Q,R){return Q?String.format(CommonUIStrings.l_SavedToStatus,
CommonUIStrings.l_OneDriveName):R&&R.length?String.format(CommonUIStrings.l_SavedToStatus,R):CommonUIStrings.l_SavedStatus};n.prototype.hu=function(){var Q=this;this.L5&&this.L5.execute(function(R){R.Xce(Object(w.a)(Q,Q.jZc,"createStatusAndModeElements"));R.Ece(Object(w.a)(Q,Q.yZf,"showHideSaveStatusElement"));R.X4f&&Q.jZc(null,null)});this.yO&&this.yO.execute(function(R){R.TPb(Object(w.a)(Q,Q.O_a,"updateToSavingStatus"))})};n.prototype.Qp=function(){this.Sx&&this.Nc&&this.Nc.DN(this.Sx)};n.prototype.yZf=
function(Q,R){this.J_a("true"===R,this.ur)};n.prototype.J_a=function(Q,R){this.tw=Q;this.ur=R;this.Oyb&&(this.Oyb.style.display=this.tw||3===this.ur||!this.cOb?"none":"");this.Jca&&(this.Jca.style.display=this.tw||3===this.ur?"none":"",this.Jca.innerText=1===this.ur?this.C_:this.N_,this.Jca.title=1===this.ur?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.ALb&&(this.ALb.style.display=this.tw||1===this.ur||!this.cOb&&!this.Jca?"none":"");this.Sx&&(this.Sx.style.display=
this.tw||1===this.ur?"none":"",this.BS(this.w7),this.Sx.title=CommonUIStrings.l_SaveStatusTooltip)};n.prototype.jZc=function(Q,R){Q=document.getElementById(B.a.A7e);R&&R.Ocg||!Q||""===this.Q_||""===this.R_||""===this.C_||""===this.N_||(this.cOb=document.getElementById(B.a.kSb),this.Oyb=B.a.Geb(Q,"BreadcrumbAppModeDash","-"),this.Jca=B.a.Geb(Q,"BreadcrumbAppModeStatus",1===this.ur?this.C_:this.N_),this.SNd(this.Jca),this.ALb=B.a.Geb(Q,"BreadcrumbSaveStatusDash","-"),this.Sx=B.a.Geb(Q,"BreadcrumbSaveStatus",
this.Q_),this.SNd(this.Sx),this.J_a(this.tw,this.ur))};n.prototype.O_a=function(){this.BS(!1)};n.prototype.BS=function(Q){this.w7=Q;this.q$f(this.w7?this.Q_:this.R_)};n.prototype.q$f=function(Q){!this.Sx||3!==this.ur&&2!==this.ur||(this.tyc&&!this.w7?(this.Ffa=this.Sx.offsetWidth<this.Ffa?this.Ffa:this.Sx.offsetWidth,this.f8f(this.R_),this.tyc=!1):this.Sx.innerText=Q)};n.prototype.SNd=function(Q){Q.style.direction=this.$f?"rtl":"ltr";Q.style.width="auto";Q.style.textAlign=this.$f?"right":"left";Q.style.display=
this.tw?"none":"";Q.setAttribute("Unselectable","on")};n.prototype.f8f=function(Q){this.Sx&&(this.Sx.style.width="",this.Sx.innerText=Q,this.Ffa=this.Sx.offsetWidth<this.Ffa?this.Ffa:this.Sx.offsetWidth,Q=E.a.Gf(this.Sx),this.Sx.style.width=this.Ffa-L.a.sk(Q.paddingLeft)-L.a.sk(Q.paddingRight)+1+"px")};Object(C.a)(n,"SaveStatusUIHandler",null,[891]);var S=e(1),J=e(139);b.prototype.Vf=function(Q){var R=this;this.Za=Q;S.AFrameworkApplication.H.J("PostMessageEmbedded")&&S.AFrameworkApplication.OJ?this.Za.register(k,
"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").Ab().xb(function(){return new k(R.Za.mc("Common.App.HostNotification.EditNotificationEventSource"),R.Za.mc("Postmessage.IHostPostmessenger"))}):S.AFrameworkApplication.ga.Xa.$hd||(S.AFrameworkApplication.ga.Xa.VG?this.Za.register(r,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").Ab().xb(function(){return new r(R.Za.mc("Common.App.HostNotification.EditNotificationEventSource"))}):
this.Za.register(n,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").Ab().xb(function(){return new n(J.EventHandlerManager.instance,R.Za.mc("Common.App.Header.HeaderEventSource"),R.Za.mc("Common.App.HostNotification.EditNotificationEventSource"),S.AFrameworkApplication.isRtl)}))};b.prototype.init=function(){S.AFrameworkApplication.H.qe(this.fu)};b.prototype.dispose=function(){this.QLa&&this.QLa.Qp()};D.global.Object.defineProperties(b.prototype,{name:{configurable:!0,
enumerable:!0,get:function(){return"Common.App.SaveStatus"}}});Object(C.a)(b,"PackageManager",null,[1,2]);e=e(90);Type.registerNamespace("Common.App.SaveStatus");e.a.instance.rh(new b)}}]);

//# sourceMappingURL=VisioWeb.editpostappframeinit.js.map